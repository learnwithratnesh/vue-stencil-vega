var __extends=this&&this.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();var __awaiter=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function o(e){try{s(r.next(e))}catch(t){a(t)}}function u(e){try{s(r["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):i(e.value).then(o,u)}s((r=r.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(e){return function(t){return s([e,t])}}function s(o){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(a=o[0]&2?i["return"]:o[0]?i["throw"]||((a=i["return"])&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;if(i=0,a)o=[o[0]&2,a.value];switch(o[0]){case 0:case 1:a=o;break;case 4:n.label++;return{value:o[1],done:false};case 5:n.label++;i=o[1];o=[0];continue;case 7:o=n.ops.pop();n.trys.pop();continue;default:if(!(a=n.trys,a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){n.label=o[1];break}if(o[0]===6&&n.label<a[1]){n.label=a[1];a=o;break}if(a&&n.label<a[2]){n.label=a[2];n.ops.push(o);break}if(a[2])n.ops.pop();n.trys.pop();continue}o=t.call(e,n)}catch(u){o=[6,u];i=0}finally{r=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var a=arguments[t],o=0,u=a.length;o<u;o++,i++)r[i]=a[o];return r};System.register(["./p-b25e1f62.system.js"],(function(e){"use strict";var t,n,r;return{setters:[function(e){t=e.r;n=e.h;r=e.g}],execute:function(){
/*! *****************************************************************************
            Copyright (c) Microsoft Corporation. All rights reserved.
            Licensed under the Apache License, Version 2.0 (the "License"); you may not use
            this file except in compliance with the License. You may obtain a copy of the
            License at http://www.apache.org/licenses/LICENSE-2.0

            THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
            KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
            WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
            MERCHANTABLITY OR NON-INFRINGEMENT.

            See the Apache Version 2.0 License for specific language governing permissions
            and limitations under the License.
            ***************************************************************************** */
var i,a,o,u,s,l,f,c;function h(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n}function d(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{s(r.next(e))}catch(t){a(t)}}function u(e){try{s(r["throw"](e))}catch(t){a(t)}}function s(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))}
/*!
             * https://github.com/Starcounter-Jack/JSON-Patch
             * (c) 2017 Joachim Wester
             * MIT license
             */var p=undefined&&undefined.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();var v=Object.prototype.hasOwnProperty;function g(e,t){return v.call(e,t)}function m(e){if(Array.isArray(e)){var t=new Array(e.length);for(var n=0;n<t.length;n++){t[n]=""+n}return t}if(Object.keys){return Object.keys(e)}var t=[];for(var r in e){if(g(e,r)){t.push(r)}}return t}function y(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function b(e){var t=0;var n=e.length;var r;while(t<n){r=e.charCodeAt(t);if(r>=48&&r<=57){t++;continue}return false}return true}function _(e){if(e.indexOf("/")===-1&&e.indexOf("~")===-1)return e;return e.replace(/~/g,"~0").replace(/\//g,"~1")}function x(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function w(e){if(e===undefined){return true}if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++){if(w(e[t])){return true}}}else if(typeof e==="object"){var r=m(e);var i=r.length;for(var t=0;t<i;t++){if(w(e[r[t]])){return true}}}}return false}function k(e,t){var n=[e];for(var r in t){var i=typeof t[r]==="object"?JSON.stringify(t[r],null,2):t[r];if(typeof i!=="undefined"){n.push(r+": "+i)}}return n.join("\n")}var A=function(e){p(t,e);function t(t,n,r,i,a){var o=this.constructor;var u=e.call(this,k(t,{name:n,index:r,operation:i,tree:a}))||this;u.name=n;u.index=r;u.operation=i;u.tree=a;Object.setPrototypeOf(u,o.prototype);u.message=k(t,{name:n,index:r,operation:i,tree:a});return u}return t}(Error);var E=A;var M=y;var O={add:function(e,t,n){e[t]=this.value;return{newDocument:n}},remove:function(e,t,n){var r=e[t];delete e[t];return{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];e[t]=this.value;return{newDocument:n,removed:r}},move:function(e,t,n){var r=D(n,this.path);if(r){r=y(r)}var i=C(n,{op:"remove",path:this.from}).removed;C(n,{op:"add",path:this.path,value:i});return{newDocument:n,removed:r}},copy:function(e,t,n){var r=D(n,this.from);C(n,{op:"add",path:this.path,value:y(r)});return{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:R(e[t],this.value)}},_get:function(e,t,n){this.value=e[t];return{newDocument:n}}};var S={add:function(e,t,n){if(b(t)){e.splice(t,0,this.value)}else{e[t]=this.value}return{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];e[t]=this.value;return{newDocument:n,removed:r}},move:O.move,copy:O.copy,test:O.test,_get:O._get};function D(e,t){if(t==""){return e}var n={op:"_get",path:t};C(e,n);return n.value}function C(e,t,n,r,i,a){if(n===void 0){n=false}if(r===void 0){r=true}if(i===void 0){i=true}if(a===void 0){a=0}if(n){if(typeof n=="function"){n(t,0,e,t.path)}else{N(t,0)}}if(t.path===""){var o={newDocument:e};if(t.op==="add"){o.newDocument=t.value;return o}else if(t.op==="replace"){o.newDocument=t.value;o.removed=e;return o}else if(t.op==="move"||t.op==="copy"){o.newDocument=D(e,t.from);if(t.op==="move"){o.removed=e}return o}else if(t.op==="test"){o.test=R(e,t.value);if(o.test===false){throw new E("Test operation failed","TEST_OPERATION_FAILED",a,t,e)}o.newDocument=e;return o}else if(t.op==="remove"){o.removed=e;o.newDocument=null;return o}else if(t.op==="_get"){t.value=e;return o}else{if(n){throw new E("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e)}else{return o}}}else{if(!r){e=y(e)}var u=t.path||"";var s=u.split("/");var l=e;var f=1;var c=s.length;var h=undefined;var d=void 0;var p=void 0;if(typeof n=="function"){p=n}else{p=N}while(true){d=s[f];if(i&&d=="__proto__"){throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README")}if(n){if(h===undefined){if(l[d]===undefined){h=s.slice(0,f).join("/")}else if(f==c-1){h=t.path}if(h!==undefined){p(t,0,e,h)}}}f++;if(Array.isArray(l)){if(d==="-"){d=l.length}else{if(n&&!b(d)){throw new E("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e)}else if(b(d)){d=~~d}}if(f>=c){if(n&&t.op==="add"&&d>l.length){throw new E("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e)}var o=S[t.op].call(t,l,d,e);if(o.test===false){throw new E("Test operation failed","TEST_OPERATION_FAILED",a,t,e)}return o}}else{if(d&&d.indexOf("~")!=-1){d=x(d)}if(f>=c){var o=O[t.op].call(t,l,d,e);if(o.test===false){throw new E("Test operation failed","TEST_OPERATION_FAILED",a,t,e)}return o}}l=l[d]}}}function F(e,t,n,r,i){if(r===void 0){r=true}if(i===void 0){i=true}if(n){if(!Array.isArray(t)){throw new E("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY")}}if(!r){e=y(e)}var a=new Array(t.length);for(var o=0,u=t.length;o<u;o++){a[o]=C(e,t[o],n,true,i,o);e=a[o].newDocument}a.newDocument=e;return a}function T(e,t,n){var r=C(e,t);if(r.test===false){throw new E("Test operation failed","TEST_OPERATION_FAILED",n,t,e)}return r.newDocument}function N(e,t,n,r){if(typeof e!=="object"||e===null||Array.isArray(e)){throw new E("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n)}else if(!O[e.op]){throw new E("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}else if(typeof e.path!=="string"){throw new E("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n)}else if(e.path.indexOf("/")!==0&&e.path.length>0){throw new E('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n)}else if((e.op==="move"||e.op==="copy")&&typeof e.from!=="string"){throw new E("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n)}else if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===undefined){throw new E("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n)}else if((e.op==="add"||e.op==="replace"||e.op==="test")&&w(e.value)){throw new E("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n)}else if(n){if(e.op=="add"){var i=e.path.split("/").length;var a=r.split("/").length;if(i!==a+1&&i!==a){throw new E("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r){throw new E("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:undefined};var u=j([o],n);if(u&&u.name==="OPERATION_PATH_UNRESOLVABLE"){throw new E("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}}function j(e,t,n){try{if(!Array.isArray(e)){throw new E("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY")}if(t){F(y(t),y(e),n||true)}else{n=n||N;for(var r=0;r<e.length;r++){n(e[r],r,t,undefined)}}}catch(i){if(i instanceof E){return i}else{throw i}}}function R(e,t){if(e===t)return true;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,a,o;if(n&&r){a=e.length;if(a!=t.length)return false;for(i=a;i--!==0;)if(!R(e[i],t[i]))return false;return true}if(n!=r)return false;var u=Object.keys(e);a=u.length;if(a!==Object.keys(t).length)return false;for(i=a;i--!==0;)if(!t.hasOwnProperty(u[i]))return false;for(i=a;i--!==0;){o=u[i];if(!R(e[o],t[o]))return false}return true}return e!==e&&t!==t}var z=Object.freeze({__proto__:null,JsonPatchError:E,deepClone:M,getValueByPointer:D,applyOperation:C,applyPatch:F,applyReducer:T,validator:N,validate:j,_areEquals:R});
/*!
             * https://github.com/Starcounter-Jack/JSON-Patch
             * (c) 2017 Joachim Wester
             * MIT license
             */var P=new WeakMap;var L=function(){function e(e){this.observers=new Map;this.obj=e}return e}();var I=function(){function e(e,t){this.callback=e;this.observer=t}return e}();function B(e){return P.get(e)}function U(e,t){return e.observers.get(t)}function q(e,t){e.observers.delete(t.callback)}function W(e,t){t.unobserve()}function H(e,t){var n=[];var r;var i=B(e);if(!i){i=new L(e);P.set(e,i)}else{var a=U(i,t);r=a&&a.observer}if(r){return r}r={};i.value=y(e);if(t){r.callback=t;r.next=null;var o=function(){G(r)};var u=function(){clearTimeout(r.next);r.next=setTimeout(o)};if(typeof window!=="undefined"){window.addEventListener("mouseup",u);window.addEventListener("keyup",u);window.addEventListener("mousedown",u);window.addEventListener("keydown",u);window.addEventListener("change",u)}}r.patches=n;r.object=e;r.unobserve=function(){G(r);clearTimeout(r.next);q(i,r);if(typeof window!=="undefined"){window.removeEventListener("mouseup",u);window.removeEventListener("keyup",u);window.removeEventListener("mousedown",u);window.removeEventListener("keydown",u);window.removeEventListener("change",u)}};i.observers.set(t,new I(t,r));return r}function G(e,t){if(t===void 0){t=false}var n=P.get(e.object);$(n.value,e.object,e.patches,"",t);if(e.patches.length){F(n.value,e.patches)}var r=e.patches;if(r.length>0){e.patches=[];if(e.callback){e.callback(r)}}return r}function $(e,t,n,r,i){if(t===e){return}if(typeof t.toJSON==="function"){t=t.toJSON()}var a=m(t);var o=m(e);var u=false;for(var s=o.length-1;s>=0;s--){var l=o[s];var f=e[l];if(g(t,l)&&!(t[l]===undefined&&f!==undefined&&Array.isArray(t)===false)){var c=t[l];if(typeof f=="object"&&f!=null&&typeof c=="object"&&c!=null){$(f,c,n,r+"/"+_(l),i)}else{if(f!==c){if(i){n.push({op:"test",path:r+"/"+_(l),value:y(f)})}n.push({op:"replace",path:r+"/"+_(l),value:y(c)})}}}else if(Array.isArray(e)===Array.isArray(t)){if(i){n.push({op:"test",path:r+"/"+_(l),value:y(f)})}n.push({op:"remove",path:r+"/"+_(l)});u=true}else{if(i){n.push({op:"test",path:r,value:e})}n.push({op:"replace",path:r,value:t})}}if(!u&&a.length==o.length){return}for(var s=0;s<a.length;s++){var l=a[s];if(!g(e,l)&&t[l]!==undefined){n.push({op:"add",path:r+"/"+_(l),value:y(t[l])})}}}function Y(e,t,n){if(n===void 0){n=false}var r=[];$(e,t,r,"",n);return r}var V=Object.freeze({__proto__:null,unobserve:W,observe:H,generate:G,compare:Y});Object.assign({},z,V,{JsonPatchError:A,deepClone:y,escapePathComponent:_,unescapePathComponent:x});var X=/("(?:[^\\"]|\\.)*")|[:,]/g;var J=function e(t,n){var r,i,a;n=n||{};r=JSON.stringify([1],undefined,n.indent===undefined?2:n.indent).slice(2,-3);i=r===""?Infinity:n.maxLength===undefined?80:n.maxLength;a=n.replacer;return function e(t,n,o){var u,s,l,f,c,h,d,p,v,g,m,y;if(t&&typeof t.toJSON==="function"){t=t.toJSON()}m=JSON.stringify(t,a);if(m===undefined){return m}d=i-n.length-o;if(m.length<=d){v=m.replace(X,(function(e,t){return t||e+" "}));if(v.length<=d){return v}}if(a!=null){t=JSON.parse(m);a=undefined}if(typeof t==="object"&&t!==null){p=n+r;l=[];s=0;if(Array.isArray(t)){g="[";u="]";d=t.length;for(;s<d;s++){l.push(e(t[s],p,s===d-1?0:1)||"null")}}else{g="{";u="}";h=Object.keys(t);d=h.length;for(;s<d;s++){f=h[s];c=JSON.stringify(f)+": ";y=e(t[f],p,c.length+(s===d-1?0:1));if(y!==undefined){l.push(c+y)}}}if(l.length>0){return[g,r+l.join(",\n"+p),u].join("\n"+n)}}return m}(t,"",0)};function Z(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function Q(e,t){return t={exports:{}},e(t,t.exports),t.exports}var K=Q((function(e,t){t=e.exports=y;var n;if(typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)){n=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER");console.log.apply(console,e)}}else{n=function(){}}t.SEMVER_SPEC_VERSION="2.0.0";var r=256;var i=Number.MAX_SAFE_INTEGER||9007199254740991;var a=16;var o=t.re=[];var u=t.src=[];var s=t.tokens={};var l=0;function f(e){s[e]=l++}f("NUMERICIDENTIFIER");u[s.NUMERICIDENTIFIER]="0|[1-9]\\d*";f("NUMERICIDENTIFIERLOOSE");u[s.NUMERICIDENTIFIERLOOSE]="[0-9]+";f("NONNUMERICIDENTIFIER");u[s.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";f("MAINVERSION");u[s.MAINVERSION]="("+u[s.NUMERICIDENTIFIER]+")\\."+"("+u[s.NUMERICIDENTIFIER]+")\\."+"("+u[s.NUMERICIDENTIFIER]+")";f("MAINVERSIONLOOSE");u[s.MAINVERSIONLOOSE]="("+u[s.NUMERICIDENTIFIERLOOSE]+")\\."+"("+u[s.NUMERICIDENTIFIERLOOSE]+")\\."+"("+u[s.NUMERICIDENTIFIERLOOSE]+")";f("PRERELEASEIDENTIFIER");u[s.PRERELEASEIDENTIFIER]="(?:"+u[s.NUMERICIDENTIFIER]+"|"+u[s.NONNUMERICIDENTIFIER]+")";f("PRERELEASEIDENTIFIERLOOSE");u[s.PRERELEASEIDENTIFIERLOOSE]="(?:"+u[s.NUMERICIDENTIFIERLOOSE]+"|"+u[s.NONNUMERICIDENTIFIER]+")";f("PRERELEASE");u[s.PRERELEASE]="(?:-("+u[s.PRERELEASEIDENTIFIER]+"(?:\\."+u[s.PRERELEASEIDENTIFIER]+")*))";f("PRERELEASELOOSE");u[s.PRERELEASELOOSE]="(?:-?("+u[s.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+u[s.PRERELEASEIDENTIFIERLOOSE]+")*))";f("BUILDIDENTIFIER");u[s.BUILDIDENTIFIER]="[0-9A-Za-z-]+";f("BUILD");u[s.BUILD]="(?:\\+("+u[s.BUILDIDENTIFIER]+"(?:\\."+u[s.BUILDIDENTIFIER]+")*))";f("FULL");f("FULLPLAIN");u[s.FULLPLAIN]="v?"+u[s.MAINVERSION]+u[s.PRERELEASE]+"?"+u[s.BUILD]+"?";u[s.FULL]="^"+u[s.FULLPLAIN]+"$";f("LOOSEPLAIN");u[s.LOOSEPLAIN]="[v=\\s]*"+u[s.MAINVERSIONLOOSE]+u[s.PRERELEASELOOSE]+"?"+u[s.BUILD]+"?";f("LOOSE");u[s.LOOSE]="^"+u[s.LOOSEPLAIN]+"$";f("GTLT");u[s.GTLT]="((?:<|>)?=?)";f("XRANGEIDENTIFIERLOOSE");u[s.XRANGEIDENTIFIERLOOSE]=u[s.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*";f("XRANGEIDENTIFIER");u[s.XRANGEIDENTIFIER]=u[s.NUMERICIDENTIFIER]+"|x|X|\\*";f("XRANGEPLAIN");u[s.XRANGEPLAIN]="[v=\\s]*("+u[s.XRANGEIDENTIFIER]+")"+"(?:\\.("+u[s.XRANGEIDENTIFIER]+")"+"(?:\\.("+u[s.XRANGEIDENTIFIER]+")"+"(?:"+u[s.PRERELEASE]+")?"+u[s.BUILD]+"?"+")?)?";f("XRANGEPLAINLOOSE");u[s.XRANGEPLAINLOOSE]="[v=\\s]*("+u[s.XRANGEIDENTIFIERLOOSE]+")"+"(?:\\.("+u[s.XRANGEIDENTIFIERLOOSE]+")"+"(?:\\.("+u[s.XRANGEIDENTIFIERLOOSE]+")"+"(?:"+u[s.PRERELEASELOOSE]+")?"+u[s.BUILD]+"?"+")?)?";f("XRANGE");u[s.XRANGE]="^"+u[s.GTLT]+"\\s*"+u[s.XRANGEPLAIN]+"$";f("XRANGELOOSE");u[s.XRANGELOOSE]="^"+u[s.GTLT]+"\\s*"+u[s.XRANGEPLAINLOOSE]+"$";f("COERCE");u[s.COERCE]="(^|[^\\d])"+"(\\d{1,"+a+"})"+"(?:\\.(\\d{1,"+a+"}))?"+"(?:\\.(\\d{1,"+a+"}))?"+"(?:$|[^\\d])";f("COERCERTL");o[s.COERCERTL]=new RegExp(u[s.COERCE],"g");f("LONETILDE");u[s.LONETILDE]="(?:~>?)";f("TILDETRIM");u[s.TILDETRIM]="(\\s*)"+u[s.LONETILDE]+"\\s+";o[s.TILDETRIM]=new RegExp(u[s.TILDETRIM],"g");var c="$1~";f("TILDE");u[s.TILDE]="^"+u[s.LONETILDE]+u[s.XRANGEPLAIN]+"$";f("TILDELOOSE");u[s.TILDELOOSE]="^"+u[s.LONETILDE]+u[s.XRANGEPLAINLOOSE]+"$";f("LONECARET");u[s.LONECARET]="(?:\\^)";f("CARETTRIM");u[s.CARETTRIM]="(\\s*)"+u[s.LONECARET]+"\\s+";o[s.CARETTRIM]=new RegExp(u[s.CARETTRIM],"g");var h="$1^";f("CARET");u[s.CARET]="^"+u[s.LONECARET]+u[s.XRANGEPLAIN]+"$";f("CARETLOOSE");u[s.CARETLOOSE]="^"+u[s.LONECARET]+u[s.XRANGEPLAINLOOSE]+"$";f("COMPARATORLOOSE");u[s.COMPARATORLOOSE]="^"+u[s.GTLT]+"\\s*("+u[s.LOOSEPLAIN]+")$|^$";f("COMPARATOR");u[s.COMPARATOR]="^"+u[s.GTLT]+"\\s*("+u[s.FULLPLAIN]+")$|^$";f("COMPARATORTRIM");u[s.COMPARATORTRIM]="(\\s*)"+u[s.GTLT]+"\\s*("+u[s.LOOSEPLAIN]+"|"+u[s.XRANGEPLAIN]+")";o[s.COMPARATORTRIM]=new RegExp(u[s.COMPARATORTRIM],"g");var d="$1$2$3";f("HYPHENRANGE");u[s.HYPHENRANGE]="^\\s*("+u[s.XRANGEPLAIN]+")"+"\\s+-\\s+"+"("+u[s.XRANGEPLAIN]+")"+"\\s*$";f("HYPHENRANGELOOSE");u[s.HYPHENRANGELOOSE]="^\\s*("+u[s.XRANGEPLAINLOOSE]+")"+"\\s+-\\s+"+"("+u[s.XRANGEPLAINLOOSE]+")"+"\\s*$";f("STAR");u[s.STAR]="(<|>)?=?\\s*\\*";for(var p=0;p<l;p++){n(p,u[p]);if(!o[p]){o[p]=new RegExp(u[p])}}t.parse=v;function v(e,t){if(!t||typeof t!=="object"){t={loose:!!t,includePrerelease:false}}if(e instanceof y){return e}if(typeof e!=="string"){return null}if(e.length>r){return null}var n=t.loose?o[s.LOOSE]:o[s.FULL];if(!n.test(e)){return null}try{return new y(e,t)}catch(i){return null}}t.valid=g;function g(e,t){var n=v(e,t);return n?n.version:null}t.clean=m;function m(e,t){var n=v(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}t.SemVer=y;function y(e,t){if(!t||typeof t!=="object"){t={loose:!!t,includePrerelease:false}}if(e instanceof y){if(e.loose===t.loose){return e}else{e=e.version}}else if(typeof e!=="string"){throw new TypeError("Invalid Version: "+e)}if(e.length>r){throw new TypeError("version is longer than "+r+" characters")}if(!(this instanceof y)){return new y(e,t)}n("SemVer",e,t);this.options=t;this.loose=!!t.loose;var a=e.trim().match(t.loose?o[s.LOOSE]:o[s.FULL]);if(!a){throw new TypeError("Invalid Version: "+e)}this.raw=e;this.major=+a[1];this.minor=+a[2];this.patch=+a[3];if(this.major>i||this.major<0){throw new TypeError("Invalid major version")}if(this.minor>i||this.minor<0){throw new TypeError("Invalid minor version")}if(this.patch>i||this.patch<0){throw new TypeError("Invalid patch version")}if(!a[4]){this.prerelease=[]}else{this.prerelease=a[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i){return t}}return e}))}this.build=a[5]?a[5].split("."):[];this.format()}y.prototype.format=function(){this.version=this.major+"."+this.minor+"."+this.patch;if(this.prerelease.length){this.version+="-"+this.prerelease.join(".")}return this.version};y.prototype.toString=function(){return this.version};y.prototype.compare=function(e){n("SemVer.compare",this.version,this.options,e);if(!(e instanceof y)){e=new y(e,this.options)}return this.compareMain(e)||this.comparePre(e)};y.prototype.compareMain=function(e){if(!(e instanceof y)){e=new y(e,this.options)}return w(this.major,e.major)||w(this.minor,e.minor)||w(this.patch,e.patch)};y.prototype.comparePre=function(e){if(!(e instanceof y)){e=new y(e,this.options)}if(this.prerelease.length&&!e.prerelease.length){return-1}else if(!this.prerelease.length&&e.prerelease.length){return 1}else if(!this.prerelease.length&&!e.prerelease.length){return 0}var t=0;do{var r=this.prerelease[t];var i=e.prerelease[t];n("prerelease compare",t,r,i);if(r===undefined&&i===undefined){return 0}else if(i===undefined){return 1}else if(r===undefined){return-1}else if(r===i){continue}else{return w(r,i)}}while(++t)};y.prototype.compareBuild=function(e){if(!(e instanceof y)){e=new y(e,this.options)}var t=0;do{var r=this.build[t];var i=e.build[t];n("prerelease compare",t,r,i);if(r===undefined&&i===undefined){return 0}else if(i===undefined){return 1}else if(r===undefined){return-1}else if(r===i){continue}else{return w(r,i)}}while(++t)};y.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc("pre",t);break;case"preminor":this.prerelease.length=0;this.patch=0;this.minor++;this.inc("pre",t);break;case"prepatch":this.prerelease.length=0;this.inc("patch",t);this.inc("pre",t);break;case"prerelease":if(this.prerelease.length===0){this.inc("patch",t)}this.inc("pre",t);break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0){this.major++}this.minor=0;this.patch=0;this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0){this.minor++}this.patch=0;this.prerelease=[];break;case"patch":if(this.prerelease.length===0){this.patch++}this.prerelease=[];break;case"pre":if(this.prerelease.length===0){this.prerelease=[0]}else{var n=this.prerelease.length;while(--n>=0){if(typeof this.prerelease[n]==="number"){this.prerelease[n]++;n=-2}}if(n===-1){this.prerelease.push(0)}}if(t){if(this.prerelease[0]===t){if(isNaN(this.prerelease[1])){this.prerelease=[t,0]}}else{this.prerelease=[t,0]}}break;default:throw new Error("invalid increment argument: "+e)}this.format();this.raw=this.version;return this};t.inc=b;function b(e,t,n,r){if(typeof n==="string"){r=n;n=undefined}try{return new y(e,n).inc(t,r).version}catch(i){return null}}t.diff=_;function _(e,t){if(R(e,t)){return null}else{var n=v(e);var r=v(t);var i="";if(n.prerelease.length||r.prerelease.length){i="pre";var a="prerelease"}for(var o in n){if(o==="major"||o==="minor"||o==="patch"){if(n[o]!==r[o]){return i+o}}}return a}}t.compareIdentifiers=w;var x=/^[0-9]+$/;function w(e,t){var n=x.test(e);var r=x.test(t);if(n&&r){e=+e;t=+t}return e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1}t.rcompareIdentifiers=k;function k(e,t){return w(t,e)}t.major=A;function A(e,t){return new y(e,t).major}t.minor=E;function E(e,t){return new y(e,t).minor}t.patch=M;function M(e,t){return new y(e,t).patch}t.compare=O;function O(e,t,n){return new y(e,n).compare(new y(t,n))}t.compareLoose=S;function S(e,t){return O(e,t,true)}t.compareBuild=D;function D(e,t,n){var r=new y(e,n);var i=new y(t,n);return r.compare(i)||r.compareBuild(i)}t.rcompare=C;function C(e,t,n){return O(t,e,n)}t.sort=F;function F(e,n){return e.sort((function(e,r){return t.compareBuild(e,r,n)}))}t.rsort=T;function T(e,n){return e.sort((function(e,r){return t.compareBuild(r,e,n)}))}t.gt=N;function N(e,t,n){return O(e,t,n)>0}t.lt=j;function j(e,t,n){return O(e,t,n)<0}t.eq=R;function R(e,t,n){return O(e,t,n)===0}t.neq=z;function z(e,t,n){return O(e,t,n)!==0}t.gte=P;function P(e,t,n){return O(e,t,n)>=0}t.lte=L;function L(e,t,n){return O(e,t,n)<=0}t.cmp=I;function I(e,t,n,r){switch(t){case"===":if(typeof e==="object")e=e.version;if(typeof n==="object")n=n.version;return e===n;case"!==":if(typeof e==="object")e=e.version;if(typeof n==="object")n=n.version;return e!==n;case"":case"=":case"==":return R(e,n,r);case"!=":return z(e,n,r);case">":return N(e,n,r);case">=":return P(e,n,r);case"<":return j(e,n,r);case"<=":return L(e,n,r);default:throw new TypeError("Invalid operator: "+t)}}t.Comparator=B;function B(e,t){if(!t||typeof t!=="object"){t={loose:!!t,includePrerelease:false}}if(e instanceof B){if(e.loose===!!t.loose){return e}else{e=e.value}}if(!(this instanceof B)){return new B(e,t)}n("comparator",e,t);this.options=t;this.loose=!!t.loose;this.parse(e);if(this.semver===U){this.value=""}else{this.value=this.operator+this.semver.version}n("comp",this)}var U={};B.prototype.parse=function(e){var t=this.options.loose?o[s.COMPARATORLOOSE]:o[s.COMPARATOR];var n=e.match(t);if(!n){throw new TypeError("Invalid comparator: "+e)}this.operator=n[1]!==undefined?n[1]:"";if(this.operator==="="){this.operator=""}if(!n[2]){this.semver=U}else{this.semver=new y(n[2],this.options.loose)}};B.prototype.toString=function(){return this.value};B.prototype.test=function(e){n("Comparator.test",e,this.options.loose);if(this.semver===U||e===U){return true}if(typeof e==="string"){try{e=new y(e,this.options)}catch(t){return false}}return I(e,this.operator,this.semver,this.options)};B.prototype.intersects=function(e,t){if(!(e instanceof B)){throw new TypeError("a Comparator is required")}if(!t||typeof t!=="object"){t={loose:!!t,includePrerelease:false}}var n;if(this.operator===""){if(this.value===""){return true}n=new q(e.value,t);return ne(this.value,n,t)}else if(e.operator===""){if(e.value===""){return true}n=new q(this.value,t);return ne(e.semver,n,t)}var r=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">");var i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<");var a=this.semver.version===e.semver.version;var o=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<=");var u=I(this.semver,"<",e.semver,t)&&((this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"));var s=I(this.semver,">",e.semver,t)&&((this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">"));return r||i||a&&o||u||s};t.Range=q;function q(e,t){if(!t||typeof t!=="object"){t={loose:!!t,includePrerelease:false}}if(e instanceof q){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease){return e}else{return new q(e.raw,t)}}if(e instanceof B){return new q(e.value,t)}if(!(this instanceof q)){return new q(e,t)}this.options=t;this.loose=!!t.loose;this.includePrerelease=!!t.includePrerelease;this.raw=e;this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length}));if(!this.set.length){throw new TypeError("Invalid SemVer Range: "+e)}this.format()}q.prototype.format=function(){this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim();return this.range};q.prototype.toString=function(){return this.range};q.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var r=t?o[s.HYPHENRANGELOOSE]:o[s.HYPHENRANGE];e=e.replace(r,ee);n("hyphen replace",e);e=e.replace(o[s.COMPARATORTRIM],d);n("comparator trim",e,o[s.COMPARATORTRIM]);e=e.replace(o[s.TILDETRIM],c);e=e.replace(o[s.CARETTRIM],h);e=e.split(/\s+/).join(" ");var i=t?o[s.COMPARATORLOOSE]:o[s.COMPARATOR];var a=e.split(" ").map((function(e){return G(e,this.options)}),this).join(" ").split(/\s+/);if(this.options.loose){a=a.filter((function(e){return!!e.match(i)}))}a=a.map((function(e){return new B(e,this.options)}),this);return a};q.prototype.intersects=function(e,t){if(!(e instanceof q)){throw new TypeError("a Range is required")}return this.set.some((function(n){return W(n,t)&&e.set.some((function(e){return W(e,t)&&n.every((function(n){return e.every((function(e){return n.intersects(e,t)}))}))}))}))};function W(e,t){var n=true;var r=e.slice();var i=r.pop();while(n&&r.length){n=r.every((function(e){return i.intersects(e,t)}));i=r.pop()}return n}t.toComparators=H;function H(e,t){return new q(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))}function G(e,t){n("comp",e,t);e=X(e,t);n("caret",e);e=Y(e,t);n("tildes",e);e=Z(e,t);n("xrange",e);e=K(e,t);n("stars",e);return e}function $(e){return!e||e.toLowerCase()==="x"||e==="*"}function Y(e,t){return e.trim().split(/\s+/).map((function(e){return V(e,t)})).join(" ")}function V(e,t){var r=t.loose?o[s.TILDELOOSE]:o[s.TILDE];return e.replace(r,(function(t,r,i,a,o){n("tilde",e,t,r,i,a,o);var u;if($(r)){u=""}else if($(i)){u=">="+r+".0.0 <"+(+r+1)+".0.0"}else if($(a)){u=">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0"}else if(o){n("replaceTilde pr",o);u=">="+r+"."+i+"."+a+"-"+o+" <"+r+"."+(+i+1)+".0"}else{u=">="+r+"."+i+"."+a+" <"+r+"."+(+i+1)+".0"}n("tilde return",u);return u}))}function X(e,t){return e.trim().split(/\s+/).map((function(e){return J(e,t)})).join(" ")}function J(e,t){n("caret",e,t);var r=t.loose?o[s.CARETLOOSE]:o[s.CARET];return e.replace(r,(function(t,r,i,a,o){n("caret",e,t,r,i,a,o);var u;if($(r)){u=""}else if($(i)){u=">="+r+".0.0 <"+(+r+1)+".0.0"}else if($(a)){if(r==="0"){u=">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0"}else{u=">="+r+"."+i+".0 <"+(+r+1)+".0.0"}}else if(o){n("replaceCaret pr",o);if(r==="0"){if(i==="0"){u=">="+r+"."+i+"."+a+"-"+o+" <"+r+"."+i+"."+(+a+1)}else{u=">="+r+"."+i+"."+a+"-"+o+" <"+r+"."+(+i+1)+".0"}}else{u=">="+r+"."+i+"."+a+"-"+o+" <"+(+r+1)+".0.0"}}else{n("no pr");if(r==="0"){if(i==="0"){u=">="+r+"."+i+"."+a+" <"+r+"."+i+"."+(+a+1)}else{u=">="+r+"."+i+"."+a+" <"+r+"."+(+i+1)+".0"}}else{u=">="+r+"."+i+"."+a+" <"+(+r+1)+".0.0"}}n("caret return",u);return u}))}function Z(e,t){n("replaceXRanges",e,t);return e.split(/\s+/).map((function(e){return Q(e,t)})).join(" ")}function Q(e,t){e=e.trim();var r=t.loose?o[s.XRANGELOOSE]:o[s.XRANGE];return e.replace(r,(function(r,i,a,o,u,s){n("xRange",e,r,i,a,o,u,s);var l=$(a);var f=l||$(o);var c=f||$(u);var h=c;if(i==="="&&h){i=""}s=t.includePrerelease?"-0":"";if(l){if(i===">"||i==="<"){r="<0.0.0-0"}else{r="*"}}else if(i&&h){if(f){o=0}u=0;if(i===">"){i=">=";if(f){a=+a+1;o=0;u=0}else{o=+o+1;u=0}}else if(i==="<="){i="<";if(f){a=+a+1}else{o=+o+1}}r=i+a+"."+o+"."+u+s}else if(f){r=">="+a+".0.0"+s+" <"+(+a+1)+".0.0"+s}else if(c){r=">="+a+"."+o+".0"+s+" <"+a+"."+(+o+1)+".0"+s}n("xRange return",r);return r}))}function K(e,t){n("replaceStars",e,t);return e.trim().replace(o[s.STAR],"")}function ee(e,t,n,r,i,a,o,u,s,l,f,c,h){if($(n)){t=""}else if($(r)){t=">="+n+".0.0"}else if($(i)){t=">="+n+"."+r+".0"}else{t=">="+t}if($(s)){u=""}else if($(l)){u="<"+(+s+1)+".0.0"}else if($(f)){u="<"+s+"."+(+l+1)+".0"}else if(c){u="<="+s+"."+l+"."+f+"-"+c}else{u="<="+u}return(t+" "+u).trim()}q.prototype.test=function(e){if(!e){return false}if(typeof e==="string"){try{e=new y(e,this.options)}catch(n){return false}}for(var t=0;t<this.set.length;t++){if(te(this.set[t],e,this.options)){return true}}return false};function te(e,t,r){for(var i=0;i<e.length;i++){if(!e[i].test(t)){return false}}if(t.prerelease.length&&!r.includePrerelease){for(i=0;i<e.length;i++){n(e[i].semver);if(e[i].semver===U){continue}if(e[i].semver.prerelease.length>0){var a=e[i].semver;if(a.major===t.major&&a.minor===t.minor&&a.patch===t.patch){return true}}}return false}return true}t.satisfies=ne;function ne(e,t,n){try{t=new q(t,n)}catch(r){return false}return t.test(e)}t.maxSatisfying=re;function re(e,t,n){var r=null;var i=null;try{var a=new q(t,n)}catch(o){return null}e.forEach((function(e){if(a.test(e)){if(!r||i.compare(e)===-1){r=e;i=new y(r,n)}}}));return r}t.minSatisfying=ie;function ie(e,t,n){var r=null;var i=null;try{var a=new q(t,n)}catch(o){return null}e.forEach((function(e){if(a.test(e)){if(!r||i.compare(e)===1){r=e;i=new y(r,n)}}}));return r}t.minVersion=ae;function ae(e,t){e=new q(e,t);var n=new y("0.0.0");if(e.test(n)){return n}n=new y("0.0.0-0");if(e.test(n)){return n}n=null;for(var r=0;r<e.set.length;++r){var i=e.set[r];i.forEach((function(e){var t=new y(e.semver.version);switch(e.operator){case">":if(t.prerelease.length===0){t.patch++}else{t.prerelease.push(0)}t.raw=t.format();case"":case">=":if(!n||N(n,t)){n=t}break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(n&&e.test(n)){return n}return null}t.validRange=oe;function oe(e,t){try{return new q(e,t).range||"*"}catch(n){return null}}t.ltr=ue;function ue(e,t,n){return le(e,t,"<",n)}t.gtr=se;function se(e,t,n){return le(e,t,">",n)}t.outside=le;function le(e,t,n,r){e=new y(e,r);t=new q(t,r);var i,a,o,u,s;switch(n){case">":i=N;a=L;o=j;u=">";s=">=";break;case"<":i=j;a=P;o=N;u="<";s="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ne(e,t,r)){return false}for(var l=0;l<t.set.length;++l){var f=t.set[l];var c=null;var h=null;f.forEach((function(e){if(e.semver===U){e=new B(">=0.0.0")}c=c||e;h=h||e;if(i(e.semver,c.semver,r)){c=e}else if(o(e.semver,h.semver,r)){h=e}}));if(c.operator===u||c.operator===s){return false}if((!h.operator||h.operator===u)&&a(e,h.semver)){return false}else if(h.operator===s&&o(e,h.semver)){return false}}return true}t.prerelease=fe;function fe(e,t){var n=v(e,t);return n&&n.prerelease.length?n.prerelease:null}t.intersects=ce;function ce(e,t,n){e=new q(e,n);t=new q(t,n);return e.intersects(t)}t.coerce=he;function he(e,t){if(e instanceof y){return e}if(typeof e==="number"){e=String(e)}if(typeof e!=="string"){return null}t=t||{};var n=null;if(!t.rtl){n=e.match(o[s.COERCE])}else{var r;while((r=o[s.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length)){if(!n||r.index+r[0].length!==n.index+n[0].length){n=r}o[s.COERCERTL].lastIndex=r.index+r[1].length+r[2].length}o[s.COERCERTL].lastIndex=-1}if(n===null){return null}return v(n[2]+"."+(n[3]||"0")+"."+(n[4]||"0"),t)}}));var ee=K.satisfies;function te(e,t,n){e.fields=t||[];e.fname=n;return e}function ne(e){return e==null?null:e.fname}function re(e){return e==null?null:e.fields}function ie(e){throw Error(e)}function ae(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)ie("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)ie("Access path missing closing bracket: "+e);if(n)ie("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var oe=Array.isArray;function ue(e){return e===Object(e)}function se(e){return typeof e==="string"}function le(e){return oe(e)?"["+e.map(le)+"]":ue(e)||se(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function fe(e,t){var n=ae(e),r="return _["+n.map(le).join("][")+"];";return te(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var ce=[];var he=fe("id");var de=te((function(e){return e}),ce,"identity");var pe=te((function(){return 0}),ce,"zero");var ve=te((function(){return 1}),ce,"one");var ge=te((function(){return true}),ce,"true");var me=te((function(){return false}),ce,"false");function ye(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var be=0;var _e=1;var xe=2;var we=3;var ke=4;function Ae(e,t){var n=e||be;return{level:function(e){if(arguments.length){n=+e;return this}else{return n}},error:function(){if(n>=_e)ye(t||"error","ERROR",arguments);return this},warn:function(){if(n>=xe)ye(t||"warn","WARN",arguments);return this},info:function(){if(n>=we)ye(t||"log","INFO",arguments);return this},debug:function(){if(n>=ke)ye(t||"log","DEBUG",arguments);return this}}}function Ee(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}return e.reduce((function(e,t){for(var n in t){if(n==="signals"){e.signals=Oe(e.signals,t.signals)}else{var r=n==="legend"?{layout:1}:n==="style"?true:null;Me(e,n,t[n],r)}}return e}),{})}function Me(e,t,n,r){var i,a;if(ue(n)&&!oe(n)){a=ue(e[t])?e[t]:e[t]={};for(i in n){if(r&&(r===true||r[i])){Me(a,i,n[i])}else{a[i]=n[i]}}}else{e[t]=n}}function Oe(e,t){if(e==null)return t;var n={},r=[];function i(e){if(!n[e.name]){n[e.name]=1;r.push(e)}}t.forEach(i);e.forEach(i);return r}function Se(e){return e[e.length-1]}function De(e){return e==null||e===""?null:+e}function Ce(e){return function(t){return e*Math.exp(t)}}function Fe(e){return function(t){return Math.log(e*t)}}function Te(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Ne(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function je(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Re(e,t,n,r){var i=n(e[0]),a=n(Se(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function ze(e,t){return Re(e,t,De,de)}function Pe(e,t){var n=Math.sign(e[0]);return Re(e,t,Fe(n),Ce(n))}function Le(e,t,n){return Re(e,t,je(n),je(1/n))}function Ie(e,t,n){return Re(e,t,Te(n),Ne(n))}function Be(e,t,n,r,i){var a=r(e[0]),o=r(Se(e)),u=t!=null?r(t):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function Ue(e,t,n){return Be(e,t,n,De,de)}function qe(e,t,n){var r=Math.sign(e[0]);return Be(e,t,n,Fe(r),Ce(r))}function We(e,t,n,r){return Be(e,t,n,je(r),je(1/r))}function He(e,t,n,r){return Be(e,t,n,Te(r),Ne(r))}function Ge(e){return 1+~~(new Date(e).getMonth()/3)}function $e(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Ye(e){return e!=null?oe(e)?e:[e]:[]}function Ve(e,t,n){var r=e[0],i=e[1],a;if(i<r){a=i;i=r;r=a}a=i-r;return a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]}function Xe(e){return typeof e==="function"}function Je(e,t){var n=[],r=(e=Ye(e)).map((function(e,t){if(e==null){return null}else{n.push(t);return Xe(e)?e:ae(e).map(le).join("][")}})),i=n.length-1,a=Ye(t),o="var u,v;return ",u,s,l,f,c,h,d,p,v;if(i<0)return null;for(s=0;s<=i;++s){u=n[s];l=r[u];if(Xe(l)){h="f"+u;f="(u=this."+h+"(a))";c="(v=this."+h+"(b))";(d=d||{})[h]=l}else{f="(u=a["+l+"])";c="(v=b["+l+"])"}h="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))";if(a[u]!=="descending"){v=1;p=-1}else{v=-1;p=1}o+="("+f+"<"+c+"||u==null)&&v!=null?"+p+":(u>v||v==null)&&u!=null?"+v+":"+h+"!==u&&v===v?"+p+":v!==v&&u===u?"+v+(u<i?":":":0")}l=Function("a","b",o+";");if(d)l=l.bind(d);e=e.reduce((function(e,t){if(Xe(t)){(re(t)||[]).forEach((function(t){e[t]=1}))}else if(t!=null){e[t+""]=1}return e}),{});return te(l,Object.keys(e))}function Ze(e){return Xe(e)?e:function(){return e}}function Qe(e,t){var n,r;function i(){t(r);n=r=null}return function(t){r=t;if(n)clearTimeout(n);n=setTimeout(i,e)}}function Ke(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}function et(e,t){var n=0,r,i,a,o;if(e&&(r=e.length)){if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);a=o=i;for(;n<r;++n){i=e[n];if(i!=null){if(i<a)a=i;if(i>o)o=i}}}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));a=o=i;for(;n<r;++n){i=t(e[n]);if(i!=null){if(i<a)a=i;if(i>o)o=i}}}}return[a,o]}function tt(e,t){var n=-1,r=e.length,i,a,o,u,s;if(t==null){while(++n<r){a=e[n];if(a!=null&&a>=a){i=o=a;break}}if(n===r)return[-1,-1];u=s=n;while(++n<r){a=e[n];if(a!=null){if(i>a){i=a;u=n}if(o<a){o=a;s=n}}}}else{while(++n<r){a=t(e[n],n,e);if(a!=null&&a>=a){i=o=a;break}}if(n===r)return[-1,-1];u=s=n;while(++n<r){a=t(e[n],n,e);if(a!=null){if(i>a){i=a;u=n}if(o<a){o=a;s=n}}}}return[u,s]}var nt=Object.prototype.hasOwnProperty;function rt(e,t){return nt.call(e,t)}var it={};function at(e){var t={},n,r;function i(e){return rt(t,e)&&t[e]!==it}n={size:0,empty:0,object:t,has:i,get:function(e){return i(e)?t[e]:undefined},set:function(e,r){if(!i(e)){++n.size;if(t[e]===it)--n.empty}t[e]=r;return this},delete:function(e){if(i(e)){--n.size;++n.empty;t[e]=it}return this},clear:function(){n.size=n.empty=0;n.object=t={}},test:function(e){if(arguments.length){r=e;return n}else{return r}},clean:function(){var e={},i=0,a,o;for(a in t){o=t[a];if(o!==it&&(!r||!r(o))){e[a]=o;++i}}n.size=i;n.empty=0;n.object=t=e}};if(e)Object.keys(e).forEach((function(t){n.set(t,e[t])}));return n}function ot(e,t,n,r,i,a){if(!n&&n!==0)return a;var o=e[0],u=Se(e),s=+n,l,f;if(u<o){l=o;o=u;u=l}l=Math.abs(t-o);f=Math.abs(u-t);return l<f&&l<=s?r:f<=s?i:a}function ut(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function st(e,t,n,r){var i=t[0],a=t[t.length-1],o;if(i>a){o=i;i=a;a=o}n=n===undefined||n;r=r===undefined||r;return(n?i<=e:i<e)&&(r?e<=a:e<a)}function lt(e){return typeof e==="boolean"}function ft(e){return Object.prototype.toString.call(e)==="[object Date]"}function ct(e){return typeof e==="number"}function ht(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function dt(e,t){if(e){e=t?Ye(e).map((function(e){return e.replace(/\\(.)/g,"$1")})):Ye(e)}var n=!(e&&e.length)?function(){return""}:Function("_","return ''+"+e.map((function(e){return"_["+(t?le(e):ae(e).map(le).join("]["))+"]"})).join("+'|'+")+";");return te(n,e,"key")}function pt(e,t){var n=e[0],r=Se(e),i=+t;return!i?n:i===1?r:n+i*(r-n)}function vt(e,t,n,r){var i=t.length,a=n.length;if(!a)return t;if(!i)return n;var o=r||new t.constructor(i+a),u=0,s=0,l=0;for(;u<i&&s<a;++l){o[l]=e(t[u],n[s])>0?n[s++]:t[u++]}for(;u<i;++u,++l){o[l]=t[u]}for(;s<a;++s,++l){o[l]=n[s]}return o}function gt(e,t){var n="";while(--t>=0)n+=e;return n}function mt(e,t,n,r){var i=n||" ",a=e+"",o=t-a.length;return o<=0?a:r==="left"?gt(i,o)+a:r==="center"?gt(i,~~(o/2))+a+gt(i,Math.ceil(o/2)):a+gt(i,o)}function yt(e){return e&&Se(e)-e[0]||0}function bt(e){return e==null||e===""?null:!e||e==="false"||e==="0"?false:!!e}function _t(e){return ct(e)?e:ft(e)?e:Date.parse(e)}function xt(e,t){t=t||_t;return e==null||e===""?null:t(e)}function wt(e){return e==null||e===""?null:e+""}function kt(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=true;return t}function At(e,t,n,r){var i=r!=null?r:"…",a=e+"",o=a.length,u=Math.max(0,t-i.length);return o<=t?a:n==="left"?i+a.slice(o-u):n==="center"?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i}function Et(e,t,n){if(e){var r=0,i=e.length,a;if(t){for(;r<i;++r){if(a=t(e[r]))n(a,r,e)}}else{e.forEach(n)}}}function Mt(e,t,n){e.fields=t||[];e.fname=n;return e}function Ot(e){throw Error(e)}function St(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);o=++u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)Ot("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)Ot("Access path missing closing bracket: "+e);if(n)Ot("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var Dt=Array.isArray;function Ct(e){return e===Object(e)}function Ft(e){return typeof e==="string"}function Tt(e){return Dt(e)?"["+e.map(Tt)+"]":Ct(e)||Ft(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Nt(e,t){var n=St(e),r="return _["+n.map(Tt).join("][")+"];";return Mt(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var jt=[];var Rt=Nt("id");var zt=Mt((function(e){return e}),jt,"identity");var Pt=Mt((function(){return 0}),jt,"zero");var Lt=Mt((function(){return 1}),jt,"one");var It=Mt((function(){return true}),jt,"true");var Bt=Mt((function(){return false}),jt,"false");function Ut(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var qt=0;var Wt=1;var Ht=2;var Gt=3;var $t=4;function Yt(e,t){var n=e||qt;return{level:function(e){if(arguments.length){n=+e;return this}else{return n}},error:function(){if(n>=Wt)Ut(t||"error","ERROR",arguments);return this},warn:function(){if(n>=Ht)Ut(t||"warn","WARN",arguments);return this},info:function(){if(n>=Gt)Ut(t||"log","INFO",arguments);return this},debug:function(){if(n>=$t)Ut(t||"log","DEBUG",arguments);return this}}}function Vt(e){return e!=null?Dt(e)?e:[e]:[]}function Xt(e){return typeof e==="function"}function Jt(e){return Xt(e)?e:function(){return e}}function Zt(e,t){var n,r;function i(){t(r);n=r=null}return function(t){r=t;if(n)clearTimeout(n);n=setTimeout(i,e)}}function Qt(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}var Kt=Object.prototype.hasOwnProperty;function en(e,t){return Kt.call(e,t)}function tn(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function nn(e,t,n){if(e){var r=0,i=e.length,a;if(t){for(;r<i;++r){if(a=t(e[r]))n(a,r,e)}}else{e.forEach(n)}}}function rn(e){var t=e||zt,n=[],r={};n.add=function(e){var i=t(e);if(!r[i]){r[i]=1;n.push(e)}return n};n.remove=function(e){var i=t(e),a;if(r[i]){r[i]=0;if((a=n.indexOf(e))>=0){n.splice(a,1)}}return n};return n}function an(e,t){return d(this,void 0,void 0,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,t(e)];case 1:r.sent();return[3,3];case 2:n=r.sent();e.error(n);return[3,3];case 3:return[2]}}))}))}var on=Symbol("vega_id"),un=1;function sn(e){return!!(e&&ln(e))}function ln(e){return e[on]}function fn(e,t){e[on]=t;return e}function cn(e){var t=e===Object(e)?e:{data:e};return ln(t)?t:fn(t,un++)}function hn(e){return e&&e.constructor===dn}function dn(){var e=[],t=[],n=[],r=[],i=[],a=false;return{constructor:dn,insert:function(t){var n=Vt(t),r=0,i=n.length;for(;r<i;++r)e.push(n[r]);return this},remove:function(e){var n=Xt(e)?r:t,i=Vt(e),a=0,o=i.length;for(;a<o;++a)n.push(i[a]);return this},modify:function(e,t,r){var a={field:t,value:Jt(r)};if(Xt(e)){a.filter=e;i.push(a)}else{a.tuple=e;n.push(a)}return this},encode:function(e,t){if(Xt(e))i.push({filter:e,field:t});else n.push({tuple:e,field:t});return this},reflow:function(){a=true;return this},pulse:function(o,u){var s={},l={},f,c,h,d,p,v;for(f=0,c=u.length;f<c;++f){s[ln(u[f])]=1}for(f=0,c=t.length;f<c;++f){p=t[f];s[ln(p)]=-1}for(f=0,c=r.length;f<c;++f){d=r[f];u.forEach((function(e){if(d(e))s[ln(e)]=-1}))}for(f=0,c=e.length;f<c;++f){p=e[f];v=ln(p);if(s[v]){s[v]=1}else{o.add.push(cn(e[f]))}}for(f=0,c=u.length;f<c;++f){p=u[f];if(s[ln(p)]<0)o.rem.push(p)}function g(e,t,n){if(n){e[t]=n(e)}else{o.encode=t}if(!a)l[ln(e)]=e}for(f=0,c=n.length;f<c;++f){h=n[f];p=h.tuple;d=h.field;v=s[ln(p)];if(v>0){g(p,d,h.value);o.modifies(d)}}for(f=0,c=i.length;f<c;++f){h=i[f];d=h.filter;u.forEach((function(e){if(d(e)&&s[ln(e)]>0){g(e,h.field,h.value)}}));o.modifies(h.field)}if(a){o.mod=t.length||r.length?u.filter((function(e){return s[ln(e)]>0})):u.slice()}else{for(v in l)o.mod.push(l[v])}return o}}}var pn="_:mod:_";function vn(){Object.defineProperty(this,pn,{writable:true,value:{}})}var gn=vn.prototype;gn.set=function(e,t,n,r){var i=this,a=i[e],o=i[pn];if(t!=null&&t>=0){if(a[t]!==n||r){a[t]=n;o[t+":"+e]=-1;o[e]=-1}}else if(a!==n||r){i[e]=n;o[e]=Dt(n)?1+n.length:-1}return i};gn.modified=function(e,t){var n=this[pn],r;if(!arguments.length){for(r in n){if(n[r])return true}return false}else if(Dt(e)){for(r=0;r<e.length;++r){if(n[e[r]])return true}return false}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]};gn.clear=function(){this[pn]={};return this};var mn=0;var yn="pulse";var bn=new vn;var _n=1,xn=2;function wn(e,t,n,r){this.id=++mn;this.value=e;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(t){this._update=t}if(n)this.parameters(n,r)}var kn=wn.prototype;kn.targets=function(){return this._targets||(this._targets=rn(Rt))};kn.set=function(e){if(this.value!==e){this.value=e;return 1}else{return 0}};function An(e){return function(t){var n=this.flags;if(arguments.length===0)return!!(n&e);this.flags=t?n|e:n&~e;return this}}kn.skip=An(_n);kn.modified=An(xn);kn.parameters=function(e,t,n){t=t!==false;var r=this,i=r._argval=r._argval||new vn,a=r._argops=r._argops||[],o=[],u,s,l,f;function c(e,n,u){if(u instanceof wn){if(u!==r){if(t)u.targets().add(r);o.push(u)}a.push({op:u,name:e,index:n})}else{i.set(e,n,u)}}for(u in e){s=e[u];if(u===yn){Vt(s).forEach((function(e){if(!(e instanceof wn)){Ot("Pulse parameters must be operator instances.")}else if(e!==r){e.targets().add(r);o.push(e)}}));r.source=s}else if(Dt(s)){i.set(u,-1,Array(l=s.length));for(f=0;f<l;++f)c(u,f,s[f])}else{c(u,-1,s)}}this.marshall().clear();if(n)a.initonly=true;return o};kn.marshall=function(e){var t=this._argval||bn,n=this._argops,r,i,a,o,u;if(n){for(i=0,a=n.length;i<a;++i){r=n[i];o=r.op;u=o.modified()&&o.stamp===e;t.set(r.name,r.index,o.value,u)}if(n.initonly){for(i=0;i<a;++i){r=n[i];r.op.targets().remove(this)}this._argops=null;this._update=null}}return t};kn.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);n.clear();if(r!==this.value){this.value=r}else if(!this.modified()){return e.StopPropagation}}};kn.run=function(e){if(e.stamp<this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false);t=0}else{t=this.evaluate(e)}return this.pulse=t||e};function En(e,t,n,r){var i=1,a;if(e instanceof wn){a=e}else if(e&&e.prototype instanceof wn){a=new e}else if(Xt(e)){a=new wn(null,e)}else{i=0;a=new wn(e,t)}this.rank(a);if(i){r=n;n=t}if(n)this.connect(a,a.parameters(n,r));this.touch(a);return a}function Mn(e,t){var n=e.rank,r,i;for(r=0,i=t.length;r<i;++r){if(n<t[r].rank){this.rerank(e);return}}}var On=0;function Sn(e,t,n){this.id=++On;this.value=null;if(n)this.receive=n;if(e)this._filter=e;if(t)this._apply=t}function Dn(e,t,n){return new Sn(e,t,n)}var Cn=Sn.prototype;Cn._filter=It;Cn._apply=zt;Cn.targets=function(){return this._targets||(this._targets=rn(Rt))};Cn.consume=function(e){if(!arguments.length)return!!this._consume;this._consume=!!e;return this};Cn.receive=function(e){if(this._filter(e)){var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0,i=0;for(;i<r;++i)n[i].receive(t);if(this._consume){e.preventDefault();e.stopPropagation()}}};Cn.filter=function(e){var t=Dn(e);this.targets().add(t);return t};Cn.apply=function(e){var t=Dn(null,e);this.targets().add(t);return t};Cn.merge=function(){var e=Dn();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t){arguments[t].targets().add(e)}return e};Cn.throttle=function(e){var t=-1;return this.filter((function(){var n=Date.now();if(n-t>e){t=n;return 1}else{return 0}}))};Cn.debounce=function(e){var t=Dn();this.targets().add(Dn(null,null,Zt(e,(function(e){var n=e.dataflow;t.receive(e);if(n&&n.run)n.run()}))));return t};Cn.between=function(e,t){var n=false;e.targets().add(Dn(null,null,(function(){n=true})));t.targets().add(Dn(null,null,(function(){n=false})));return this.filter((function(){return n}))};function Fn(e,t,n,r){var i=this,a=Dn(n,r),o=function(e){e.dataflow=i;try{a.receive(e)}catch(ie){i.error(ie)}finally{i.run()}},u;if(typeof e==="string"&&typeof document!=="undefined"){u=document.querySelectorAll(e)}else{u=Vt(e)}for(var s=0,l=u.length;s<l;++s){u[s].addEventListener(t,o)}return a}function Tn(e,t,n){e.fields=t||[];e.fname=n;return e}function Nn(e){return e==null?null:e.fields}function jn(e){throw Error(e)}function Rn(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);o=++u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)jn("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)jn("Access path missing closing bracket: "+e);if(n)jn("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var zn=Array.isArray;function Pn(e){return e===Object(e)}function Ln(e){return typeof e==="string"}function In(e){return zn(e)?"["+e.map(In)+"]":Pn(e)||Ln(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Bn(e,t){var n=Rn(e),r="return _["+n.map(In).join("][")+"];";return Tn(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var Un=[];var qn=Bn("id");var Wn=Tn((function(e){return e}),Un,"identity");var Hn=Tn((function(){return 0}),Un,"zero");var Gn=Tn((function(){return 1}),Un,"one");var $n=Tn((function(){return true}),Un,"true");var Yn=Tn((function(){return false}),Un,"false");function Vn(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}return e.reduce((function(e,t){for(var n in t){if(n==="signals"){e.signals=Jn(e.signals,t.signals)}else{var r=n==="legend"?{layout:1}:n==="style"?true:null;Xn(e,n,t[n],r)}}return e}),{})}function Xn(e,t,n,r){var i,a;if(Pn(n)&&!zn(n)){a=Pn(e[t])?e[t]:e[t]={};for(i in n){if(r&&(r===true||r[i])){Xn(a,i,n[i])}else{a[i]=n[i]}}}else{e[t]=n}}function Jn(e,t){if(e==null)return t;var n={},r=[];function i(e){if(!n[e.name]){n[e.name]=1;r.push(e)}}t.forEach(i);e.forEach(i);return r}function Zn(e){return e[e.length-1]}function Qn(e){return e==null||e===""?null:+e}function Kn(e){return e!=null?zn(e)?e:[e]:[]}function er(e){return typeof e==="function"}function tr(e,t){var n=[],r=(e=Kn(e)).map((function(e,t){if(e==null){return null}else{n.push(t);return er(e)?e:Rn(e).map(In).join("][")}})),i=n.length-1,a=Kn(t),o="var u,v;return ",u,s,l,f,c,h,d,p,v;if(i<0)return null;for(s=0;s<=i;++s){u=n[s];l=r[u];if(er(l)){h="f"+u;f="(u=this."+h+"(a))";c="(v=this."+h+"(b))";(d=d||{})[h]=l}else{f="(u=a["+l+"])";c="(v=b["+l+"])"}h="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))";if(a[u]!=="descending"){v=1;p=-1}else{v=-1;p=1}o+="("+f+"<"+c+"||u==null)&&v!=null?"+p+":(u>v||v==null)&&u!=null?"+v+":"+h+"!==u&&v===v?"+p+":v!==v&&u===u?"+v+(u<i?":":":0")}l=Function("a","b",o+";");if(d)l=l.bind(d);e=e.reduce((function(e,t){if(er(t)){(Nn(t)||[]).forEach((function(t){e[t]=1}))}else if(t!=null){e[t+""]=1}return e}),{});return Tn(l,Object.keys(e))}function nr(e){return er(e)?e:function(){return e}}function rr(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}var ir=Object.prototype.hasOwnProperty;function ar(e,t){return ir.call(e,t)}function or(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function ur(e,t,n,r){var i=t[0],a=t[t.length-1],o;if(i>a){o=i;i=a;a=o}n=n===undefined||n;r=r===undefined||r;return(n?i<=e:i<e)&&(r?e<=a:e<a)}function sr(e){return typeof e==="boolean"}function lr(e){return Object.prototype.toString.call(e)==="[object Date]"}function fr(e){return typeof e==="number"}function cr(e,t){if(e){e=t?Kn(e).map((function(e){return e.replace(/\\(.)/g,"$1")})):Kn(e)}var n=!(e&&e.length)?function(){return""}:Function("_","return ''+"+e.map((function(e){return"_["+(t?In(e):Rn(e).map(In).join("]["))+"]"})).join("+'|'+")+";");return Tn(n,e,"key")}function hr(e){return e&&Zn(e)-e[0]||0}function dr(e){return e==null||e===""?null:!e||e==="false"||e==="0"?false:!!e}function pr(e){return fr(e)?e:lr(e)?e:Date.parse(e)}function vr(e,t){t=t||pr;return e==null||e===""?null:t(e)}function gr(e){return e==null||e===""?null:e+""}function mr(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=true;return t}function yr(e,t,n){if(e){var r=0,i=e.length,a;if(t){for(;r<i;++r){if(a=t(e[r]))n(a,r,e)}}else{e.forEach(n)}}}var br=/^([A-Za-z]+:)?\/\//;var _r=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i;var xr=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;var wr="file://";function kr(e,t){return function(n){return{options:n||{},sanitize:Er,load:Ar,fileAccess:!!t,file:Mr(t),http:Sr(e)}}}function Ar(e,t){return d(this,void 0,void 0,(function(){var n,r;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.sanitize(e,t)];case 1:n=i.sent(),r=n.href;return[2,n.localFile?this.file(r):this.http(r,t)]}}))}))}function Er(e,t){return d(this,void 0,void 0,(function(){var n,r,i,a,o,u,s;return __generator(this,(function(l){t=rr({},this.options,t);n=this.fileAccess,r={href:null};u=_r.test(e.replace(xr,""));if(e==null||typeof e!=="string"||!u){jn("Sanitize failure, invalid URI: "+In(e))}s=br.test(e);if((o=t.baseURL)&&!s){if(!e.startsWith("/")&&o[o.length-1]!=="/"){e="/"+e}e=o+e}a=(i=e.startsWith(wr))||t.mode==="file"||t.mode!=="http"&&!s&&n;if(i){e=e.slice(wr.length)}else if(e.startsWith("//")){if(t.defaultProtocol==="file"){e=e.slice(2);a=true}else{e=(t.defaultProtocol||"http")+":"+e}}Object.defineProperty(r,"localFile",{value:!!a});r.href=e;if(t.target){r.target=t.target+""}if(t.rel){r.rel=t.rel+""}return[2,r]}))}))}function Mr(e){return e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){if(e)r(e);else n(t)}))}))}:Or}function Or(){return d(this,void 0,void 0,(function(){return __generator(this,(function(e){jn("No file system access.");return[2]}))}))}function Sr(e){return e?function(t,n){return d(this,void 0,void 0,(function(){var r,i,a;return __generator(this,(function(o){switch(o.label){case 0:r=rr({},this.options.http,n),i=n&&n.response;return[4,e(t,r)];case 1:a=o.sent();return[2,!a.ok?jn(a.status+""+a.statusText):er(a[i])?a[i]():a.text()]}}))}))}:Dr}function Dr(){return d(this,void 0,void 0,(function(){return __generator(this,(function(e){jn("No HTTP fetch method available.");return[2]}))}))}var Cr={boolean:dr,integer:Qn,number:Qn,date:vr,string:gr,unknown:Wn};var Fr=[zr,Ir,Lr,Pr];var Tr=["boolean","integer","number","date"];function Nr(e,t){if(!e||!e.length)return"unknown";var n,r,i,a=0,o=e.length,u=Fr.length,s=Fr.map((function(e,t){return t+1}));for(r=0,o=e.length;r<o;++r){n=t?e[r][t]:e[r];for(i=0;i<u;++i){if(s[i]&&Rr(n)&&!Fr[i](n)){s[i]=0;++a;if(a===Fr.length)return"string"}}}a=s.reduce((function(e,t){return e===0?t:e}),0)-1;return Tr[a]}function jr(e,t){return t.reduce((function(t,n){t[n]=Nr(e,n);return t}),{})}function Rr(e){return e!=null&&e===e}function zr(e){return e==="true"||e==="false"||e===true||e===false}function Pr(e){return!Number.isNaN(Date.parse(e))}function Lr(e){return!Number.isNaN(+e)&&!(e instanceof Date)}function Ir(e){return Lr(e)&&Number.isInteger(+e)}var Br={},Ur={},qr=34,Wr=10,Hr=13;function Gr(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function $r(e,t){var n=Gr(e);return function(r,i){return t(n(r),i,e)}}function Yr(e){var t=Object.create(null),n=[];e.forEach((function(e){for(var r in e){if(!(r in t)){n.push(t[r]=r)}}}));return n}function Vr(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function Xr(e){return e<0?"-"+Vr(-e,6):e>9999?"+"+Vr(e,6):Vr(e,4)}function Jr(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Xr(e.getUTCFullYear())+"-"+Vr(e.getUTCMonth()+1,2)+"-"+Vr(e.getUTCDate(),2)+(i?"T"+Vr(t,2)+":"+Vr(n,2)+":"+Vr(r,2)+"."+Vr(i,3)+"Z":r?"T"+Vr(t,2)+":"+Vr(n,2)+":"+Vr(r,2)+"Z":n||t?"T"+Vr(t,2)+":"+Vr(n,2)+"Z":"")}function Zr(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var n,r,a=i(e,(function(e,i){if(n)return n(e,i-1);r=e,n=t?$r(e,t):Gr(e)}));a.columns=r||[];return a}function i(e,t){var r=[],i=e.length,a=0,o=0,u,s=i<=0,l=false;if(e.charCodeAt(i-1)===Wr)--i;if(e.charCodeAt(i-1)===Hr)--i;function f(){if(s)return Ur;if(l)return l=false,Br;var t,r=a,o;if(e.charCodeAt(r)===qr){while(a++<i&&e.charCodeAt(a)!==qr||e.charCodeAt(++a)===qr);if((t=a)>=i)s=true;else if((o=e.charCodeAt(a++))===Wr)l=true;else if(o===Hr){l=true;if(e.charCodeAt(a)===Wr)++a}return e.slice(r+1,t-1).replace(/""/g,'"')}while(a<i){if((o=e.charCodeAt(t=a++))===Wr)l=true;else if(o===Hr){l=true;if(e.charCodeAt(a)===Wr)++a}else if(o!==n)continue;return e.slice(r,t)}return s=true,e.slice(r,i)}while((u=f())!==Ur){var c=[];while(u!==Br&&u!==Ur)c.push(u),u=f();if(t&&(c=t(c,o++))==null)continue;r.push(c)}return r}function a(t,n){return t.map((function(t){return n.map((function(e){return f(t[e])})).join(e)}))}function o(t,n){if(n==null)n=Yr(t);return[n.map(f).join(e)].concat(a(t,n)).join("\n")}function u(e,t){if(t==null)t=Yr(e);return a(e,t).join("\n")}function s(e){return e.map(l).join("\n")}function l(t){return t.map(f).join(e)}function f(e){return e==null?"":e instanceof Date?Jr(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:r,parseRows:i,format:o,formatBody:u,formatRows:s}}var Qr=Zr(",");var Kr=Zr("\t");var ei=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function ti(e){var t=function(t,n){var r={delimiter:e};return ni(t,n?rr(n,r):r)};t.responseType="text";return t}function ni(e,t){if(t.header){e=t.header.map(In).join(t.delimiter)+"\n"+e}return Zr(t.delimiter).parse(e+"")}ni.responseType="text";function ri(e){return typeof Buffer==="function"&&er(Buffer.isBuffer)?Buffer.isBuffer(e):false}function ii(e,t){var n=t&&t.property?Bn(t.property):Wn;return Pn(e)&&!ri(e)?ai(n(e)):n(JSON.parse(e))}ii.responseType="json";function ai(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}function oi(e){return e}function ui(e){if(e==null)return oi;var t,n,r=e.scale[0],i=e.scale[1],a=e.translate[0],o=e.translate[1];return function(e,u){if(!u)t=n=0;var s=2,l=e.length,f=new Array(l);f[0]=(t+=e[0])*r+a;f[1]=(n+=e[1])*i+o;while(s<l)f[s]=e[s],++s;return f}}function si(e,t){var n,r=e.length,i=r-t;while(i<--r)n=e[i],e[i++]=e[r],e[r]=n}function li(e,t){if(typeof t==="string")t=e.objects[t];return t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map((function(t){return fi(e,t)}))}:fi(e,t)}function fi(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,a=ci(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:a}:r==null?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function ci(e,t){var n=ui(e.transform),r=e.arcs;function i(e,t){if(t.length)t.pop();for(var i=r[e<0?~e:e],a=0,o=i.length;a<o;++a){t.push(n(i[a],a))}if(e<0)si(t,o)}function a(e){return n(e)}function o(e){var t=[];for(var n=0,r=e.length;n<r;++n)i(e[n],t);if(t.length<2)t.push(t[0]);return t}function u(e){var t=o(e);while(t.length<4)t.push(t[0]);return t}function s(e){return e.map(u)}function l(e){var t=e.type,n;switch(t){case"GeometryCollection":return{type:t,geometries:e.geometries.map(l)};case"Point":n=a(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(a);break;case"LineString":n=o(e.arcs);break;case"MultiLineString":n=e.arcs.map(o);break;case"Polygon":n=s(e.arcs);break;case"MultiPolygon":n=e.arcs.map(s);break;default:return null}return{type:t,coordinates:n}}return l(t)}function hi(e,t){var n={},r={},i={},a=[],o=-1;t.forEach((function(n,r){var i=e.arcs[n<0?~n:n],a;if(i.length<3&&!i[1][0]&&!i[1][1]){a=t[++o],t[o]=n,t[r]=a}}));t.forEach((function(e){var t=u(e),n=t[0],a=t[1],o,s;if(o=i[n]){delete i[o.end];o.push(e);o.end=a;if(s=r[a]){delete r[s.start];var l=s===o?o:o.concat(s);r[l.start=o.start]=i[l.end=s.end]=l}else{r[o.start]=i[o.end]=o}}else if(o=r[a]){delete r[o.start];o.unshift(e);o.start=n;if(s=i[n]){delete i[s.end];var f=s===o?o:s.concat(o);r[f.start=s.start]=i[f.end=o.end]=f}else{r[o.start]=i[o.end]=o}}else{o=[e];r[o.start=n]=i[o.end=a]=o}}));function u(t){var n=e.arcs[t<0?~t:t],r=n[0],i;if(e.transform)i=[0,0],n.forEach((function(e){i[0]+=e[0],i[1]+=e[1]}));else i=n[n.length-1];return t<0?[i,r]:[r,i]}function s(e,t){for(var r in e){var i=e[r];delete t[i.start];delete i.start;delete i.end;i.forEach((function(e){n[e<0?~e:e]=1}));a.push(i)}}s(i,r);s(r,i);t.forEach((function(e){if(!n[e<0?~e:e])a.push([e])}));return a}function di(e){return ci(e,pi.apply(this,arguments))}function pi(e,t,n){var r,i,a;if(arguments.length>1)r=vi(e,t,n);else for(i=0,r=new Array(a=e.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:hi(e,r)}}function vi(e,t,n){var r=[],i=[],a;function o(e){var t=e<0?~e:e;(i[t]||(i[t]=[])).push({i:e,g:a})}function u(e){e.forEach(o)}function s(e){e.forEach(u)}function l(e){e.forEach(s)}function f(e){switch(a=e,e.type){case"GeometryCollection":e.geometries.forEach(f);break;case"LineString":u(e.arcs);break;case"MultiLineString":case"Polygon":s(e.arcs);break;case"MultiPolygon":l(e.arcs);break}}f(t);i.forEach(n==null?function(e){r.push(e[0].i)}:function(e){if(n(e[0].g,e[e.length-1].g))r.push(e[0].i)});return r}var gi={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function mi(e,t){var n,r,i,a;e=ii(e,t);if(t&&t.feature){n=li;i=t.feature}else if(t&&t.mesh){n=di;i=t.mesh;a=gi[t.filter]}else{jn("Missing TopoJSON feature or mesh parameter.")}r=(r=e.objects[i])?n(e,r,a):jn("Invalid TopoJSON object: "+i);return r&&r.features||[r]}mi.responseType="json";var yi={dsv:ni,csv:ti(","),tsv:ti("\t"),json:ii,topojson:mi};function bi(e,t){if(arguments.length>1){yi[e]=t;return this}else{return ar(yi,e)?yi[e]:null}}function _i(e){var t=bi(e);return t&&t.responseType||"text"}var xi=new Date,wi=new Date;function ki(e,t,n,r){function i(t){return e(t=arguments.length===0?new Date:new Date(+t)),t}i.floor=function(t){return e(t=new Date(+t)),t};i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n};i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n};i.offset=function(e,n){return t(e=new Date(+e),n==null?1:Math.floor(n)),e};i.range=function(n,r,a){var o=[],u;n=i.ceil(n);a=a==null?1:Math.floor(a);if(!(n<r)||!(a>0))return o;do{o.push(u=new Date(+n)),t(n,a),e(n)}while(u<n&&n<r);return o};i.filter=function(n){return ki((function(t){if(t>=t)while(e(t),!n(t))t.setTime(t-1)}),(function(e,r){if(e>=e){if(r<0)while(++r<=0){while(t(e,-1),!n(e)){}}else while(--r>=0){while(t(e,+1),!n(e)){}}}}))};if(n){i.count=function(t,r){xi.setTime(+t),wi.setTime(+r);e(xi),e(wi);return Math.floor(n(xi,wi))};i.every=function(e){e=Math.floor(e);return!isFinite(e)||!(e>0)?null:!(e>1)?i:i.filter(r?function(t){return r(t)%e===0}:function(t){return i.count(0,t)%e===0})}}return i}var Ai=ki((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));Ai.every=function(e){e=Math.floor(e);if(!isFinite(e)||!(e>0))return null;if(!(e>1))return Ai;return ki((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e}))};var Ei=1e3;var Mi=6e4;var Oi=36e5;var Si=864e5;var Di=6048e5;var Ci=ki((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*Ei)}),(function(e,t){return(t-e)/Ei}),(function(e){return e.getUTCSeconds()}));var Fi=ki((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ei)}),(function(e,t){e.setTime(+e+t*Mi)}),(function(e,t){return(t-e)/Mi}),(function(e){return e.getMinutes()}));var Ti=ki((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ei-e.getMinutes()*Mi)}),(function(e,t){e.setTime(+e+t*Oi)}),(function(e,t){return(t-e)/Oi}),(function(e){return e.getHours()}));var Ni=ki((function(e){e.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Mi)/Si}),(function(e){return e.getDate()-1}));function ji(e){return ki((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7);t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t*7)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Mi)/Di}))}var Ri=ji(0);var zi=ji(1);var Pi=ji(2);var Li=ji(3);var Ii=ji(4);var Bi=ji(5);var Ui=ji(6);var qi=ki((function(e){e.setDate(1);e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12}),(function(e){return e.getMonth()}));var Wi=ki((function(e){e.setMonth(0,1);e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));Wi.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ki((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e);t.setMonth(0,1);t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)}))};var Hi=ki((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*Mi)}),(function(e,t){return(t-e)/Mi}),(function(e){return e.getUTCMinutes()}));var Gi=ki((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*Oi)}),(function(e,t){return(t-e)/Oi}),(function(e){return e.getUTCHours()}));var $i=ki((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/Si}),(function(e){return e.getUTCDate()-1}));function Yi(e){return ki((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7);t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t*7)}),(function(e,t){return(t-e)/Di}))}var Vi=Yi(0);var Xi=Yi(1);var Ji=Yi(2);var Zi=Yi(3);var Qi=Yi(4);var Ki=Yi(5);var ea=Yi(6);var ta=ki((function(e){e.setUTCDate(1);e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12}),(function(e){return e.getUTCMonth()}));var na=ki((function(e){e.setUTCMonth(0,1);e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));na.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ki((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e);t.setUTCMonth(0,1);t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}))};function ra(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);t.setFullYear(e.y);return t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ia(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));t.setUTCFullYear(e.y);return t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function aa(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function oa(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,u=e.months,s=e.shortMonths;var l=da(i),f=pa(i),c=da(a),h=pa(a),d=da(o),p=pa(o),v=da(u),g=pa(u),m=da(s),y=pa(s);var b={a:N,A:j,b:R,B:z,c:null,d:Ra,e:Ra,f:Ba,H:za,I:Pa,j:La,L:Ia,m:Ua,M:qa,p:P,q:L,Q:mo,s:yo,S:Wa,u:Ha,U:Ga,V:$a,w:Ya,W:Va,x:null,X:null,y:Xa,Y:Ja,Z:Za,"%":go};var _={a:I,A:B,b:U,B:q,c:null,d:Qa,e:Qa,f:ro,H:Ka,I:eo,j:to,L:no,m:io,M:ao,p:W,q:H,Q:mo,s:yo,S:oo,u:uo,U:so,V:lo,w:fo,W:co,x:null,X:null,y:ho,Y:po,Z:vo,"%":go};var x={a:M,A:O,b:S,B:D,c:C,d:Ea,e:Ea,f:Fa,H:Oa,I:Oa,j:Ma,L:Ca,m:Aa,M:Sa,p:E,q:ka,Q:Na,s:ja,S:Da,u:ga,U:ma,V:ya,w:va,W:ba,x:F,X:T,y:xa,Y:_a,Z:wa,"%":Ta};b.x=w(n,b);b.X=w(r,b);b.c=w(t,b);_.x=w(n,_);_.X=w(r,_);_.c=w(t,_);function w(e,t){return function(n){var r=[],i=-1,a=0,o=e.length,u,s,l;if(!(n instanceof Date))n=new Date(+n);while(++i<o){if(e.charCodeAt(i)===37){r.push(e.slice(a,i));if((s=ua[u=e.charAt(++i)])!=null)u=e.charAt(++i);else s=u==="e"?" ":"0";if(l=t[u])u=l(n,s);r.push(u);a=i+1}}r.push(e.slice(a,i));return r.join("")}}function k(e,t){return function(n){var r=aa(1900,undefined,1),i=A(r,e,n+="",0),a,o;if(i!=n.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(r.s*1e3+("L"in r?r.L:0));if(t&&!("Z"in r))r.Z=0;if("p"in r)r.H=r.H%12+r.p*12;if(r.m===undefined)r.m="q"in r?r.q:0;if("V"in r){if(r.V<1||r.V>53)return null;if(!("w"in r))r.w=1;if("Z"in r){a=ia(aa(r.y,0,1)),o=a.getUTCDay();a=o>4||o===0?Xi.ceil(a):Xi(a);a=$i.offset(a,(r.V-1)*7);r.y=a.getUTCFullYear();r.m=a.getUTCMonth();r.d=a.getUTCDate()+(r.w+6)%7}else{a=ra(aa(r.y,0,1)),o=a.getDay();a=o>4||o===0?zi.ceil(a):zi(a);a=Ni.offset(a,(r.V-1)*7);r.y=a.getFullYear();r.m=a.getMonth();r.d=a.getDate()+(r.w+6)%7}}else if("W"in r||"U"in r){if(!("w"in r))r.w="u"in r?r.u%7:"W"in r?1:0;o="Z"in r?ia(aa(r.y,0,1)).getUTCDay():ra(aa(r.y,0,1)).getDay();r.m=0;r.d="W"in r?(r.w+6)%7+r.W*7-(o+5)%7:r.w+r.U*7-(o+6)%7}if("Z"in r){r.H+=r.Z/100|0;r.M+=r.Z%100;return ia(r)}return ra(r)}}function A(e,t,n,r){var i=0,a=t.length,o=n.length,u,s;while(i<a){if(r>=o)return-1;u=t.charCodeAt(i++);if(u===37){u=t.charAt(i++);s=x[u in ua?t.charAt(i++):u];if(!s||(r=s(e,n,r))<0)return-1}else if(u!=n.charCodeAt(r++)){return-1}}return r}function E(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=f[r[0].toLowerCase()],n+r[0].length):-1}function M(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=p[r[0].toLowerCase()],n+r[0].length):-1}function O(e,t,n){var r=c.exec(t.slice(n));return r?(e.w=h[r[0].toLowerCase()],n+r[0].length):-1}function S(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=y[r[0].toLowerCase()],n+r[0].length):-1}function D(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=g[r[0].toLowerCase()],n+r[0].length):-1}function C(e,n,r){return A(e,t,n,r)}function F(e,t,r){return A(e,n,t,r)}function T(e,t,n){return A(e,r,t,n)}function N(e){return o[e.getDay()]}function j(e){return a[e.getDay()]}function R(e){return s[e.getMonth()]}function z(e){return u[e.getMonth()]}function P(e){return i[+(e.getHours()>=12)]}function L(e){return 1+~~(e.getMonth()/3)}function I(e){return o[e.getUTCDay()]}function B(e){return a[e.getUTCDay()]}function U(e){return s[e.getUTCMonth()]}function q(e){return u[e.getUTCMonth()]}function W(e){return i[+(e.getUTCHours()>=12)]}function H(e){return 1+~~(e.getUTCMonth()/3)}return{format:function(e){var t=w(e+="",b);t.toString=function(){return e};return t},parse:function(e){var t=k(e+="",false);t.toString=function(){return e};return t},utcFormat:function(e){var t=w(e+="",_);t.toString=function(){return e};return t},utcParse:function(e){var t=k(e+="",true);t.toString=function(){return e};return t}}}var ua={"-":"",_:" ",0:"0"},sa=/^\s*\d+/,la=/^%/,fa=/[\\^$*+?|[\]().{}]/g;function ca(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function ha(e){return e.replace(fa,"\\$&")}function da(e){return new RegExp("^(?:"+e.map(ha).join("|")+")","i")}function pa(e){var t={},n=-1,r=e.length;while(++n<r)t[e[n].toLowerCase()]=n;return t}function va(e,t,n){var r=sa.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function ga(e,t,n){var r=sa.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function ma(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function ya(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function ba(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function _a(e,t,n){var r=sa.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function xa(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function wa(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function ka(e,t,n){var r=sa.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Aa(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Ea(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Ma(e,t,n){var r=sa.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Oa(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Sa(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Da(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Ca(e,t,n){var r=sa.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Fa(e,t,n){var r=sa.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ta(e,t,n){var r=la.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Na(e,t,n){var r=sa.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function ja(e,t,n){var r=sa.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Ra(e,t){return ca(e.getDate(),t,2)}function za(e,t){return ca(e.getHours(),t,2)}function Pa(e,t){return ca(e.getHours()%12||12,t,2)}function La(e,t){return ca(1+Ni.count(Wi(e),e),t,3)}function Ia(e,t){return ca(e.getMilliseconds(),t,3)}function Ba(e,t){return Ia(e,t)+"000"}function Ua(e,t){return ca(e.getMonth()+1,t,2)}function qa(e,t){return ca(e.getMinutes(),t,2)}function Wa(e,t){return ca(e.getSeconds(),t,2)}function Ha(e){var t=e.getDay();return t===0?7:t}function Ga(e,t){return ca(Ri.count(Wi(e)-1,e),t,2)}function $a(e,t){var n=e.getDay();e=n>=4||n===0?Ii(e):Ii.ceil(e);return ca(Ii.count(Wi(e),e)+(Wi(e).getDay()===4),t,2)}function Ya(e){return e.getDay()}function Va(e,t){return ca(zi.count(Wi(e)-1,e),t,2)}function Xa(e,t){return ca(e.getFullYear()%100,t,2)}function Ja(e,t){return ca(e.getFullYear()%1e4,t,4)}function Za(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ca(t/60|0,"0",2)+ca(t%60,"0",2)}function Qa(e,t){return ca(e.getUTCDate(),t,2)}function Ka(e,t){return ca(e.getUTCHours(),t,2)}function eo(e,t){return ca(e.getUTCHours()%12||12,t,2)}function to(e,t){return ca(1+$i.count(na(e),e),t,3)}function no(e,t){return ca(e.getUTCMilliseconds(),t,3)}function ro(e,t){return no(e,t)+"000"}function io(e,t){return ca(e.getUTCMonth()+1,t,2)}function ao(e,t){return ca(e.getUTCMinutes(),t,2)}function oo(e,t){return ca(e.getUTCSeconds(),t,2)}function uo(e){var t=e.getUTCDay();return t===0?7:t}function so(e,t){return ca(Vi.count(na(e)-1,e),t,2)}function lo(e,t){var n=e.getUTCDay();e=n>=4||n===0?Qi(e):Qi.ceil(e);return ca(Qi.count(na(e),e)+(na(e).getUTCDay()===4),t,2)}function fo(e){return e.getUTCDay()}function co(e,t){return ca(Xi.count(na(e)-1,e),t,2)}function ho(e,t){return ca(e.getUTCFullYear()%100,t,2)}function po(e,t){return ca(e.getUTCFullYear()%1e4,t,4)}function vo(){return"+0000"}function go(){return"%"}function mo(e){return+e}function yo(e){return Math.floor(+e/1e3)}var bo;var _o;var xo;var wo;var ko;Ao({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ao(e){bo=oa(e);_o=bo.format;xo=bo.parse;wo=bo.utcFormat;ko=bo.utcParse;return bo}function Eo(e,t,n){t=t||{};var r=bi(t.type||"json");if(!r)jn("Unknown data format type: "+t.type);e=r(e,t);if(t.parse)Mo(e,t.parse,n);if(ar(e,"columns"))delete e.columns;return e}function Mo(e,t,n){if(!e.length)return;n=n||xo;var r=e.columns||Object.keys(e[0]),i,a,o,u,s,l,f;if(t==="auto")t=jr(e,r);r=Object.keys(t);i=r.map((function(e){var r=t[e],i,a;if(r&&(r.indexOf("date:")===0||r.indexOf("utc:")===0)){i=r.split(/:(.+)?/,2);a=i[1];if(a[0]==="'"&&a[a.length-1]==="'"||a[0]==='"'&&a[a.length-1]==='"'){a=a.slice(1,-1)}return i[0]==="utc"?ko(a):n(a)}if(!Cr[r]){throw Error("Illegal format pattern: "+e+":"+r)}return Cr[r]}));for(u=0,l=e.length,f=r.length;u<l;++u){a=e[u];for(s=0;s<f;++s){o=r[s];a[o]=i[s](a[o])}}}var Oo=kr(typeof fetch!=="undefined"&&fetch,null);var So=Eo;function Do(e,t,n){return this.pulse(e,this.changeset().insert(So(t,n)))}function Co(e,t){return d(this,void 0,void 0,(function(){var n,r,i,a;return __generator(this,(function(o){switch(o.label){case 0:n=this;r=0;o.label=1;case 1:o.trys.push([1,3,,4]);return[4,n.loader().load(e,{context:"dataflow",response:_i(t&&t.type)})];case 2:i=o.sent();try{i=So(i,t)}catch(u){r=-2;n.warn("Data ingestion failed",e,u)}return[3,4];case 3:a=o.sent();r=-1;n.warn("Loading failed",e,a);return[3,4];case 4:return[2,{data:i,status:r}]}}))}))}function Fo(e,t,n){return d(this,void 0,void 0,(function(){var r,i,a;return __generator(this,(function(o){switch(o.label){case 0:r=this,i=r._pending||To(r);i.requests+=1;return[4,r.request(t,n)];case 1:a=o.sent();r.pulse(e,r.changeset().remove(It).insert(a.data||[]));i.done();return[2,a]}}))}))}function To(e){var t=new Promise((function(e){n=e})),n;t.requests=0;t.done=function(){if(--t.requests===0){e._pending=null;n(e)}};return e._pending=t}var No={skip:true};function jo(e,t,n,r,i){var a=e instanceof wn?zo:Ro;a(this,e,t,n,r,i);return this}function Ro(e,t,n,r,i,a){var o=Qt({},a,No),u,s;if(!Xt(n))n=Jt(n);if(r===undefined){u=function(t){return e.touch(n(t))}}else if(Xt(r)){s=new wn(null,r,i,false);u=function(t){s.evaluate(t);var r=n(t),i=s.value;hn(i)?e.pulse(r,i,a):e.update(r,i,o)}}else{u=function(t){return e.update(n(t),r,o)}}t.apply(u)}function zo(e,t,n,r,i,a){if(r===undefined){t.targets().add(n)}else{var o=a||{},u=new wn(null,Po(n,r),i,false);u.modified(o.force);u.rank=t.rank;t.targets().add(u);if(n){u.skip(true);u.value=n.value;u.targets().add(n);e.connect(n,[u])}}}function Po(e,t){t=Xt(t)?t:Jt(t);return e?function(n,r){var i=t(n,r);if(!e.skip()){e.skip(i!==this.value).value=i}return i}:t}function Lo(e){e.rank=++this._rank}function Io(e){var t=[e],n,r,i;while(t.length){this.rank(n=t.pop());if(r=n._targets){for(i=r.length;--i>=0;){t.push(n=r[i]);if(n===e)Ot("Cycle detected in dataflow graph.")}}}}var Bo={};var Uo=1<<0,qo=1<<1,Wo=1<<2,Ho=Uo|qo,Go=Uo|Wo,$o=Uo|qo|Wo,Yo=1<<3,Vo=1<<4,Xo=1<<5,Jo=1<<6;function Zo(e,t,n){this.dataflow=e;this.stamp=t==null?-1:t;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}var Qo=Zo.prototype;Qo.StopPropagation=Bo;Qo.ADD=Uo;Qo.REM=qo;Qo.MOD=Wo;Qo.ADD_REM=Ho;Qo.ADD_MOD=Go;Qo.ALL=$o;Qo.REFLOW=Yo;Qo.SOURCE=Vo;Qo.NO_SOURCE=Xo;Qo.NO_FIELDS=Jo;Qo.fork=function(e){return new Zo(this.dataflow).init(this,e)};Qo.clone=function(){var e=this.fork($o);e.add=e.add.slice();e.rem=e.rem.slice();e.mod=e.mod.slice();if(e.source)e.source=e.source.slice();return e.materialize($o|Vo)};Qo.addAll=function(){var e=this;if(!this.source||this.source.length===this.add.length){return e}else{e=new Zo(this.dataflow).init(this);e.add=e.source;return e}};Qo.init=function(e,t){var n=this;n.stamp=e.stamp;n.encode=e.encode;if(e.fields&&!(t&Jo)){n.fields=e.fields}if(t&Uo){n.addF=e.addF;n.add=e.add}else{n.addF=null;n.add=[]}if(t&qo){n.remF=e.remF;n.rem=e.rem}else{n.remF=null;n.rem=[]}if(t&Wo){n.modF=e.modF;n.mod=e.mod}else{n.modF=null;n.mod=[]}if(t&Xo){n.srcF=null;n.source=null}else{n.srcF=e.srcF;n.source=e.source}return n};Qo.runAfter=function(e){this.dataflow.runAfter(e)};Qo.changed=function(e){var t=e||$o;return t&Uo&&this.add.length||t&qo&&this.rem.length||t&Wo&&this.mod.length};Qo.reflow=function(e){if(e)return this.fork($o).reflow();var t=this.add.length,n=this.source&&this.source.length;if(n&&n!==t){this.mod=this.source;if(t)this.filter(Wo,tu(this,Uo))}return this};Qo.modifies=function(e){var t=this.fields||(this.fields={});if(Dt(e)){e.forEach((function(e){return t[e]=true}))}else{t[e]=true}return this};Qo.modified=function(e,t){var n=this.fields;return!((t||this.mod.length)&&n)?false:!arguments.length?!!n:Dt(e)?e.some((function(e){return n[e]})):n[e]};Qo.filter=function(e,t){var n=this;if(e&Uo)n.addF=Ko(n.addF,t);if(e&qo)n.remF=Ko(n.remF,t);if(e&Wo)n.modF=Ko(n.modF,t);if(e&Vo)n.srcF=Ko(n.srcF,t);return n};function Ko(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}Qo.materialize=function(e){e=e||$o;var t=this;if(e&Uo&&t.addF){t.add=eu(t.add,t.addF);t.addF=null}if(e&qo&&t.remF){t.rem=eu(t.rem,t.remF);t.remF=null}if(e&Wo&&t.modF){t.mod=eu(t.mod,t.modF);t.modF=null}if(e&Vo&&t.srcF){t.source=t.source.filter(t.srcF);t.srcF=null}return t};function eu(e,t){var n=[];nn(e,t,(function(e){n.push(e)}));return n}function tu(e,t){var n={};e.visit(t,(function(e){n[ln(e)]=1}));return function(e){return n[ln(e)]?null:e}}Qo.visit=function(e,t){var n=this,r=t,i,a;if(e&Vo){nn(n.source,n.srcF,r);return n}if(e&Uo)nn(n.add,n.addF,r);if(e&qo)nn(n.rem,n.remF,r);if(e&Wo)nn(n.mod,n.modF,r);if(e&Yo&&(i=n.source)){a=n.add.length+n.mod.length;if(a===i.length);else if(a){nn(i,tu(n,Go),r)}else{nn(i,n.srcF,r)}}return n};function nu(e,t,n,r){var i=this,a=0,o,u,s,l,f;this.dataflow=e;this.stamp=t;this.fields=null;this.encode=r||null;this.pulses=n;for(s=0,l=n.length;s<l;++s){o=n[s];if(o.stamp!==t)continue;if(o.fields){u=i.fields||(i.fields={});for(f in o.fields){u[f]=1}}if(o.changed(i.ADD))a|=i.ADD;if(o.changed(i.REM))a|=i.REM;if(o.changed(i.MOD))a|=i.MOD}this.changes=a}var ru=tn(nu,Zo);ru.fork=function(e){var t=new Zo(this.dataflow).init(this,e&this.NO_FIELDS);if(e!==undefined){if(e&t.ADD){this.visit(t.ADD,(function(e){return t.add.push(e)}))}if(e&t.REM){this.visit(t.REM,(function(e){return t.rem.push(e)}))}if(e&t.MOD){this.visit(t.MOD,(function(e){return t.mod.push(e)}))}}return t};ru.changed=function(e){return this.changes&e};ru.modified=function(e){var t=this,n=t.fields;return!(n&&t.changes&t.MOD)?0:Dt(e)?e.some((function(e){return n[e]})):n[e]};ru.filter=function(){Ot("MultiPulse does not support filtering.")};ru.materialize=function(){Ot("MultiPulse does not support materialization.")};ru.visit=function(e,t){var n=this,r=n.pulses,i=r.length,a=0;if(e&n.SOURCE){for(;a<i;++a){r[a].visit(e,t)}}else{for(;a<i;++a){if(r[a].stamp===n.stamp){r[a].visit(e,t)}}}return n};function iu(e,t,n){return d(this,void 0,void 0,(function(){var r,i,a,o,u,s,l,f,c,h,d,p;return __generator(this,(function(v){switch(v.label){case 0:r=this,i=r.logLevel(),a=[];if(r._pulse)return[2,su(r)];if(!r._pending)return[3,2];return[4,r._pending];case 1:v.sent();v.label=2;case 2:if(!t)return[3,4];return[4,an(r,t)];case 3:v.sent();v.label=4;case 4:if(!r._touched.length){r.info("Dataflow invoked, but nothing to do.");return[2,r]}o=++r._clock,u=0;r._pulse=new Zo(r,o,e);if(i>=Gt){f=Date.now();r.debug("-- START PROPAGATION ("+o+") -----")}r._touched.forEach((function(e){return r._enqueue(e,true)}));r._touched=rn(Rt);v.label=5;case 5:v.trys.push([5,11,,12]);v.label=6;case 6:if(!(r._heap.size()>0))return[3,10];s=r._heap.pop();if(s.rank!==s.qrank){r._enqueue(s,true);return[3,6]}l=s.run(r._getPulse(s,e));if(!l.then)return[3,8];return[4,l];case 7:l=v.sent();return[3,9];case 8:if(l.async){a.push(l.async);l=Bo}v.label=9;case 9:if(i>=$t){r.debug(s.id,l===Bo?"STOP":l,s)}if(l!==Bo){if(s._targets)s._targets.forEach((function(e){return r._enqueue(e)}))}++u;return[3,6];case 10:return[3,12];case 11:h=v.sent();r._heap.clear();c=h;return[3,12];case 12:r._input={};r._pulse=null;if(i>=Gt){f=Date.now()-f;r.info("> Pulse "+o+": "+u+" operators; "+f+"ms")}if(c){r._postrun=[];r.error(c)}if(!r._postrun.length)return[3,16];d=r._postrun.sort((function(e,t){return t.priority-e.priority}));r._postrun=[];p=0;v.label=13;case 13:if(!(p<d.length))return[3,16];return[4,an(r,d[p].callback)];case 14:v.sent();v.label=15;case 15:++p;return[3,13];case 16:if(!n)return[3,18];return[4,an(r,n)];case 17:v.sent();v.label=18;case 18:if(a.length){Promise.all(a).then((function(e){return r.runAsync(null,(function(){e.forEach((function(e){try{e(r)}catch(t){r.error(t)}}))}))}))}return[2,r]}}))}))}function au(e,t,n){return d(this,void 0,void 0,(function(){var r;var i=this;return __generator(this,(function(a){switch(a.label){case 0:if(!this._running)return[3,2];return[4,this._running];case 1:a.sent();return[3,0];case 2:r=function(){return i._running=null};(this._running=this.evaluate(e,t,n)).then(r,r);return[2,this._running]}}))}))}function ou(e,t,n){return this._pulse?su(this):(this.evaluate(e,t,n),this)}function uu(e,t,n){if(this._pulse||t){this._postrun.push({priority:n||0,callback:e})}else{try{e(this)}catch(r){this.error(r)}}}function su(e){e.error("Dataflow already running. Use runAsync() to chain invocations.");return e}function lu(e,t){var n=e.stamp<this._clock;if(n)e.stamp=this._clock;if(n||t){e.qrank=e.rank;this._heap.push(e)}}function fu(e,t){var n=e.source,r=this._clock;return n&&Dt(n)?new nu(this,r,n.map((function(e){return e.pulse})),t):this._input[e.id]||cu(this._pulse,n&&n.pulse)}function cu(e,t){if(t&&t.stamp===e.stamp){return t}e=e.fork();if(t&&t!==Bo){e.source=t.source}return e}var hu={skip:false,force:false};function du(e,t){var n=t||hu;if(this._pulse){this._enqueue(e)}else{this._touched.add(e)}if(n.skip)e.skip(true);return this}function pu(e,t,n){var r=n||hu;if(e.set(t)||r.force){this.touch(e,r)}return this}function vu(e,t,n){this.touch(e,n||hu);var r=new Zo(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];r.target=e;this._input[e.id]=t.pulse(r,i);return this}function gu(e){var t=[];return{clear:function(){return t=[]},size:function(){return t.length},peek:function(){return t[0]},push:function(n){t.push(n);return mu(t,0,t.length-1,e)},pop:function(){var n=t.pop(),r;if(t.length){r=t[0];t[0]=n;yu(t,0,e)}else{r=n}return r}}}function mu(e,t,n,r){var i,a,o;i=e[n];while(n>t){o=n-1>>1;a=e[o];if(r(i,a)<0){e[n]=a;n=o;continue}break}return e[n]=i}function yu(e,t,n){var r=t,i=e.length,a=e[t],o=(t<<1)+1,u;while(o<i){u=o+1;if(u<i&&n(e[o],e[u])>=0){o=u}e[t]=e[o];t=o;o=(t<<1)+1}e[t]=a;return mu(e,r,t,n)}function bu(){this.logger(Yt());this.logLevel(Wt);this._clock=0;this._rank=0;try{this._loader=Oo()}catch(e){}this._touched=rn(Rt);this._input={};this._pulse=null;this._heap=gu((function(e,t){return e.qrank-t.qrank}));this._postrun=[]}var _u=bu.prototype;_u.stamp=function(){return this._clock};_u.loader=function(e){if(arguments.length){this._loader=e;return this}else{return this._loader}};_u.cleanThreshold=1e4;_u.add=En;_u.connect=Mn;_u.rank=Lo;_u.rerank=Io;_u.pulse=vu;_u.touch=du;_u.update=pu;_u.changeset=dn;_u.ingest=Do;_u.parse=So;_u.preload=Fo;_u.request=Co;_u.events=Fn;_u.on=jo;_u.evaluate=iu;_u.run=ou;_u.runAsync=au;_u.runAfter=uu;_u._enqueue=lu;_u._getPulse=fu;function xu(e){return function(){return this._log[e].apply(this,arguments)}}_u.logger=function(e){if(arguments.length){this._log=e;return this}else{return this._log}};_u.error=xu("error");_u.warn=xu("warn");_u.info=xu("info");_u.debug=xu("debug");_u.logLevel=xu("level");function wu(e,t){wn.call(this,e,null,t)}var ku=tn(wu,wn);ku.run=function(e){var t=this;if(e.stamp<this.stamp)return e.StopPropagation;var n;if(this.skip()){this.skip(false)}else{n=this.evaluate(e)}n=n||e;if(n.then){n=n.then((function(e){return t.pulse=e}))}else if(n!==e.StopPropagation){this.pulse=n}return n};ku.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);t.clear();return n};ku.transform=function(){};var Au={};function Eu(e){var t=Mu(e);return t&&t.Definition||null}function Mu(e){e=e&&e.toLowerCase();return en(Au,e)?Au[e]:null}function Ou(e){return function(t){var n=e.length,r=1,i=String(e[0](t));for(;r<n;++r){i+="|"+e[r](t)}return i}}function Su(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:Ou(e)}function Du(e,t,n){e.fields=t||[];e.fname=n;return e}function Cu(e){return e==null?null:e.fname}function Fu(e){return e==null?null:e.fields}function Tu(e){throw Error(e)}function Nu(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)Tu("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)Tu("Access path missing closing bracket: "+e);if(n)Tu("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var ju=Array.isArray;function Ru(e){return e===Object(e)}function zu(e){return typeof e==="string"}function Pu(e){return ju(e)?"["+e.map(Pu)+"]":Ru(e)||zu(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Lu(e,t){var n=Nu(e),r="return _["+n.map(Pu).join("][")+"];";return Du(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var Iu=[];var Bu=Lu("id");var Uu=Du((function(e){return e}),Iu,"identity");var qu=Du((function(){return 0}),Iu,"zero");var Wu=Du((function(){return 1}),Iu,"one");var Hu=Du((function(){return true}),Iu,"true");var Gu=Du((function(){return false}),Iu,"false");function $u(e){return e[e.length-1]}function Yu(e){return e!=null?ju(e)?e:[e]:[]}function Vu(e){return typeof e==="function"}function Xu(e,t){var n=[],r=(e=Yu(e)).map((function(e,t){if(e==null){return null}else{n.push(t);return Vu(e)?e:Nu(e).map(Pu).join("][")}})),i=n.length-1,a=Yu(t),o="var u,v;return ",u,s,l,f,c,h,d,p,v;if(i<0)return null;for(s=0;s<=i;++s){u=n[s];l=r[u];if(Vu(l)){h="f"+u;f="(u=this."+h+"(a))";c="(v=this."+h+"(b))";(d=d||{})[h]=l}else{f="(u=a["+l+"])";c="(v=b["+l+"])"}h="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))";if(a[u]!=="descending"){v=1;p=-1}else{v=-1;p=1}o+="("+f+"<"+c+"||u==null)&&v!=null?"+p+":(u>v||v==null)&&u!=null?"+v+":"+h+"!==u&&v===v?"+p+":v!==v&&u===u?"+v+(u<i?":":":0")}l=Function("a","b",o+";");if(d)l=l.bind(d);e=e.reduce((function(e,t){if(Vu(t)){(Fu(t)||[]).forEach((function(t){e[t]=1}))}else if(t!=null){e[t+""]=1}return e}),{});return Du(l,Object.keys(e))}function Ju(e){return Vu(e)?e:function(){return e}}function Zu(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}function Qu(e,t){var n=0,r,i,a,o;if(e&&(r=e.length)){if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);a=o=i;for(;n<r;++n){i=e[n];if(i!=null){if(i<a)a=i;if(i>o)o=i}}}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));a=o=i;for(;n<r;++n){i=t(e[n]);if(i!=null){if(i<a)a=i;if(i>o)o=i}}}}return[a,o]}function Ku(e,t){var n=-1,r=e.length,i,a,o,u,s;if(t==null){while(++n<r){a=e[n];if(a!=null&&a>=a){i=o=a;break}}if(n===r)return[-1,-1];u=s=n;while(++n<r){a=e[n];if(a!=null){if(i>a){i=a;u=n}if(o<a){o=a;s=n}}}}else{while(++n<r){a=t(e[n],n,e);if(a!=null&&a>=a){i=o=a;break}}if(n===r)return[-1,-1];u=s=n;while(++n<r){a=t(e[n],n,e);if(a!=null){if(i>a){i=a;u=n}if(o<a){o=a;s=n}}}}return[u,s]}var es=Object.prototype.hasOwnProperty;function ts(e,t){return es.call(e,t)}var ns={};function rs(e){var t={},n,r;function i(e){return ts(t,e)&&t[e]!==ns}n={size:0,empty:0,object:t,has:i,get:function(e){return i(e)?t[e]:undefined},set:function(e,r){if(!i(e)){++n.size;if(t[e]===ns)--n.empty}t[e]=r;return this},delete:function(e){if(i(e)){--n.size;++n.empty;t[e]=ns}return this},clear:function(){n.size=n.empty=0;n.object=t={}},test:function(e){if(arguments.length){r=e;return n}else{return r}},clean:function(){var e={},i=0,a,o;for(a in t){o=t[a];if(o!==ns&&(!r||!r(o))){e[a]=o;++i}}n.size=i;n.empty=0;n.object=t=e}};if(e)Object.keys(e).forEach((function(t){n.set(t,e[t])}));return n}function is(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function as(e,t){if(e){e=t?Yu(e).map((function(e){return e.replace(/\\(.)/g,"$1")})):Yu(e)}var n=!(e&&e.length)?function(){return""}:Function("_","return ''+"+e.map((function(e){return"_["+(t?Pu(e):Nu(e).map(Pu).join("]["))+"]"})).join("+'|'+")+";");return Du(n,e,"key")}function os(e,t,n,r){var i=t.length,a=n.length;if(!a)return t;if(!i)return n;var o=r||new t.constructor(i+a),u=0,s=0,l=0;for(;u<i&&s<a;++l){o[l]=e(t[u],n[s])>0?n[s++]:t[u++]}for(;u<i;++u,++l){o[l]=t[u]}for(;s<a;++s,++l){o[l]=n[s]}return o}function us(e){return e&&$u(e)-e[0]||0}function ss(e,t,n){return n||e+(!t?"":"_"+t)}var ls={values:hs({name:"values",init:"cell.store = true;",set:"cell.data.values()",idx:-1}),count:hs({name:"count",set:"cell.num"}),__count__:hs({name:"count",set:"this.missing + this.valid"}),missing:hs({name:"missing",set:"this.missing"}),valid:hs({name:"valid",set:"this.valid"}),sum:hs({name:"sum",init:"this.sum = 0;",add:"this.sum += +v;",rem:"this.sum -= v;",set:"this.sum"}),mean:hs({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.valid ? this.mean : undefined"}),average:hs({name:"average",set:"this.valid ? this.mean : undefined",req:["mean"],idx:1}),variance:hs({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : undefined",req:["mean"],idx:1}),variancep:hs({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : undefined",req:["variance"],idx:2}),stdev:hs({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : undefined",req:["variance"],idx:2}),stdevp:hs({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : undefined",req:["variance"],idx:2}),stderr:hs({name:"stderr",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : undefined",req:["variance"],idx:2}),distinct:hs({name:"distinct",set:"cell.data.distinct(this.get)",req:["values"],idx:3}),ci0:hs({name:"ci0",set:"cell.data.ci0(this.get)",req:["values"],idx:3}),ci1:hs({name:"ci1",set:"cell.data.ci1(this.get)",req:["values"],idx:3}),median:hs({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:hs({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:hs({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),argmin:hs({name:"argmin",init:"this.argmin = undefined;",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = undefined;",set:"this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:hs({name:"argmax",init:"this.argmax = undefined;",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = undefined;",set:"this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:hs({name:"min",init:"this.min = undefined;",add:"if (v < this.min || this.min === undefined) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (Number.isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:hs({name:"max",init:"this.max = undefined;",add:"if (v > this.max || this.max === undefined) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (Number.isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4})};var fs=Object.keys(ls);function cs(e,t){return ls[e](t)}function hs(e){return function(t){var n=Zu({init:"",add:"",rem:"",idx:0},e);n.out=t||e.name;return n}}function ds(e,t){return e.idx-t.idx}function ps(e,t){function n(e,r){function i(t){if(!e[t])n(e,e[t]=ls[t]())}if(r.req)r.req.forEach(i);if(t&&r.str)r.str.forEach(i);return e}var r=e.reduce(n,e.reduce((function(e,t){e[t.name]=t;return e}),{}));var i=[],a;for(a in r)i.push(r[a]);return i.sort(ds)}function vs(e,t){var n=t||Uu,r=ps(e,true),i="var cell = this.cell; this.valid = 0; this.missing = 0;",a="this.cell = cell; this.init();",o="if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;",u="if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;",s="var cell = this.cell;";r.forEach((function(e){i+=e.init;o+=e.add;u+=e.rem}));e.slice().sort(ds).forEach((function(e){s+="t["+Pu(e.out)+"]="+e.set+";"}));s+="return t;";a=Function("cell",a);a.prototype.init=Function(i);a.prototype.add=Function("v","t",o);a.prototype.rem=Function("v","t",u);a.prototype.set=Function("t",s);a.prototype.get=n;a.fields=e.map((function(e){return e.out}));return a}function gs(e,t,n){e.fields=t||[];e.fname=n;return e}function ms(e){throw Error(e)}function ys(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);o=++u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)ms("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)ms("Access path missing closing bracket: "+e);if(n)ms("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var bs=Array.isArray;function _s(e){return e===Object(e)}function xs(e){return typeof e==="string"}function ws(e){return bs(e)?"["+e.map(ws)+"]":_s(e)||xs(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function ks(e,t){var n=ys(e),r="return _["+n.map(ws).join("][")+"];";return gs(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var As=[];var Es=ks("id");var Ms=gs((function(e){return e}),As,"identity");var Os=gs((function(){return 0}),As,"zero");var Ss=gs((function(){return 1}),As,"one");var Ds=gs((function(){return true}),As,"true");var Cs=gs((function(){return false}),As,"false");function Fs(e){return e!=null?bs(e)?e:[e]:[]}function Ts(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function Ns(e,t,n){if(e){var r=0,i=e.length,a;if(t){for(;r<i;++r){if(a=t(e[r]))n(a,r,e)}}else{e.forEach(n)}}}function js(e){var t=e||Ms,n=[],r={};n.add=function(e){var i=t(e);if(!r[i]){r[i]=1;n.push(e)}return n};n.remove=function(e){var i=t(e),a;if(r[i]){r[i]=0;if((a=n.indexOf(e))>=0){n.splice(a,1)}}return n};return n}var Rs=Symbol("vega_id"),zs=1;function Ps(e){return e[Rs]}function Ls(e,t){e[Rs]=t;return e}function Is(e){var t=e===Object(e)?e:{data:e};return Ps(t)?t:Ls(t,zs++)}function Bs(e){return Us(e,Is({}))}function Us(e,t){for(var n in e)t[n]=e[n];return t}function qs(e,t){return Ls(t,Ps(e))}function Ws(e,t){return!e?null:t?function(n,r){return e(n,r)||Ps(t(n))-Ps(t(r))}:function(t,n){return e(t,n)||Ps(t)-Ps(n)}}var Hs="_:mod:_";function Gs(){Object.defineProperty(this,Hs,{writable:true,value:{}})}var $s=Gs.prototype;$s.set=function(e,t,n,r){var i=this,a=i[e],o=i[Hs];if(t!=null&&t>=0){if(a[t]!==n||r){a[t]=n;o[t+":"+e]=-1;o[e]=-1}}else if(a!==n||r){i[e]=n;o[e]=bs(n)?1+n.length:-1}return i};$s.modified=function(e,t){var n=this[Hs],r;if(!arguments.length){for(r in n){if(n[r])return true}return false}else if(bs(e)){for(r=0;r<e.length;++r){if(n[e[r]])return true}return false}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]};$s.clear=function(){this[Hs]={};return this};var Ys=0;var Vs="pulse";var Xs=new Gs;var Js=1,Zs=2;function Qs(e,t,n,r){this.id=++Ys;this.value=e;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(t){this._update=t}if(n)this.parameters(n,r)}var Ks=Qs.prototype;Ks.targets=function(){return this._targets||(this._targets=js(Es))};Ks.set=function(e){if(this.value!==e){this.value=e;return 1}else{return 0}};function el(e){return function(t){var n=this.flags;if(arguments.length===0)return!!(n&e);this.flags=t?n|e:n&~e;return this}}Ks.skip=el(Js);Ks.modified=el(Zs);Ks.parameters=function(e,t,n){t=t!==false;var r=this,i=r._argval=r._argval||new Gs,a=r._argops=r._argops||[],o=[],u,s,l,f;function c(e,n,u){if(u instanceof Qs){if(u!==r){if(t)u.targets().add(r);o.push(u)}a.push({op:u,name:e,index:n})}else{i.set(e,n,u)}}for(u in e){s=e[u];if(u===Vs){Fs(s).forEach((function(e){if(!(e instanceof Qs)){ms("Pulse parameters must be operator instances.")}else if(e!==r){e.targets().add(r);o.push(e)}}));r.source=s}else if(bs(s)){i.set(u,-1,Array(l=s.length));for(f=0;f<l;++f)c(u,f,s[f])}else{c(u,-1,s)}}this.marshall().clear();if(n)a.initonly=true;return o};Ks.marshall=function(e){var t=this._argval||Xs,n=this._argops,r,i,a,o,u;if(n){for(i=0,a=n.length;i<a;++i){r=n[i];o=r.op;u=o.modified()&&o.stamp===e;t.set(r.name,r.index,o.value,u)}if(n.initonly){for(i=0;i<a;++i){r=n[i];r.op.targets().remove(this)}this._argops=null;this._update=null}}return t};Ks.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);n.clear();if(r!==this.value){this.value=r}else if(!this.modified()){return e.StopPropagation}}};Ks.run=function(e){if(e.stamp<this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false);t=0}else{t=this.evaluate(e)}return this.pulse=t||e};var tl={};var nl=1<<0,rl=1<<1,il=1<<2,al=nl|rl,ol=nl|il,ul=nl|rl|il,sl=1<<3,ll=1<<4,fl=1<<5,cl=1<<6;function hl(e,t,n){this.dataflow=e;this.stamp=t==null?-1:t;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}var dl=hl.prototype;dl.StopPropagation=tl;dl.ADD=nl;dl.REM=rl;dl.MOD=il;dl.ADD_REM=al;dl.ADD_MOD=ol;dl.ALL=ul;dl.REFLOW=sl;dl.SOURCE=ll;dl.NO_SOURCE=fl;dl.NO_FIELDS=cl;dl.fork=function(e){return new hl(this.dataflow).init(this,e)};dl.clone=function(){var e=this.fork(ul);e.add=e.add.slice();e.rem=e.rem.slice();e.mod=e.mod.slice();if(e.source)e.source=e.source.slice();return e.materialize(ul|ll)};dl.addAll=function(){var e=this;if(!this.source||this.source.length===this.add.length){return e}else{e=new hl(this.dataflow).init(this);e.add=e.source;return e}};dl.init=function(e,t){var n=this;n.stamp=e.stamp;n.encode=e.encode;if(e.fields&&!(t&cl)){n.fields=e.fields}if(t&nl){n.addF=e.addF;n.add=e.add}else{n.addF=null;n.add=[]}if(t&rl){n.remF=e.remF;n.rem=e.rem}else{n.remF=null;n.rem=[]}if(t&il){n.modF=e.modF;n.mod=e.mod}else{n.modF=null;n.mod=[]}if(t&fl){n.srcF=null;n.source=null}else{n.srcF=e.srcF;n.source=e.source}return n};dl.runAfter=function(e){this.dataflow.runAfter(e)};dl.changed=function(e){var t=e||ul;return t&nl&&this.add.length||t&rl&&this.rem.length||t&il&&this.mod.length};dl.reflow=function(e){if(e)return this.fork(ul).reflow();var t=this.add.length,n=this.source&&this.source.length;if(n&&n!==t){this.mod=this.source;if(t)this.filter(il,gl(this,nl))}return this};dl.modifies=function(e){var t=this.fields||(this.fields={});if(bs(e)){e.forEach((function(e){return t[e]=true}))}else{t[e]=true}return this};dl.modified=function(e,t){var n=this.fields;return!((t||this.mod.length)&&n)?false:!arguments.length?!!n:bs(e)?e.some((function(e){return n[e]})):n[e]};dl.filter=function(e,t){var n=this;if(e&nl)n.addF=pl(n.addF,t);if(e&rl)n.remF=pl(n.remF,t);if(e&il)n.modF=pl(n.modF,t);if(e&ll)n.srcF=pl(n.srcF,t);return n};function pl(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}dl.materialize=function(e){e=e||ul;var t=this;if(e&nl&&t.addF){t.add=vl(t.add,t.addF);t.addF=null}if(e&rl&&t.remF){t.rem=vl(t.rem,t.remF);t.remF=null}if(e&il&&t.modF){t.mod=vl(t.mod,t.modF);t.modF=null}if(e&ll&&t.srcF){t.source=t.source.filter(t.srcF);t.srcF=null}return t};function vl(e,t){var n=[];Ns(e,t,(function(e){n.push(e)}));return n}function gl(e,t){var n={};e.visit(t,(function(e){n[Ps(e)]=1}));return function(e){return n[Ps(e)]?null:e}}dl.visit=function(e,t){var n=this,r=t,i,a;if(e&ll){Ns(n.source,n.srcF,r);return n}if(e&nl)Ns(n.add,n.addF,r);if(e&rl)Ns(n.rem,n.remF,r);if(e&il)Ns(n.mod,n.modF,r);if(e&sl&&(i=n.source)){a=n.add.length+n.mod.length;if(a===i.length);else if(a){Ns(i,gl(n,ol),r)}else{Ns(i,n.srcF,r)}}return n};function ml(e,t,n,r){var i=this,a=0,o,u,s,l,f;this.dataflow=e;this.stamp=t;this.fields=null;this.encode=r||null;this.pulses=n;for(s=0,l=n.length;s<l;++s){o=n[s];if(o.stamp!==t)continue;if(o.fields){u=i.fields||(i.fields={});for(f in o.fields){u[f]=1}}if(o.changed(i.ADD))a|=i.ADD;if(o.changed(i.REM))a|=i.REM;if(o.changed(i.MOD))a|=i.MOD}this.changes=a}var yl=Ts(ml,hl);yl.fork=function(e){var t=new hl(this.dataflow).init(this,e&this.NO_FIELDS);if(e!==undefined){if(e&t.ADD){this.visit(t.ADD,(function(e){return t.add.push(e)}))}if(e&t.REM){this.visit(t.REM,(function(e){return t.rem.push(e)}))}if(e&t.MOD){this.visit(t.MOD,(function(e){return t.mod.push(e)}))}}return t};yl.changed=function(e){return this.changes&e};yl.modified=function(e){var t=this,n=t.fields;return!(n&&t.changes&t.MOD)?0:bs(e)?e.some((function(e){return n[e]})):n[e]};yl.filter=function(){ms("MultiPulse does not support filtering.")};yl.materialize=function(){ms("MultiPulse does not support materialization.")};yl.visit=function(e,t){var n=this,r=n.pulses,i=r.length,a=0;if(e&n.SOURCE){for(;a<i;++a){r[a].visit(e,t)}}else{for(;a<i;++a){if(r[a].stamp===n.stamp){r[a].visit(e,t)}}}return n};function bl(e,t){Qs.call(this,e,null,t)}var _l=Ts(bl,Qs);_l.run=function(e){var t=this;if(e.stamp<this.stamp)return e.StopPropagation;var n;if(this.skip()){this.skip(false)}else{n=this.evaluate(e)}n=n||e;if(n.then){n=n.then((function(e){return t.pulse=e}))}else if(n!==e.StopPropagation){this.pulse=n}return n};_l.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);t.clear();return n};_l.transform=function(){};function xl(e,t){var n,r,i,a,o,u,s;return __generator(this,(function(l){switch(l.label){case 0:if(!(t===undefined))return[3,5];n=0,r=e;l.label=1;case 1:if(!(n<r.length))return[3,4];i=r[n];if(!(i!=null&&(i=+i)>=i))return[3,3];return[4,i];case 2:l.sent();l.label=3;case 3:n++;return[3,1];case 4:return[3,9];case 5:a=-1;o=0,u=e;l.label=6;case 6:if(!(o<u.length))return[3,9];s=u[o];if(!((s=t(s,++a,e))!=null&&(s=+s)>=s))return[3,8];return[4,s];case 7:l.sent();l.label=8;case 8:o++;return[3,6];case 9:return[2]}}))}function wl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function kl(e){if(e.length===1)e=Al(e);return{left:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)<0)r=a+1;else i=a}return r},right:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)>0)i=a;else r=a+1}return r}}}function Al(e){return function(t,n){return wl(e(t),n)}}var El=kl(wl);var Ml=El.right;var Ol=El.left;function Sl(e,t){var n=0;var r;var i=0;var a=0;if(t===undefined){for(var o=0,u=e;o<u.length;o++){var s=u[o];if(s!=null&&(s=+s)>=s){r=s-i;i+=r/++n;a+=r*(s-i)}}}else{var l=-1;for(var f=0,c=e;f<c.length;f++){var h=c[f];if((h=t(h,++l,e))!=null&&(h=+h)>=h){r=h-i;i+=r/++n;a+=r*(h-i)}}}if(n>1)return a/(n-1)}function Dl(e,t){var n=Sl(e,t);return n?Math.sqrt(n):n}function Cl(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);while(++r<i){a[r]=e+r*n}return a}var Fl=Math.sqrt(50),Tl=Math.sqrt(10),Nl=Math.sqrt(2);function jl(e,t,n){var r,i=-1,a,o,u;t=+t,e=+e,n=+n;if(e===t&&n>0)return[e];if(r=t<e)a=e,e=t,t=a;if((u=Rl(e,t,n))===0||!isFinite(u))return[];if(u>0){e=Math.ceil(e/u);t=Math.floor(t/u);o=new Array(a=Math.ceil(t-e+1));while(++i<a)o[i]=(e+i)*u}else{e=Math.floor(e*u);t=Math.ceil(t*u);o=new Array(a=Math.ceil(e-t+1));while(++i<a)o[i]=(e-i)/u}if(r)o.reverse();return o}function Rl(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=Fl?10:a>=Tl?5:a>=Nl?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=Fl?10:a>=Tl?5:a>=Nl?2:1)}function zl(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;if(a>=Fl)i*=10;else if(a>=Tl)i*=5;else if(a>=Nl)i*=2;return t<e?-i:i}function Pl(e,t){var n;if(t===undefined){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a!=null&&(n<a||n===undefined&&a>=a)){n=a}}}else{var o=-1;for(var u=0,s=e;u<s.length;u++){var l=s[u];if((l=t(l,++o,e))!=null&&(n<l||n===undefined&&l>=l)){n=l}}}return n}function Ll(e,t){var n;if(t===undefined){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a!=null&&(n>a||n===undefined&&a>=a)){n=a}}}else{var o=-1;for(var u=0,s=e;u<s.length;u++){var l=s[u];if((l=t(l,++o,e))!=null&&(n>l||n===undefined&&l>=l)){n=l}}}return n}function Il(e,t,n,r,i){if(n===void 0){n=0}if(r===void 0){r=e.length-1}if(i===void 0){i=wl}while(r>n){if(r-n>600){var a=r-n+1;var o=t-n+1;var u=Math.log(a);var s=.5*Math.exp(2*u/3);var l=.5*Math.sqrt(u*s*(a-s)/a)*(o-a/2<0?-1:1);var f=Math.max(n,Math.floor(t-o*s/a+l));var c=Math.min(r,Math.floor(t+(a-o)*s/a+l));Il(e,t,f,c,i)}var h=e[t];var d=n;var p=r;Bl(e,n,t);if(i(e[r],h)>0)Bl(e,n,r);while(d<p){Bl(e,d,p),++d,--p;while(i(e[d],h)<0)++d;while(i(e[p],h)>0)--p}if(i(e[n],h)===0)Bl(e,n,p);else++p,Bl(e,p,r);if(p<=t)n=p+1;if(t<=p)r=p-1}return e}function Bl(e,t,n){var r=e[t];e[t]=e[n];e[n]=r}function Ul(e){return e===null?NaN:+e}function ql(e,t){var n,r,i,a,o,u,s;return __generator(this,(function(l){switch(l.label){case 0:if(!(t===undefined))return[3,5];n=0,r=e;l.label=1;case 1:if(!(n<r.length))return[3,4];i=r[n];if(!(i!=null&&(i=+i)>=i))return[3,3];return[4,i];case 2:l.sent();l.label=3;case 3:n++;return[3,1];case 4:return[3,9];case 5:a=-1;o=0,u=e;l.label=6;case 6:if(!(o<u.length))return[3,9];s=u[o];if(!((s=t(s,++a,e))!=null&&(s=+s)>=s))return[3,8];return[4,s];case 7:l.sent();l.label=8;case 8:o++;return[3,6];case 9:return[2]}}))}function Wl(e,t,n){e=Float64Array.from(ql(e,n));if(!(r=e.length))return;if((t=+t)<=0||r<2)return Ll(e);if(t>=1)return Pl(e);var r,i=(r-1)*t,a=Math.floor(i),o=Pl(Il(e,a).subarray(0,a+1)),u=Ll(e.subarray(a+1));return o+(u-o)*(i-a)}function Hl(e,t,n){if(n===void 0){n=Ul}if(!(r=e.length))return;if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e),u=+n(e[a+1],a+1,e);return o+(u-o)*(i-a)}function Gl(e,t){var n=0;var r=0;if(t===undefined){for(var i=0,a=e;i<a.length;i++){var o=a[i];if(o!=null&&(o=+o)>=o){++n,r+=o}}}else{var u=-1;for(var s=0,l=e;s<l.length;s++){var f=l[s];if((f=t(f,++u,e))!=null&&(f=+f)>=f){++n,r+=f}}}if(n)return r/n}function $l(e,t){return Wl(e,.5,t)}function Yl(e,t){return Array.from(t,(function(t){return e[t]}))}function Vl(e,t){var n=0;if(t===undefined){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a=+a){n+=a}}}else{var o=-1;for(var u=0,s=e;u<s.length;u++){var l=s[u];if(l=+t(l,++o,e)){n+=l}}}return n}function Xl(e,t,n){var r=Float64Array.from(xl(e,n));r.sort(wl);return t.map((function(e){return Hl(r,e)}))}function Jl(e,t){return Xl(e,[.25,.5,.75],t)}function Zl(e,t){var n=e.length,r=Dl(e,t),i=Jl(e,t),a=(i[2]-i[0])/1.34;r=Math.min(r,a)||r||Math.abs(i[0])||1;return 1.06*r*Math.pow(n,-.2)}function Ql(e){var t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2],a=e.extent[0],o=e.extent[1],u=e.span||o-a||Math.abs(a)||1,s,l,f,c,h,d,p,v;if(e.step){s=e.step}else if(e.steps){h=u/t;for(d=0,p=e.steps.length;d<p&&e.steps[d]<h;++d);s=e.steps[Math.max(0,d-1)]}else{l=Math.ceil(Math.log(t)/r);f=e.minstep||0;s=Math.max(f,Math.pow(n,Math.round(Math.log(u)/r)-l));while(Math.ceil(u/s)>t){s*=n}for(d=0,p=i.length;d<p;++d){h=s/i[d];if(h>=f&&u/h<=t)s=h}}h=Math.log(s);c=h>=0?0:~~(-h/r)+1;v=Math.pow(n,-c-1);if(e.nice||e.nice===undefined){h=Math.floor(a/s+v)*s;a=a<h?h-s:h;o=Math.ceil(o/s)*s}return{start:a,stop:o===a?a+s:o,step:s}}var Kl=Math.random;function ef(e){Kl=e}function tf(e,t,n,r){if(!e.length)return[undefined,undefined];var i=Float64Array.from(xl(e,r)),a=i.length,o=t,u,s,l,f;for(l=0,f=Array(o);l<o;++l){for(u=0,s=0;s<a;++s){u+=i[~~(Kl()*a)]}f[l]=u/a}f.sort(wl);return[Wl(f,n/2),Wl(f,1-n/2)]}function nf(e,t,n,r){r=r||function(e){return e};var i=0,a=1,o=e.length,u=new Float64Array(o),s=r(e[0]),l=s,f=s+t,c;for(;a<o;++a){c=r(e[a]);if(c>=f){l=(s+l)/2;for(;i<a;++i)u[i]=l;f=c+t;s=c}l=c}l=(s+l)/2;for(;i<a;++i)u[i]=l;return n?rf(u,t+t/4):u}function rf(e,t){var n=e.length,r=0,i=1,a,o;while(e[r]===e[i])++i;while(i<n){a=i+1;while(e[i]===e[a])++a;if(e[i]-e[i-1]<t){o=i+(r+a-i-i>>1);while(o<i)e[o++]=e[i];while(o>i)e[o--]=e[r]}r=i;i=a}return e}function af(e){return function(){e=(1103515245*e+12345)%2147483647;return e/2147483647}}function of(e,t){if(t==null){t=e;e=0}var n={},r,i,a;n.min=function(e){if(arguments.length){r=e||0;a=i-r;return n}else{return r}};n.max=function(e){if(arguments.length){i=e||0;a=i-r;return n}else{return i}};n.sample=function(){return r+Math.floor(a*Kl())};n.pdf=function(e){return e===Math.floor(e)&&e>=r&&e<i?1/a:0};n.cdf=function(e){var t=Math.floor(e);return t<r?0:t>=i?1:(t-r+1)/a};n.icdf=function(e){return e>=0&&e<=1?r-1+Math.floor(e*a):NaN};return n.min(e).max(t)}var uf=Math.sqrt(2*Math.PI);var sf=Math.SQRT2;var lf=NaN;function ff(e,t){e=e||0;t=t==null?1:t;var n=0,r=0,i,a;if(lf===lf){n=lf;lf=NaN}else{do{n=Kl()*2-1;r=Kl()*2-1;i=n*n+r*r}while(i===0||i>1);a=Math.sqrt(-2*Math.log(i)/i);n*=a;lf=r*a}return e+n*t}function cf(e,t,n){n=n==null?1:n;var r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*uf)}function hf(e,t,n){t=t||0;n=n==null?1:n;var r,i=(e-t)/n,a=Math.abs(i);if(a>37){r=0}else{var o,u=Math.exp(-a*a/2);if(a<7.07106781186547){o=.0352624965998911*a+.700383064443688;o=o*a+6.37396220353165;o=o*a+33.912866078383;o=o*a+112.079291497871;o=o*a+221.213596169931;o=o*a+220.206867912376;r=u*o;o=.0883883476483184*a+1.75566716318264;o=o*a+16.064177579207;o=o*a+86.7807322029461;o=o*a+296.564248779674;o=o*a+637.333633378831;o=o*a+793.826512519948;o=o*a+440.413735824752;r=r/o}else{o=a+.65;o=a+4/o;o=a+3/o;o=a+2/o;o=a+1/o;r=u/o/2.506628274631}}return i>0?1-r:r}function df(e,t,n){if(e<0||e>1)return NaN;return(t||0)+(n==null?1:n)*sf*pf(2*e-1)}function pf(e){var t=-Math.log((1-e)*(1+e)),n;if(t<6.25){t-=3.125;n=-364441206401782e-35;n=-16850591381820166e-35+n*t;n=128584807152564e-32+n*t;n=11157877678025181e-33+n*t;n=-1333171662854621e-31+n*t;n=20972767875968562e-33+n*t;n=6637638134358324e-30+n*t;n=-4054566272975207e-29+n*t;n=-8151934197605472e-29+n*t;n=26335093153082323e-28+n*t;n=-12975133253453532e-27+n*t;n=-5415412054294628e-26+n*t;n=1.0512122733215323e-9+n*t;n=-4.112633980346984e-9+n*t;n=-2.9070369957882005e-8+n*t;n=4.2347877827932404e-7+n*t;n=-13654692000834679e-22+n*t;n=-13882523362786469e-21+n*t;n=.00018673420803405714+n*t;n=-.000740702534166267+n*t;n=-.006033670871430149+n*t;n=.24015818242558962+n*t;n=1.6536545626831027+n*t}else if(t<16){t=Math.sqrt(t)-3.25;n=2.2137376921775787e-9;n=9.075656193888539e-8+n*t;n=-2.7517406297064545e-7+n*t;n=1.8239629214389228e-8+n*t;n=15027403968909828e-22+n*t;n=-4013867526981546e-21+n*t;n=29234449089955446e-22+n*t;n=12475304481671779e-21+n*t;n=-47318229009055734e-21+n*t;n=6828485145957318e-20+n*t;n=24031110387097894e-21+n*t;n=-.0003550375203628475+n*t;n=.0009532893797373805+n*t;n=-.0016882755560235047+n*t;n=.002491442096107851+n*t;n=-.003751208507569241+n*t;n=.005370914553590064+n*t;n=1.0052589676941592+n*t;n=3.0838856104922208+n*t}else if(Number.isFinite(t)){t=Math.sqrt(t)-5;n=-27109920616438573e-27;n=-2.555641816996525e-10+n*t;n=1.5076572693500548e-9+n*t;n=-3.789465440126737e-9+n*t;n=7.61570120807834e-9+n*t;n=-1.496002662714924e-8+n*t;n=2.914795345090108e-8+n*t;n=-6.771199775845234e-8+n*t;n=2.2900482228026655e-7+n*t;n=-9.9298272942317e-7+n*t;n=4526062597223154e-21+n*t;n=-1968177810553167e-20+n*t;n=7599527703001776e-20+n*t;n=-.00021503011930044477+n*t;n=-.00013871931833623122+n*t;n=1.0103004648645344+n*t;n=4.849906401408584+n*t}else{n=Infinity}return n*e}function vf(e,t){var n,r,i={mean:function(e){if(arguments.length){n=e||0;return i}else{return n}},stdev:function(e){if(arguments.length){r=e==null?1:e;return i}else{return r}},sample:function(){return ff(n,r)},pdf:function(e){return cf(e,n,r)},cdf:function(e){return hf(e,n,r)},icdf:function(e){return df(e,n,r)}};return i.mean(e).stdev(t)}function gf(e,t){var n=vf(),r={},i=0;r.data=function(n){if(arguments.length){e=n;i=n?n.length:0;return r.bandwidth(t)}else{return e}};r.bandwidth=function(n){if(!arguments.length)return t;t=n;if(!t&&e)t=Zl(e);return r};r.sample=function(){return e[~~(Kl()*i)]+t*n.sample()};r.pdf=function(r){for(var a=0,o=0;o<i;++o){a+=n.pdf((r-e[o])/t)}return a/t/i};r.cdf=function(r){for(var a=0,o=0;o<i;++o){a+=n.cdf((r-e[o])/t)}return a/i};r.icdf=function(){throw Error("KDE icdf not supported.")};return r.data(e)}function mf(e,t){e=e||0;t=t==null?1:t;return Math.exp(e+ff()*t)}function yf(e,t,n){if(e<=0)return 0;t=t||0;n=n==null?1:n;var r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*uf*e)}function bf(e,t,n){return hf(Math.log(e),t,n)}function _f(e,t,n){return Math.exp(df(e,t,n))}function xf(e,t){var n,r,i={mean:function(e){if(arguments.length){n=e||0;return i}else{return n}},stdev:function(e){if(arguments.length){r=e==null?1:e;return i}else{return r}},sample:function(){return mf(n,r)},pdf:function(e){return yf(e,n,r)},cdf:function(e){return bf(e,n,r)},icdf:function(e){return _f(e,n,r)}};return i.mean(e).stdev(t)}function wf(e,t){var n={},r=0,i;function a(e){var t=[],n=0,i;for(i=0;i<r;++i){n+=t[i]=e[i]==null?1:+e[i]}for(i=0;i<r;++i){t[i]/=n}return t}n.weights=function(e){if(arguments.length){i=a(t=e||[]);return n}return t};n.distributions=function(i){if(arguments.length){if(i){r=i.length;e=i}else{r=0;e=[]}return n.weights(t)}return e};n.sample=function(){var t=Kl(),n=e[r-1],a=i[0],o=0;for(;o<r-1;a+=i[++o]){if(t<a){n=e[o];break}}return n.sample()};n.pdf=function(t){for(var n=0,a=0;a<r;++a){n+=i[a]*e[a].pdf(t)}return n};n.cdf=function(t){for(var n=0,a=0;a<r;++a){n+=i[a]*e[a].cdf(t)}return n};n.icdf=function(){throw Error("Mixture icdf not supported.")};return n.distributions(e).weights(t)}function kf(e,t){if(t==null){t=e==null?1:e;e=0}return e+(t-e)*Kl()}function Af(e,t,n){if(n==null){n=t==null?1:t;t=0}return e>=t&&e<=n?1/(n-t):0}function Ef(e,t,n){if(n==null){n=t==null?1:t;t=0}return e<t?0:e>n?1:(e-t)/(n-t)}function Mf(e,t,n){if(n==null){n=t==null?1:t;t=0}return e>=0&&e<=1?t+e*(n-t):NaN}function Of(e,t){var n,r,i={min:function(e){if(arguments.length){n=e||0;return i}else{return n}},max:function(e){if(arguments.length){r=e==null?1:e;return i}else{return r}},sample:function(){return kf(n,r)},pdf:function(e){return Af(e,n,r)},cdf:function(e){return Ef(e,n,r)},icdf:function(e){return Mf(e,n,r)}};if(t==null){t=e==null?1:e;e=0}return i.min(e).max(t)}function Sf(e,t,n,r){var i=r-e*e,a=Math.abs(i)<1e-24?0:(n-e*t)/i,o=t-a*e;return[o,a]}function Df(e,t,n,r){e=e.filter((function(e){var r=t(e),i=n(e);return r!=null&&(r=+r)>=r&&i!=null&&(i=+i)>=i}));if(r){e.sort((function(e,n){return t(e)-t(n)}))}var i=e.length,a=new Float64Array(i),o=new Float64Array(i);var u=0,s=0,l=0,f,c,h;for(var d=0,p=e;d<p.length;d++){h=p[d];a[u]=f=+t(h);o[u]=c=+n(h);++u;s+=(f-s)/u;l+=(c-l)/u}for(u=0;u<i;++u){a[u]-=s;o[u]-=l}return[a,o,s,l]}function Cf(e,t,n,r){var i=-1,a,o;for(var u=0,s=e;u<s.length;u++){var l=s[u];a=t(l);o=n(l);if(a!=null&&(a=+a)>=a&&o!=null&&(o=+o)>=o){r(a,o,++i)}}}function Ff(e,t,n,r,i){var a=0,o=0;Cf(e,t,n,(function(e,t){var n=t-i(e),u=t-r;a+=n*n;o+=u*u}));return 1-a/o}function Tf(e,t,n){var r=0,i=0,a=0,o=0,u=0;Cf(e,t,n,(function(e,t){++u;r+=(e-r)/u;i+=(t-i)/u;a+=(e*t-a)/u;o+=(e*e-o)/u}));var s=Sf(r,i,a,o),l=function(e){return s[0]+s[1]*e};return{coef:s,predict:l,rSquared:Ff(e,t,n,i,l)}}function Nf(e,t,n){var r=0,i=0,a=0,o=0,u=0;Cf(e,t,n,(function(e,t){++u;e=Math.log(e);r+=(e-r)/u;i+=(t-i)/u;a+=(e*t-a)/u;o+=(e*e-o)/u}));var s=Sf(r,i,a,o),l=function(e){return s[0]+s[1]*Math.log(e)};return{coef:s,predict:l,rSquared:Ff(e,t,n,i,l)}}function jf(e,t,n){var r=0,i=0,a=0,o=0,u=0,s=0;Cf(e,t,n,(function(e,t){var n=Math.log(t),l=e*t;++s;r+=(t-r)/s;a+=(l-a)/s;u+=(e*l-u)/s;i+=(t*n-i)/s;o+=(l*n-o)/s}));var l=Sf(a/r,i/r,o/r,u/r),f=function(e){return l[0]*Math.exp(l[1]*e)};l[0]=Math.exp(l[0]);return{coef:l,predict:f,rSquared:Ff(e,t,n,r,f)}}function Rf(e,t,n){var r=0,i=0,a=0,o=0,u=0,s=0;Cf(e,t,n,(function(e,t){var n=Math.log(e),l=Math.log(t);++s;r+=(n-r)/s;i+=(l-i)/s;a+=(n*l-a)/s;o+=(n*n-o)/s;u+=(t-u)/s}));var l=Sf(r,i,a,o),f=function(e){return l[0]*Math.pow(e,l[1])};l[0]=Math.exp(l[0]);return{coef:l,predict:f,rSquared:Ff(e,t,n,u,f)}}function zf(e,t,n){var r=Df(e,t,n),i=r[0],a=r[1],o=r[2],u=r[3],s=i.length;var l=0,f=0,c=0,h=0,d=0,p,v,g,m;for(p=0;p<s;){v=i[p];g=a[p++];m=v*v;l+=(m-l)/p;f+=(m*v-f)/p;c+=(m*m-c)/p;h+=(v*g-h)/p;d+=(m*g-d)/p}var y=c-l*l,b=l*y-f*f,_=(d*l-h*f)/b,x=(h*y-d*f)/b,w=-_*l,k=function(e){e=e-o;return _*e*e+x*e+w+u};return{coef:[w-x*o+_*o*o+u,x-2*_*o,_],predict:k,rSquared:Ff(e,t,n,u,k)}}function Pf(e,t,n,r){if(r===1)return Tf(e,t,n);if(r===2)return zf(e,t,n);var i=Df(e,t,n),a=i[0],o=i[1],u=i[2],s=i[3],l=a.length,f=[],c=[],h=r+1;var d,p,v,g,m;for(d=0;d<h;++d){for(v=0,g=0;v<l;++v){g+=Math.pow(a[v],d)*o[v]}f.push(g);m=new Float64Array(h);for(p=0;p<h;++p){for(v=0,g=0;v<l;++v){g+=Math.pow(a[v],d+p)}m[p]=g}c.push(m)}c.push(f);var y=If(c),b=function(e){e-=u;var t=s+y[0]+y[1]*e+y[2]*e*e;for(d=3;d<h;++d)t+=y[d]*Math.pow(e,d);return t};return{coef:Lf(h,y,-u,s),predict:b,rSquared:Ff(e,t,n,s,b)}}function Lf(e,t,n,r){var i=Array(e);var a,o,u,s;for(a=0;a<e;++a)i[a]=0;for(a=e-1;a>=0;--a){u=t[a];s=1;i[a]+=u;for(o=1;o<=a;++o){s*=(a+1-o)/o;i[a-o]+=u*Math.pow(n,o)*s}}i[0]+=r;return i}function If(e){var t=e.length-1,n=[];var r,i,a,o,u;for(r=0;r<t;++r){o=r;for(i=r+1;i<t;++i){if(Math.abs(e[r][i])>Math.abs(e[r][o])){o=i}}for(a=r;a<t+1;++a){u=e[a][r];e[a][r]=e[a][o];e[a][o]=u}for(i=r+1;i<t;++i){for(a=t;a>=r;a--){e[a][i]-=e[a][r]*e[r][i]/e[r][r]}}}for(i=t-1;i>=0;--i){u=0;for(a=i+1;a<t;++a){u+=e[a][i]*n[a]}n[i]=(e[t][i]-u)/e[i][i]}return n}var Bf=2,Uf=1e-12;function qf(e,t,n,r){var i=Df(e,t,n,true),a=i[0],o=i[1],u=i[2],s=i[3],l=a.length,f=Math.max(2,~~(r*l)),c=new Float64Array(l),h=new Float64Array(l),d=new Float64Array(l).fill(1);for(var p=-1;++p<=Bf;){var v=[0,f-1];for(var g=0;g<l;++g){var m=a[g],y=v[0],b=v[1],_=m-a[y]>a[b]-m?y:b;var x=0,w=0,k=0,A=0,E=0,M=1/Math.abs(a[_]-m||1);for(var O=y;O<=b;++O){var S=a[O],D=o[O],C=Wf(Math.abs(m-S)*M)*d[O],F=S*C;x+=C;w+=F;k+=D*C;A+=D*F;E+=S*F}var T=Sf(w/x,k/x,A/x,E/x),N=T[0],j=T[1];c[g]=N+j*m;h[g]=Math.abs(o[g]-c[g]);Hf(a,g+1,v)}if(p===Bf){break}var R=$l(h);if(Math.abs(R)<Uf)break;for(var g=0,z=void 0,P;g<l;++g){z=h[g]/(6*R);d[g]=z>=1?Uf:(P=1-z*z)*P}}return Gf(a,c,u,s)}function Wf(e){return(e=1-e*e*e)*e*e}function Hf(e,t,n){var r=e[t],i=n[0],a=n[1]+1;if(a>=e.length)return;while(t>i&&e[a]-r<=r-e[i]){n[0]=++i;n[1]=a;++a}}function Gf(e,t,n,r){var i=e.length,a=[];var o=0,u=0,s=[],l;for(;o<i;++o){l=e[o]+n;if(s[0]===l){s[1]+=(t[o]-s[1])/++u}else{u=0;s[1]+=r;s=[l,t[o]];a.push(s)}}s[1]+=r;return a}var $f=.1*Math.PI/180;function Yf(e,t,n,r){n=n||25;r=Math.max(n,r||200);var i=function(t){return[t,e(t)]},a=t[0],o=t[1],u=o-a,s=u/r,l=[i(a)],f=[];if(n===r){for(var c=1;c<r;++c){l.push(i(a+c/n*u))}l.push(i(o));return l}else{f.push(i(o));for(var c=n;--c>0;){f.push(i(a+c/n*u))}}var h=l[0],d=f[f.length-1];while(d){var p=i((h[0]+d[0])/2);if(p[0]-h[0]>=s&&Vf(h,p,d)>$f){f.push(p)}else{h=d;l.push(d);f.pop()}d=f[f.length-1]}return l}function Vf(e,t,n){var r=Math.atan2(n[1]-e[1],n[0]-e[0]),i=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(r-i)}function Xf(e){this._key=e?Lu(e):Ps;this.reset()}var Jf=Xf.prototype;Jf.reset=function(){this._add=[];this._rem=[];this._ext=null;this._get=null;this._q=null};Jf.add=function(e){this._add.push(e)};Jf.rem=function(e){this._rem.push(e)};Jf.values=function(){this._get=null;if(this._rem.length===0)return this._add;var e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,a=Array(r-i),o={},u,s,l;for(u=0;u<i;++u){o[n(t[u])]=1}for(u=0,s=0;u<r;++u){if(o[n(l=e[u])]){o[n(l)]=0}else{a[s++]=l}}this._rem=[];return this._add=a};Jf.distinct=function(e){var t=this.values(),n=t.length,r={},i=0,a;while(--n>=0){a=e(t[n])+"";if(!ts(r,a)){r[a]=1;++i}}return i};Jf.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=Ku(t,e);this._ext=[t[n[0]],t[n[1]]];this._get=e}return this._ext};Jf.argmin=function(e){return this.extent(e)[0]||{}};Jf.argmax=function(e){return this.extent(e)[1]||{}};Jf.min=function(e){var t=this.extent(e)[0];return t!=null?e(t):undefined};Jf.max=function(e){var t=this.extent(e)[1];return t!=null?e(t):undefined};Jf.quartile=function(e){if(this._get!==e||!this._q){this._q=Jl(this.values(),e);this._get=e}return this._q};Jf.q1=function(e){return this.quartile(e)[0]};Jf.q2=function(e){return this.quartile(e)[1]};Jf.q3=function(e){return this.quartile(e)[2]};Jf.ci=function(e){if(this._get!==e||!this._ci){this._ci=tf(this.values(),1e3,.05,e);this._get=e}return this._ci};Jf.ci0=function(e){return this.ci(e)[0]};Jf.ci1=function(e){return this.ci(e)[1]};function Zf(e){bl.call(this,null,e);this._adds=[];this._mods=[];this._alen=0;this._mlen=0;this._drop=true;this._cross=false;this._dims=[];this._dnames=[];this._measures=[];this._countOnly=false;this._counts=null;this._prev=null;this._inputs=null;this._outputs=null}Zf.Definition={type:"Aggregate",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:fs},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"drop",type:"boolean",default:true},{name:"cross",type:"boolean",default:false},{name:"key",type:"field"}]};var Qf=is(Zf,bl);Qf.transform=function(e,t){var n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();n.stamp=r.stamp;if(n.value&&(i||t.modified(n._inputs,true))){n._prev=n.value;n.value=i?n.init(e):{};t.visit(t.SOURCE,(function(e){return n.add(e)}))}else{n.value=n.value||n.init(e);t.visit(t.REM,(function(e){return n.rem(e)}));t.visit(t.ADD,(function(e){return n.add(e)}))}r.modifies(n._outputs);n._drop=e.drop!==false;if(e.cross&&n._dims.length>1){n._drop=false;n.cross()}return n.changes(r)};Qf.cross=function(){var e=this,t=e.value,n=e._dnames,r=n.map((function(){return{}})),i=n.length;function a(e){var t,a,o,u;for(t in e){o=e[t].tuple;for(a=0;a<i;++a){r[a][u=o[n[a]]]=u}}}a(e._prev);a(t);function o(a,u,s){var l=n[s],f=r[s++],c,h;for(c in f){u[l]=f[c];h=a?a+"|"+c:c;if(s<i)o(h,u,s);else if(!t[h])e.cell(h,u)}}o("",{},0)};Qf.init=function(e){var t=this._inputs=[],n=this._outputs=[],r={};function i(e){var n=Yu(Fu(e)),i=0,a=n.length,o;for(;i<a;++i){if(!r[o=n[i]]){r[o]=1;t.push(o)}}}this._dims=Yu(e.groupby);this._dnames=this._dims.map((function(e){var t=Cu(e);i(e);n.push(t);return t}));this.cellkey=e.key?e.key:Su(this._dims);this._countOnly=true;this._counts=[];this._measures=[];var a=e.fields||[null],o=e.ops||["count"],u=e.as||[],s=a.length,l={},f,c,h,d,p,v;if(s!==o.length){Tu("Unmatched number of fields and aggregate ops.")}for(v=0;v<s;++v){f=a[v];c=o[v];if(f==null&&c!=="count"){Tu("Null aggregate field specified.")}d=Cu(f);p=ss(c,d,u[v]);n.push(p);if(c==="count"){this._counts.push(p);continue}h=l[d];if(!h){i(f);h=l[d]=[];h.field=f;this._measures.push(h)}if(c!=="count")this._countOnly=false;h.push(cs(c,p))}this._measures=this._measures.map((function(e){return vs(e,e.field)}));return{}};Qf.cellkey=Su();Qf.cell=function(e,t){var n=this.value[e];if(!n){n=this.value[e]=this.newcell(e,t);this._adds[this._alen++]=n}else if(n.num===0&&this._drop&&n.stamp<this.stamp){n.stamp=this.stamp;this._adds[this._alen++]=n}else if(n.stamp<this.stamp){n.stamp=this.stamp;this._mods[this._mlen++]=n}return n};Qf.newcell=function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:false};if(!this._countOnly){var r=this._measures,i=r.length,a;n.agg=Array(i);for(a=0;a<i;++a){n.agg[a]=new r[a](n)}}if(n.store){n.data=new Xf}return n};Qf.newtuple=function(e,t){var n=this._dnames,r=this._dims,i={},a,o;for(a=0,o=r.length;a<o;++a){i[n[a]]=r[a](e)}return t?qs(t.tuple,i):Is(i)};Qf.add=function(e){var t=this.cellkey(e),n=this.cell(t,e),r,i,a;n.num+=1;if(this._countOnly)return;if(n.store)n.data.add(e);r=n.agg;for(i=0,a=r.length;i<a;++i){r[i].add(r[i].get(e),e)}};Qf.rem=function(e){var t=this.cellkey(e),n=this.cell(t,e),r,i,a;n.num-=1;if(this._countOnly)return;if(n.store)n.data.rem(e);r=n.agg;for(i=0,a=r.length;i<a;++i){r[i].rem(r[i].get(e),e)}};Qf.celltuple=function(e){var t=e.tuple,n=this._counts,r,i,a;if(e.store){e.data.values()}for(i=0,a=n.length;i<a;++i){t[n[i]]=e.num}if(!this._countOnly){r=e.agg;for(i=0,a=r.length;i<a;++i){r[i].set(t)}}return t};Qf.changes=function(e){var t=this._adds,n=this._mods,r=this._prev,i=this._drop,a=e.add,o=e.rem,u=e.mod,s,l,f,c;if(r)for(l in r){s=r[l];if(!i||s.num)o.push(s.tuple)}for(f=0,c=this._alen;f<c;++f){a.push(this.celltuple(t[f]));t[f]=null}for(f=0,c=this._mlen;f<c;++f){s=n[f];(s.num===0&&i?o:u).push(this.celltuple(s));n[f]=null}this._alen=this._mlen=0;this._prev=null;return e};var Kf=1e-14;function ec(e){bl.call(this,null,e)}ec.Definition={type:"Bin",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"interval",type:"boolean",default:true},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:true,default:[5,2]},{name:"extent",type:"number",array:true,length:2,required:true},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:true},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:true},{name:"name",type:"string"},{name:"as",type:"string",array:true,length:2,default:["bin0","bin1"]}]};var tc=is(ec,bl);tc.transform=function(e,t){var n=e.interval!==false,r=this._bins(e),i=r.start,a=r.step,o=e.as||["bin0","bin1"],u=o[0],s=o[1],l;if(e.modified()){t=t.reflow(true);l=t.SOURCE}else{l=t.modified(Fu(e.field))?t.ADD_MOD:t.ADD}t.visit(l,n?function(e){var t=r(e);e[u]=t;e[s]=t==null?null:i+a*(1+(t-i)/a)}:function(e){e[u]=r(e)});return t.modifies(n?o:u)};tc._bins=function(e){if(this.value&&!e.modified()){return this.value}var t=e.field,n=Ql(e),r=n.step,i=n.start,a=i+Math.ceil((n.stop-i)/r)*r,o,u;if((o=e.anchor)!=null){u=o-(i+r*Math.floor((o-i)/r));i+=u;a+=u}var s=function(e){var n=t(e);return n==null?null:n<i?-Infinity:n>a?+Infinity:(n=Math.max(i,Math.min(+n,a-r)),i+r*Math.floor(Kf+(n-i)/r))};s.start=i;s.stop=n.stop;s.step=r;return this.value=Du(s,Fu(t),e.name||"bin_"+Cu(t))};function nc(e,t,n){var r=e,i=t||[],a=n||[],o={},u=0;return{add:function(e){a.push(e)},remove:function(e){o[r(e)]=++u},size:function(){return i.length},data:function(e,t){if(u){i=i.filter((function(e){return!o[r(e)]}));o={};u=0}if(t&&e){i.sort(e)}if(a.length){i=e?os(e,i,a.sort(e)):i.concat(a);a=[]}return i}}}function rc(e){bl.call(this,[],e)}rc.Definition={type:"Collect",metadata:{source:true},params:[{name:"sort",type:"compare"}]};var ic=is(rc,bl);ic.transform=function(e,t){var n=t.fork(t.ALL),r=nc(Ps,this.value,n.materialize(n.ADD).add),i=e.sort,a=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));n.visit(n.REM,r.remove);this.modified(a);this.value=n.source=r.data(Ws(i),a);if(t.source&&t.source.root){this.value.root=t.source.root}return n};function ac(e){Qs.call(this,null,oc,e)}is(ac,Qs);function oc(e){return this.value&&!e.modified()?this.value:Xu(e.fields,e.orders)}function uc(e){bl.call(this,null,e)}uc.Definition={type:"CountPattern",metadata:{generates:true,changes:true},params:[{name:"field",type:"field",required:true},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:true,length:2,default:["text","count"]}]};function sc(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}var lc=is(uc,bl);lc.transform=function(e,t){function n(t){return function(n){var r=sc(u(n),e.case,a)||[],i;for(var s=0,l=r.length;s<l;++s){if(!o.test(i=r[s]))t(i)}}}var r=this._parameterCheck(e,t),i=this._counts,a=this._match,o=this._stop,u=e.field,s=e.as||["text","count"],l=n((function(e){i[e]=1+(i[e]||0)})),f=n((function(e){i[e]-=1}));if(r){t.visit(t.SOURCE,l)}else{t.visit(t.ADD,l);t.visit(t.REM,f)}return this._finish(t,s)};lc._parameterCheck=function(e,t){var n=false;if(e.modified("stopwords")||!this._stop){this._stop=new RegExp("^"+(e.stopwords||"")+"$","i");n=true}if(e.modified("pattern")||!this._match){this._match=new RegExp(e.pattern||"[\\w']+","g");n=true}if(e.modified("field")||t.modified(e.field.fields)){n=true}if(n)this._counts={};return n};lc._finish=function(e,t){var n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],a=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS),u,s,l;for(u in n){s=r[u];l=n[u]||0;if(!s&&l){r[u]=s=Is({});s[i]=u;s[a]=l;o.add.push(s)}else if(l===0){if(s)o.rem.push(s);n[u]=null;r[u]=null}else if(s[a]!==l){s[a]=l;o.mod.push(s)}}return o.modifies(t)};function fc(e){bl.call(this,null,e)}fc.Definition={type:"Cross",metadata:{generates:true},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:true,length:2,default:["a","b"]}]};var cc=is(fc,bl);cc.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=this.value,i=e.as||["a","b"],a=i[0],o=i[1],u=!r||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");if(u){if(r)n.rem=r;r=t.materialize(t.SOURCE).source;n.add=this.value=hc(r,a,o,e.filter||Hu)}else{n.mod=r}n.source=this.value;return n.modifies(i)};function hc(e,t,n,r){var i=[],a={},o=e.length,u=0,s,l;for(;u<o;++u){a[t]=l=e[u];for(s=0;s<o;++s){a[n]=e[s];if(r(a)){i.push(Is(a));a={};a[t]=l}}}return i}var dc={kde:gf,mixture:wf,normal:vf,lognormal:xf,uniform:Of};var pc="distributions",vc="function",gc="field";function mc(e,t){var n=e[vc];if(!ts(dc,n)){Tu("Unknown distribution function: "+n)}var r=dc[n]();for(var i in e){if(i===gc){r.data((e.from||t()).map(e[i]))}else if(i===pc){r[i](e[i].map((function(e){return mc(e,t)})))}else if(typeof r[i]===vc){r[i](e[i])}}return r}function yc(e){bl.call(this,null,e)}var bc=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:true},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];var _c={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:true,params:bc},{name:"weights",type:"number",array:true}]};yc.Definition={type:"Density",metadata:{generates:true},params:[{name:"extent",type:"number",array:true,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:bc.concat(_c)},{name:"as",type:"string",array:true,default:["value","density"]}]};var xc=is(yc,bl);xc.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=mc(e.distribution,wc(t)),i=e.steps||e.minsteps||25,a=e.steps||e.maxsteps||200,o=e.method||"pdf";if(o!=="pdf"&&o!=="cdf"){Tu("Invalid density method: "+o)}if(!e.extent&&!r.data){Tu("Missing density extent parameter.")}o=r[o];var u=e.as||["value","density"],s=e.extent||Qu(r.data()),l=Yf(o,s,i,a).map((function(e){var t={};t[u[0]]=e[0];t[u[1]]=e[1];return Is(t)}));if(this.value)n.rem=this.value;this.value=n.add=n.source=l}return n};function wc(e){return function(){return e.materialize(e.SOURCE).source}}function kc(e,t){if(!e)return null;return e.map((function(e,n){return t[n]||Cu(e)}))}function Ac(e,t,n){var r=[],i=function(e){return e(s)},a,o,u,s,l,f;if(t==null){r.push(e.map(n))}else{for(a={},o=0,u=e.length;o<u;++o){s=e[o];l=t.map(i);f=a[l];if(!f){a[l]=f=[];f.dims=l;r.push(f)}f.push(n(s))}}return r}var Ec="bin";function Mc(e){bl.call(this,null,e)}Mc.Definition={type:"DotBin",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:false},{name:"as",type:"string",default:Ec}]};var Oc=is(Mc,bl);Oc.transform=function(e,t){if(this.value&&!(e.modified()||t.changed())){return t}var n=t.materialize(t.SOURCE).source,r=Ac(t.source,e.groupby,Uu),i=e.smooth||false,a=e.field,o=e.step||Sc(n,a),u=Ws((function(e,t){return a(e)-a(t)})),s=e.as||Ec,l=r.length;var f=Infinity,c=-Infinity,h=0,d;for(;h<l;++h){var p=r[h].sort(u);d=-1;for(var v=0,g=nf(p,o,i,a);v<g.length;v++){var m=g[v];if(m<f)f=m;if(m>c)c=m;p[++d][s]=m}}this.value={start:f,stop:c,step:o};return t.reflow(true).modifies(s)};function Sc(e,t){return us(Qu(e,t))/30}function Dc(e){Qs.call(this,null,Cc,e);this.modified(true)}is(Dc,Qs);function Cc(e){var t=e.expr;return this.value&&!e.modified("expr")?this.value:Du((function(n){return t(n,e)}),Fu(t),Cu(t))}function Fc(e){bl.call(this,[undefined,undefined],e)}Fc.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:true}]};var Tc=is(Fc,bl);Tc.transform=function(e,t){var n=this.value,r=e.field,i=n[0],a=n[1],o;o=t.changed()||t.modified(r.fields)||e.modified("field");if(o||i==null){i=+Infinity;a=-Infinity}t.visit(o?t.SOURCE:t.ADD,(function(e){var t=r(e);if(t!=null){t=+t;if(t<i)i=t;if(t>a)a=t}}));if(!Number.isFinite(i)||!Number.isFinite(a)){var u=Cu(r);if(u)u=' for field "'+u+'"';t.dataflow.warn("Infinite extent"+u+": ["+i+", "+a+"]");i=a=undefined}this.value=[i,a]};function Nc(e,t){Qs.call(this,e);this.parent=t}var jc=is(Nc,Qs);jc.connect=function(e){this.targets().add(e);return e.source=this};jc.add=function(e){this.value.add.push(e)};jc.rem=function(e){this.value.rem.push(e)};jc.mod=function(e){this.value.mod.push(e)};jc.init=function(e){this.value.init(e,e.NO_SOURCE)};jc.evaluate=function(){return this.value};function Rc(e){bl.call(this,{},e);this._keys=rs();var t=this._targets=[];t.active=0;t.forEach=function(e){for(var n=0,r=t.active;n<r;++n)e(t[n],n,t)}}var zc=is(Rc,bl);zc.activate=function(e){this._targets[this._targets.active++]=e};zc.subflow=function(e,t,n,r){var i=this.value,a=ts(i,e)&&i[e],o,u;if(!a){u=r||(u=this._group[e])&&u.tuple;o=n.dataflow;a=o.add(new Nc(n.fork(n.NO_SOURCE),this)).connect(t(o,e,u));i[e]=a;this.activate(a)}else if(a.value.stamp<n.stamp){a.init(n);this.activate(a)}return a};zc.transform=function(e,t){var n=t.dataflow,r=this,i=e.key,a=e.subflow,o=this._keys,u=e.modified("key");function s(e){return r.subflow(e,a,t)}this._group=e.group||{};this._targets.active=0;t.visit(t.REM,(function(e){var t=Ps(e),n=o.get(t);if(n!==undefined){o.delete(t);s(n).rem(e)}}));t.visit(t.ADD,(function(e){var t=i(e);o.set(Ps(e),t);s(t).add(e)}));if(u||t.modified(i.fields)){t.visit(t.MOD,(function(e){var t=Ps(e),n=o.get(t),r=i(e);if(n===r){s(r).mod(e)}else{o.set(t,r);s(n).rem(e);s(r).add(e)}}))}else if(t.changed(t.MOD)){t.visit(t.MOD,(function(e){s(o.get(Ps(e))).mod(e)}))}if(u){t.visit(t.REFLOW,(function(e){var t=Ps(e),n=o.get(t),r=i(e);if(n!==r){o.set(t,r);s(n).rem(e);s(r).add(e)}}))}if(o.empty>n.cleanThreshold)n.runAfter(o.clean);return t};function Pc(e){Qs.call(this,null,Lc,e)}is(Pc,Qs);function Lc(e){return this.value&&!e.modified()?this.value:ju(e.name)?Yu(e.name).map((function(e){return Lu(e)})):Lu(e.name,e.as)}function Ic(e){bl.call(this,rs(),e)}Ic.Definition={type:"Filter",metadata:{changes:true},params:[{name:"expr",type:"expr",required:true}]};var Bc=is(Ic,bl);Bc.transform=function(e,t){var n=t.dataflow,r=this.value,i=t.fork(),a=i.add,o=i.rem,u=i.mod,s=e.expr,l=true;t.visit(t.REM,(function(e){var t=Ps(e);if(!r.has(t))o.push(e);else r.delete(t)}));t.visit(t.ADD,(function(t){if(s(t,e))a.push(t);else r.set(Ps(t),1)}));function f(t){var n=Ps(t),i=s(t,e),f=r.get(n);if(i&&f){r.delete(n);a.push(t)}else if(!i&&!f){r.set(n,1);o.push(t)}else if(l&&i&&!f){u.push(t)}}t.visit(t.MOD,f);if(e.modified()){l=false;t.visit(t.REFLOW,f)}if(r.empty>n.cleanThreshold)n.runAfter(r.clean);return i};function Uc(e){bl.call(this,[],e)}Uc.Definition={type:"Flatten",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"index",type:"string"},{name:"as",type:"string",array:true}]};var qc=is(Uc,bl);qc.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,i=kc(r,e.as||[]),a=e.index||null,o=i.length;n.rem=this.value;t.visit(t.SOURCE,(function(e){var t=r.map((function(t){return t(e)})),u=t.reduce((function(e,t){return Math.max(e,t.length)}),0),s=0,l,f,c;for(;s<u;++s){f=Bs(e);for(l=0;l<o;++l){f[i[l]]=(c=t[l][s])==null?null:c}if(a){f[a]=s}n.add.push(f)}}));this.value=n.source=n.add;if(a)n.modifies(a);return n.modifies(i)};function Wc(e){bl.call(this,[],e)}Wc.Definition={type:"Fold",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true,length:2,default:["key","value"]}]};var Hc=is(Wc,bl);Hc.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(Cu),a=e.as||["key","value"],o=a[0],u=a[1],s=r.length;n.rem=this.value;t.visit(t.SOURCE,(function(e){for(var t=0,a;t<s;++t){a=Bs(e);a[o]=i[t];a[u]=r[t](e);n.add.push(a)}}));this.value=n.source=n.add;return n.modifies(a)};function Gc(e){bl.call(this,null,e)}Gc.Definition={type:"Formula",metadata:{modifies:true},params:[{name:"expr",type:"expr",required:true},{name:"as",type:"string",required:true},{name:"initonly",type:"boolean"}]};var $c=is(Gc,bl);$c.transform=function(e,t){var n=e.expr,r=e.as,i=e.modified(),a=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;if(i){t=t.materialize().reflow(true)}if(!e.initonly){t.modifies(r)}return t.visit(a,(function(t){return t[r]=n(t,e)}))};function Yc(e){bl.call(this,[],e)}var Vc=is(Yc,bl);Vc.transform=function(e,t){var n=this.value,r=t.fork(t.ALL),i=e.size-n.length,a=e.generator,o,u,s;if(i>0){for(o=[];--i>=0;){o.push(s=Is(a(e)));n.push(s)}r.add=r.add.length?r.materialize(r.ADD).add.concat(o):o}else{u=n.slice(0,-i);r.rem=r.rem.length?r.materialize(r.REM).rem.concat(u):u;n=n.slice(-i)}r.source=this.value=n;return r};var Xc={value:"value",median:$l,mean:Gl,min:Ll,max:Pl};var Jc=[];function Zc(e){bl.call(this,[],e)}Zc.Definition={type:"Impute",metadata:{changes:true},params:[{name:"field",type:"field",required:true},{name:"key",type:"field",required:true},{name:"keyvals",array:true},{name:"groupby",type:"field",array:true},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};var Qc=is(Zc,bl);function Kc(e){var t=e.method||Xc.value,n;if(Xc[t]==null){Tu("Unrecognized imputation method: "+t)}else if(t===Xc.value){n=e.value!==undefined?e.value:0;return function(){return n}}else{return Xc[t]}}function eh(e){var t=e.field;return function(e){return e?t(e):NaN}}Qc.transform=function(e,t){var n=t.fork(t.ALL),r=Kc(e),i=eh(e),a=Cu(e.field),o=Cu(e.key),u=(e.groupby||[]).map(Cu),s=th(t.source,e.groupby,e.key,e.keyvals),l=[],f=this.value,c=s.domain.length,h,d,p,v,g,m,y,b,_,x;for(g=0,b=s.length;g<b;++g){h=s[g];p=h.values;d=NaN;for(y=0;y<c;++y){if(h[y]!=null)continue;v=s.domain[y];x={_impute:true};for(m=0,_=p.length;m<_;++m)x[u[m]]=p[m];x[o]=v;x[a]=Number.isNaN(d)?d=r(h,i):d;l.push(Is(x))}}if(l.length)n.add=n.materialize(n.ADD).add.concat(l);if(f.length)n.rem=n.materialize(n.REM).rem.concat(f);this.value=l;return n};function th(e,t,n,r){var i=function(e){return e(g)},a=[],o=r?r.slice():[],u={},s={},l,f,c,h,d,p,v,g;o.forEach((function(e,t){u[e]=t+1}));for(h=0,v=e.length;h<v;++h){g=e[h];p=n(g);d=u[p]||(u[p]=o.push(p));f=(l=t?t.map(i):Jc)+"";if(!(c=s[f])){c=s[f]=[];a.push(c);c.values=l}c[d-1]=g}a.domain=o;return a}function nh(e){Zf.call(this,e)}nh.Definition={type:"JoinAggregate",metadata:{modifies:true},params:[{name:"groupby",type:"field",array:true},{name:"fields",type:"field",null:true,array:true},{name:"ops",type:"enum",array:true,values:fs},{name:"as",type:"string",null:true,array:true},{name:"key",type:"field"}]};var rh=is(nh,Zf);rh.transform=function(e,t){var n=this,r=e.modified(),i;if(n.value&&(r||t.modified(n._inputs,true))){i=n.value=r?n.init(e):{};t.visit(t.SOURCE,(function(e){n.add(e)}))}else{i=n.value=n.value||this.init(e);t.visit(t.REM,(function(e){n.rem(e)}));t.visit(t.ADD,(function(e){n.add(e)}))}n.changes();t.visit(t.SOURCE,(function(e){Zu(e,i[n.cellkey(e)].tuple)}));return t.reflow(r).modifies(this._outputs)};rh.changes=function(){var e=this._adds,t=this._mods,n,r;for(n=0,r=this._alen;n<r;++n){this.celltuple(e[n]);e[n]=null}for(n=0,r=this._mlen;n<r;++n){this.celltuple(t[n]);t[n]=null}this._alen=this._mlen=0};function ih(e){bl.call(this,null,e)}ih.Definition={type:"KDE",metadata:{generates:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"cumulative",type:"boolean",default:false},{name:"counts",type:"boolean",default:false},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:true,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:true,default:["value","density"]}]};var ah=is(ih,bl);ah.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,i=Ac(r,e.groupby,e.field),a=(e.groupby||[]).map(Cu),o=e.bandwidth,u=e.cumulative?"cdf":"pdf",s=e.as||["value","density"],l=[];var f=e.extent,c=e.steps||e.minsteps||25,h=e.steps||e.maxsteps||200;if(u!=="pdf"&&u!=="cdf"){Tu("Invalid density method: "+u)}if(e.resolve==="shared"){if(!f)f=Qu(r,e.field);c=h=e.steps||h}i.forEach((function(t){var n=gf(t,o)[u],r=e.counts?t.length:1,i=f||Qu(t);Yf(n,i,c,h).forEach((function(e){var n={};for(var i=0;i<a.length;++i){n[a[i]]=t.dims[i]}n[s[0]]=e[0];n[s[1]]=e[1]*r;l.push(Is(n))}))}));if(this.value)n.rem=this.value;this.value=n.add=n.source=l}return n};function oh(e){Qs.call(this,null,uh,e)}is(oh,Qs);function uh(e){return this.value&&!e.modified()?this.value:as(e.fields,e.flat)}function sh(e){bl.call(this,[],e);this._pending=null}var lh=is(sh,bl);lh.transform=function(e,t){var n=this;var r=t.dataflow;if(this._pending){return ch(this,t,this._pending)}if(fh(e))return t.StopPropagation;if(e.values){return ch(this,t,r.parse(e.values,e.format))}else if(e.async){var i=r.request(e.url,e.format).then((function(e){n._pending=Yu(e.data);return function(e){return e.touch(n)}}));return{async:i}}else{return r.request(e.url,e.format).then((function(e){return ch(n,t,Yu(e.data))}))}};function fh(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function ch(e,t,n){n.forEach(Is);var r=t.fork(t.NO_FIELDS&t.NO_SOURCE);r.rem=e.value;e.value=r.source=r.add=n;e._pending=null;return r}function hh(e){bl.call(this,{},e)}hh.Definition={type:"Lookup",metadata:{modifies:true},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:true},{name:"key",type:"field",required:true}]},{name:"values",type:"field",array:true},{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true},{name:"default",default:null}]};var dh=is(hh,bl);dh.transform=function(e,t){var n=t,r=e.as,i=e.fields,a=e.index,o=e.values,u=e.default==null?null:e.default,s=e.modified(),l=s?t.SOURCE:t.ADD,f=i.length,c,h,d;if(o){h=o.length;if(f>1&&!r){Tu('Multi-field lookup requires explicit "as" parameter.')}if(r&&r.length!==f*h){Tu('The "as" parameter has too few output field names.')}r=r||o.map(Cu);c=function(e){for(var t=0,n=0,s,l;t<f;++t){l=a.get(i[t](e));if(l==null)for(s=0;s<h;++s,++n)e[r[n]]=u;else for(s=0;s<h;++s,++n)e[r[n]]=o[s](l)}}}else{if(!r){Tu("Missing output field names.")}c=function(e){for(var t=0,n;t<f;++t){n=a.get(i[t](e));e[r[t]]=n==null?u:n}}}if(s){n=t.reflow(true)}else{d=i.some((function(e){return t.modified(e.fields)}));l|=d?t.MOD:0}t.visit(l,c);return n.modifies(r)};function ph(e){Qs.call(this,null,vh,e)}is(ph,Qs);function vh(e){if(this.value&&!e.modified()){return this.value}var t=+Infinity,n=-Infinity,r=e.extents,i,a,o;for(i=0,a=r.length;i<a;++i){o=r[i];if(o[0]<t)t=o[0];if(o[1]>n)n=o[1]}return[t,n]}function gh(e){Qs.call(this,null,mh,e)}is(gh,Qs);function mh(e){return this.value&&!e.modified()?this.value:e.values.reduce((function(e,t){return e.concat(t)}),[])}function yh(e){bl.call(this,null,e)}is(yh,bl);yh.prototype.transform=function(e,t){this.modified(e.modified());this.value=e;return t.fork(t.NO_SOURCE|t.NO_FIELDS)};function bh(e){Zf.call(this,e)}bh.Definition={type:"Pivot",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"value",type:"field",required:true},{name:"op",type:"enum",values:fs,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};var _h=is(bh,Zf);_h._transform=_h.transform;_h.transform=function(e,t){return this._transform(xh(e,t),t)};function xh(e,t){var n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",a=Fu(n).concat(Fu(r)),o=kh(n,e.limit||0,t);if(t.changed())e.set("__pivot__",null,null,true);return{key:e.key,groupby:e.groupby,ops:o.map((function(){return i})),fields:o.map((function(e){return wh(e,n,r,a)})),as:o.map((function(e){return e+""})),modified:e.modified.bind(e)}}function wh(e,t,n,r){return Du((function(r){return t(r)===e?n(r):NaN}),r,e+"")}function kh(e,t,n){var r={},i=[];n.visit(n.SOURCE,(function(t){var n=e(t);if(!r[n]){r[n]=1;i.push(n)}}));i.sort((function(e,t){return(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0}));return t?i.slice(0,t):i}function Ah(e){Rc.call(this,e)}var Eh=is(Ah,Rc);Eh.transform=function(e,t){var n=this,r=e.subflow,i=e.field;if(e.modified("field")||i&&t.modified(Fu(i))){Tu("PreFacet does not support field modification.")}this._targets.active=0;t.visit(t.MOD,(function(e){var a=n.subflow(Ps(e),r,t,e);i?i(e).forEach((function(e){a.mod(e)})):a.mod(e)}));t.visit(t.ADD,(function(e){var a=n.subflow(Ps(e),r,t,e);i?i(e).forEach((function(e){a.add(Is(e))})):a.add(e)}));t.visit(t.REM,(function(e){var a=n.subflow(Ps(e),r,t,e);i?i(e).forEach((function(e){a.rem(e)})):a.rem(e)}));return t};function Mh(e){bl.call(this,null,e)}Mh.Definition={type:"Project",metadata:{generates:true,changes:true},params:[{name:"fields",type:"field",array:true},{name:"as",type:"string",null:true,array:true}]};var Oh=is(Mh,bl);Oh.transform=function(e,t){var n=e.fields,r=kc(e.fields,e.as||[]),i=n?function(e,t){return Sh(e,t,n,r)}:Us,a,o;if(this.value){o=this.value}else{t=t.addAll();o=this.value={}}a=t.fork(t.NO_SOURCE);t.visit(t.REM,(function(e){var t=Ps(e);a.rem.push(o[t]);o[t]=null}));t.visit(t.ADD,(function(e){var t=i(e,Is({}));o[Ps(e)]=t;a.add.push(t)}));t.visit(t.MOD,(function(e){a.mod.push(i(e,o[Ps(e)]))}));return a};function Sh(e,t,n,r){for(var i=0,a=n.length;i<a;++i){t[r[i]]=n[i](e)}return t}function Dh(e){bl.call(this,null,e)}var Ch=is(Dh,bl);Ch.transform=function(e,t){this.value=e.value;return e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};function Fh(e){bl.call(this,null,e)}Fh.Definition={type:"Quantile",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"probs",type:"number",array:true},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:true,default:["prob","value"]}]};var Th=is(Fh,bl);var Nh=1e-14;Th.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed()){n.source=this.value;return n}var i=t.materialize(t.SOURCE).source,a=Ac(i,e.groupby,e.field),o=(e.groupby||[]).map(Cu),u=[],s=e.step||.01,l=e.probs||Cl(s/2,1-Nh,s),f=l.length;a.forEach((function(e){var t=Xl(e,l);for(var n=0;n<f;++n){var i={};for(var a=0;a<o.length;++a){i[o[a]]=e.dims[a]}i[r[0]]=l[n];i[r[1]]=t[n];u.push(Is(i))}}));if(this.value)n.rem=this.value;this.value=n.add=n.source=u;return n};function jh(e){bl.call(this,null,e)}var Rh=is(jh,bl);Rh.transform=function(e,t){var n,r;if(this.value){r=this.value}else{n=t=t.addAll();r=this.value={}}if(e.derive){n=t.fork(t.NO_SOURCE);t.visit(t.REM,(function(e){var t=Ps(e);n.rem.push(r[t]);r[t]=null}));t.visit(t.ADD,(function(e){var t=Bs(e);r[Ps(e)]=t;n.add.push(t)}));t.visit(t.MOD,(function(e){var t=r[Ps(e)],i;for(i in e){t[i]=e[i];n.modifies(i)}n.mod.push(t)}))}return n};function zh(e){bl.call(this,[],e);this.count=0}zh.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};var Ph=is(zh,bl);Ph.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,a=this.value,o=this.count,u=0,s=a.reduce((function(e,t){e[Ps(t)]=1;return e}),{});function l(e){var t,r;if(a.length<i){a.push(e)}else{r=~~((o+1)*Kl());if(r<a.length&&r>=u){t=a[r];if(s[Ps(t)])n.rem.push(t);a[r]=e}}++o}if(t.rem.length){t.visit(t.REM,(function(e){var t=Ps(e);if(s[t]){s[t]=-1;n.rem.push(e)}--o}));a=a.filter((function(e){return s[Ps(e)]!==-1}))}if((t.rem.length||r)&&a.length<i&&t.source){u=o=a.length;t.visit(t.SOURCE,(function(e){if(!s[Ps(e)])l(e)}));u=-1}if(r&&a.length>i){for(var f=0,c=a.length-i;f<c;++f){s[Ps(a[f])]=-1;n.rem.push(a[f])}a=a.slice(c)}if(t.mod.length){t.visit(t.MOD,(function(e){if(s[Ps(e)])n.mod.push(e)}))}if(t.add.length){t.visit(t.ADD,l)}if(t.add.length||u<0){n.add=a.filter((function(e){return!s[Ps(e)]}))}this.count=o;this.value=n.source=a;return n};function Lh(e){bl.call(this,null,e)}Lh.Definition={type:"Sequence",metadata:{generates:true,changes:true},params:[{name:"start",type:"number",required:true},{name:"stop",type:"number",required:true},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};var Ih=is(Lh,bl);Ih.transform=function(e,t){if(this.value&&!e.modified())return;var n=t.materialize().fork(t.MOD),r=e.as||"data";n.rem=this.value?t.rem.concat(this.value):t.rem;this.value=Cl(e.start,e.stop,e.step||1).map((function(e){var t={};t[r]=e;return Is(t)}));n.add=t.add.concat(this.value);return n};function Bh(e){bl.call(this,null,e);this.modified(true)}var Uh=is(Bh,bl);Uh.transform=function(e,t){this.value=t.source;return t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};var qh="year";var Wh="quarter";var Hh="month";var Gh="week";var $h="date";var Yh="day";var Vh="hours";var Xh="minutes";var Jh="seconds";var Zh="milliseconds";var Qh=[qh,Wh,Hh,Gh,$h,Yh,Vh,Xh,Jh,Zh].reduce((function(e,t,n){return e[t]=1+n,e}),{});function Kh(e){var t=Kn(e).slice(),n={};if(!t.length)jn("Missing time unit.");t.forEach((function(e){if(ar(Qh,e)){n[e]=1}else{jn("Invalid time unit: "+e+".")}}));if((n[Gh]||n[Yh])&&(n[Wh]||n[Hh]||n[$h])){jn("Incompatible time units: "+e)}t.sort((function(e,t){return Qh[e]-Qh[t]}));return t}var ed=new Date;function td(e,t,n,r){var i=t||1,a=Zn(e),o=function(e,t,r){return nd(n[r||e],e===a&&i,t)};var u=new Date,s=mr(e),l=s[qh]?o(qh):nr(2012),f=s[Hh]?o(Hh):s[Wh]?o(Wh):Hn,c=s[Gh]&&s[Yh]?o(Yh,1,Gh+Yh):s[Gh]?o(Gh,1):s[Yh]?o(Yh,1):s[$h]?o($h,1):Gn,h=s[Vh]?o(Vh):Hn,d=s[Xh]?o(Xh):Hn,p=s[Jh]?o(Jh):Hn,v=s[Zh]?o(Zh):Hn;return function(e){u.setTime(+e);var t=l(u);return r(t,f(u),c(u,t),h(u),d(u),p(u),v(u))}}function nd(e,t,n){return t<=1?e:n?function(r,i){return n+t*Math.floor((e(r,i)-n)/t)}:function(n,r){return t*Math.floor(e(n,r)/t)}}function rd(e,t,n){return t+e*7-(n+6)%7}var id=(i={},i[qh]=function(e){return e.getFullYear()},i[Wh]=function(e){return 3*~~(e.getMonth()/3)},i[Hh]=function(e){return e.getMonth()},i[$h]=function(e){return e.getDate()},i[Vh]=function(e){return e.getHours()},i[Xh]=function(e){return e.getMinutes()},i[Jh]=function(e){return e.getSeconds()},i[Zh]=function(e){return e.getMilliseconds()},i[Yh]=function(e,t){return rd(1,e.getDay(),ud(t))},i[Gh]=function(e,t){return rd(od(e),0,ud(t))},i[Gh+Yh]=function(e,t){return rd(od(e),e.getDay(),ud(t))},i);function ad(e){ed.setFullYear(e);ed.setMonth(0);ed.setDate(1);ed.setHours(0,0,0,0);return ed}function od(e){return Ri.count(ad(e.getFullYear())-1,e)}function ud(e){return ad(e).getDay()}function sd(e,t,n,r,i,a,o){if(0<=e&&e<100){var u=new Date(-1,t,n,r,i,a,o);u.setFullYear(e);return u}return new Date(e,t,n,r,i,a,o)}function ld(e,t){return td(e,t||1,id,sd)}var fd=(a={},a[qh]=function(e){return e.getUTCFullYear()},a[Wh]=function(e){return 3*~~(e.getUTCMonth()/3)},a[Hh]=function(e){return e.getUTCMonth()},a[$h]=function(e){return e.getUTCDate()},a[Vh]=function(e){return e.getUTCHours()},a[Xh]=function(e){return e.getUTCMinutes()},a[Jh]=function(e){return e.getUTCSeconds()},a[Zh]=function(e){return e.getUTCMilliseconds()},a[Yh]=function(e,t){return rd(1,e.getUTCDay(),hd(t))},a[Gh]=function(e,t){return rd(cd(e),0,hd(t))},a[Gh+Yh]=function(e,t){return rd(cd(e),e.getUTCDay(),hd(t))},a);function cd(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return Vi.count(t-1,e)}function hd(e){ed.setTime(Date.UTC(e,0,1));return ed.getUTCDay()}function dd(e,t,n,r,i,a,o){if(0<=e&&e<100){var u=new Date(Date.UTC(-1,t,n,r,i,a,o));u.setUTCFullYear(n.y);return u}return new Date(Date.UTC(e,t,n,r,i,a,o))}function pd(e,t){return td(e,t||1,fd,dd)}var vd=(o={},o[qh]=Wi,o[Wh]=qi.every(3),o[Hh]=qi,o[Gh]=Ri,o[$h]=Ni,o[Yh]=Ni,o[Vh]=Ti,o[Xh]=Fi,o[Jh]=Ci,o[Zh]=Ai,o);var gd=(u={},u[qh]=na,u[Wh]=ta.every(3),u[Hh]=ta,u[Gh]=Vi,u[$h]=$i,u[Yh]=$i,u[Vh]=Gi,u[Xh]=Hi,u[Jh]=Ci,u[Zh]=Ai,u);function md(e){return vd[e]}function yd(e){return gd[e]}function bd(e,t,n){return e?e.offset(t,n):undefined}function _d(e,t,n){return bd(md(e),t,n)}function xd(e,t,n){return bd(yd(e),t,n)}function wd(e,t,n,r){return e?e.range(t,n,r):undefined}function kd(e,t,n,r){return wd(md(e),t,n,r)}function Ad(e,t,n,r){return wd(yd(e),t,n,r)}var Ed=(s={},s[qh]="%Y ",s[Wh]="Q%q ",s[Hh]="%b ",s[$h]="%d ",s[Gh]="W%U ",s[Yh]="%a ",s[Vh]="%H:00",s[Xh]="00:%M",s[Jh]=":%S",s[Zh]=".%L",s[qh+"-"+Hh]="%Y-%m ",s[qh+"-"+Hh+"-"+$h]="%Y-%m-%d ",s[Vh+"-"+Xh]="%H:%M",s);function Md(e,t){var n=rr({},Ed,t),r=Kh(e),i=r.length;var a="",o=0,u,s;for(o=0;o<i;){for(u=r.length;u>o;--u){s=r.slice(o,u).join("-");if(n[s]!=null){a+=n[s];o=u;break}}}return a.trim()}function Od(e){return Dd(_o,md,e)}function Sd(e){return Dd(wo,yd,e)}function Dd(e,t,n){return Ln(n)?e(n):Cd(e,t,n)}function Cd(e,t,n){n=n||{};if(!Pn(n)){jn("Invalid time multi-format specifier: "+n)}var r=t(Jh),i=t(Xh),a=t(Vh),o=t($h),u=t(Gh),s=t(Hh),l=t(Wh),f=t(qh),c=e(n[Zh]||".%L"),h=e(n[Jh]||":%S"),d=e(n[Xh]||"%I:%M"),p=e(n[Vh]||"%I %p"),v=e(n[$h]||n[Yh]||"%a %d"),g=e(n[Gh]||"%b %d"),m=e(n[Hh]||"%B"),y=e(n[Wh]||"%B"),b=e(n[qh]||"%Y");return function(e){return(r(e)<e?c:i(e)<e?h:a(e)<e?d:o(e)<e?p:s(e)<e?u(e)<e?v:g:f(e)<e?l(e)<e?m:y:b)(e)}}var Fd=1e3,Td=Fd*60,Nd=Td*60,jd=Nd*24,Rd=jd*7,zd=jd*30,Pd=jd*365;var Ld=[qh,Hh,$h,Vh,Xh,Jh,Zh],Id=Ld.slice(0,-1),Bd=Id.slice(0,-1),Ud=Bd.slice(0,-1),qd=Ud.slice(0,-1),Wd=[qh,Gh],Hd=[qh,Hh],Gd=[qh];var $d=[[Id,1,Fd],[Id,5,5*Fd],[Id,15,15*Fd],[Id,30,30*Fd],[Bd,1,Td],[Bd,5,5*Td],[Bd,15,15*Td],[Bd,30,30*Td],[Ud,1,Nd],[Ud,3,3*Nd],[Ud,6,6*Nd],[Ud,12,12*Nd],[qd,1,jd],[Wd,1,Rd],[Hd,1,zd],[Hd,3,3*zd],[Gd,1,Pd]];function Yd(e){var t=e.extent,n=e.maxbins||40,r=Math.abs(hr(t))/n;var i=kl((function(e){return e[2]})).right($d,r),a,o;if(i===$d.length){a=Gd,o=zl(t[0]/Pd,t[1]/Pd,n)}else if(i){i=$d[r/$d[i-1][2]<$d[i][2]/r?i-1:i];a=i[0];o=i[1]}else{a=Ld;o=Math.max(zl(t[0],t[1],n),1)}return{units:a,step:o}}function Vd(e){bl.call(this,null,e)}var Xd=["unit0","unit1"];Vd.Definition={type:"TimeUnit",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"interval",type:"boolean",default:true},{name:"units",type:"string",array:true},{name:"step",type:"number",default:1},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:true,length:2,default:Xd}]};var Jd=is(Vd,bl);Jd.transform=function(e,t){var n=e.field,r=e.interval!==false,i=e.timezone==="utc",a=this._floor(e,t),o=(i?yd:md)(a.unit).offset,u=e.as||Xd,s=u[0],l=u[1],f=a.start||Infinity,c=a.stop||-Infinity,h=a.step,d=t.ADD;if(e.modified()||t.modified(Fu(e.field))){t=t.reflow(true);d=t.SOURCE;f=Infinity;c=-Infinity}t.visit(d,(function(e){var t=n(e),i,u;if(t==null){e[s]=null;if(r)e[l]=null}else{e[s]=i=u=a(t);if(r)e[l]=u=o(i,h);if(i<f)f=i;if(u>c)c=u}}));a.start=f;a.stop=c;return t.modifies(r?u:s)};Jd._floor=function(e,t){var n=e.timezone==="utc";var r=e.units?{units:e.units,step:e.step||1}:Yd({extent:Qu(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),i=r.units,a=r.step;i=Kh(i);var o=this.value||{},u=(n?pd:ld)(i,a);u.unit=$u(i);u.units=i;u.step=a;u.start=o.start;u.stop=o.stop;return this.value=u};function Zd(e){bl.call(this,rs(),e)}var Qd=is(Zd,bl);Qd.transform=function(e,t){var n=t.dataflow,r=e.field,i=this.value,a=true;function o(e){i.set(r(e),e)}if(e.modified("field")||t.modified(r.fields)){i.clear();t.visit(t.SOURCE,o)}else if(t.changed()){t.visit(t.REM,(function(e){i.delete(r(e))}));t.visit(t.ADD,o)}else{a=false}this.modified(a);if(i.empty>n.cleanThreshold)n.runAfter(i.clean);return t.fork()};function Kd(e){bl.call(this,null,e)}var ep=is(Kd,bl);ep.transform=function(e,t){var n=!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields);if(n){this.value=(e.sort?t.source.slice().sort(Ws(e.sort)):t.source).map(e.field)}};function tp(e,t,n,r){var i=np[e](t,n);return{init:i.init||qu,update:function(e,t){t[r]=i.next(e)}}}var np={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){var e=np.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){return e=0},next:function(t){var n=t.index,r=t.data,i=t.compare;if(e<n){while(n+1<r.length&&!i(r[n],r[n+1]))++n;e=n}return(1+e)/r.length}}},ntile:function(e,t){t=+t;if(!(t>0))Tu("ntile num must be greater than zero.");var n=np.cume_dist(),r=n.next;return{init:n.init,next:function(e){return Math.ceil(t*r(e))}}},lag:function(e,t){t=+t||1;return{next:function(n){var r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){t=+t||1;return{next:function(n){var r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){t=+t;if(!(t>0))Tu("nth_value nth must be greater than zero.");return{next:function(n){var r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){var t=null;return{next:function(n){var r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){var t=null,n=-1;return{next:function(r){var i=r.data;return r.index<=n?t:(n=rp(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function rp(e,t,n){for(var r=t.length;n<r;++n){var i=e(t[n]);if(i!=null)return n}return-1}var ip=Object.keys(np);function ap(e){var t=this,n=Yu(e.ops),r=Yu(e.fields),i=Yu(e.params),a=Yu(e.as),o=t.outputs=[],u=t.windows=[],s={},l={},f=true,c=[],h=[];function d(e){Yu(Fu(e)).forEach((function(e){return s[e]=1}))}d(e.sort);n.forEach((function(e,t){var n=r[t],s=Cu(n),p=ss(e,s,a[t]);d(n);o.push(p);if(ts(np,e)){u.push(tp(e,r[t],i[t],p))}else{if(n==null&&e!=="count"){Tu("Null aggregate field specified.")}if(e==="count"){c.push(p);return}f=false;var v=l[s];if(!v){v=l[s]=[];v.field=n;h.push(v)}v.push(cs(e,p))}}));if(c.length||h.length){t.cell=up(h,c,f)}t.inputs=Object.keys(s)}var op=ap.prototype;op.init=function(){this.windows.forEach((function(e){return e.init()}));if(this.cell)this.cell.init()};op.update=function(e,t){var n=this,r=n.cell,i=n.windows,a=e.data,o=i&&i.length,u;if(r){for(u=e.p0;u<e.i0;++u)r.rem(a[u]);for(u=e.p1;u<e.i1;++u)r.add(a[u]);r.set(t)}for(u=0;u<o;++u)i[u].update(e,t)};function up(e,t,n){e=e.map((function(e){return vs(e,e.field)}));var r={num:0,agg:null,store:false,count:t};if(!n){var i=e.length,a=r.agg=Array(i),o=0;for(;o<i;++o)a[o]=new e[o](r)}if(r.store){var u=r.data=new Xf}r.add=function(e){r.num+=1;if(n)return;if(u)u.add(e);for(var t=0;t<i;++t){a[t].add(a[t].get(e),e)}};r.rem=function(e){r.num-=1;if(n)return;if(u)u.rem(e);for(var t=0;t<i;++t){a[t].rem(a[t].get(e),e)}};r.set=function(e){var i,o;if(u)u.values();for(i=0,o=t.length;i<o;++i)e[t[i]]=r.num;if(!n)for(i=0,o=a.length;i<o;++i)a[i].set(e)};r.init=function(){r.num=0;if(u)u.reset();for(var e=0;e<i;++e)a[e].init()};return r}function sp(e){bl.call(this,{},e);this._mlen=0;this._mods=[]}sp.Definition={type:"Window",metadata:{modifies:true},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:ip.concat(fs)},{name:"params",type:"number",null:true,array:true},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"frame",type:"number",null:true,array:true,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:false}]};var lp=is(sp,bl);lp.transform=function(e,t){var n=this,r=n.state,i=e.modified(),a=Ws(e.sort),o,u;this.stamp=t.stamp;if(!r||i){r=n.state=new ap(e)}var s=Su(e.groupby);function l(e){return n.group(s(e))}if(i||t.modified(r.inputs)){n.value={};t.visit(t.SOURCE,(function(e){l(e).add(e)}))}else{t.visit(t.REM,(function(e){l(e).remove(e)}));t.visit(t.ADD,(function(e){l(e).add(e)}))}for(o=0,u=n._mlen;o<u;++o){fp(n._mods[o],r,a,e)}n._mlen=0;n._mods=[];return t.reflow(i).modifies(r.outputs)};lp.group=function(e){var t=this,n=t.value[e];if(!n){n=t.value[e]=nc(Ps);n.stamp=-1}if(n.stamp<t.stamp){n.stamp=t.stamp;t._mods[t._mlen++]=n}return n};function fp(e,t,n,r){var i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],u=e.data(n),s=u.length,l=0,f=a?kl(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:u,compare:i||Ju(-1)};for(t.init();l<s;++l){cp(c,o,l,s);if(a)hp(c,f);t.update(c,u[l])}}function cp(e,t,n,r){e.p0=e.i0;e.p1=e.i1;e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0]));e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1);e.index=n}function hp(e,t){var n=e.i0,r=e.i1-1,i=e.compare,a=e.data,o=a.length-1;if(n>0&&!i(a[n],a[n-1]))e.i0=t.left(a,a[n]);if(r<o&&!i(a[r],a[r+1]))e.i1=t.right(a,a[r])}var dp=Object.freeze({__proto__:null,aggregate:Zf,bin:ec,collect:rc,compare:ac,countpattern:uc,cross:fc,density:yc,dotbin:Mc,expression:Dc,extent:Fc,facet:Rc,field:Pc,filter:Ic,flatten:Uc,fold:Wc,formula:Gc,generate:Yc,impute:Zc,joinaggregate:nh,kde:ih,key:oh,load:sh,lookup:hh,multiextent:ph,multivalues:gh,params:yh,pivot:bh,prefacet:Ah,project:Mh,proxy:Dh,quantile:Fh,relay:jh,sample:zh,sequence:Lh,sieve:Bh,subflow:Nc,timeunit:Vd,tupleindex:Zd,values:Kd,window:sp});var pp="top";var vp="left";var gp="right";var mp="bottom";var yp="top-left";var bp="top-right";var _p="bottom-left";var xp="bottom-right";var wp="start";var kp="middle";var Ap="end";var Ep="x";var Mp="y";var Op="group";var Sp="axis";var Dp="title";var Cp="frame";var Fp="scope";var Tp="legend";var Np="row-header";var jp="row-footer";var Rp="row-title";var zp="column-header";var Pp="column-footer";var Lp="column-title";var Ip="padding";var Bp="symbol";var Up="fit";var qp="fit-x";var Wp="fit-y";var Hp="pad";var Gp="none";var $p="all";var Yp="each";var Vp="flush";var Xp="column";var Jp="row";function Zp(e){var t=e||Wn,n=[],r={};n.add=function(e){var i=t(e);if(!r[i]){r[i]=1;n.push(e)}return n};n.remove=function(e){var i=t(e),a;if(r[i]){r[i]=0;if((a=n.indexOf(e))>=0){n.splice(a,1)}}return n};return n}var Qp=Symbol("vega_id"),Kp=1;function ev(e){return!!(e&&tv(e))}function tv(e){return e[Qp]}function nv(e,t){e[Qp]=t;return e}function rv(e){var t=e===Object(e)?e:{data:e};return tv(t)?t:nv(t,Kp++)}function iv(e,t){for(var n in e)t[n]=e[n];return t}function av(e,t){return nv(t,tv(e))}function ov(e,t){return!e?null:t?function(n,r){return e(n,r)||tv(t(n))-tv(t(r))}:function(t,n){return e(t,n)||tv(t)-tv(n)}}var uv="_:mod:_";function sv(){Object.defineProperty(this,uv,{writable:true,value:{}})}var lv=sv.prototype;lv.set=function(e,t,n,r){var i=this,a=i[e],o=i[uv];if(t!=null&&t>=0){if(a[t]!==n||r){a[t]=n;o[t+":"+e]=-1;o[e]=-1}}else if(a!==n||r){i[e]=n;o[e]=zn(n)?1+n.length:-1}return i};lv.modified=function(e,t){var n=this[uv],r;if(!arguments.length){for(r in n){if(n[r])return true}return false}else if(zn(e)){for(r=0;r<e.length;++r){if(n[e[r]])return true}return false}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]};lv.clear=function(){this[uv]={};return this};var fv=0;var cv="pulse";var hv=new sv;var dv=1,pv=2;function vv(e,t,n,r){this.id=++fv;this.value=e;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(t){this._update=t}if(n)this.parameters(n,r)}var gv=vv.prototype;gv.targets=function(){return this._targets||(this._targets=Zp(qn))};gv.set=function(e){if(this.value!==e){this.value=e;return 1}else{return 0}};function mv(e){return function(t){var n=this.flags;if(arguments.length===0)return!!(n&e);this.flags=t?n|e:n&~e;return this}}gv.skip=mv(dv);gv.modified=mv(pv);gv.parameters=function(e,t,n){t=t!==false;var r=this,i=r._argval=r._argval||new sv,a=r._argops=r._argops||[],o=[],u,s,l,f;function c(e,n,u){if(u instanceof vv){if(u!==r){if(t)u.targets().add(r);o.push(u)}a.push({op:u,name:e,index:n})}else{i.set(e,n,u)}}for(u in e){s=e[u];if(u===cv){Kn(s).forEach((function(e){if(!(e instanceof vv)){jn("Pulse parameters must be operator instances.")}else if(e!==r){e.targets().add(r);o.push(e)}}));r.source=s}else if(zn(s)){i.set(u,-1,Array(l=s.length));for(f=0;f<l;++f)c(u,f,s[f])}else{c(u,-1,s)}}this.marshall().clear();if(n)a.initonly=true;return o};gv.marshall=function(e){var t=this._argval||hv,n=this._argops,r,i,a,o,u;if(n){for(i=0,a=n.length;i<a;++i){r=n[i];o=r.op;u=o.modified()&&o.stamp===e;t.set(r.name,r.index,o.value,u)}if(n.initonly){for(i=0;i<a;++i){r=n[i];r.op.targets().remove(this)}this._argops=null;this._update=null}}return t};gv.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);n.clear();if(r!==this.value){this.value=r}else if(!this.modified()){return e.StopPropagation}}};gv.run=function(e){if(e.stamp<this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false);t=0}else{t=this.evaluate(e)}return this.pulse=t||e};var yv={};var bv=1<<0,_v=1<<1,xv=1<<2,wv=bv|_v,kv=bv|xv,Av=bv|_v|xv,Ev=1<<3,Mv=1<<4,Ov=1<<5,Sv=1<<6;function Dv(e,t,n){this.dataflow=e;this.stamp=t==null?-1:t;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}var Cv=Dv.prototype;Cv.StopPropagation=yv;Cv.ADD=bv;Cv.REM=_v;Cv.MOD=xv;Cv.ADD_REM=wv;Cv.ADD_MOD=kv;Cv.ALL=Av;Cv.REFLOW=Ev;Cv.SOURCE=Mv;Cv.NO_SOURCE=Ov;Cv.NO_FIELDS=Sv;Cv.fork=function(e){return new Dv(this.dataflow).init(this,e)};Cv.clone=function(){var e=this.fork(Av);e.add=e.add.slice();e.rem=e.rem.slice();e.mod=e.mod.slice();if(e.source)e.source=e.source.slice();return e.materialize(Av|Mv)};Cv.addAll=function(){var e=this;if(!this.source||this.source.length===this.add.length){return e}else{e=new Dv(this.dataflow).init(this);e.add=e.source;return e}};Cv.init=function(e,t){var n=this;n.stamp=e.stamp;n.encode=e.encode;if(e.fields&&!(t&Sv)){n.fields=e.fields}if(t&bv){n.addF=e.addF;n.add=e.add}else{n.addF=null;n.add=[]}if(t&_v){n.remF=e.remF;n.rem=e.rem}else{n.remF=null;n.rem=[]}if(t&xv){n.modF=e.modF;n.mod=e.mod}else{n.modF=null;n.mod=[]}if(t&Ov){n.srcF=null;n.source=null}else{n.srcF=e.srcF;n.source=e.source}return n};Cv.runAfter=function(e){this.dataflow.runAfter(e)};Cv.changed=function(e){var t=e||Av;return t&bv&&this.add.length||t&_v&&this.rem.length||t&xv&&this.mod.length};Cv.reflow=function(e){if(e)return this.fork(Av).reflow();var t=this.add.length,n=this.source&&this.source.length;if(n&&n!==t){this.mod=this.source;if(t)this.filter(xv,Nv(this,bv))}return this};Cv.modifies=function(e){var t=this.fields||(this.fields={});if(zn(e)){e.forEach((function(e){return t[e]=true}))}else{t[e]=true}return this};Cv.modified=function(e,t){var n=this.fields;return!((t||this.mod.length)&&n)?false:!arguments.length?!!n:zn(e)?e.some((function(e){return n[e]})):n[e]};Cv.filter=function(e,t){var n=this;if(e&bv)n.addF=Fv(n.addF,t);if(e&_v)n.remF=Fv(n.remF,t);if(e&xv)n.modF=Fv(n.modF,t);if(e&Mv)n.srcF=Fv(n.srcF,t);return n};function Fv(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}Cv.materialize=function(e){e=e||Av;var t=this;if(e&bv&&t.addF){t.add=Tv(t.add,t.addF);t.addF=null}if(e&_v&&t.remF){t.rem=Tv(t.rem,t.remF);t.remF=null}if(e&xv&&t.modF){t.mod=Tv(t.mod,t.modF);t.modF=null}if(e&Mv&&t.srcF){t.source=t.source.filter(t.srcF);t.srcF=null}return t};function Tv(e,t){var n=[];yr(e,t,(function(e){n.push(e)}));return n}function Nv(e,t){var n={};e.visit(t,(function(e){n[tv(e)]=1}));return function(e){return n[tv(e)]?null:e}}Cv.visit=function(e,t){var n=this,r=t,i,a;if(e&Mv){yr(n.source,n.srcF,r);return n}if(e&bv)yr(n.add,n.addF,r);if(e&_v)yr(n.rem,n.remF,r);if(e&xv)yr(n.mod,n.modF,r);if(e&Ev&&(i=n.source)){a=n.add.length+n.mod.length;if(a===i.length);else if(a){yr(i,Nv(n,kv),r)}else{yr(i,n.srcF,r)}}return n};function jv(e,t,n,r){var i=this,a=0,o,u,s,l,f;this.dataflow=e;this.stamp=t;this.fields=null;this.encode=r||null;this.pulses=n;for(s=0,l=n.length;s<l;++s){o=n[s];if(o.stamp!==t)continue;if(o.fields){u=i.fields||(i.fields={});for(f in o.fields){u[f]=1}}if(o.changed(i.ADD))a|=i.ADD;if(o.changed(i.REM))a|=i.REM;if(o.changed(i.MOD))a|=i.MOD}this.changes=a}var Rv=or(jv,Dv);Rv.fork=function(e){var t=new Dv(this.dataflow).init(this,e&this.NO_FIELDS);if(e!==undefined){if(e&t.ADD){this.visit(t.ADD,(function(e){return t.add.push(e)}))}if(e&t.REM){this.visit(t.REM,(function(e){return t.rem.push(e)}))}if(e&t.MOD){this.visit(t.MOD,(function(e){return t.mod.push(e)}))}}return t};Rv.changed=function(e){return this.changes&e};Rv.modified=function(e){var t=this,n=t.fields;return!(n&&t.changes&t.MOD)?0:zn(e)?e.some((function(e){return n[e]})):n[e]};Rv.filter=function(){jn("MultiPulse does not support filtering.")};Rv.materialize=function(){jn("MultiPulse does not support materialization.")};Rv.visit=function(e,t){var n=this,r=n.pulses,i=r.length,a=0;if(e&n.SOURCE){for(;a<i;++a){r[a].visit(e,t)}}else{for(;a<i;++a){if(r[a].stamp===n.stamp){r[a].visit(e,t)}}}return n};function zv(e,t){vv.call(this,e,null,t)}var Pv=or(zv,vv);Pv.run=function(e){var t=this;if(e.stamp<this.stamp)return e.StopPropagation;var n;if(this.skip()){this.skip(false)}else{n=this.evaluate(e)}n=n||e;if(n.then){n=n.then((function(e){return t.pulse=e}))}else if(n!==e.StopPropagation){this.pulse=n}return n};Pv.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);t.clear();return n};Pv.transform=function(){};function Lv(e){this.clear();if(e)this.union(e)}var Iv=Lv.prototype;Iv.clone=function(){return new Lv(this)};Iv.clear=function(){this.x1=+Number.MAX_VALUE;this.y1=+Number.MAX_VALUE;this.x2=-Number.MAX_VALUE;this.y2=-Number.MAX_VALUE;return this};Iv.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE};Iv.equals=function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2};Iv.set=function(e,t,n,r){if(n<e){this.x2=e;this.x1=n}else{this.x1=e;this.x2=n}if(r<t){this.y2=t;this.y1=r}else{this.y1=t;this.y2=r}return this};Iv.add=function(e,t){if(e<this.x1)this.x1=e;if(t<this.y1)this.y1=t;if(e>this.x2)this.x2=e;if(t>this.y2)this.y2=t;return this};Iv.expand=function(e){this.x1-=e;this.y1-=e;this.x2+=e;this.y2+=e;return this};Iv.round=function(){this.x1=Math.floor(this.x1);this.y1=Math.floor(this.y1);this.x2=Math.ceil(this.x2);this.y2=Math.ceil(this.y2);return this};Iv.translate=function(e,t){this.x1+=e;this.x2+=e;this.y1+=t;this.y2+=t;return this};Iv.rotate=function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])};Iv.rotatedPoints=function(e,t,n){var r=this,i=r.x1,a=r.y1,o=r.x2,u=r.y2,s=Math.cos(e),l=Math.sin(e),f=t-t*s+n*l,c=n-t*l-n*s;return[s*i-l*a+f,l*i+s*a+c,s*i-l*u+f,l*i+s*u+c,s*o-l*a+f,l*o+s*a+c,s*o-l*u+f,l*o+s*u+c]};Iv.union=function(e){if(e.x1<this.x1)this.x1=e.x1;if(e.y1<this.y1)this.y1=e.y1;if(e.x2>this.x2)this.x2=e.x2;if(e.y2>this.y2)this.y2=e.y2;return this};Iv.intersect=function(e){if(e.x1>this.x1)this.x1=e.x1;if(e.y1>this.y1)this.y1=e.y1;if(e.x2<this.x2)this.x2=e.x2;if(e.y2<this.y2)this.y2=e.y2;return this};Iv.encloses=function(e){return e&&(this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2)};Iv.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)};Iv.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)};Iv.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)};Iv.width=function(){return this.x2-this.x1};Iv.height=function(){return this.y2-this.y1};var Bv=0;var Uv="p_";function qv(e){return e&&e.gradient}function Wv(e,t,n){var r=e.id,i=e.gradient,a=i==="radial"?Uv:"";if(!r){r=e.id="gradient_"+Bv++;if(i==="radial"){e.x1=Hv(e.x1,.5);e.y1=Hv(e.y1,.5);e.r1=Hv(e.r1,0);e.x2=Hv(e.x2,.5);e.y2=Hv(e.y2,.5);e.r2=Hv(e.r2,.5);a=Uv}else{e.x1=Hv(e.x1,0);e.y1=Hv(e.y1,0);e.x2=Hv(e.x2,1);e.y2=Hv(e.y2,0)}}t[r]=e;return"url("+(n||"")+"#"+a+r+")"}function Hv(e,t){return e!=null?e:t}function Gv(e){this.mark=e;this.bounds=this.bounds||new Lv}function $v(e){Gv.call(this,e);this.items=this.items||[]}or($v,Gv);function Yv(e,t){if(typeof document!=="undefined"&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext){n.width=e;n.height=t;return n}}return null}function Vv(){return typeof Image!=="undefined"?Image:null}function Xv(e){this._pending=0;this._loader=e||Oo()}var Jv=Xv.prototype;Jv.pending=function(){return this._pending};function Zv(e){e._pending+=1}function Qv(e){e._pending-=1}Jv.sanitizeURL=function(e){var t=this;Zv(t);return t._loader.sanitize(e,{context:"href"}).then((function(e){Qv(t);return e})).catch((function(){Qv(t);return null}))};Jv.loadImage=function(e){var t=this,n=Vv();Zv(t);return t._loader.sanitize(e,{context:"image"}).then((function(e){var r=e.href;if(!r||!n)throw{url:r};var i=new n;i.onload=function(){Qv(t)};i.onerror=function(){Qv(t)};i.src=r;return i})).catch((function(e){Qv(t);return{complete:false,width:0,height:0,src:e&&e.url||""}}))};Jv.ready=function(){var e=this;return new Promise((function(t){function n(r){if(!e.pending())t(r);else setTimeout((function(){n(true)}),10)}n(false)}))};var Kv=Math.PI,eg=2*Kv,tg=1e-6,ng=eg-tg;function rg(){this._x0=this._y0=this._x1=this._y1=null;this._=""}function ig(){return new rg}rg.prototype=ig.prototype={constructor:rg,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,u=n-e,s=r-t,l=a-e,f=o-t,c=l*l+f*f;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null){this._+="M"+(this._x1=e)+","+(this._y1=t)}else if(!(c>tg));else if(!(Math.abs(f*u-s*l)>tg)||!i){this._+="L"+(this._x1=e)+","+(this._y1=t)}else{var h=n-a,d=r-o,p=u*u+s*s,v=h*h+d*d,g=Math.sqrt(p),m=Math.sqrt(c),y=i*Math.tan((Kv-Math.acos((p+c-v)/(2*g*m)))/2),b=y/m,_=y/g;if(Math.abs(b-1)>tg){this._+="L"+(e+b*l)+","+(t+b*f)}this._+="A"+i+","+i+",0,0,"+ +(f*h>l*d)+","+(this._x1=e+_*u)+","+(this._y1=t+_*s)}},arc:function(e,t,n,r,i,a){e=+e,t=+t,n=+n,a=!!a;var o=n*Math.cos(r),u=n*Math.sin(r),s=e+o,l=t+u,f=1^a,c=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);if(this._x1===null){this._+="M"+s+","+l}else if(Math.abs(this._x1-s)>tg||Math.abs(this._y1-l)>tg){this._+="L"+s+","+l}if(!n)return;if(c<0)c=c%eg+eg;if(c>ng){this._+="A"+n+","+n+",0,1,"+f+","+(e-o)+","+(t-u)+"A"+n+","+n+",0,1,"+f+","+(this._x1=s)+","+(this._y1=l)}else if(c>tg){this._+="A"+n+","+n+",0,"+ +(c>=Kv)+","+f+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))}},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function ag(e){return function t(){return e}}var og=Math.abs;var ug=Math.atan2;var sg=Math.cos;var lg=Math.max;var fg=Math.min;var cg=Math.sin;var hg=Math.sqrt;var dg=1e-12;var pg=Math.PI;var vg=pg/2;var gg=2*pg;function mg(e){return e>1?0:e<-1?pg:Math.acos(e)}function yg(e){return e>=1?vg:e<=-1?-vg:Math.asin(e)}function bg(e){return e.innerRadius}function _g(e){return e.outerRadius}function xg(e){return e.startAngle}function wg(e){return e.endAngle}function kg(e){return e&&e.padAngle}function Ag(e,t,n,r,i,a,o,u){var s=n-e,l=r-t,f=o-i,c=u-a,h=c*s-f*l;if(h*h<dg)return;h=(f*(t-a)-c*(e-i))/h;return[e+h*s,t+h*l]}function Eg(e,t,n,r,i,a,o){var u=e-n,s=t-r,l=(o?a:-a)/hg(u*u+s*s),f=l*s,c=-l*u,h=e+f,d=t+c,p=n+f,v=r+c,g=(h+p)/2,m=(d+v)/2,y=p-h,b=v-d,_=y*y+b*b,x=i-a,w=h*v-p*d,k=(b<0?-1:1)*hg(lg(0,x*x*_-w*w)),A=(w*b-y*k)/_,E=(-w*y-b*k)/_,M=(w*b+y*k)/_,O=(-w*y+b*k)/_,S=A-g,D=E-m,C=M-g,F=O-m;if(S*S+D*D>C*C+F*F)A=M,E=O;return{cx:A,cy:E,x01:-f,y01:-c,x11:A*(i/x-1),y11:E*(i/x-1)}}function Mg(){var e=bg,t=_g,n=ag(0),r=null,i=xg,a=wg,o=kg,u=null;function s(){var s,l,f=+e.apply(this,arguments),c=+t.apply(this,arguments),h=i.apply(this,arguments)-vg,d=a.apply(this,arguments)-vg,p=og(d-h),v=d>h;if(!u)u=s=ig();if(c<f)l=c,c=f,f=l;if(!(c>dg))u.moveTo(0,0);else if(p>gg-dg){u.moveTo(c*sg(h),c*cg(h));u.arc(0,0,c,h,d,!v);if(f>dg){u.moveTo(f*sg(d),f*cg(d));u.arc(0,0,f,d,h,v)}}else{var g=h,m=d,y=h,b=d,_=p,x=p,w=o.apply(this,arguments)/2,k=w>dg&&(r?+r.apply(this,arguments):hg(f*f+c*c)),A=fg(og(c-f)/2,+n.apply(this,arguments)),E=A,M=A,O,S;if(k>dg){var D=yg(k/f*cg(w)),C=yg(k/c*cg(w));if((_-=D*2)>dg)D*=v?1:-1,y+=D,b-=D;else _=0,y=b=(h+d)/2;if((x-=C*2)>dg)C*=v?1:-1,g+=C,m-=C;else x=0,g=m=(h+d)/2}var F=c*sg(g),T=c*cg(g),N=f*sg(b),j=f*cg(b);if(A>dg){var R=c*sg(m),z=c*cg(m),P=f*sg(y),L=f*cg(y),I;if(p<pg&&(I=Ag(F,T,P,L,R,z,N,j))){var B=F-I[0],U=T-I[1],q=R-I[0],W=z-I[1],H=1/cg(mg((B*q+U*W)/(hg(B*B+U*U)*hg(q*q+W*W)))/2),G=hg(I[0]*I[0]+I[1]*I[1]);E=fg(A,(f-G)/(H-1));M=fg(A,(c-G)/(H+1))}}if(!(x>dg))u.moveTo(F,T);else if(M>dg){O=Eg(P,L,F,T,c,M,v);S=Eg(R,z,N,j,c,M,v);u.moveTo(O.cx+O.x01,O.cy+O.y01);if(M<A)u.arc(O.cx,O.cy,M,ug(O.y01,O.x01),ug(S.y01,S.x01),!v);else{u.arc(O.cx,O.cy,M,ug(O.y01,O.x01),ug(O.y11,O.x11),!v);u.arc(0,0,c,ug(O.cy+O.y11,O.cx+O.x11),ug(S.cy+S.y11,S.cx+S.x11),!v);u.arc(S.cx,S.cy,M,ug(S.y11,S.x11),ug(S.y01,S.x01),!v)}}else u.moveTo(F,T),u.arc(0,0,c,g,m,!v);if(!(f>dg)||!(_>dg))u.lineTo(N,j);else if(E>dg){O=Eg(N,j,R,z,f,-E,v);S=Eg(F,T,P,L,f,-E,v);u.lineTo(O.cx+O.x01,O.cy+O.y01);if(E<A)u.arc(O.cx,O.cy,E,ug(O.y01,O.x01),ug(S.y01,S.x01),!v);else{u.arc(O.cx,O.cy,E,ug(O.y01,O.x01),ug(O.y11,O.x11),!v);u.arc(0,0,f,ug(O.cy+O.y11,O.cx+O.x11),ug(S.cy+S.y11,S.cx+S.x11),v);u.arc(S.cx,S.cy,E,ug(S.y11,S.x11),ug(S.y01,S.x01),!v)}}else u.arc(0,0,f,b,y,v)}u.closePath();if(s)return u=null,s+""||null}s.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-pg/2;return[sg(r)*n,cg(r)*n]};s.innerRadius=function(t){return arguments.length?(e=typeof t==="function"?t:ag(+t),s):e};s.outerRadius=function(e){return arguments.length?(t=typeof e==="function"?e:ag(+e),s):t};s.cornerRadius=function(e){return arguments.length?(n=typeof e==="function"?e:ag(+e),s):n};s.padRadius=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:ag(+e),s):r};s.startAngle=function(e){return arguments.length?(i=typeof e==="function"?e:ag(+e),s):i};s.endAngle=function(e){return arguments.length?(a=typeof e==="function"?e:ag(+e),s):a};s.padAngle=function(e){return arguments.length?(o=typeof e==="function"?e:ag(+e),s):o};s.context=function(e){return arguments.length?(u=e==null?null:e,s):u};return s}function Og(e){this._context=e}Og.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Sg(e){return new Og(e)}function Dg(e){return e[0]}function Cg(e){return e[1]}function Fg(){var e=Dg,t=Cg,n=ag(true),r=null,i=Sg,a=null;function o(o){var u,s=o.length,l,f=false,c;if(r==null)a=i(c=ig());for(u=0;u<=s;++u){if(!(u<s&&n(l=o[u],u,o))===f){if(f=!f)a.lineStart();else a.lineEnd()}if(f)a.point(+e(l,u,o),+t(l,u,o))}if(c)return a=null,c+""||null}o.x=function(t){return arguments.length?(e=typeof t==="function"?t:ag(+t),o):e};o.y=function(e){return arguments.length?(t=typeof e==="function"?e:ag(+e),o):t};o.defined=function(e){return arguments.length?(n=typeof e==="function"?e:ag(!!e),o):n};o.curve=function(e){return arguments.length?(i=e,r!=null&&(a=i(r)),o):i};o.context=function(e){return arguments.length?(e==null?r=a=null:a=i(r=e),o):r};return o}function Tg(){var e=Dg,t=null,n=ag(0),r=Cg,i=ag(true),a=null,o=Sg,u=null;function s(s){var l,f,c,h=s.length,d,p=false,v,g=new Array(h),m=new Array(h);if(a==null)u=o(v=ig());for(l=0;l<=h;++l){if(!(l<h&&i(d=s[l],l,s))===p){if(p=!p){f=l;u.areaStart();u.lineStart()}else{u.lineEnd();u.lineStart();for(c=l-1;c>=f;--c){u.point(g[c],m[c])}u.lineEnd();u.areaEnd()}}if(p){g[l]=+e(d,l,s),m[l]=+n(d,l,s);u.point(t?+t(d,l,s):g[l],r?+r(d,l,s):m[l])}}if(v)return u=null,v+""||null}function l(){return Fg().defined(i).curve(o).context(a)}s.x=function(n){return arguments.length?(e=typeof n==="function"?n:ag(+n),t=null,s):e};s.x0=function(t){return arguments.length?(e=typeof t==="function"?t:ag(+t),s):e};s.x1=function(e){return arguments.length?(t=e==null?null:typeof e==="function"?e:ag(+e),s):t};s.y=function(e){return arguments.length?(n=typeof e==="function"?e:ag(+e),r=null,s):n};s.y0=function(e){return arguments.length?(n=typeof e==="function"?e:ag(+e),s):n};s.y1=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:ag(+e),s):r};s.lineX0=s.lineY0=function(){return l().x(e).y(n)};s.lineY1=function(){return l().x(e).y(r)};s.lineX1=function(){return l().x(t).y(n)};s.defined=function(e){return arguments.length?(i=typeof e==="function"?e:ag(!!e),s):i};s.curve=function(e){return arguments.length?(o=e,a!=null&&(u=o(a)),s):o};s.context=function(e){return arguments.length?(e==null?a=u=null:u=o(a=e),s):a};return s}var Ng={draw:function(e,t){var n=Math.sqrt(t/pg);e.moveTo(n,0);e.arc(0,0,n,0,gg)}};function jg(){var e=ag(Ng),t=ag(64),n=null;function r(){var r;if(!n)n=r=ig();e.apply(this,arguments).draw(n,+t.apply(this,arguments));if(r)return n=null,r+""||null}r.type=function(t){return arguments.length?(e=typeof t==="function"?t:ag(t),r):e};r.size=function(e){return arguments.length?(t=typeof e==="function"?e:ag(+e),r):t};r.context=function(e){return arguments.length?(n=e==null?null:e,r):n};return r}function Rg(){}function zg(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Pg(e){this._context=e}Pg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){switch(this._point){case 3:zg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:zg(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function Lg(e){return new Pg(e)}function Ig(e){this._context=e}Ig.prototype={areaStart:Rg,areaEnd:Rg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2);this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3);this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3);this._context.closePath();break}case 3:{this.point(this._x2,this._y2);this.point(this._x3,this._y3);this.point(this._x4,this._y4);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x2=e,this._y2=t;break;case 1:this._point=2;this._x3=e,this._y3=t;break;case 2:this._point=3;this._x4=e,this._y4=t;this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:zg(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function Bg(e){return new Ig(e)}function Ug(e){this._context=e}Ug.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:zg(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function qg(e){return new Ug(e)}function Wg(e,t){this._basis=new Pg(e);this._beta=t}Wg.prototype={lineStart:function(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0){var r=e[0],i=t[0],a=e[n]-r,o=t[n]-i,u=-1,s;while(++u<=n){s=u/n;this._basis.point(this._beta*e[u]+(1-this._beta)*(r+s*a),this._beta*t[u]+(1-this._beta)*(i+s*o))}}this._x=this._y=null;this._basis.lineEnd()},point:function(e,t){this._x.push(+e);this._y.push(+t)}};var Hg=function e(t){function n(e){return t===1?new Pg(e):new Wg(e,t)}n.beta=function(t){return e(+t)};return n}(.85);function Gg(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function $g(e,t){this._context=e;this._k=(1-t)/6}$g.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Gg(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;this._x1=e,this._y1=t;break;case 2:this._point=3;default:Gg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Yg=function e(t){function n(e){return new $g(e,t)}n.tension=function(t){return e(+t)};return n}(0);function Vg(e,t){this._context=e;this._k=(1-t)/6}Vg.prototype={areaStart:Rg,areaEnd:Rg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:Gg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Xg=function e(t){function n(e){return new Vg(e,t)}n.tension=function(t){return e(+t)};return n}(0);function Jg(e,t){this._context=e;this._k=(1-t)/6}Jg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Gg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Zg=function e(t){function n(e){return new Jg(e,t)}n.tension=function(t){return e(+t)};return n}(0);function Qg(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>dg){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,s=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/s;i=(i*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/s}if(e._l23_a>dg){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/f;o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/f}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function Kg(e,t){this._context=e;this._alpha=t}Kg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Qg(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var em=function e(t){function n(e){return t?new Kg(e,t):new $g(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function tm(e,t){this._context=e;this._alpha=t}tm.prototype={areaStart:Rg,areaEnd:Rg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:Qg(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var nm=function e(t){function n(e){return t?new tm(e,t):new Vg(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function rm(e,t){this._context=e;this._alpha=t}rm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Qg(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var im=function e(t){function n(e){return t?new rm(e,t):new Jg(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function am(e){this._context=e}am.prototype={areaStart:Rg,areaEnd:Rg,lineStart:function(){this._point=0},lineEnd:function(){if(this._point)this._context.closePath()},point:function(e,t){e=+e,t=+t;if(this._point)this._context.lineTo(e,t);else this._point=1,this._context.moveTo(e,t)}};function om(e){return new am(e)}function um(e){return e<0?-1:1}function sm(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),u=(a*i+o*r)/(r+i);return(um(a)+um(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function lm(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function fm(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,u=(a-r)/3;e._context.bezierCurveTo(r+u,i+u*t,a-u,o-u*n,a,o)}function cm(e){this._context=e}cm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:fm(this,this._t0,lm(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){var n=NaN;e=+e,t=+t;if(e===this._x1&&t===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;fm(this,lm(this,n=sm(this,e,t)),n);break;default:fm(this,this._t0,n=sm(this,e,t));break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t;this._t0=n}};function hm(e){this._context=new dm(e)}(hm.prototype=Object.create(cm.prototype)).point=function(e,t){cm.prototype.point.call(this,t,e)};function dm(e){this._context=e}dm.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function pm(e){return new cm(e)}function vm(e){return new hm(e)}function gm(e){this._context=e}gm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[];this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n){this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]);if(n===2){this._context.lineTo(e[1],t[1])}else{var r=mm(e),i=mm(t);for(var a=0,o=1;o<n;++a,++o){this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o])}}}if(this._line||this._line!==0&&n===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function(e,t){this._x.push(+e);this._y.push(+t)}};function mm(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);i[0]=0,a[0]=2,o[0]=e[0]+2*e[1];for(t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n];for(t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];i[n-1]=o[n-1]/a[n-1];for(t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];a[n-1]=(e[n]+i[n-1])/2;for(t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function ym(e){return new gm(e)}function bm(e,t){this._context=e;this._t=t}bm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN;this._point=0},lineEnd:function(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,t);this._context.lineTo(e,t)}else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y);this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function _m(e){return new bm(e,.5)}function xm(e){return new bm(e,0)}function wm(e){return new bm(e,1)}var km={basis:{curve:Lg},"basis-closed":{curve:Bg},"basis-open":{curve:qg},bundle:{curve:Hg,tension:"beta",value:.85},cardinal:{curve:Yg,tension:"tension",value:0},"cardinal-open":{curve:Zg,tension:"tension",value:0},"cardinal-closed":{curve:Xg,tension:"tension",value:0},"catmull-rom":{curve:em,tension:"alpha",value:.5},"catmull-rom-closed":{curve:nm,tension:"alpha",value:.5},"catmull-rom-open":{curve:im,tension:"alpha",value:.5},linear:{curve:Sg},"linear-closed":{curve:om},monotone:{horizontal:vm,vertical:pm},natural:{curve:ym},step:{curve:_m},"step-after":{curve:wm},"step-before":{curve:xm}};function Am(e,t,n){var r=ar(km,e)&&km[e],i=null;if(r){i=r.curve||r[t||"vertical"];if(r.tension&&n!=null){i=i[r.tension](n)}}return i}var Em={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Mm=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];function Om(e){var t=[],n,r,i,a,o,u,s,l,f,c,h;n=e.slice().replace(Mm[0],"###$1").split(Mm[1]).slice(1);for(l=0,c=n.length;l<c;++l){r=n[l];i=r.slice(1).trim().replace(Mm[2],"$1###$2").split(Mm[3]);u=r.charAt(0);a=[u];for(f=0,h=i.length;f<h;++f){if((o=+i[f])===o){a.push(o)}}s=Em[u.toLowerCase()];if(a.length-1>s){for(f=1,h=a.length;f<h;f+=s){t.push([u].concat(a.slice(f,f+s)))}}else{t.push(a)}}return t}var Sm=Math.PI/180;var Dm=Math.PI/2;var Cm=Math.PI*2;var Fm=Math.sqrt(3)/2;var Tm={};var Nm={};var jm=[].join;function Rm(e,t,n,r,i,a,o,u,s){var l=jm.call(arguments);if(Tm[l]){return Tm[l]}var f=o*Sm;var c=Math.sin(f);var h=Math.cos(f);n=Math.abs(n);r=Math.abs(r);var d=h*(u-e)*.5+c*(s-t)*.5;var p=h*(s-t)*.5-c*(u-e)*.5;var v=d*d/(n*n)+p*p/(r*r);if(v>1){v=Math.sqrt(v);n*=v;r*=v}var g=h/n;var m=c/n;var y=-c/r;var b=h/r;var _=g*u+m*s;var x=y*u+b*s;var w=g*e+m*t;var k=y*e+b*t;var A=(w-_)*(w-_)+(k-x)*(k-x);var E=1/A-.25;if(E<0)E=0;var M=Math.sqrt(E);if(a==i)M=-M;var O=.5*(_+w)-M*(k-x);var S=.5*(x+k)+M*(w-_);var D=Math.atan2(x-S,_-O);var C=Math.atan2(k-S,w-O);var F=C-D;if(F<0&&a===1){F+=Cm}else if(F>0&&a===0){F-=Cm}var T=Math.ceil(Math.abs(F/(Dm+.001)));var N=[];for(var j=0;j<T;++j){var R=D+j*F/T;var z=D+(j+1)*F/T;N[j]=[O,S,R,z,n,r,c,h]}return Tm[l]=N}function zm(e){var t=jm.call(e);if(Nm[t]){return Nm[t]}var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7];var f=l*o;var c=-s*u;var h=s*o;var d=l*u;var p=Math.cos(i);var v=Math.sin(i);var g=Math.cos(a);var m=Math.sin(a);var y=.5*(a-i);var b=Math.sin(y*.5);var _=8/3*b*b/Math.sin(y);var x=n+p-_*v;var w=r+v+_*p;var k=n+g;var A=r+m;var E=k+_*m;var M=A-_*g;return Nm[t]=[f*x+c*w,h*x+d*w,f*E+c*M,h*E+d*M,f*k+c*A,h*k+d*A]}var Pm=["l",0,0,0,0,0,0,0];function Lm(e,t,n){var r=Pm[0]=e[0];if(r==="a"||r==="A"){Pm[1]=t*e[1];Pm[2]=n*e[2];Pm[3]=e[3];Pm[4]=e[4];Pm[5]=e[5];Pm[6]=t*e[6];Pm[7]=n*e[7]}else if(r==="h"||r==="H"){Pm[1]=t*e[1]}else if(r==="v"||r==="V"){Pm[1]=n*e[1]}else{for(var i=1,a=e.length;i<a;++i){Pm[i]=(i%2==1?t:n)*e[i]}}return Pm}function Im(e,t,n,r,i,a){var o,u=null,s=0,l=0,f=0,c=0,h,d,p,v;if(n==null)n=0;if(r==null)r=0;if(i==null)i=1;if(a==null)a=i;if(e.beginPath)e.beginPath();for(var g=0,m=t.length;g<m;++g){o=t[g];if(i!==1||a!==1){o=Lm(o,i,a)}switch(o[0]){case"l":s+=o[1];l+=o[2];e.lineTo(s+n,l+r);break;case"L":s=o[1];l=o[2];e.lineTo(s+n,l+r);break;case"h":s+=o[1];e.lineTo(s+n,l+r);break;case"H":s=o[1];e.lineTo(s+n,l+r);break;case"v":l+=o[1];e.lineTo(s+n,l+r);break;case"V":l=o[1];e.lineTo(s+n,l+r);break;case"m":s+=o[1];l+=o[2];e.moveTo(s+n,l+r);break;case"M":s=o[1];l=o[2];e.moveTo(s+n,l+r);break;case"c":h=s+o[5];d=l+o[6];f=s+o[3];c=l+o[4];e.bezierCurveTo(s+o[1]+n,l+o[2]+r,f+n,c+r,h+n,d+r);s=h;l=d;break;case"C":s=o[5];l=o[6];f=o[3];c=o[4];e.bezierCurveTo(o[1]+n,o[2]+r,f+n,c+r,s+n,l+r);break;case"s":h=s+o[3];d=l+o[4];f=2*s-f;c=2*l-c;e.bezierCurveTo(f+n,c+r,s+o[1]+n,l+o[2]+r,h+n,d+r);f=s+o[1];c=l+o[2];s=h;l=d;break;case"S":h=o[3];d=o[4];f=2*s-f;c=2*l-c;e.bezierCurveTo(f+n,c+r,o[1]+n,o[2]+r,h+n,d+r);s=h;l=d;f=o[1];c=o[2];break;case"q":h=s+o[3];d=l+o[4];f=s+o[1];c=l+o[2];e.quadraticCurveTo(f+n,c+r,h+n,d+r);s=h;l=d;break;case"Q":h=o[3];d=o[4];e.quadraticCurveTo(o[1]+n,o[2]+r,h+n,d+r);s=h;l=d;f=o[1];c=o[2];break;case"t":h=s+o[1];d=l+o[2];if(u[0].match(/[QqTt]/)===null){f=s;c=l}else if(u[0]==="t"){f=2*s-p;c=2*l-v}else if(u[0]==="q"){f=2*s-f;c=2*l-c}p=f;v=c;e.quadraticCurveTo(f+n,c+r,h+n,d+r);s=h;l=d;f=s+o[1];c=l+o[2];break;case"T":h=o[1];d=o[2];f=2*s-f;c=2*l-c;e.quadraticCurveTo(f+n,c+r,h+n,d+r);s=h;l=d;break;case"a":Bm(e,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+s+n,o[7]+l+r]);s+=o[6];l+=o[7];break;case"A":Bm(e,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]);s=o[6];l=o[7];break;case"z":case"Z":e.closePath();break}u=o}}function Bm(e,t,n,r){var i=Rm(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(var a=0;a<i.length;++a){var o=zm(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var Um=.5773502691896257;var qm={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0);e.arc(0,0,n,0,Cm)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r);e.lineTo(-n,r);e.lineTo(-r,r);e.lineTo(-r,n);e.lineTo(r,n);e.lineTo(r,r);e.lineTo(n,r);e.lineTo(n,-r);e.lineTo(r,-r);e.lineTo(r,-n);e.lineTo(-r,-n);e.lineTo(-r,-r);e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0);e.lineTo(0,-n);e.lineTo(n,0);e.lineTo(0,n);e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,a=n/8;e.moveTo(-r,n);e.lineTo(r,n);e.lineTo(r,-a);e.lineTo(i,-a);e.lineTo(0,-n);e.lineTo(-i,-a);e.lineTo(-r,-a);e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fm*n,i=r-n*Um,a=n/4;e.moveTo(0,-r-i);e.lineTo(-a,r-i);e.lineTo(a,r-i);e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fm*n,i=r-n*Um;e.moveTo(0,-r-i);e.lineTo(-n,r-i);e.lineTo(n,r-i);e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fm*n;e.moveTo(0,-r);e.lineTo(-n,r);e.lineTo(n,r);e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fm*n;e.moveTo(0,r);e.lineTo(-n,-r);e.lineTo(n,-r);e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fm*n;e.moveTo(r,0);e.lineTo(-r,-n);e.lineTo(-r,n);e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Fm*n;e.moveTo(-r,0);e.lineTo(r,-n);e.lineTo(r,n);e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0);e.lineTo(n,0)}}};function Wm(e){return ar(qm,e)?qm[e]:Gm(e)}var Hm={};function Gm(e){if(!ar(Hm,e)){var t=Om(e);Hm[e]={draw:function(e,n){Im(e,t,0,0,Math.sqrt(n)/2)}}}return Hm[e]}var $m=.448084975506;function Ym(e){return e.x}function Vm(e){return e.y}function Xm(e){return e.width}function Jm(e){return e.height}function Zm(e){return typeof e==="function"?e:function(){return+e}}function Qm(e,t,n){return Math.max(t,Math.min(e,n))}function Km(){var e=Ym,t=Vm,n=Xm,r=Jm,i=Zm(0),a=i,o=i,u=i,s=null;function l(l,f,c){var h,d=f!=null?f:+e.call(this,l),p=c!=null?c:+t.call(this,l),v=+n.call(this,l),g=+r.call(this,l),m=Math.min(v,g)/2,y=Qm(+i.call(this,l),0,m),b=Qm(+a.call(this,l),0,m),_=Qm(+o.call(this,l),0,m),x=Qm(+u.call(this,l),0,m);if(!s)s=h=ig();if(y<=0&&b<=0&&_<=0&&x<=0){s.rect(d,p,v,g)}else{var w=d+v,k=p+g;s.moveTo(d+y,p);s.lineTo(w-b,p);s.bezierCurveTo(w-$m*b,p,w,p+$m*b,w,p+b);s.lineTo(w,k-x);s.bezierCurveTo(w,k-$m*x,w-$m*x,k,w-x,k);s.lineTo(d+_,k);s.bezierCurveTo(d+$m*_,k,d,k-$m*_,d,k-_);s.lineTo(d,p+y);s.bezierCurveTo(d,p+$m*y,d+$m*y,p,d+y,p);s.closePath()}if(h){s=null;return h+""||null}}l.x=function(t){if(arguments.length){e=Zm(t);return l}else{return e}};l.y=function(e){if(arguments.length){t=Zm(e);return l}else{return t}};l.width=function(e){if(arguments.length){n=Zm(e);return l}else{return n}};l.height=function(e){if(arguments.length){r=Zm(e);return l}else{return r}};l.cornerRadius=function(e,t,n,r){if(arguments.length){i=Zm(e);a=t!=null?Zm(t):i;u=n!=null?Zm(n):i;o=r!=null?Zm(r):a;return l}else{return i}};l.context=function(e){if(arguments.length){s=e==null?null:e;return l}else{return s}};return l}function ey(){var e,t,n,r,i=null,a,o,u,s;function l(e,t,n){var r=n/2;if(a){var l=u-t,f=e-o;if(l||f){var c=Math.sqrt(l*l+f*f),h=(l/=c)*s,d=(f/=c)*s,p=Math.atan2(f,l);i.moveTo(o-h,u-d);i.lineTo(e-l*r,t-f*r);i.arc(e,t,r,p-Math.PI,p);i.lineTo(o+h,u+d);i.arc(o,u,s,p,p+Math.PI)}else{i.arc(e,t,r,0,Cm)}i.closePath()}else{a=1}o=e;u=t;s=r}function f(o){var u,s=o.length,f,c=false,h;if(i==null)i=h=ig();for(u=0;u<=s;++u){if(!(u<s&&r(f=o[u],u,o))===c){if(c=!c)a=0}if(c)l(+e(f,u,o),+t(f,u,o),+n(f,u,o))}if(h){i=null;return h+""||null}}f.x=function(t){if(arguments.length){e=t;return f}else{return e}};f.y=function(e){if(arguments.length){t=e;return f}else{return t}};f.size=function(e){if(arguments.length){n=e;return f}else{return n}};f.defined=function(e){if(arguments.length){r=e;return f}else{return r}};f.context=function(e){if(arguments.length){if(e==null){i=null}else{i=e}return f}else{return i}};return f}function ty(e,t){return e!=null?e:t}var ny=function(e){return e.x||0},ry=function(e){return e.y||0},iy=function(e){return e.width||0},ay=function(e){return e.height||0},oy=function(e){return(e.x||0)+(e.width||0)},uy=function(e){return(e.y||0)+(e.height||0)},sy=function(e){return e.startAngle||0},ly=function(e){return e.endAngle||0},fy=function(e){return e.padAngle||0},cy=function(e){return e.innerRadius||0},hy=function(e){return e.outerRadius||0},dy=function(e){return e.cornerRadius||0},py=function(e){return ty(e.cornerRadiusTopLeft,e.cornerRadius)||0},vy=function(e){return ty(e.cornerRadiusTopRight,e.cornerRadius)||0},gy=function(e){return ty(e.cornerRadiusBottomRight,e.cornerRadius)||0},my=function(e){return ty(e.cornerRadiusBottomLeft,e.cornerRadius)||0},yy=function(e){return ty(e.size,64)},by=function(e){return e.size||1},_y=function(e){return!(e.defined===false)},xy=function(e){return Wm(e.shape||"circle")};var wy=Mg().startAngle(sy).endAngle(ly).padAngle(fy).innerRadius(cy).outerRadius(hy).cornerRadius(dy),ky=Tg().x(ny).y1(ry).y0(uy).defined(_y),Ay=Tg().y(ry).x1(ny).x0(oy).defined(_y),Ey=Fg().x(ny).y(ry).defined(_y),My=Km().x(ny).y(ry).width(iy).height(ay).cornerRadius(py,vy,gy,my),Oy=jg().type(xy).size(yy),Sy=ey().x(ny).y(ry).defined(_y).size(by);function Dy(e,t){return wy.context(e)(t)}function Cy(e,t){var n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?Ay:ky).curve(Am(r,n.orient,n.tension)).context(e)(t)}function Fy(e,t){var n=t[0],r=n.interpolate||"linear";return Ey.curve(Am(r,n.orient,n.tension)).context(e)(t)}function Ty(e,t,n,r){return My.context(e)(t,n,r)}function Ny(e,t){return(t.mark.shape||t.shape).context(e)(t)}function jy(e,t){return Oy.context(e)(t)}function Ry(e,t){return Sy.context(e)(t)}function zy(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){var r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Py(t,r):0))}return e}function Py(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}var Ly,Iy=Cm-1e-8;function By(e){Ly=e;return By}function Uy(){}function qy(e,t){Ly.add(e,t)}By.beginPath=Uy;By.closePath=Uy;By.moveTo=qy;By.lineTo=qy;By.rect=function(e,t,n,r){qy(e,t);qy(e+n,t+r)};By.quadraticCurveTo=function(e,t,n,r){qy(e,t);qy(n,r)};By.bezierCurveTo=function(e,t,n,r,i,a){qy(e,t);qy(n,r);qy(i,a)};By.arc=function(e,t,n,r,i,a){if(Math.abs(i-r)>Iy){qy(e-n,t-n);qy(e+n,t+n);return}var o=Infinity,u=-Infinity,s=Infinity,l=-Infinity,f,c,h,d;function p(e){h=n*Math.cos(e);d=n*Math.sin(e);if(h<o)o=h;if(h>u)u=h;if(d<s)s=d;if(d>l)l=d}p(r);p(i);if(i!==r){r=r%Cm;if(r<0)r+=Cm;i=i%Cm;if(i<0)i+=Cm;if(i<r){a=!a;f=r;r=i;i=f}if(a){i-=Cm;f=r-r%Dm;for(c=0;c<4&&f>i;++c,f-=Dm)p(f)}else{f=r-r%Dm+Dm;for(c=0;c<4&&f<i;++c,f=f+Dm)p(f)}}qy(e+o,t+s);qy(e+u,t+l)};var Wy=(Wy=Yv(1,1))?Wy.getContext("2d"):null;var Hy=new Lv;function Gy(e){return function(t,n){if(!Wy)return true;e(Wy,t);Hy.clear().union(t.bounds).intersect(n).round();var r=Hy.x1,i=Hy.y1,a=Hy.x2,o=Hy.y2;for(var u=i;u<=o;++u){for(var s=r;s<=a;++s){if(Wy.isPointInPath(s,u)){return true}}}return false}}function $y(e,t){return t.contains(e.x||0,e.y||0)}function Yy(e,t){var n=e.x||0,r=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(Hy.set(n,r,n+i,r+a))}function Vy(e,t){var n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,a=e.y2!=null?e.y2:r;return Xy(t,n,r,i,a)}function Xy(e,t,n,r,i){var a=e.x1,o=e.y1,u=e.x2,s=e.y2,l=r-t,f=i-n;var c=0,h=1,d,p,v,g;for(g=0;g<4;++g){if(g===0){d=-l;p=-(a-t)}if(g===1){d=l;p=u-t}if(g===2){d=-f;p=-(o-n)}if(g===3){d=f;p=s-n}if(Math.abs(d)<1e-10&&p<0)return false;v=p/d;if(d<0){if(v>h)return false;else if(v>c)c=v}else if(d>0){if(v<c)return false;else if(v<h)h=v}}return true}function Jy(e,t,n){var r=n.width(),i=n.height(),a=t.stops,o=a.length;var u=t.gradient==="radial"?e.createRadialGradient(n.x1+Zy(t.x1,.5)*r,n.y1+Zy(t.y1,.5)*i,Math.max(r,i)*Zy(t.r1,0),n.x1+Zy(t.x2,.5)*r,n.y1+Zy(t.y2,.5)*i,Math.max(r,i)*Zy(t.r2,.5)):e.createLinearGradient(n.x1+Zy(t.x1,0)*r,n.y1+Zy(t.y1,0)*i,n.x1+Zy(t.x2,1)*r,n.y1+Zy(t.y2,0)*i);for(var s=0;s<o;++s){u.addColorStop(a[s].offset,a[s].color)}return u}function Zy(e,t){return e==null?t:e}function Qy(e,t,n){return qv(n)?Jy(e,n,t.bounds):n}function Ky(e,t,n){n*=t.fillOpacity==null?1:t.fillOpacity;if(n>0){e.globalAlpha=n;e.fillStyle=Qy(e,t,t.fill);return true}else{return false}}var eb=[];function tb(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;if(r<=0)return false;n*=t.strokeOpacity==null?1:t.strokeOpacity;if(n>0){e.globalAlpha=n;e.strokeStyle=Qy(e,t,t.stroke);e.lineWidth=r;e.lineCap=t.strokeCap||"butt";e.lineJoin=t.strokeJoin||"miter";e.miterLimit=t.strokeMiterLimit||10;if(e.setLineDash){e.setLineDash(t.strokeDash||eb);e.lineDashOffset=t.strokeDashOffset||0}return true}else{return false}}function nb(e,t){return e.zindex-t.zindex||e.index-t.index}function rb(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,a;for(i=0,a=t.length;i<a;++i){r=t[i];r.index=i;if(r.zindex)n.push(r)}e.zdirty=false;return e.zitems=n.sort(nb)}function ib(e,t){var n=e.items,r,i;if(!n||!n.length)return;var a=rb(e);if(a&&a.length){for(r=0,i=n.length;r<i;++r){if(!n[r].zindex)t(n[r])}n=a}for(r=0,i=n.length;r<i;++r){t(n[r])}}function ab(e,t){var n=e.items,r,i;if(!n||!n.length)return null;var a=rb(e);if(a&&a.length)n=a;for(i=n.length;--i>=0;){if(r=t(n[i]))return r}if(n===a){for(n=e.items,i=n.length;--i>=0;){if(!n[i].zindex){if(r=t(n[i]))return r}}}return null}function ob(e){return function(t,n,r){ib(n,(function(n){if(!r||r.intersects(n.bounds)){sb(e,t,n,n)}}))}}function ub(e){return function(t,n,r){if(n.items.length&&(!r||r.intersects(n.bounds))){sb(e,t,n.items[0],n.items)}}}function sb(e,t,n,r){var i=n.opacity==null?1:n.opacity;if(i===0)return;if(e(t,r))return;if(n.fill&&Ky(t,n,i)){t.fill()}if(n.stroke&&tb(t,n,i)){t.stroke()}}function lb(e){e=e||$n;return function(t,n,r,i,a,o){r*=t.pixelRatio;i*=t.pixelRatio;return ab(n,(function(n){var u=n.bounds;if(u&&!u.contains(a,o)||!u)return;if(e(t,n,r,i,a,o))return n}))}}function fb(e,t){return function(n,r,i,a){var o=Array.isArray(r)?r[0]:r,u=t==null?o.fill:t,s=o.stroke&&n.isPointInStroke,l,f;if(s){l=o.strokeWidth;f=o.strokeCap;n.lineWidth=l!=null?l:1;n.lineCap=f!=null?f:"butt"}return e(n,r)?false:u&&n.isPointInPath(i,a)||s&&n.isPointInStroke(i,a)}}function cb(e){return lb(fb(e))}function hb(e,t){return"translate("+e+","+t+")"}function db(e){return"rotate("+e+")"}function pb(e,t){return"scale("+e+","+t+")"}function vb(e){return hb(e.x||0,e.y||0)}function gb(e){return hb(e.x||0,e.y||0)+(e.angle?" "+db(e.angle):"")+(e.scaleX||e.scaleY?" "+pb(e.scaleX||1,e.scaleY||1):"")}function mb(e,t,n){function r(e,n){e("transform",gb(n));e("d",t(null,n))}function i(e,n){var r=n.x||0,i=n.y||0;t(By(e),n);zy(e,n).translate(r,i);if(n.angle){e.rotate(n.angle*Sm,r,i)}return e}function a(e,n){var r=n.x||0,i=n.y||0,a=n.angle||0;e.translate(r,i);if(a)e.rotate(a*=Sm);e.beginPath();t(e,n);if(a)e.rotate(-a);e.translate(-r,-i)}return{type:e,tag:"path",nested:false,attr:r,bound:i,draw:ob(a),pick:cb(a),isect:n||Gy(a)}}var yb=mb("arc",Dy);function bb(e,t){var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,a=+Infinity,o,u;while(--i>=0){if(e[i].defined===false)continue;u=Math.abs(e[i][r]-n);if(u<a){a=u;o=e[i]}}return o}function _b(e,t){var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,a,o;while(--r>=0){if(e[r].defined===false)continue;i=e[r].x-t[0];a=e[r].y-t[1];o=i*i+a*a;if(o<n)return e[r]}return null}function xb(e,t){var n=e.length,r,i,a;while(--n>=0){if(e[n].defined===false)continue;r=e[n].x-t[0];i=e[n].y-t[1];a=r*r+i*i;r=e[n].size||1;if(a<r*r)return e[n]}return null}function wb(e,t,n){function r(e,n){var r=n.mark.items;if(r.length)e("d",t(null,r))}function i(e,n){var r=n.items;if(r.length===0){return e}else{t(By(e),r);return zy(e,r[0])}}function a(e,n){e.beginPath();t(e,n)}var o=fb(a);function u(e,t,n,r,i,a){var u=t.items,s=t.bounds;if(!u||!u.length||s&&!s.contains(i,a)){return null}n*=e.pixelRatio;r*=e.pixelRatio;return o(e,u,n,r)?u[0]:null}return{type:e,tag:"path",nested:true,attr:r,bound:i,draw:ub(a),pick:u,isect:$y,tip:n}}var kb=wb("area",Cy,bb);var Ab=1;function Eb(e,t,n){var r=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+Ab++),o=i.clipping[a]||(i.clipping[a]={id:a});if(er(r)){o.path=r(null)}else{o.width=n.width||0;o.height=n.height||0}return"url(#"+a+")"}var Mb=.5;function Ob(e,t){e("transform",vb(t))}function Sb(e,t){var n=t.stroke?Mb:0;e("class","background");e("d",Ty(null,t,n,n))}function Db(e,t,n){var r=t.clip?Eb(n,t,t):null;e("clip-path",r)}function Cb(e,t){if(!t.clip&&t.items){var n=t.items;for(var r=0,i=n.length;r<i;++r){e.union(n[r].bounds)}}if((t.clip||t.width||t.height)&&!t.noBound){e.add(0,0).add(t.width||0,t.height||0)}zy(e,t);return e.translate(t.x||0,t.y||0)}function Fb(e,t){var n=t.stroke?Mb:0;e.beginPath();Ty(e,t,n,n)}var Tb=fb(Fb);function Nb(e,t,n){var r=this;ib(t,(function(t){var i=t.x||0,a=t.y||0,o=t.width||0,u=t.height||0,s;e.save();e.translate(i,a);if(t.stroke||t.fill){s=t.opacity==null?1:t.opacity;if(s>0){Fb(e,t);if(t.fill&&Ky(e,t,s)){e.fill()}if(t.stroke&&tb(e,t,s)){e.stroke()}}}if(t.clip){e.beginPath();e.rect(0,0,o,u);e.clip()}if(n)n.translate(-i,-a);ib(t,(function(t){r.draw(e,t,n)}));if(n)n.translate(i,a);e.restore()}))}function jb(e,t,n,r,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items){return null}var o=this,u=n*e.pixelRatio,s=r*e.pixelRatio;return ab(t,(function(l){var f,c,h,d;d=l.bounds;if(d&&!d.contains(i,a))return;c=l.x||0;h=l.y||0;e.save();e.translate(c,h);c=i-c;h=a-h;f=ab(l,(function(e){return Rb(e,c,h)?o.pick(e,n,r,c,h):null}));if(!f&&t.interactive!==false&&(l.fill||l.stroke)&&Tb(e,l,u,s)){f=l}e.restore();return f||null}))}function Rb(e,t,n){return(e.interactive!==false||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var zb={type:"group",tag:"g",nested:false,attr:Ob,bound:Cb,draw:Nb,pick:jb,isect:Yy,background:Sb,foreground:Db};function Pb(e,t){var n=e.image;if(!n||e.url&&e.url!==n.url){n={complete:false,width:0,height:0};t.loadImage(e.url).then((function(t){e.image=t;e.image.url=e.url}))}return n}function Lb(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==false&&e.height?e.height*t.width/t.height:t.width}function Ib(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==false&&e.width?e.width*t.height/t.width:t.height}function Bb(e,t){return e==="center"?t/2:e==="right"?t:0}function Ub(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function qb(e,t,n){var r=Pb(t,n),i=t.x||0,a=t.y||0,o=Lb(t,r),u=Ib(t,r),s=t.aspect===false?"none":"xMidYMid";i-=Bb(t.align,o);a-=Ub(t.baseline,u);if(!r.src&&r.toDataURL){e("href",r.toDataURL(),"http://www.w3.org/1999/xlink","xlink:href")}else{e("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href")}e("transform",hb(i,a));e("width",o);e("height",u);e("preserveAspectRatio",s)}function Wb(e,t){var n=t.image,r=t.x||0,i=t.y||0,a=Lb(t,n),o=Ib(t,n);r-=Bb(t.align,a);i-=Ub(t.baseline,o);return e.set(r,i,r+a,i+o)}function Hb(e,t,n){var r=this;ib(t,(function(t){if(n&&!n.intersects(t.bounds))return;var i=Pb(t,r),a=t.x||0,o=t.y||0,u=Lb(t,i),s=Ib(t,i),l,f,c,h;a-=Bb(t.align,u);o-=Ub(t.baseline,s);if(t.aspect!==false){f=i.width/i.height;c=t.width/t.height;if(f===f&&c===c&&f!==c){if(c<f){h=u/f;o+=(s-h)/2;s=h}else{h=s*f;a+=(u-h)/2;u=h}}}if(i.complete||i.toDataURL){e.globalAlpha=(l=t.opacity)!=null?l:1;e.imageSmoothingEnabled=t.smooth!==false;e.drawImage(i,a,o,u,s)}}))}var Gb={type:"image",tag:"image",nested:false,attr:qb,bound:Wb,draw:Hb,pick:lb(),isect:$n,get:Pb,xOffset:Bb,yOffset:Ub};var $b=wb("line",Fy,_b);function Yb(e,t){var n=t.scaleX||1,r=t.scaleY||1;if(n!==1||r!==1){e("vector-effect","non-scaling-stroke")}e("transform",gb(t));e("d",t.path)}function Vb(e,t){var n=t.path;if(n==null)return true;var r=t.x||0,i=t.y||0,a=t.scaleX||1,o=t.scaleY||1,u=(t.angle||0)*Sm,s=t.pathCache;if(!s||s.path!==n){(t.pathCache=s=Om(n)).path=n}if(u&&e.rotate&&e.translate){e.translate(r,i);e.rotate(u);Im(e,s,0,0,a,o);e.rotate(-u);e.translate(-r,-i)}else{Im(e,s,r,i,a,o)}}function Xb(e,t){Vb(By(e),t)?e.set(0,0,0,0):zy(e,t,true);if(t.angle){e.rotate(t.angle*Sm,t.x||0,t.y||0)}return e}var Jb={type:"path",tag:"path",nested:false,attr:Yb,bound:Xb,draw:ob(Vb),pick:cb(Vb),isect:Gy(Vb)};function Zb(e,t){e("d",Ty(null,t))}function Qb(e,t){var n,r;return zy(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function Kb(e,t){e.beginPath();Ty(e,t)}var e_={type:"rect",tag:"path",nested:false,attr:Zb,bound:Qb,draw:ob(Kb),pick:cb(Kb),isect:Yy};function t_(e,t){e("transform",vb(t));e("x2",t.x2!=null?t.x2-(t.x||0):0);e("y2",t.y2!=null?t.y2-(t.y||0):0)}function n_(e,t){var n,r;return zy(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function r_(e,t,n){var r,i,a,o;if(t.stroke&&tb(e,t,n)){r=t.x||0;i=t.y||0;a=t.x2!=null?t.x2:r;o=t.y2!=null?t.y2:i;e.beginPath();e.moveTo(r,i);e.lineTo(a,o);return true}return false}function i_(e,t,n){ib(t,(function(t){if(n&&!n.intersects(t.bounds))return;var r=t.opacity==null?1:t.opacity;if(r&&r_(e,t,r)){e.stroke()}}))}function a_(e,t,n,r){if(!e.isPointInStroke)return false;return r_(e,t,1)&&e.isPointInStroke(n,r)}var o_={type:"rule",tag:"line",nested:false,attr:t_,bound:n_,draw:i_,pick:lb(a_),isect:Vy};var u_=mb("shape",Ny);var s_=mb("symbol",jy,$y);var l_;var f_={height:v_,measureWidth:d_,estimateWidth:c_,width:c_,canvas:g_};g_(true);function c_(e,t){l_=v_(e);return h_(x_(e,t))}function h_(e){return~~(.8*e.length*l_)}function d_(e,t){return v_(e)<=0?0:(Wy.font=A_(e),p_(x_(e,t)))}function p_(e){return Wy.measureText(e).width}function v_(e){return e.fontSize!=null?e.fontSize:11}function g_(e){f_.width=e&&Wy?d_:c_}function m_(e){return e.lineHeight!=null?e.lineHeight:v_(e)+2}function y_(e){return zn(e)?e.length>1?e:e[0]:e}function b_(e){return y_(e.lineBreak&&e.text&&!zn(e.text)?e.text.split(e.lineBreak):e.text)}function __(e){var t=b_(e);return(zn(t)?t.length-1:0)*m_(e)}function x_(e,t){return t==null?"":e.limit>0?w_(e,t):t+""}function w_(e,t){var n=+e.limit,r=t+"",i;if(f_.width===d_){Wy.font=A_(e);i=p_}else{l_=v_(e);i=h_}if(i(r)<n)return r;var a=e.ellipsis||"…",o=e.dir==="rtl",u=0,s=r.length,l;n-=i(a);if(o){while(u<s){l=u+s>>>1;if(i(r.slice(l))>n)u=l+1;else s=l}return a+r.slice(u)}else{while(u<s){l=1+(u+s>>>1);if(i(r.slice(0,l))<n)u=l;else s=l-1}return r.slice(0,u)+a}}function k_(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function A_(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+v_(e)+"px "+k_(e,t)}function E_(e){var t=e.baseline,n=v_(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:0)}var M_={left:"start",center:"middle",right:"end"};var O_=new Lv;function S_(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;if(r){i=(e.theta||0)-Dm;t+=r*Math.cos(i);n+=r*Math.sin(i)}O_.x1=t;O_.y1=n;return O_}function D_(e,t){var n=t.dx||0,r=(t.dy||0)+E_(t),i=S_(t),a=i.x1,o=i.y1,u=t.angle||0,s;e("text-anchor",M_[t.align]||"start");if(u){s=hb(a,o)+" "+db(u);if(n||r)s+=" "+hb(n,r)}else{s=hb(a+n,o+r)}e("transform",s)}function C_(e,t,n){var r=f_.height(t),i=t.align,a=S_(t),o=a.x1,u=a.y1,s=t.dx||0,l=(t.dy||0)+E_(t)-Math.round(.8*r),f=b_(t),c;if(zn(f)){r+=m_(t)*(f.length-1);c=f.reduce((function(e,n){return Math.max(e,f_.width(t,n))}),0)}else{c=f_.width(t,f)}if(i==="center"){s-=c/2}else if(i==="right"){s-=c}e.set(s+=o,l+=u,s+c,l+r);if(t.angle&&!n){e.rotate(t.angle*Sm,o,u)}else if(n===2){return e.rotatedPoints(t.angle*Sm,o,u)}return e}function F_(e,t,n){ib(t,(function(t){var r=t.opacity==null?1:t.opacity,i,a,o,u,s,l,f;if(n&&!n.intersects(t.bounds)||r===0||t.fontSize<=0||t.text==null||t.text.length===0)return;e.font=A_(t);e.textAlign=t.align||"left";i=S_(t);a=i.x1,o=i.y1;if(t.angle){e.save();e.translate(a,o);e.rotate(t.angle*Sm);a=o=0}a+=t.dx||0;o+=(t.dy||0)+E_(t);l=b_(t);if(zn(l)){s=m_(t);for(u=0;u<l.length;++u){f=x_(t,l[u]);if(t.fill&&Ky(e,t,r)){e.fillText(f,a,o)}if(t.stroke&&tb(e,t,r)){e.strokeText(f,a,o)}o+=s}}else{f=x_(t,l);if(t.fill&&Ky(e,t,r)){e.fillText(f,a,o)}if(t.stroke&&tb(e,t,r)){e.strokeText(f,a,o)}}if(t.angle)e.restore()}))}function T_(e,t,n,r,i,a){if(t.fontSize<=0)return false;if(!t.angle)return true;var o=S_(t),u=o.x1,s=o.y1,l=C_(O_,t,1),f=-t.angle*Sm,c=Math.cos(f),h=Math.sin(f),d=c*i-h*a+(u-c*u+h*s),p=h*i+c*a+(s-h*u-c*s);return l.contains(d,p)}function N_(e,t){var n=C_(O_,e,2);return Xy(t,n[0],n[1],n[2],n[3])||Xy(t,n[0],n[1],n[4],n[5])||Xy(t,n[4],n[5],n[6],n[7])||Xy(t,n[2],n[3],n[6],n[7])}var j_={type:"text",tag:"text",nested:false,attr:D_,bound:C_,draw:F_,pick:lb(T_),isect:N_};var R_=wb("trail",Ry,xb);var z_={arc:yb,area:kb,group:zb,image:Gb,line:$b,path:Jb,rect:e_,rule:o_,shape:u_,symbol:s_,text:j_,trail:R_};function P_(e,t,n){if(!e&&typeof document!=="undefined"&&document.createElement){e=document}return e?n?e.createElementNS(n,t):e.createElement(t):null}function L_(e,t){t=t.toLowerCase();var n=e.childNodes,r=0,i=n.length;for(;r<i;++r)if(n[r].tagName.toLowerCase()===t){return n[r]}}function I_(e,t,n,r){var i=e.childNodes[t],a;if(!i||i.tagName.toLowerCase()!==n.toLowerCase()){a=i||null;i=P_(e.ownerDocument,n,r);e.insertBefore(i,a)}return i}function B_(e,t){var n=e.childNodes,r=n.length;while(r>t)e.removeChild(n[--r]);return e}function U_(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function q_(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function W_(e,t,n,r){var i=e&&e.mark,a,o;if(i&&(a=z_[i.marktype]).tip){o=q_(t,n);o[0]-=r[0];o[1]-=r[1];while(e=e.mark.group){o[0]-=e.x||0;o[1]-=e.y||0}e=a.tip(i.items,o)}return e}function H_(e,t){this._active=null;this._handlers={};this._loader=e||Oo();this._tooltip=t||G_}function G_(e,t,n,r){e.element().setAttribute("title",r||"")}var $_=H_.prototype;$_.initialize=function(e,t,n){this._el=e;this._obj=n||null;return this.origin(t)};$_.element=function(){return this._el};$_.canvas=function(){return this._el&&this._el.firstChild};$_.origin=function(e){if(arguments.length){this._origin=e||[0,0];return this}else{return this._origin.slice()}};$_.scene=function(e){if(!arguments.length)return this._scene;this._scene=e;return this};$_.on=function(){};$_.off=function(){};$_._handlerIndex=function(e,t,n){for(var r=e?e.length:0;--r>=0;){if(e[r].type===t&&(!n||e[r].handler===n)){return r}}return-1};$_.handlers=function(e){var t=this._handlers,n=[],r;if(e){n.push.apply(n,t[this.eventName(e)])}else{for(r in t){n.push.apply(n,t[r])}}return n};$_.eventName=function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)};$_.handleHref=function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((function(t){var n=new MouseEvent(e.type,e),r=P_(null,"a");for(var i in t)r.setAttribute(i,t[i]);r.dispatchEvent(n)})).catch((function(){}))};$_.handleTooltip=function(e,t,n){if(t&&t.tooltip!=null){t=W_(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}};$_.getItemBoundingClientRect=function(e){if(!(t=this.canvas()))return;var t,n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.x1+r[0]+n.left,o=i.y1+r[1]+n.top,u=i.width(),s=i.height();while(e.mark&&(e=e.mark.group)){a+=e.x||0;o+=e.y||0}return{x:a,y:o,width:u,height:s,left:a,top:o,right:a+u,bottom:o+s}};function Y_(e){this._el=null;this._bgcolor=null;this._loader=new Xv(e)}var V_=Y_.prototype;V_.initialize=function(e,t,n,r,i){this._el=e;return this.resize(t,n,r,i)};V_.element=function(){return this._el};V_.canvas=function(){return this._el&&this._el.firstChild};V_.background=function(e){if(arguments.length===0)return this._bgcolor;this._bgcolor=e;return this};V_.resize=function(e,t,n,r){this._width=e;this._height=t;this._origin=n||[0,0];this._scale=r||1;return this};V_.dirty=function(){};V_.render=function(e){var t=this;t._call=function(){t._render(e)};t._call();t._call=null;return t};V_._render=function(){};V_.renderAsync=function(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)};V_._load=function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then((function(e){if(e)i();n._ready=null}))}return r};V_.sanitizeURL=function(e){return this._load("sanitizeURL",e)};V_.loadImage=function(e){return this._load("loadImage",e)};var X_=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"];var J_="mousemove";var Z_="mouseout";var Q_="click";function K_(e,t){H_.call(this,e,t);this._down=null;this._touch=null;this._first=true}var ex=or(K_,H_);ex.initialize=function(e,t,n){var r=this._canvas=e&&L_(e,"canvas");if(r){var i=this;this.events.forEach((function(e){r.addEventListener(e,(function(t){if(ex[e]){ex[e].call(i,t)}else{i.fire(e,t)}}))}))}return H_.prototype.initialize.call(this,e,t,n)};ex.canvas=function(){return this._canvas};ex.context=function(){return this._canvas.getContext("2d")};ex.events=X_;ex.DOMMouseScroll=function(e){this.fire("mousewheel",e)};function tx(e,t,n){return function(r){var i=this._active,a=this.pickEvent(r);if(a===i){this.fire(e,r)}else{if(!i||!i.exit){this.fire(n,r)}this._active=a;this.fire(t,r);this.fire(e,r)}}}function nx(e){return function(t){this.fire(e,t);this._active=null}}ex.mousemove=tx("mousemove","mouseover","mouseout");ex.dragover=tx("dragover","dragenter","dragleave");ex.mouseout=nx("mouseout");ex.dragleave=nx("dragleave");ex.mousedown=function(e){this._down=this._active;this.fire("mousedown",e)};ex.click=function(e){if(this._down===this._active){this.fire("click",e);this._down=null}};ex.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]);if(this._first){this._active=this._touch;this._first=false}this.fire("touchstart",e,true)};ex.touchmove=function(e){this.fire("touchmove",e,true)};ex.touchend=function(e){this.fire("touchend",e,true);this._touch=null};ex.fire=function(e,t,n){var r=n?this._touch:this._active,i=this._handlers[e],a,o;t.vegaType=e;if(e===Q_&&r&&r.href){this.handleHref(t,r,r.href)}else if(e===J_||e===Z_){this.handleTooltip(t,r,e!==Z_)}if(i){for(a=0,o=i.length;a<o;++a){i[a].handler.call(this._obj,t,r)}}};ex.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){(r[n]||(r[n]=[])).push({type:e,handler:t})}return this};ex.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){r.splice(i,1)}return this};ex.pickEvent=function(e){var t=q_(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])};ex.pick=function(e,t,n,r,i){var a=this.context(),o=z_[e.marktype];return o.pick.call(this,a,e,t,n,r,i)};function rx(e,t){var n=t.clip;e.save();e.beginPath();if(er(n)){n(e)}else{var r=t.group;e.rect(0,0,r.width||0,r.height||0)}e.clip()}function ix(){return typeof window!=="undefined"?window.devicePixelRatio||1:1}var ax=ix();function ox(e,t,n,r,i,a){var o=typeof HTMLElement!=="undefined"&&e instanceof HTMLElement&&e.parentNode!=null;var u=e.getContext("2d"),s=o?ax:i,l;e.width=t*s;e.height=n*s;for(l in a){u[l]=a[l]}if(o&&s!==1){e.style.width=t+"px";e.style.height=n+"px"}u.pixelRatio=s;u.setTransform(s,0,0,s,s*r[0],s*r[1]);return e}function ux(e){Y_.call(this,e);this._redraw=false;this._dirty=new Lv}var sx=or(ux,Y_),lx=Y_.prototype,fx=new Lv;sx.initialize=function(e,t,n,r,i,a){this._options=a;this._canvas=Yv(1,1);if(e){B_(e,0).appendChild(this._canvas);this._canvas.setAttribute("class","marks")}return lx.initialize.call(this,e,t,n,r,i)};sx.resize=function(e,t,n,r){lx.resize.call(this,e,t,n,r);ox(this._canvas,this._width,this._height,this._origin,this._scale,this._options&&this._options.context);this._redraw=true;return this};sx.canvas=function(){return this._canvas};sx.context=function(){return this._canvas?this._canvas.getContext("2d"):null};sx.dirty=function(e){var t=dx(e.bounds,e.mark.group);this._dirty.union(t)};function cx(e,t,n){t.expand(1).round();t.translate(-(n[0]%1),-(n[1]%1));e.beginPath();e.rect(t.x1,t.y1,t.width(),t.height());e.clip();return t}function hx(e,t,n){return fx.set(0,0,t,n).translate(-e[0],-e[1])}function dx(e,t){if(t==null)return e;var n=fx.clear().union(e);for(;t!=null;t=t.mark.group){n.translate(t.x||0,t.y||0)}return n}sx._render=function(e){var t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty;t.save();if(this._redraw||a.empty()){this._redraw=false;a=hx(n,r,i).expand(1)}else{a=cx(t,a.intersect(hx(n,r,i)),n)}this.clear(-n[0],-n[1],r,i);this.draw(t,e,a);t.restore();this._dirty.clear();return this};sx.draw=function(e,t,n){var r=z_[t.marktype];if(t.clip)rx(e,t);r.draw.call(this,e,t,n);if(t.clip)e.restore()};sx.clear=function(e,t,n,r){var i=this.context();i.clearRect(e,t,n,r);if(this._bgcolor!=null){i.fillStyle=this._bgcolor;i.fillRect(e,t,n,r)}};function px(e,t){H_.call(this,e,t);var n=this;n._hrefHandler=gx(n,(function(e,t){if(t&&t.href)n.handleHref(e,t,t.href)}));n._tooltipHandler=gx(n,(function(e,t){n.handleTooltip(e,t,e.type!==Z_)}))}var vx=or(px,H_);vx.initialize=function(e,t,n){var r=this._svg;if(r){r.removeEventListener(Q_,this._hrefHandler);r.removeEventListener(J_,this._tooltipHandler);r.removeEventListener(Z_,this._tooltipHandler)}this._svg=r=e&&L_(e,"svg");if(r){r.addEventListener(Q_,this._hrefHandler);r.addEventListener(J_,this._tooltipHandler);r.addEventListener(Z_,this._tooltipHandler)}return H_.prototype.initialize.call(this,e,t,n)};vx.canvas=function(){return this._svg};function gx(e,t){return function(n){var r=n.target,i=r.__data__;n.vegaType=n.type;i=Array.isArray(i)?i[0]:i;t.call(e._obj,n,i)}}vx.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){var a={type:e,handler:t,listener:gx(this,t)};(r[n]||(r[n]=[])).push(a);if(this._svg){this._svg.addEventListener(n,a.listener)}}return this};vx.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){if(this._svg){this._svg.removeEventListener(n,r[i].listener)}r.splice(i,1)}return this};function mx(e,t,n){var r="<"+e,i,a;if(t){for(i in t){a=t[i];if(a!=null){r+=" "+i+'="'+a+'"'}}}if(n)r+=" "+n;return r+">"}function yx(e){return"</"+e+">"}var bx={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};var _x={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"};var xx=Object.keys(_x);var wx=bx.xmlns;function kx(e){Y_.call(this,e);this._dirtyID=0;this._dirty=[];this._svg=null;this._root=null;this._defs=null}var Ax=or(kx,Y_);var Ex=Y_.prototype;Ax.initialize=function(e,t,n,r){if(e){this._svg=I_(e,0,"svg",wx);this._svg.setAttribute("class","marks");B_(e,1);this._root=I_(this._svg,0,"g",wx);B_(this._svg,1)}this._defs={gradient:{},clipping:{}};this.background(this._bgcolor);return Ex.initialize.call(this,e,t,n,r)};Ax.background=function(e){if(arguments.length&&this._svg){this._svg.style.setProperty("background-color",e)}return Ex.background.apply(this,arguments)};Ax.resize=function(e,t,n,r){Ex.resize.call(this,e,t,n,r);if(this._svg){this._svg.setAttribute("width",this._width*this._scale);this._svg.setAttribute("height",this._height*this._scale);this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height);this._root.setAttribute("transform","translate("+this._origin+")")}this._dirty=[];return this};Ax.canvas=function(){return this._svg};Ax.svg=function(){if(!this._svg)return null;var e={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var t in bx){e[t]=bx[t]}var n=!this._bgcolor?"":mx("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+yx("rect");return mx("svg",e)+n+this._svg.innerHTML+yx("svg")};Ax._render=function(e){if(this._dirtyCheck()){if(this._dirtyAll)this._resetDefs();this.draw(this._root,e);B_(this._root,1)}this.updateDefs();this._dirty=[];++this._dirtyID;return this};Ax.updateDefs=function(){var e=this._svg,t=this._defs,n=t.el,r=0,i;for(i in t.gradient){if(!n)t.el=n=I_(e,0,"defs",wx);r=Mx(n,t.gradient[i],r)}for(i in t.clipping){if(!n)t.el=n=I_(e,0,"defs",wx);r=Ox(n,t.clipping[i],r)}if(n){if(r===0){e.removeChild(n);t.el=null}else{B_(n,r)}}};function Mx(e,t,n){var r,i,a;if(t.gradient==="radial"){var o=I_(e,n++,"pattern",wx);o.setAttribute("id",Uv+t.id);o.setAttribute("viewBox","0,0,1,1");o.setAttribute("width","100%");o.setAttribute("height","100%");o.setAttribute("preserveAspectRatio","xMidYMid slice");o=I_(o,0,"rect",wx);o.setAttribute("width","1");o.setAttribute("height","1");o.setAttribute("fill","url("+Px()+"#"+t.id+")");e=I_(e,n++,"radialGradient",wx);e.setAttribute("id",t.id);e.setAttribute("fx",t.x1);e.setAttribute("fy",t.y1);e.setAttribute("fr",t.r1);e.setAttribute("cx",t.x2);e.setAttribute("cy",t.y2);e.setAttribute("r",t.r2)}else{e=I_(e,n++,"linearGradient",wx);e.setAttribute("id",t.id);e.setAttribute("x1",t.x1);e.setAttribute("x2",t.x2);e.setAttribute("y1",t.y1);e.setAttribute("y2",t.y2)}for(r=0,i=t.stops.length;r<i;++r){a=I_(e,r,"stop",wx);a.setAttribute("offset",t.stops[r].offset);a.setAttribute("stop-color",t.stops[r].color)}B_(e,r);return n}function Ox(e,t,n){var r;e=I_(e,n,"clipPath",wx);e.setAttribute("id",t.id);if(t.path){r=I_(e,0,"path",wx);r.setAttribute("d",t.path)}else{r=I_(e,0,"rect",wx);r.setAttribute("x",0);r.setAttribute("y",0);r.setAttribute("width",t.width);r.setAttribute("height",t.height)}return n+1}Ax._resetDefs=function(){var e=this._defs;e.gradient={};e.clipping={}};Ax.dirty=function(e){if(e.dirty!==this._dirtyID){e.dirty=this._dirtyID;this._dirty.push(e)}};Ax.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID};Ax._dirtyCheck=function(){this._dirtyAll=true;var e=this._dirty;if(!e.length||!this._dirtyID)return true;var t=++this._dirtyID,n,r,i,a,o,u,s;for(o=0,u=e.length;o<u;++o){n=e[o];r=n.mark;if(r.marktype!==i){i=r.marktype;a=z_[i]}if(r.zdirty&&r.dirty!==t){this._dirtyAll=false;Sx(n,t);r.items.forEach((function(e){e.dirty=t}))}if(r.zdirty)continue;if(n.exit){if(a.nested&&r.items.length){s=r.items[0];if(s._svg)this._update(a,s._svg,s)}else if(n._svg){s=n._svg.parentNode;if(s)s.removeChild(n._svg)}n._svg=null;continue}n=a.nested?r.items[0]:n;if(n._update===t)continue;if(!n._svg||!n._svg.ownerSVGElement){this._dirtyAll=false;Sx(n,t)}else{this._update(a,n._svg,n)}n._update=t}return!this._dirtyAll};function Sx(e,t){for(;e&&e.dirty!==t;e=e.mark.group){e.dirty=t;if(e.mark&&e.mark.dirty!==t){e.mark.dirty=t}else return}}Ax.draw=function(e,t,n){if(!this.isDirty(t))return t._svg;var r=this,i=this._svg,a=z_[t.marktype],o=t.interactive===false?"none":null,u=a.tag==="g",s=null,l=0,f;f=Cx(t,e,n,"g",i);f.setAttribute("class",U_(t));if(!u){f.style.setProperty("pointer-events",o)}if(t.clip){f.setAttribute("clip-path",Eb(r,t,t.group))}else{f.removeAttribute("clip-path")}function c(e){var t=r.isDirty(e),n=Cx(e,f,s,a.tag,i);if(t){r._update(a,n,e);if(u)Dx(r,n,e)}s=n;++l}if(a.nested){if(t.items.length)c(t.items[0])}else{ib(t,c)}B_(f,l);return f};function Dx(e,t,n){t=t.lastChild;var r,i=0;ib(n,(function(n){r=e.draw(t,n,r);++i}));B_(t,1+i)}function Cx(e,t,n,r,i){var a=e._svg,o;if(!a){o=t.ownerDocument;a=P_(o,r,wx);e._svg=a;if(e.mark){a.__data__=e;a.__values__={fill:"default"};if(r==="g"){var u=P_(o,"path",wx);u.setAttribute("class","background");a.appendChild(u);u.__data__=e;var s=P_(o,"g",wx);a.appendChild(s);s.__data__=e}}}if(a.ownerSVGElement!==i||Fx(a,n)){t.insertBefore(a,n?n.nextSibling:t.firstChild)}return a}function Fx(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}var Tx=null,Nx=null;var jx={group:function(e,t,n){Nx=t.__values__;Tx=t.childNodes[1];e.foreground(zx,n,this);Tx=t.childNodes[0];e.background(zx,n,this);var r=n.mark.interactive===false?"none":null;if(r!==Nx.events){Tx.style.setProperty("pointer-events",r);Nx.events=r}},image:function(e,t,n){if(n.smooth===false){Rx(t,"image-rendering","optimizeSpeed");Rx(t,"image-rendering","pixelated")}else{Rx(t,"image-rendering",null)}},text:function(e,t,n){var r=b_(n),i,a,o,u;if(zn(r)){a=r.map((function(e){return x_(n,e)}));i=a.join("\n");if(i!==Nx.text){B_(t,0);o=t.ownerDocument;u=m_(n);a.forEach((function(e,r){var i=P_(o,"tspan",wx);i.__data__=n;i.textContent=e;if(r){i.setAttribute("x",0);i.setAttribute("dy",u)}t.appendChild(i)}));Nx.text=i}}else{a=x_(n,r);if(a!==Nx.text){t.textContent=a;Nx.text=a}}Rx(t,"font-family",k_(n));Rx(t,"font-size",v_(n)+"px");Rx(t,"font-style",n.fontStyle);Rx(t,"font-variant",n.fontVariant);Rx(t,"font-weight",n.fontWeight)}};function Rx(e,t,n){if(n!==Nx[t]){if(n==null){e.style.removeProperty(t)}else{e.style.setProperty(t,n+"")}Nx[t]=n}}Ax._update=function(e,t,n){Tx=t;Nx=t.__values__;e.attr(zx,n,this);var r=jx[e.type];if(r)r.call(this,e,t,n);this.style(Tx,n)};function zx(e,t,n){if(t===Nx[e])return;if(t!=null){if(n){Tx.setAttributeNS(n,e,t)}else{Tx.setAttribute(e,t)}}else{if(n){Tx.removeAttributeNS(n,e)}else{Tx.removeAttribute(e)}}Nx[e]=t}Ax.style=function(e,t){if(t==null)return;var n,r,i,a,o;for(n=0,r=xx.length;n<r;++n){i=xx[n];o=t[i];if(i==="font"){o=k_(t)}if(o===Nx[i])continue;a=_x[i];if(o==null){if(a==="fill"){e.style.setProperty(a,"none")}else{e.style.removeProperty(a)}}else{if(qv(o)){o=Wv(o,this._defs.gradient,Px())}e.style.setProperty(a,o+"")}Nx[i]=o}};function Px(){var e;return typeof window==="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Lx(e){Y_.call(this,e);this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""};this._defs={gradient:{},clipping:{}}}var Ix=or(Lx,Y_);var Bx=Y_.prototype;Ix.resize=function(e,t,n,r){Bx.resize.call(this,e,t,n,r);var i=this._origin,a=this._text;var o={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var u in bx){o[u]=bx[u]}a.head=mx("svg",o);var s=this._bgcolor;if(s==="transparent"||s==="none")s=null;if(s){a.bg=mx("rect",{width:this._width,height:this._height,style:"fill: "+s+";"})+yx("rect")}else{a.bg=""}a.root=mx("g",{transform:"translate("+i+")"});a.foot=yx("g")+yx("svg");return this};Ix.background=function(){var e=Bx.background.apply(this,arguments);if(arguments.length&&this._text.head){this.resize(this._width,this._height,this._origin,this._scale)}return e};Ix.svg=function(){var e=this._text;return e.head+e.bg+e.defs+e.root+e.body+e.foot};Ix._render=function(e){this._text.body=this.mark(e);this._text.defs=this.buildDefs();return this};Ix.buildDefs=function(){var e=this._defs,t="",n,r,i,a,o;for(r in e.gradient){i=e.gradient[r];o=i.stops;if(i.gradient==="radial"){t+=mx(a="pattern",{id:Uv+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"});t+=mx("rect",{width:"1",height:"1",fill:"url(#"+r+")"})+yx("rect");t+=yx(a);t+=mx(a="radialGradient",{id:r,fx:i.x1,fy:i.y1,fr:i.r1,cx:i.x2,cy:i.y2,r:i.r2})}else{t+=mx(a="linearGradient",{id:r,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2})}for(n=0;n<o.length;++n){t+=mx("stop",{offset:o[n].offset,"stop-color":o[n].color})+yx("stop")}t+=yx(a)}for(r in e.clipping){i=e.clipping[r];t+=mx("clipPath",{id:r});if(i.path){t+=mx("path",{d:i.path})+yx("path")}else{t+=mx("rect",{x:0,y:0,width:i.width,height:i.height})+yx("rect")}t+=yx("clipPath")}return t.length>0?mx("defs")+t+yx("defs"):""};var Ux;function qx(e,t,n,r){Ux[r||e]=t}Ix.attributes=function(e,t){Ux={};e(qx,t,this);return Ux};Ix.href=function(e){var t=this,n=e.href,r;if(n){if(r=t._hrefs&&t._hrefs[n]){return r}else{t.sanitizeURL(n).then((function(e){e["xlink:href"]=e.href;e.href=null;(t._hrefs||(t._hrefs={}))[n]=e}))}}return null};Ix.mark=function(e){var t=this,n=z_[e.marktype],r=n.tag,i=this._defs,a="",o;if(r!=="g"&&e.interactive===false){o='style="pointer-events: none;"'}a+=mx("g",{class:U_(e),"clip-path":e.clip?Eb(t,e,e.group):null},o);function u(u){var s=t.href(u);if(s)a+=mx("a",s);o=r!=="g"?Wx(u,e,r,i):null;a+=mx(r,t.attributes(n.attr,u),o);if(r==="text"){var l=b_(u);if(zn(l)){var f={x:0,dy:m_(u)};for(var c=0;c<l.length;++c){a+=mx("tspan",c?f:null)+Hx(x_(u,l[c]))+yx("tspan")}}else{a+=Hx(x_(u,l))}}else if(r==="g"){a+=mx("path",t.attributes(n.background,u),Wx(u,e,"bgrect",i))+yx("path");a+=mx("g",t.attributes(n.foreground,u))+t.markGroup(u)+yx("g")}a+=yx(r);if(s)a+=yx("a")}if(n.nested){if(e.items&&e.items.length)u(e.items[0])}else{ib(e,u)}return a+yx("g")};Ix.markGroup=function(e){var t=this,n="";ib(e,(function(e){n+=t.mark(e)}));return n};function Wx(e,t,n,r){if(e==null)return"";var i,a,o,u,s,l="";if(n==="bgrect"&&t.interactive===false){l+="pointer-events: none; "}if(n==="image"){if(e.smooth===false){l+="image-rendering: optimizeSpeed; image-rendering: pixelated; "}}if(n==="text"){l+="font-family: "+k_(e)+"; ";l+="font-size: "+v_(e)+"px; ";if(e.fontStyle)l+="font-style: "+e.fontStyle+"; ";if(e.fontVariant)l+="font-variant: "+e.fontVariant+"; ";if(e.fontWeight)l+="font-weight: "+e.fontWeight+"; "}for(i=0,a=xx.length;i<a;++i){o=xx[i];u=_x[o];s=e[o];if(s==null){if(u==="fill"){l+="fill: none; "}}else if(s==="transparent"&&(u==="fill"||u==="stroke")){l+=u+": none; "}else{if(qv(s)){s=Wv(s,r.gradient,"")}l+=u+": "+s+"; "}}return l?'style="'+l.trim()+'"':null}function Hx(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var Gx=new Lv;function $x(e){var t=e.clip;if(er(t)){t(By(Gx.clear()))}else if(t){Gx.set(0,0,e.group.width,e.group.height)}else return;e.bounds.intersect(Gx)}function Yx(e){zv.call(this,null,e)}var Vx=or(Yx,zv);Vx.transform=function(e,t){var n=t.dataflow,r=e.mark,i=r.marktype,a=z_[i],o=a.bound,u=r.bounds,s;if(a.nested){if(r.items.length)n.dirty(r.items[0]);u=Xx(r,o);r.items.forEach((function(e){e.bounds.clear().union(u)}))}else if(i===Op||e.modified()){t.visit(t.MOD,(function(e){n.dirty(e)}));u.clear();r.items.forEach((function(e){u.union(Xx(e,o))}));switch(r.role){case Sp:case Tp:case Dp:t.reflow()}}else{s=t.changed(t.REM);t.visit(t.ADD,(function(e){u.union(Xx(e,o))}));t.visit(t.MOD,(function(e){s=s||u.alignsWith(e.bounds);n.dirty(e);u.union(Xx(e,o))}));if(s){u.clear();r.items.forEach((function(e){u.union(e.bounds)}))}}$x(r);return t.modifies("bounds")};function Xx(e,t,n){return t(e.bounds.clear(),e,n)}var Jx=":vega_identifier:";function Zx(e){zv.call(this,0,e)}Zx.Definition={type:"Identifier",metadata:{modifies:true},params:[{name:"as",type:"string",required:true}]};var Qx=or(Zx,zv);Qx.transform=function(e,t){var n=Kx(t.dataflow),r=n.value,i=e.as;t.visit(t.ADD,(function(e){if(!e[i])e[i]=++r}));n.set(this.value=r);return t};function Kx(e){var t=e._signals[Jx];if(!t){e._signals[Jx]=t=e.add(0)}return t}function ew(e){zv.call(this,null,e)}var tw=or(ew,zv);tw.transform=function(e,t){var n=this.value;if(!n){n=t.dataflow.scenegraph().mark(e.markdef,nw(e),e.index);n.group.context=e.context;if(!e.context.group)e.context.group=n.group;n.source=this.source;n.clip=e.clip;n.interactive=e.interactive;this.value=n}var r=n.marktype===Op?$v:Gv;t.visit(t.ADD,(function(e){r.call(e,n)}));if(e.modified("clip")||e.modified("interactive")){n.clip=e.clip;n.interactive=!!e.interactive;n.zdirty=true;t.reflow()}n.items=t.source;return t};function nw(e){var t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function rw(e){zv.call(this,null,e)}var iw=or(rw,zv);var aw={parity:function(e){return e.filter((function(e,t){return t%2?e.opacity=0:1}))},greedy:function(e,t){var n;return e.filter((function(e,r){if(!r||!ow(n.bounds,e.bounds,t)){n=e;return 1}else{return e.opacity=0}}))}};function ow(e,t,n){return n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2)}function uw(e,t){for(var n=1,r=e.length,i=e[0].bounds,a;n<r;i=a,++n){if(ow(i,a=e[n].bounds,t))return true}}function sw(e){var t=e.bounds;return t.width()>1&&t.height()>1}function lw(e,t,n){var r=e.range(),i=new Lv;if(t===pp||t===mp){i.set(r[0],-Infinity,r[1],+Infinity)}else{i.set(-Infinity,r[0],+Infinity,r[1])}i.expand(n||1);return function(e){return i.encloses(e.bounds)}}function fw(e){e.forEach((function(e){return e.opacity=1}));return e}function cw(e,t){return e.reflow(t.modified()).modifies("opacity")}iw.transform=function(e,t){var n=aw[e.method]||aw.parity,r=t.materialize(t.SOURCE).source,i=e.separation||0,a,o,u;if(!r||!r.length)return;if(!e.method){if(e.modified("method")){fw(r);t=cw(t,e)}return t}if(e.sort){r=r.slice().sort(e.sort)}r=r.filter(sw);a=fw(r);t=cw(t,e);if(a.length>=3&&uw(a,i)){do{a=n(a,i)}while(a.length>=3&&uw(a,i));if(a.length<3&&!Zn(r).opacity){if(a.length>1)Zn(a).opacity=0;Zn(r).opacity=1}}if(e.boundScale&&e.boundTolerance>=0){o=lw(e.boundScale,e.boundOrient,+e.boundTolerance);r.forEach((function(e){if(!o(e))e.opacity=0}))}u=a[0].mark.bounds.clear();r.forEach((function(e){if(e.opacity)u.union(e.bounds)}));return t};function hw(e){zv.call(this,null,e)}var dw=or(hw,zv);dw.transform=function(e,t){var n=t.dataflow;t.visit(t.ALL,(function(e){n.dirty(e)}));if(t.fields&&t.fields["zindex"]){var r=t.source&&t.source[0];if(r)r.mark.zdirty=true}};var pw=new Lv;function vw(e,t,n){return e[t]===n?0:(e[t]=n,1)}function gw(e){var t=e.items[0].datum.orient;return t===vp||t===gp}function mw(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function yw(e,t,n,r){var i=t.items[0],a=i.datum,o=a.orient,u=a.translate!=null?a.translate:.5,s=mw(a),l=i.range,f=i.offset,c=i.position,h=i.minExtent,d=i.maxExtent,p=a.title&&i.items[s[2]].items[0],v=i.titlePadding,g=i.bounds,m=p&&__(p),y=0,b=0,_,x;pw.clear().union(g);g.clear();if((_=s[0])>-1)g.union(i.items[_].bounds);if((_=s[1])>-1)g.union(i.items[_].bounds);switch(o){case pp:y=c||0;b=-f;x=Math.max(h,Math.min(d,-g.y1));if(p)x=bw(e,p,x,v,m,0,-1,g);g.add(0,-x).add(l,0);break;case vp:y=-f;b=c||0;x=Math.max(h,Math.min(d,-g.x1));if(p)x=bw(e,p,x,v,m,1,-1,g);g.add(-x,0).add(0,l);break;case gp:y=n+f;b=c||0;x=Math.max(h,Math.min(d,g.x2));if(p)x=bw(e,p,x,v,m,1,1,g);g.add(0,0).add(x,l);break;case mp:y=c||0;b=r+f;x=Math.max(h,Math.min(d,g.y2));if(p)x=bw(e,p,x,v,0,0,1,g);g.add(0,0).add(l,x);break;default:y=i.x;b=i.y}zy(g.translate(y,b),i);if(vw(i,"x",y+u)|vw(i,"y",b+u)){i.bounds=pw;e.dirty(i);i.bounds=g;e.dirty(i)}return i.mark.bounds.clear().union(g)}function bw(e,t,n,r,i,a,o,u){var s=t.bounds,l=0,f=0;if(t.auto){e.dirty(t);n+=r;a?l=(t.x||0)-(t.x=o*(n+i)):f=(t.y||0)-(t.y=o*(n+i));t.mark.bounds.clear().union(s.translate(-l,-f));e.dirty(t);if(a){u.add(0,s.y1).add(0,s.y2);n+=s.width()}else{u.add(s.x1,0).add(s.x2,0);n+=s.height()}}else{u.union(s)}return n}function _w(e){var t,n,r,i,a;var o=e.items,u=o.length,s=0,l,f;var c={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;s<u;++s){l=o[s];f=l.items;if(l.marktype===Op){switch(l.role){case Sp:case Tp:case Dp:break;case Np:(t=c.rowheaders).push.apply(t,f);break;case jp:(n=c.rowfooters).push.apply(n,f);break;case zp:(r=c.colheaders).push.apply(r,f);break;case Pp:(i=c.colfooters).push.apply(i,f);break;case Rp:c.rowtitle=f[0];break;case Lp:c.coltitle=f[0];break;default:(a=c.marks).push.apply(a,f)}}}return c}function xw(e){return(new Lv).set(0,0,e.width||0,e.height||0)}function ww(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function kw(e,t,n){var r=Pn(e)?e[t]:e;return r!=null?r:n!==undefined?n:0}function Aw(e){return e<0?Math.ceil(-e):0}function Ew(e,t,n){var r=!n.nodirty,i=n.bounds===Vp?xw:ww,a=pw.set(0,0,0,0),o=kw(n.align,Xp),u=kw(n.align,Jp),s=kw(n.padding,Xp),l=kw(n.padding,Jp),f=n.columns||t.length,c=f<0?1:Math.ceil(t.length/f),h=t.length,d=Array(h),p=Array(f),v=0,g=Array(h),m=Array(c),y=0,b=Array(h),_=Array(h),x=Array(h),w,k,A,E,M,O,S,D,C,F,T;for(k=0;k<f;++k)p[k]=0;for(k=0;k<c;++k)m[k]=0;for(k=0;k<h;++k){O=t[k];M=x[k]=i(O);O.x=O.x||0;b[k]=0;O.y=O.y||0;_[k]=0;A=k%f;E=~~(k/f);v=Math.max(v,S=Math.ceil(M.x2));y=Math.max(y,D=Math.ceil(M.y2));p[A]=Math.max(p[A],S);m[E]=Math.max(m[E],D);d[k]=s+Aw(M.x1);g[k]=l+Aw(M.y1);if(r)e.dirty(t[k])}for(k=0;k<h;++k){if(k%f===0)d[k]=0;if(k<f)g[k]=0}if(o===Yp){for(A=1;A<f;++A){for(T=0,k=A;k<h;k+=f){if(T<d[k])T=d[k]}for(k=A;k<h;k+=f){d[k]=T+p[A-1]}}}else if(o===$p){for(T=0,k=0;k<h;++k){if(k%f&&T<d[k])T=d[k]}for(k=0;k<h;++k){if(k%f)d[k]=T+v}}else{for(o=false,A=1;A<f;++A){for(k=A;k<h;k+=f){d[k]+=p[A-1]}}}if(u===Yp){for(E=1;E<c;++E){for(T=0,k=E*f,w=k+f;k<w;++k){if(T<g[k])T=g[k]}for(k=E*f;k<w;++k){g[k]=T+m[E-1]}}}else if(u===$p){for(T=0,k=f;k<h;++k){if(T<g[k])T=g[k]}for(k=f;k<h;++k){g[k]=T+y}}else{for(u=false,E=1;E<c;++E){for(k=E*f,w=k+f;k<w;++k){g[k]+=m[E-1]}}}for(C=0,k=0;k<h;++k){C=d[k]+(k%f?C:0);b[k]+=C-t[k].x}for(A=0;A<f;++A){for(F=0,k=A;k<h;k+=f){F+=g[k];_[k]+=F-t[k].y}}if(o&&kw(n.center,Xp)&&c>1){for(k=0;k<h;++k){M=o===$p?v:p[k%f];C=M-x[k].x2-t[k].x-b[k];if(C>0)b[k]+=C/2}}if(u&&kw(n.center,Jp)&&f!==1){for(k=0;k<h;++k){M=u===$p?y:m[~~(k/f)];F=M-x[k].y2-t[k].y-_[k];if(F>0)_[k]+=F/2}}for(k=0;k<h;++k){a.union(x[k].translate(b[k],_[k]))}C=kw(n.anchor,Ep);F=kw(n.anchor,Mp);switch(kw(n.anchor,Xp)){case Ap:C-=a.width();break;case kp:C-=a.width()/2}switch(kw(n.anchor,Jp)){case Ap:F-=a.height();break;case kp:F-=a.height()/2}C=Math.round(C);F=Math.round(F);a.clear();for(k=0;k<h;++k){t[k].mark.bounds.clear()}for(k=0;k<h;++k){O=t[k];O.x+=b[k]+=C;O.y+=_[k]+=F;a.union(O.mark.bounds.union(O.bounds.translate(b[k],_[k])));if(r)e.dirty(O)}return a}function Mw(e,t,n){var r=_w(t),i=r.marks,a=n.bounds===Vp?Ow:Sw,o=n.offset,u=n.columns||i.length,s=u<0?1:Math.ceil(i.length/u),l=s*u,f,c,h,d,p,v,g;var m=Ew(e,i,n);if(r.rowheaders){v=kw(n.headerBand,Jp,null);f=Fw(e,r.rowheaders,i,u,s,-kw(o,"rowHeader"),Dw,0,a,"x1",0,u,1,v)}if(r.colheaders){v=kw(n.headerBand,Xp,null);c=Fw(e,r.colheaders,i,u,u,-kw(o,"columnHeader"),Dw,1,a,"y1",0,1,u,v)}if(r.rowfooters){v=kw(n.footerBand,Jp,null);h=Fw(e,r.rowfooters,i,u,s,kw(o,"rowFooter"),Cw,0,a,"x2",u-1,u,1,v)}if(r.colfooters){v=kw(n.footerBand,Xp,null);d=Fw(e,r.colfooters,i,u,u,kw(o,"columnFooter"),Cw,1,a,"y2",l-u,1,u,v)}if(r.rowtitle){p=kw(n.titleAnchor,Jp);g=kw(o,"rowTitle");g=p===Ap?h+g:f-g;v=kw(n.titleBand,Jp,.5);Tw(e,r.rowtitle,g,0,m,v)}if(r.coltitle){p=kw(n.titleAnchor,Xp);g=kw(o,"columnTitle");g=p===Ap?d+g:c-g;v=kw(n.titleBand,Xp,.5);Tw(e,r.coltitle,g,1,m,v)}}function Ow(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):undefined}function Sw(e,t){return e.bounds[t]}function Dw(e,t){return Math.floor(Math.min(e,t))}function Cw(e,t){return Math.ceil(Math.max(e,t))}function Fw(e,t,n,r,i,a,o,u,s,l,f,c,h,d){var p=n.length,v=0,g=0,m,y,b,_,x,w,k,A,E;if(!p)return v;for(m=f;m<p;m+=c){if(n[m])v=o(v,s(n[m],l))}if(!t.length)return v;if(t.length>i){e.warn("Grid headers exceed limit: "+i);t=t.slice(0,i)}v+=a;for(y=0,_=t.length;y<_;++y){e.dirty(t[y]);t[y].mark.bounds.clear()}for(m=f,y=0,_=t.length;y<_;++y,m+=c){w=t[y];x=w.mark.bounds;for(b=m;b>=0&&(k=n[b])==null;b-=h);if(u){A=d==null?k.x:Math.round(k.bounds.x1+d*k.bounds.width());E=v}else{A=v;E=d==null?k.y:Math.round(k.bounds.y1+d*k.bounds.height())}x.union(w.bounds.translate(A-(w.x||0),E-(w.y||0)));w.x=A;w.y=E;e.dirty(w);g=o(g,x[l])}return g}function Tw(e,t,n,r,i,a){if(!t)return;e.dirty(t);var o=n,u=n;r?o=Math.round(i.x1+a*i.width()):u=Math.round(i.y1+a*i.height());t.bounds.translate(o-(t.x||0),u-(t.y||0));t.mark.bounds.clear().union(t.bounds);t.x=o;t.y=u;e.dirty(t)}function Nw(e,t){var n=e[t]||{};return function(t,r){return n[t]!=null?n[t]:e[t]!=null?e[t]:r}}function jw(e,t){var n=-Infinity;e.forEach((function(e){if(e.offset!=null)n=Math.max(n,e.offset)}));return n>-Infinity?n:t}function Rw(e,t,n,r,i,a,o){var u=Nw(n,t),s=jw(e,u("offset",0)),l=u("anchor",wp),f=l===Ap?1:l===kp?.5:0;var c={align:Yp,bounds:u("bounds",Vp),columns:u("direction")==="vertical"?1:e.length,padding:u("margin",8),center:u("center"),nodirty:true};switch(t){case vp:c.anchor={x:Math.floor(r.x1)-s,column:Ap,y:f*(o||r.height()+2*r.y1),row:l};break;case gp:c.anchor={x:Math.ceil(r.x2)+s,y:f*(o||r.height()+2*r.y1),row:l};break;case pp:c.anchor={y:Math.floor(i.y1)-s,row:Ap,x:f*(a||i.width()+2*i.x1),column:l};break;case mp:c.anchor={y:Math.ceil(i.y2)+s,x:f*(a||i.width()+2*i.x1),column:l};break;case yp:c.anchor={x:s,y:s};break;case bp:c.anchor={x:a-s,y:s,column:Ap};break;case _p:c.anchor={x:s,y:o-s,row:Ap};break;case xp:c.anchor={x:a-s,y:o-s,column:Ap,row:Ap};break}return c}function zw(e,t){var n=t.items[0],r=n.datum,i=n.orient,a=n.bounds,o=n.x,u=n.y,s,l;n._bounds?n._bounds.clear().union(a):n._bounds=a.clone();a.clear();Lw(e,n,n.items[0].items[0]);a=Pw(n,a);s=2*n.padding;l=2*n.padding;if(!a.empty()){s=Math.ceil(a.width()+s);l=Math.ceil(a.height()+l)}if(r.type===Bp){Uw(n.items[0].items[0].items[0].items)}if(i!==Gp){n.x=o=0;n.y=u=0}n.width=s;n.height=l;zy(a.set(o,u,o+s,u+l),n);n.mark.bounds.clear().union(a);return n}function Pw(e,t){e.items.forEach((function(e){return t.union(e.bounds)}));t.x1=e.padding;t.y1=e.padding;return t}function Lw(e,t,n){var r=t.padding,i=r-n.x,a=r-n.y;if(!t.datum.title){if(i||a)Bw(e,n,i,a)}else{var o=t.items[1].items[0],u=o.anchor,s=t.titlePadding||0,l=r-o.x,f=r-o.y;switch(o.orient){case vp:i+=Math.ceil(o.bounds.width())+s;break;case gp:case mp:break;default:a+=o.bounds.height()+s}if(i||a)Bw(e,n,i,a);switch(o.orient){case vp:f+=Iw(t,n,o,u,1,1);break;case gp:l+=Iw(t,n,o,Ap,0,0)+s;f+=Iw(t,n,o,u,1,1);break;case mp:l+=Iw(t,n,o,u,0,0);f+=Iw(t,n,o,Ap,-1,0,1)+s;break;default:l+=Iw(t,n,o,u,0,0)}if(l||f)Bw(e,o,l,f);if((l=Math.round(o.bounds.x1-r))<0){Bw(e,n,-l,0);Bw(e,o,-l,0)}}}function Iw(e,t,n,r,i,a,o){var u=e.datum.type!=="symbol",s=n.datum.vgrad,l=u&&(a||!s)&&!o?t.items[0]:t,f=l.bounds[i?"y2":"x2"]-e.padding,c=s&&a?f:0,h=s&&a?0:f,d=i<=0?0:__(n);return Math.round(r===wp?c:r===Ap?h-d:.5*(f-d))}function Bw(e,t,n,r){t.x+=n;t.y+=r;t.bounds.translate(n,r);t.mark.bounds.translate(n,r);e.dirty(t)}function Uw(e){var t=e.reduce((function(e,t){e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0);return e}),{});e.forEach((function(e){e.width=t[e.column];e.height=e.bounds.y2-e.y}))}function qw(e,t,n,r,i){var a=t.items[0],o=a.frame,u=a.orient,s=a.anchor,l=a.offset,f=a.padding,c=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],d=u===vp||u===gp?r:n,p=0,v=0,g=0,m=0,y=0,b;if(o!==Op){u===vp?(p=i.y2,d=i.y1):u===gp?(p=i.y1,d=i.y2):(p=i.x1,d=i.x2)}else if(u===vp){p=r,d=0}b=s===wp?p:s===Ap?d:(p+d)/2;if(h&&h.text){switch(u){case pp:case mp:y=c.bounds.height()+f;break;case vp:m=c.bounds.width()+f;break;case gp:m=-c.bounds.width()-f;break}pw.clear().union(h.bounds);pw.translate(m-(h.x||0),y-(h.y||0));if(vw(h,"x",m)|vw(h,"y",y)){e.dirty(h);h.bounds.clear().union(pw);h.mark.bounds.clear().union(pw);e.dirty(h)}pw.clear().union(h.bounds)}else{pw.clear()}pw.union(c.bounds);switch(u){case pp:v=b;g=i.y1-pw.height()-l;break;case vp:v=i.x1-pw.width()-l;g=b;break;case gp:v=i.x2+pw.width()+l;g=b;break;case mp:v=b;g=i.y2+l;break;default:v=a.x;g=a.y}if(vw(a,"x",v)|vw(a,"y",g)){pw.translate(v,g);e.dirty(a);a.bounds.clear().union(pw);t.bounds.clear().union(pw);e.dirty(a)}return a.bounds}function Ww(e){zv.call(this,null,e)}var Hw=or(Ww,zv);Hw.transform=function(e,t){var n=t.dataflow;e.mark.items.forEach((function(t){if(e.layout)Mw(n,t,e.layout);Gw(n,t,e)}));if(e.modified())t.reflow();return t};function Gw(e,t,n){var r=t.items,i=Math.max(0,t.width||0),a=Math.max(0,t.height||0),o=(new Lv).set(0,0,i,a),u=o.clone(),s=o.clone(),l=[],f,c,h,d,p,v;for(p=0,v=r.length;p<v;++p){c=r[p];switch(c.role){case Sp:d=gw(c)?u:s;d.union(yw(e,c,i,a));break;case Dp:f=c;break;case Tp:l.push(zw(e,c));break;case Cp:case Fp:case Np:case jp:case Rp:case zp:case Pp:case Lp:u.union(c.bounds);s.union(c.bounds);break;default:o.union(c.bounds)}}if(l.length){var g={};l.forEach((function(e){h=e.orient||gp;if(h!==Gp)(g[h]||(g[h]=[])).push(e)}));for(var m in g){var y=g[m];Ew(e,y,Rw(y,m,n.legends,u,s,i,a))}l.forEach((function(t){var r=t.bounds;if(!r.equals(t._bounds)){t.bounds=t._bounds;e.dirty(t);t.bounds=r;e.dirty(t)}if(n.autosize&&n.autosize.type===Up){switch(t.orient){case vp:case gp:o.add(r.x1,0).add(r.x2,0);break;case pp:case mp:o.add(0,r.y1).add(0,r.y2)}}else{o.union(r)}}))}o.union(u).union(s);if(f){o.union(qw(e,f,i,a,o))}if(t.clip){o.set(0,0,t.width||0,t.height||0)}$w(e,t,o,n)}function $w(e,t,n,r){var i=r.autosize||{},a=i.type,o=e._width,u=e._height,s=e.padding();if(e._autosize<1||!a)return;var l=Math.max(0,t.width||0),f=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,t.height||0),d=Math.max(0,Math.ceil(-n.y1)),p=Math.max(0,Math.ceil(n.y2-h));if(i.contains===Ip){o-=s.left+s.right;u-=s.top+s.bottom}if(a===Gp){f=0;d=0;l=o;h=u}else if(a===Up){l=Math.max(0,o-f-c);h=Math.max(0,u-d-p)}else if(a===qp){l=Math.max(0,o-f-c);u=h+d+p}else if(a===Wp){o=l+f+c;h=Math.max(0,u-d-p)}else if(a===Hp){o=l+f+c;u=h+d+p}e._resizeView(o,u,l,h,[f,d],i.resize)}var Yw=Object.freeze({__proto__:null,bound:Yx,identifier:Zx,mark:ew,overlap:rw,render:hw,viewlayout:Ww});function Vw(e,t,n){var r=e-t+n*2;return e?r>0?r:1:0}var Xw="identity";var Jw="linear";var Zw="log";var Qw="pow";var Kw="sqrt";var ek="symlog";var tk="time";var nk="utc";var rk="sequential";var ik="diverging";var ak="quantile";var ok="quantize";var uk="threshold";var sk="ordinal";var lk="point";var fk="band";var ck="bin-ordinal";var hk="continuous";var dk="discrete";var pk="discretizing";var vk="interpolating";var gk="temporal";function mk(e,t,n){e.fields=t||[];e.fname=n;return e}function yk(e){throw Error(e)}function bk(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)yk("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)yk("Access path missing closing bracket: "+e);if(n)yk("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var _k=Array.isArray;function xk(e){return e===Object(e)}function wk(e){return typeof e==="string"}function kk(e){return _k(e)?"["+e.map(kk)+"]":xk(e)||wk(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Ak(e,t){var n=bk(e),r="return _["+n.map(kk).join("][")+"];";return mk(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var Ek=[];var Mk=Ak("id");var Ok=mk((function(e){return e}),Ek,"identity");var Sk=mk((function(){return 0}),Ek,"zero");var Dk=mk((function(){return 1}),Ek,"one");var Ck=mk((function(){return true}),Ek,"true");var Fk=mk((function(){return false}),Ek,"false");function Tk(e){return e[e.length-1]}function Nk(e){return e!=null?_k(e)?e:[e]:[]}function jk(e){return typeof e==="function"}function Rk(e){return jk(e)?e:function(){return e}}var zk=Object.prototype.hasOwnProperty;function Pk(e,t){return zk.call(e,t)}function Lk(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=true;return t}function Ik(e){return function(t){var n=t[0],r=t[1],i;if(r<n){i=n;n=r;r=i}return[e.invert(n),e.invert(r)]}}function Bk(e){return function(t){var n=e.range(),r=t[0],i=t[1],a=-1,o,u,s,l;if(i<r){u=r;r=i;i=u}for(s=0,l=n.length;s<l;++s){if(n[s]>=r&&n[s]<=i){if(a<0)a=s;o=s}}if(a<0)return undefined;r=e.invertExtent(n[a]);i=e.invertExtent(n[o]);return[r[0]===undefined?r[1]:r[0],i[1]===undefined?i[0]:i[1]]}}function Uk(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function qk(e,t){switch(arguments.length){case 0:break;case 1:{if(typeof e==="function")this.interpolator(e);else this.range(e);break}default:{this.domain(e);if(typeof t==="function")this.interpolator(t);else this.range(t);break}}return this}var Wk=Symbol("implicit");function Hk(){var e=new Map,t=[],n=[],r=Wk;function i(i){var a=i+"",o=e.get(a);if(!o){if(r!==Wk)return r;e.set(a,o=t.push(i))}return n[(o-1)%n.length]}i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;for(var r=0,a=n;r<a.length;r++){var o=a[r];var u=o+"";if(e.has(u))continue;e.set(u,t.push(o))}return i};i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()};i.unknown=function(e){return arguments.length?(r=e,i):r};i.copy=function(){return Hk(t,n).unknown(r)};Uk.apply(i,arguments);return i}function Gk(e,t,n){e.prototype=t.prototype=n;n.constructor=e}function $k(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Yk(){}var Vk=.7;var Xk=1/Vk;var Jk="\\s*([+-]?\\d+)\\s*",Zk="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Qk="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kk=/^#([0-9a-f]{3,8})$/,eA=new RegExp("^rgb\\("+[Jk,Jk,Jk]+"\\)$"),tA=new RegExp("^rgb\\("+[Qk,Qk,Qk]+"\\)$"),nA=new RegExp("^rgba\\("+[Jk,Jk,Jk,Zk]+"\\)$"),rA=new RegExp("^rgba\\("+[Qk,Qk,Qk,Zk]+"\\)$"),iA=new RegExp("^hsl\\("+[Zk,Qk,Qk]+"\\)$"),aA=new RegExp("^hsla\\("+[Zk,Qk,Qk,Zk]+"\\)$");var oA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Gk(Yk,fA,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:uA,formatHex:uA,formatHsl:sA,formatRgb:lA,toString:lA});function uA(){return this.rgb().formatHex()}function sA(){return _A(this).formatHsl()}function lA(){return this.rgb().formatRgb()}function fA(e){var t,n;e=(e+"").trim().toLowerCase();return(t=Kk.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?cA(t):n===3?new vA(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?new vA(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?new vA(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=eA.exec(e))?new vA(t[1],t[2],t[3],1):(t=tA.exec(e))?new vA(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=nA.exec(e))?hA(t[1],t[2],t[3],t[4]):(t=rA.exec(e))?hA(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=iA.exec(e))?bA(t[1],t[2]/100,t[3]/100,1):(t=aA.exec(e))?bA(t[1],t[2]/100,t[3]/100,t[4]):oA.hasOwnProperty(e)?cA(oA[e]):e==="transparent"?new vA(NaN,NaN,NaN,0):null}function cA(e){return new vA(e>>16&255,e>>8&255,e&255,1)}function hA(e,t,n,r){if(r<=0)e=t=n=NaN;return new vA(e,t,n,r)}function dA(e){if(!(e instanceof Yk))e=fA(e);if(!e)return new vA;e=e.rgb();return new vA(e.r,e.g,e.b,e.opacity)}function pA(e,t,n,r){return arguments.length===1?dA(e):new vA(e,t,n,r==null?1:r)}function vA(e,t,n,r){this.r=+e;this.g=+t;this.b=+n;this.opacity=+r}Gk(vA,pA,$k(Yk,{brighter:function(e){e=e==null?Xk:Math.pow(Xk,e);return new vA(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){e=e==null?Vk:Math.pow(Vk,e);return new vA(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&(-.5<=this.g&&this.g<255.5)&&(-.5<=this.b&&this.b<255.5)&&(0<=this.opacity&&this.opacity<=1)},hex:gA,formatHex:gA,formatRgb:mA,toString:mA}));function gA(){return"#"+yA(this.r)+yA(this.g)+yA(this.b)}function mA(){var e=this.opacity;e=isNaN(e)?1:Math.max(0,Math.min(1,e));return(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function yA(e){e=Math.max(0,Math.min(255,Math.round(e)||0));return(e<16?"0":"")+e.toString(16)}function bA(e,t,n,r){if(r<=0)e=t=n=NaN;else if(n<=0||n>=1)e=t=NaN;else if(t<=0)e=NaN;return new wA(e,t,n,r)}function _A(e){if(e instanceof wA)return new wA(e.h,e.s,e.l,e.opacity);if(!(e instanceof Yk))e=fA(e);if(!e)return new wA;if(e instanceof wA)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,u=a-i,s=(a+i)/2;if(u){if(t===a)o=(n-r)/u+(n<r)*6;else if(n===a)o=(r-t)/u+2;else o=(t-n)/u+4;u/=s<.5?a+i:2-a-i;o*=60}else{u=s>0&&s<1?0:o}return new wA(o,u,s,e.opacity)}function xA(e,t,n,r){return arguments.length===1?_A(e):new wA(e,t,n,r==null?1:r)}function wA(e,t,n,r){this.h=+e;this.s=+t;this.l=+n;this.opacity=+r}Gk(wA,xA,$k(Yk,{brighter:function(e){e=e==null?Xk:Math.pow(Xk,e);return new wA(this.h,this.s,this.l*e,this.opacity)},darker:function(e){e=e==null?Vk:Math.pow(Vk,e);return new wA(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new vA(kA(e>=240?e-240:e+120,i,r),kA(e,i,r),kA(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&(0<=this.l&&this.l<=1)&&(0<=this.opacity&&this.opacity<=1)},formatHsl:function(){var e=this.opacity;e=isNaN(e)?1:Math.max(0,Math.min(1,e));return(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function kA(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var AA=Math.PI/180;var EA=180/Math.PI;var MA=18,OA=.96422,SA=1,DA=.82521,CA=4/29,FA=6/29,TA=3*FA*FA,NA=FA*FA*FA;function jA(e){if(e instanceof zA)return new zA(e.l,e.a,e.b,e.opacity);if(e instanceof WA)return HA(e);if(!(e instanceof vA))e=dA(e);var t=BA(e.r),n=BA(e.g),r=BA(e.b),i=PA((.2225045*t+.7168786*n+.0606169*r)/SA),a,o;if(t===n&&n===r)a=o=i;else{a=PA((.4360747*t+.3850649*n+.1430804*r)/OA);o=PA((.0139322*t+.0971045*n+.7141733*r)/DA)}return new zA(116*i-16,500*(a-i),200*(i-o),e.opacity)}function RA(e,t,n,r){return arguments.length===1?jA(e):new zA(e,t,n,r==null?1:r)}function zA(e,t,n,r){this.l=+e;this.a=+t;this.b=+n;this.opacity=+r}Gk(zA,RA,$k(Yk,{brighter:function(e){return new zA(this.l+MA*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new zA(this.l-MA*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;t=OA*LA(t);e=SA*LA(e);n=DA*LA(n);return new vA(IA(3.1338561*t-1.6168667*e-.4906146*n),IA(-.9787684*t+1.9161415*e+.033454*n),IA(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function PA(e){return e>NA?Math.pow(e,1/3):e/TA+CA}function LA(e){return e>FA?e*e*e:TA*(e-CA)}function IA(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function BA(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function UA(e){if(e instanceof WA)return new WA(e.h,e.c,e.l,e.opacity);if(!(e instanceof zA))e=jA(e);if(e.a===0&&e.b===0)return new WA(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*EA;return new WA(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function qA(e,t,n,r){return arguments.length===1?UA(e):new WA(e,t,n,r==null?1:r)}function WA(e,t,n,r){this.h=+e;this.c=+t;this.l=+n;this.opacity=+r}function HA(e){if(isNaN(e.h))return new zA(e.l,0,0,e.opacity);var t=e.h*AA;return new zA(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Gk(WA,qA,$k(Yk,{brighter:function(e){return new WA(this.h,this.c,this.l+MA*(e==null?1:e),this.opacity)},darker:function(e){return new WA(this.h,this.c,this.l-MA*(e==null?1:e),this.opacity)},rgb:function(){return HA(this).rgb()}}));var GA=-.14861,$A=+1.78277,YA=-.29227,VA=-.90649,XA=+1.97294,JA=XA*VA,ZA=XA*$A,QA=$A*YA-VA*GA;function KA(e){if(e instanceof tE)return new tE(e.h,e.s,e.l,e.opacity);if(!(e instanceof vA))e=dA(e);var t=e.r/255,n=e.g/255,r=e.b/255,i=(QA*r+JA*t-ZA*n)/(QA+JA-ZA),a=r-i,o=(XA*(n-i)-YA*a)/VA,u=Math.sqrt(o*o+a*a)/(XA*i*(1-i)),s=u?Math.atan2(o,a)*EA-120:NaN;return new tE(s<0?s+360:s,u,i,e.opacity)}function eE(e,t,n,r){return arguments.length===1?KA(e):new tE(e,t,n,r==null?1:r)}function tE(e,t,n,r){this.h=+e;this.s=+t;this.l=+n;this.opacity=+r}Gk(tE,eE,$k(Yk,{brighter:function(e){e=e==null?Xk:Math.pow(Xk,e);return new tE(this.h,this.s,this.l*e,this.opacity)},darker:function(e){e=e==null?Vk:Math.pow(Vk,e);return new tE(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*AA,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new vA(255*(t+n*(GA*r+$A*i)),255*(t+n*(YA*r+VA*i)),255*(t+n*(XA*r)),this.opacity)}}));function nE(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}function rE(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,u=r<t-1?e[r+2]:2*a-i;return nE((n-r/t)*t,o,i,a,u)}}function iE(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],u=e[(r+2)%t];return nE((n-r/t)*t,i,a,o,u)}}function aE(e){return function(){return e}}function oE(e,t){return function(n){return e+n*t}}function uE(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function sE(e,t){var n=t-e;return n?oE(e,n>180||n<-180?n-360*Math.round(n/360):n):aE(isNaN(e)?t:e)}function lE(e){return(e=+e)===1?fE:function(t,n){return n-t?uE(t,n,e):aE(isNaN(t)?n:t)}}function fE(e,t){var n=t-e;return n?oE(e,n):aE(isNaN(e)?t:e)}var cE=function e(t){var n=lE(t);function r(e,t){var r=n((e=pA(e)).r,(t=pA(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=fE(e.opacity,t.opacity);return function(t){e.r=r(t);e.g=i(t);e.b=a(t);e.opacity=o(t);return e+""}}r.gamma=e;return r}(1);function hE(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),a=new Array(n),o,u;for(o=0;o<n;++o){u=pA(t[o]);r[o]=u.r||0;i[o]=u.g||0;a[o]=u.b||0}r=e(r);i=e(i);a=e(a);u.opacity=1;return function(e){u.r=r(e);u.g=i(e);u.b=a(e);return u+""}}}var dE=hE(rE);var pE=hE(iE);function vE(e,t){if(!t)t=[];var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function gE(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function mE(e,t){return(gE(t)?vE:yE)(e,t)}function yE(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=OE(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(e){for(o=0;o<r;++o)a[o]=i[o](e);return a}}function bE(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function _E(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function xE(e,t){var n={},r={},i;if(e===null||typeof e!=="object")e={};if(t===null||typeof t!=="object")t={};for(i in t){if(i in e){n[i]=OE(e[i],t[i])}else{r[i]=t[i]}}return function(e){for(i in n)r[i]=n[i](e);return r}}var wE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,kE=new RegExp(wE.source,"g");function AE(e){return function(){return e}}function EE(e){return function(t){return e(t)+""}}function ME(e,t){var n=wE.lastIndex=kE.lastIndex=0,r,i,a,o=-1,u=[],s=[];e=e+"",t=t+"";while((r=wE.exec(e))&&(i=kE.exec(t))){if((a=i.index)>n){a=t.slice(n,a);if(u[o])u[o]+=a;else u[++o]=a}if((r=r[0])===(i=i[0])){if(u[o])u[o]+=i;else u[++o]=i}else{u[++o]=null;s.push({i:o,x:_E(r,i)})}n=kE.lastIndex}if(n<t.length){a=t.slice(n);if(u[o])u[o]+=a;else u[++o]=a}return u.length<2?s[0]?EE(s[0].x):AE(t):(t=s.length,function(e){for(var n=0,r;n<t;++n)u[(r=s[n]).i]=r.x(e);return u.join("")})}function OE(e,t){var n=typeof t,r;return t==null||n==="boolean"?aE(t):(n==="number"?_E:n==="string"?(r=fA(t))?(t=r,cE):ME:t instanceof fA?cE:t instanceof Date?bE:gE(t)?vE:Array.isArray(t)?yE:typeof t.valueOf!=="function"&&typeof t.toString!=="function"||isNaN(t)?xE:_E)(e,t)}function SE(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function DE(e,t){var n=sE(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}function CE(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var FE=180/Math.PI;var TE={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function NE(e,t,n,r,i,a){var o,u,s;if(o=Math.sqrt(e*e+t*t))e/=o,t/=o;if(s=e*n+t*r)n-=e*s,r-=t*s;if(u=Math.sqrt(n*n+r*r))n/=u,r/=u,s/=u;if(e*r<t*n)e=-e,t=-t,s=-s,o=-o;return{translateX:i,translateY:a,rotate:Math.atan2(t,e)*FE,skewX:Math.atan(s)*FE,scaleX:o,scaleY:u}}var jE,RE,zE,PE;function LE(e){if(e==="none")return TE;if(!jE)jE=document.createElement("DIV"),RE=document.documentElement,zE=document.defaultView;jE.style.transform=e;e=zE.getComputedStyle(RE.appendChild(jE),null).getPropertyValue("transform");RE.removeChild(jE);e=e.slice(7,-1).split(",");return NE(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5])}function IE(e){if(e==null)return TE;if(!PE)PE=document.createElementNS("http://www.w3.org/2000/svg","g");PE.setAttribute("transform",e);if(!(e=PE.transform.baseVal.consolidate()))return TE;e=e.matrix;return NE(e.a,e.b,e.c,e.d,e.e,e.f)}function BE(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}function a(e,r,i,a,o,u){if(e!==i||r!==a){var s=o.push("translate(",null,t,null,n);u.push({i:s-4,x:_E(e,i)},{i:s-2,x:_E(r,a)})}else if(i||a){o.push("translate("+i+t+a+n)}}function o(e,t,n,a){if(e!==t){if(e-t>180)t+=360;else if(t-e>180)e+=360;a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:_E(e,t)})}else if(t){n.push(i(n)+"rotate("+t+r)}}function u(e,t,n,a){if(e!==t){a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:_E(e,t)})}else if(t){n.push(i(n)+"skewX("+t+r)}}function s(e,t,n,r,a,o){if(e!==n||t!==r){var u=a.push(i(a)+"scale(",null,",",null,")");o.push({i:u-4,x:_E(e,n)},{i:u-2,x:_E(t,r)})}else if(n!==1||r!==1){a.push(i(a)+"scale("+n+","+r+")")}}return function(t,n){var r=[],i=[];t=e(t),n=e(n);a(t.translateX,t.translateY,n.translateX,n.translateY,r,i);o(t.rotate,n.rotate,r,i);u(t.skewX,n.skewX,r,i);s(t.scaleX,t.scaleY,n.scaleX,n.scaleY,r,i);t=n=null;return function(e){var t=-1,n=i.length,a;while(++t<n)r[(a=i[t]).i]=a.x(e);return r.join("")}}}var UE=BE(LE,"px, ","px)","deg)");var qE=BE(IE,", ",")",")");var WE=Math.SQRT2,HE=2,GE=4,$E=1e-12;function YE(e){return((e=Math.exp(e))+1/e)/2}function VE(e){return((e=Math.exp(e))-1/e)/2}function XE(e){return((e=Math.exp(2*e))-1)/(e+1)}function JE(e,t){var n=e[0],r=e[1],i=e[2],a=t[0],o=t[1],u=t[2],s=a-n,l=o-r,f=s*s+l*l,c,h;if(f<$E){h=Math.log(u/i)/WE;c=function(e){return[n+e*s,r+e*l,i*Math.exp(WE*e*h)]}}else{var d=Math.sqrt(f),p=(u*u-i*i+GE*f)/(2*i*HE*d),v=(u*u-i*i-GE*f)/(2*u*HE*d),g=Math.log(Math.sqrt(p*p+1)-p),m=Math.log(Math.sqrt(v*v+1)-v);h=(m-g)/WE;c=function(e){var t=e*h,a=YE(g),o=i/(HE*d)*(a*XE(WE*t+g)-VE(g));return[n+o*s,r+o*l,i*a/YE(WE*t+g)]}}c.duration=h*1e3;return c}function ZE(e){return function(t,n){var r=e((t=xA(t)).h,(n=xA(n)).h),i=fE(t.s,n.s),a=fE(t.l,n.l),o=fE(t.opacity,n.opacity);return function(e){t.h=r(e);t.s=i(e);t.l=a(e);t.opacity=o(e);return t+""}}}var QE=ZE(sE);var KE=ZE(fE);function eM(e,t){var n=fE((e=RA(e)).l,(t=RA(t)).l),r=fE(e.a,t.a),i=fE(e.b,t.b),a=fE(e.opacity,t.opacity);return function(t){e.l=n(t);e.a=r(t);e.b=i(t);e.opacity=a(t);return e+""}}function tM(e){return function(t,n){var r=e((t=qA(t)).h,(n=qA(n)).h),i=fE(t.c,n.c),a=fE(t.l,n.l),o=fE(t.opacity,n.opacity);return function(e){t.h=r(e);t.c=i(e);t.l=a(e);t.opacity=o(e);return t+""}}}var nM=tM(sE);var rM=tM(fE);function iM(e){return function t(n){n=+n;function r(t,r){var i=e((t=eE(t)).h,(r=eE(r)).h),a=fE(t.s,r.s),o=fE(t.l,r.l),u=fE(t.opacity,r.opacity);return function(e){t.h=i(e);t.s=a(e);t.l=o(Math.pow(e,n));t.opacity=u(e);return t+""}}r.gamma=t;return r}(1)}var aM=iM(sE);var oM=iM(fE);function uM(e,t){var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);while(n<r)a[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return a[t](e-t)}}function sM(e,t){var n=new Array(t);for(var r=0;r<t;++r)n[r]=e(r/(t-1));return n}var lM=Object.freeze({__proto__:null,interpolate:OE,interpolateArray:mE,interpolateBasis:rE,interpolateBasisClosed:iE,interpolateDate:bE,interpolateDiscrete:SE,interpolateHue:DE,interpolateNumber:_E,interpolateNumberArray:vE,interpolateObject:xE,interpolateRound:CE,interpolateString:ME,interpolateTransformCss:UE,interpolateTransformSvg:qE,interpolateZoom:JE,interpolateRgb:cE,interpolateRgbBasis:dE,interpolateRgbBasisClosed:pE,interpolateHsl:QE,interpolateHslLong:KE,interpolateLab:eM,interpolateHcl:nM,interpolateHclLong:rM,interpolateCubehelix:aM,interpolateCubehelixLong:oM,piecewise:uM,quantize:sM});function fM(e){return function(){return e}}function cM(e){return+e}var hM=[0,1];function dM(e){return e}function pM(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:fM(isNaN(t)?NaN:.5)}function vM(e,t){var n;if(e>t)n=e,e=t,t=n;return function(n){return Math.max(e,Math.min(t,n))}}function gM(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];if(i<r)r=pM(i,r),a=n(o,a);else r=pM(r,i),a=n(a,o);return function(e){return a(r(e))}}function mM(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;if(e[r]<e[0]){e=e.slice().reverse();t=t.slice().reverse()}while(++o<r){i[o]=pM(e[o],e[o+1]);a[o]=n(t[o],t[o+1])}return function(t){var n=Ml(e,t,1,r)-1;return a[n](i[n](t))}}function yM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function bM(){var e=hM,t=hM,n=OE,r,i,a,o=dM,u,s,l;function f(){var n=Math.min(e.length,t.length);if(o!==dM)o=vM(e[0],e[n-1]);u=n>2?mM:gM;s=l=null;return c}function c(i){return isNaN(i=+i)?a:(s||(s=u(e.map(r),t,n)))(r(o(i)))}c.invert=function(n){return o(i((l||(l=u(t,e.map(r),_E)))(n)))};c.domain=function(t){return arguments.length?(e=Array.from(t,cM),f()):e.slice()};c.range=function(e){return arguments.length?(t=Array.from(e),f()):t.slice()};c.rangeRound=function(e){return t=Array.from(e),n=CE,f()};c.clamp=function(e){return arguments.length?(o=e?true:dM,f()):o!==dM};c.interpolate=function(e){return arguments.length?(n=e,f()):n};c.unknown=function(e){return arguments.length?(a=e,c):a};return function(e,t){r=e,i=t;return f()}}function _M(){return bM()(dM,dM)}function xM(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function wM(e){return e=xM(Math.abs(e)),e?e[1]:NaN}function kM(e,t){return function(n,r){var i=n.length,a=[],o=0,u=e[0],s=0;while(i>0&&u>0){if(s+u+1>r)u=Math.max(1,r-s);a.push(n.substring(i-=u,i+u));if((s+=u+1)>r)break;u=e[o=(o+1)%e.length]}return a.reverse().join(t)}}function AM(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}var EM=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function MM(e){if(!(t=EM.exec(e)))throw new Error("invalid format: "+e);var t;return new OM({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}MM.prototype=OM.prototype;function OM(e){this.fill=e.fill===undefined?" ":e.fill+"";this.align=e.align===undefined?">":e.align+"";this.sign=e.sign===undefined?"-":e.sign+"";this.symbol=e.symbol===undefined?"":e.symbol+"";this.zero=!!e.zero;this.width=e.width===undefined?undefined:+e.width;this.comma=!!e.comma;this.precision=e.precision===undefined?undefined:+e.precision;this.trim=!!e.trim;this.type=e.type===undefined?"":e.type+""}OM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function SM(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n){switch(e[n]){case".":r=i=n;break;case"0":if(r===0)r=n;i=n;break;default:if(r>0){if(!+e[n])break e;r=0}break}}return r>0?e.slice(0,r)+e.slice(i+1):e}var DM;function CM(e,t){var n=xM(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(DM=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+xM(e,Math.max(0,t+a-1))[0]}function FM(e,t){var n=xM(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var TM={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return FM(e*100,t)},r:FM,s:CM,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function NM(e){return e}var jM=Array.prototype.map,RM=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function zM(e){var t=e.grouping===undefined||e.thousands===undefined?NM:kM(jM.call(e.grouping,Number),e.thousands+""),n=e.currency===undefined?"":e.currency[0]+"",r=e.currency===undefined?"":e.currency[1]+"",i=e.decimal===undefined?".":e.decimal+"",a=e.numerals===undefined?NM:AM(jM.call(e.numerals,String)),o=e.percent===undefined?"%":e.percent+"",u=e.minus===undefined?"-":e.minus+"",s=e.nan===undefined?"NaN":e.nan+"";function l(e){e=MM(e);var l=e.fill,f=e.align,c=e.sign,h=e.symbol,d=e.zero,p=e.width,v=e.comma,g=e.precision,m=e.trim,y=e.type;if(y==="n")v=true,y="g";else if(!TM[y])g===undefined&&(g=12),m=true,y="g";if(d||l==="0"&&f==="=")d=true,l="0",f="=";var b=h==="$"?n:h==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",_=h==="$"?r:/[%p]/.test(y)?o:"";var x=TM[y],w=/[defgprs%]/.test(y);g=g===undefined?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function k(e){var n=b,r=_,o,h,k;if(y==="c"){r=x(e)+r;e=""}else{e=+e;var A=e<0;e=isNaN(e)?s:x(Math.abs(e),g);if(m)e=SM(e);if(A&&+e===0)A=false;n=(A?c==="("?c:u:c==="-"||c==="("?"":c)+n;r=(y==="s"?RM[8+DM/3]:"")+r+(A&&c==="("?")":"");if(w){o=-1,h=e.length;while(++o<h){if(k=e.charCodeAt(o),48>k||k>57){r=(k===46?i+e.slice(o+1):e.slice(o))+r;e=e.slice(0,o);break}}}}if(v&&!d)e=t(e,Infinity);var E=n.length+e.length+r.length,M=E<p?new Array(p-E+1).join(l):"";if(v&&d)e=t(M+e,M.length?p-r.length:Infinity),M="";switch(f){case"<":e=n+e+r+M;break;case"=":e=n+M+e+r;break;case"^":e=M.slice(0,E=M.length>>1)+n+e+r+M.slice(E);break;default:e=M+n+e+r;break}return a(e)}k.toString=function(){return e+""};return k}function f(e,t){var n=l((e=MM(e),e.type="f",e)),r=Math.max(-8,Math.min(8,Math.floor(wM(t)/3)))*3,i=Math.pow(10,-r),a=RM[8+r/3];return function(e){return n(i*e)+a}}return{format:l,formatPrefix:f}}var PM;var LM;var IM;BM({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function BM(e){PM=zM(e);LM=PM.format;IM=PM.formatPrefix;return PM}function UM(e){return Math.max(0,-wM(Math.abs(e)))}function qM(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wM(t)/3)))*3-wM(Math.abs(e)))}function WM(e,t){e=Math.abs(e),t=Math.abs(t)-e;return Math.max(0,wM(t)-wM(e))+1}function HM(e,t,n,r){var i=zl(e,t,n),a;r=MM(r==null?",f":r);switch(r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));if(r.precision==null&&!isNaN(a=qM(i,o)))r.precision=a;return IM(r,o)}case"":case"e":case"g":case"p":case"r":{if(r.precision==null&&!isNaN(a=WM(i,Math.max(Math.abs(e),Math.abs(t)))))r.precision=a-(r.type==="e");break}case"f":case"%":{if(r.precision==null&&!isNaN(a=UM(i)))r.precision=a-(r.type==="%")*2;break}}return LM(r)}function GM(e){var t=e.domain;e.ticks=function(e){var n=t();return jl(n[0],n[n.length-1],e==null?10:e)};e.tickFormat=function(e,n){var r=t();return HM(r[0],r[r.length-1],e==null?10:e,n)};e.nice=function(n){if(n==null)n=10;var r=t(),i=0,a=r.length-1,o=r[i],u=r[a],s;if(u<o){s=o,o=u,u=s;s=i,i=a,a=s}s=Rl(o,u,n);if(s>0){o=Math.floor(o/s)*s;u=Math.ceil(u/s)*s;s=Rl(o,u,n)}else if(s<0){o=Math.ceil(o*s)/s;u=Math.floor(u*s)/s;s=Rl(o,u,n)}if(s>0){r[i]=Math.floor(o/s)*s;r[a]=Math.ceil(u/s)*s;t(r)}else if(s<0){r[i]=Math.ceil(o*s)/s;r[a]=Math.floor(u*s)/s;t(r)}return e};return e}function $M(){var e=_M();e.copy=function(){return yM(e,$M())};Uk.apply(e,arguments);return GM(e)}function YM(e){var t;function n(e){return isNaN(e=+e)?t:e}n.invert=n;n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,cM),n):e.slice()};n.unknown=function(e){return arguments.length?(t=e,n):t};n.copy=function(){return YM(e).unknown(t)};e=arguments.length?Array.from(e,cM):[0,1];return GM(n)}function VM(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],o;if(a<i){o=n,n=r,r=o;o=i,i=a,a=o}e[n]=t.floor(i);e[r]=t.ceil(a);return e}function XM(e){return Math.log(e)}function JM(e){return Math.exp(e)}function ZM(e){return-Math.log(-e)}function QM(e){return-Math.exp(-e)}function KM(e){return isFinite(e)?+("1e"+e):e<0?0:e}function eO(e){return e===10?KM:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function tO(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function nO(e){return function(t){return-e(-t)}}function rO(e){var t=e(XM,JM),n=t.domain,r=10,i,a;function o(){i=tO(r),a=eO(r);if(n()[0]<0){i=nO(i),a=nO(a);e(ZM,QM)}else{e(XM,JM)}return t}t.base=function(e){return arguments.length?(r=+e,o()):r};t.domain=function(e){return arguments.length?(n(e),o()):n()};t.ticks=function(e){var t=n(),o=t[0],u=t[t.length-1],s;if(s=u<o)l=o,o=u,u=l;var l=i(o),f=i(u),c,h,d,p=e==null?10:+e,v=[];if(!(r%1)&&f-l<p){l=Math.floor(l),f=Math.ceil(f);if(o>0)for(;l<=f;++l){for(h=1,c=a(l);h<r;++h){d=c*h;if(d<o)continue;if(d>u)break;v.push(d)}}else for(;l<=f;++l){for(h=r-1,c=a(l);h>=1;--h){d=c*h;if(d<o)continue;if(d>u)break;v.push(d)}}if(v.length*2<p)v=jl(o,u,p)}else{v=jl(l,f,Math.min(f-l,p)).map(a)}return s?v.reverse():v};t.tickFormat=function(e,n){if(n==null)n=r===10?".0e":",";if(typeof n!=="function")n=LM(n);if(e===Infinity)return n;if(e==null)e=10;var o=Math.max(1,r*e/t.ticks().length);return function(e){var t=e/a(Math.round(i(e)));if(t*r<r-.5)t*=r;return t<=o?n(e):""}};t.nice=function(){return n(VM(n(),{floor:function(e){return a(Math.floor(i(e)))},ceil:function(e){return a(Math.ceil(i(e)))}}))};return t}function iO(){var e=rO(bM()).domain([1,10]);e.copy=function(){return yM(e,iO()).base(e.base())};Uk.apply(e,arguments);return e}function aO(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function oO(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function uO(e){var t=1,n=e(aO(t),oO(t));n.constant=function(n){return arguments.length?e(aO(t=+n),oO(t)):t};return GM(n)}function sO(){var e=uO(bM());e.copy=function(){return yM(e,sO()).constant(e.constant())};return Uk.apply(e,arguments)}function lO(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function fO(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function cO(e){return e<0?-e*e:e*e}function hO(e){var t=e(dM,dM),n=1;function r(){return n===1?e(dM,dM):n===.5?e(fO,cO):e(lO(n),lO(1/n))}t.exponent=function(e){return arguments.length?(n=+e,r()):n};return GM(t)}function dO(){var e=hO(bM());e.copy=function(){return yM(e,dO()).exponent(e.exponent())};Uk.apply(e,arguments);return e}function pO(){return dO.apply(null,arguments).exponent(.5)}function vO(){var e=[],t=[],n=[],r;function i(){var r=0,i=Math.max(1,t.length);n=new Array(i-1);while(++r<i)n[r-1]=Wl(e,r/i);return a}function a(e){return isNaN(e=+e)?r:t[Ml(n,e)]}a.invertExtent=function(r){var i=t.indexOf(r);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]};a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n=0,r=t;n<r.length;n++){var a=r[n];if(a!=null&&!isNaN(a=+a))e.push(a)}e.sort(wl);return i()};a.range=function(e){return arguments.length?(t=Array.from(e),i()):t.slice()};a.unknown=function(e){return arguments.length?(r=e,a):r};a.quantiles=function(){return n.slice()};a.copy=function(){return vO().domain(e).range(t).unknown(r)};return Uk.apply(a,arguments)}function gO(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function o(e){return e<=e?i[Ml(r,e,0,n)]:a}function u(){var i=-1;r=new Array(n);while(++i<n)r[i]=((i+1)*t-(i-n)*e)/(n+1);return o}o.domain=function(n){return arguments.length?(e=n[0],t=n[1],n,e=+e,t=+t,u()):[e,t]};o.range=function(e){return arguments.length?(n=(i=Array.from(e)).length-1,u()):i.slice()};o.invertExtent=function(a){var o=i.indexOf(a);return o<0?[NaN,NaN]:o<1?[e,r[0]]:o>=n?[r[n-1],t]:[r[o-1],r[o]]};o.unknown=function(e){return arguments.length?(a=e,o):o};o.thresholds=function(){return r.slice()};o.copy=function(){return gO().domain([e,t]).range(i).unknown(a)};return Uk.apply(GM(o),arguments)}function mO(){var e=[.5],t=[0,1],n,r=1;function i(i){return i<=i?t[Ml(e,i,0,r)]:n}i.domain=function(n){return arguments.length?(e=Array.from(n),r=Math.min(e.length,t.length-1),i):e.slice()};i.range=function(n){return arguments.length?(t=Array.from(n),r=Math.min(e.length,t.length-1),i):t.slice()};i.invertExtent=function(n){var r=t.indexOf(n);return[e[r-1],e[r]]};i.unknown=function(e){return arguments.length?(n=e,i):n};i.copy=function(){return mO().domain(e).range(t).unknown(n)};return Uk.apply(i,arguments)}var yO=1e3,bO=yO*60,_O=bO*60,xO=_O*24,wO=xO*7,kO=xO*30,AO=xO*365;function EO(e){return new Date(e)}function MO(e){return e instanceof Date?+e:+new Date(+e)}function OO(e,t,n,r,i,a,o,u,s){var l=_M(),f=l.invert,c=l.domain;var h=s(".%L"),d=s(":%S"),p=s("%I:%M"),v=s("%I %p"),g=s("%a %d"),m=s("%b %d"),y=s("%B"),b=s("%Y");var _=[[o,1,yO],[o,5,5*yO],[o,15,15*yO],[o,30,30*yO],[a,1,bO],[a,5,5*bO],[a,15,15*bO],[a,30,30*bO],[i,1,_O],[i,3,3*_O],[i,6,6*_O],[i,12,12*_O],[r,1,xO],[r,2,2*xO],[n,1,wO],[t,1,kO],[t,3,3*kO],[e,1,AO]];function x(u){return(o(u)<u?h:a(u)<u?d:i(u)<u?p:r(u)<u?v:t(u)<u?n(u)<u?g:m:e(u)<u?y:b)(u)}function w(t,n,r){if(t==null)t=10;if(typeof t==="number"){var i=Math.abs(r-n)/t,a=kl((function(e){return e[2]})).right(_,i),o;if(a===_.length){o=zl(n/AO,r/AO,t);t=e}else if(a){a=_[i/_[a-1][2]<_[a][2]/i?a-1:a];o=a[1];t=a[0]}else{o=Math.max(zl(n,r,t),1);t=u}return t.every(o)}return t}l.invert=function(e){return new Date(f(e))};l.domain=function(e){return arguments.length?c(Array.from(e,MO)):c().map(EO)};l.ticks=function(e){var t=c(),n=t[0],r=t[t.length-1],i=r<n,a;if(i)a=n,n=r,r=a;a=w(e,n,r);a=a?a.range(n,r+1):[];return i?a.reverse():a};l.tickFormat=function(e,t){return t==null?x:s(t)};l.nice=function(e){var t=c();return(e=w(e,t[0],t[t.length-1]))?c(VM(t,e)):l};l.copy=function(){return yM(l,OO(e,t,n,r,i,a,o,u,s))};return l}function SO(){return Uk.apply(OO(Wi,qi,Ri,Ni,Ti,Fi,Ci,Ai,_o).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function DO(){return Uk.apply(OO(na,ta,Vi,$i,Gi,Hi,Ci,Ai,wo).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function CO(){var e=0,t=1,n,r,i,a,o=dM,u=false,s;function l(e){return isNaN(e=+e)?s:o(i===0?.5:(e=(a(e)-n)*i,u?Math.max(0,Math.min(1,e)):e))}l.domain=function(o){return arguments.length?(e=o[0],t=o[1],o,n=a(e=+e),r=a(t=+t),i=n===r?0:1/(r-n),l):[e,t]};l.clamp=function(e){return arguments.length?(u=!!e,l):u};l.interpolator=function(e){return arguments.length?(o=e,l):o};function f(e){return function(t){var n,r;return arguments.length?(n=t[0],r=t[1],t,o=e(n,r),l):[o(0),o(1)]}}l.range=f(OE);l.rangeRound=f(CE);l.unknown=function(e){return arguments.length?(s=e,l):s};return function(o){a=o,n=o(e),r=o(t),i=n===r?0:1/(r-n);return l}}function FO(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function TO(){var e=GM(CO()(dM));e.copy=function(){return FO(e,TO())};return qk.apply(e,arguments)}function NO(){var e=rO(CO()).domain([1,10]);e.copy=function(){return FO(e,NO()).base(e.base())};return qk.apply(e,arguments)}function jO(){var e=uO(CO());e.copy=function(){return FO(e,jO()).constant(e.constant())};return qk.apply(e,arguments)}function RO(){var e=hO(CO());e.copy=function(){return FO(e,RO()).exponent(e.exponent())};return qk.apply(e,arguments)}function zO(){return RO.apply(null,arguments).exponent(.5)}function PO(){var e=0,t=.5,n=1,r=1,i,a,o,u,s,l=dM,f,c=false,h;function d(e){return isNaN(e=+e)?h:(e=.5+((e=+f(e))-a)*(r*e<r*a?u:s),l(c?Math.max(0,Math.min(1,e)):e))}d.domain=function(l){return arguments.length?(e=l[0],t=l[1],n=l[2],l,i=f(e=+e),a=f(t=+t),o=f(n=+n),u=i===a?0:.5/(a-i),s=a===o?0:.5/(o-a),r=a<i?-1:1,d):[e,t,n]};d.clamp=function(e){return arguments.length?(c=!!e,d):c};d.interpolator=function(e){return arguments.length?(l=e,d):l};function p(e){return function(t){var n,r,i;return arguments.length?(n=t[0],r=t[1],i=t[2],t,l=uM(e,[n,r,i]),d):[l(0),l(.5),l(1)]}}d.range=p(OE);d.rangeRound=p(CE);d.unknown=function(e){return arguments.length?(h=e,d):h};return function(l){f=l,i=l(e),a=l(t),o=l(n),u=i===a?0:.5/(a-i),s=a===o?0:.5/(o-a),r=a<i?-1:1;return d}}function LO(){var e=GM(PO()(dM));e.copy=function(){return FO(e,LO())};return qk.apply(e,arguments)}function IO(){var e=rO(PO()).domain([.1,1,10]);e.copy=function(){return FO(e,IO()).base(e.base())};return qk.apply(e,arguments)}function BO(){var e=uO(PO());e.copy=function(){return FO(e,BO()).constant(e.constant())};return qk.apply(e,arguments)}function UO(){var e=hO(PO());e.copy=function(){return FO(e,UO()).exponent(e.exponent())};return qk.apply(e,arguments)}function qO(){return UO.apply(null,arguments).exponent(.5)}function WO(){var e=Hk().unknown(undefined),t=e.domain,n=e.range,r=[0,1],i,a,o=false,u=0,s=0,l=.5;delete e.unknown;function f(){var e=t().length,f=r[1]<r[0],c=r[f-0],h=r[1-f],d=Vw(e,u,s);i=(h-c)/(d||1);if(o){i=Math.floor(i)}c+=(h-c-i*(e-u))*l;a=i*(1-u);if(o){c=Math.round(c);a=Math.round(a)}var p=Cl(e).map((function(e){return c+i*e}));return n(f?p.reverse():p)}e.domain=function(e){if(arguments.length){t(e);return f()}else{return t()}};e.range=function(e){if(arguments.length){r=[+e[0],+e[1]];return f()}else{return r.slice()}};e.rangeRound=function(e){r=[+e[0],+e[1]];o=true;return f()};e.bandwidth=function(){return a};e.step=function(){return i};e.round=function(e){if(arguments.length){o=!!e;return f()}else{return o}};e.padding=function(e){if(arguments.length){s=Math.max(0,Math.min(1,e));u=s;return f()}else{return u}};e.paddingInner=function(e){if(arguments.length){u=Math.max(0,Math.min(1,e));return f()}else{return u}};e.paddingOuter=function(e){if(arguments.length){s=Math.max(0,Math.min(1,e));return f()}else{return s}};e.align=function(e){if(arguments.length){l=Math.max(0,Math.min(1,e));return f()}else{return l}};e.invertRange=function(e){if(e[0]==null||e[1]==null)return;var i=+e[0],o=+e[1],u=r[1]<r[0],s=u?n().reverse():n(),l=s.length-1,f,c,h;if(i!==i||o!==o)return;if(o<i){h=i;i=o;o=h}if(o<s[0]||i>r[1-u])return;f=Math.max(0,Ml(s,i)-1);c=i===o?f:Ml(s,o)-1;if(i-s[f]>a+1e-10)++f;if(u){h=f;f=l-c;c=l-h}return f>c?undefined:t().slice(f,c+1)};e.invert=function(t){var n=e.invertRange([t,t]);return n?n[0]:n};e.copy=function(){return WO().domain(t()).range(r).round(o).paddingInner(u).paddingOuter(s).align(l)};return f()}function HO(e){var t=e.copy;e.padding=e.paddingOuter;delete e.paddingInner;e.copy=function(){return HO(t())};return e}function GO(){return HO(WO().paddingInner(1))}var $O=Array.prototype.map;function YO(e){return $O.call(e,(function(e){return+e}))}var VO=Array.prototype.slice;function XO(){var e=[],t=[];function n(n){return n==null||n!==n?undefined:t[(Ml(e,n)-1)%t.length]}n.domain=function(t){if(arguments.length){e=YO(t);return n}else{return e.slice()}};n.range=function(e){if(arguments.length){t=VO.call(e);return n}else{return t.slice()}};n.tickFormat=function(t,n){return HM(e[0],Tk(e),t==null?10:t,n)};n.copy=function(){return XO().domain(n.domain()).range(n.range())};return n}var JO={};function ZO(e,t,n){var r=function n(){var r=t();if(!r.invertRange){r.invertRange=r.invert?Ik(r):r.invertExtent?Bk(r):undefined}r.type=e;return r};r.metadata=Lk(Nk(n));return r}function QO(e,t,n){if(arguments.length>1){JO[e]=ZO(e,t,n);return this}else{return KO(e)?JO[e]:undefined}}QO(Xw,YM);QO(Jw,$M,hk);QO(Zw,iO,[hk,Zw]);QO(Qw,dO,hk);QO(Kw,pO,hk);QO(ek,sO,hk);QO(tk,SO,[hk,gk]);QO(nk,DO,[hk,gk]);QO(rk,TO,[hk,vk]);QO(rk+"-"+Jw,TO,[hk,vk]);QO(rk+"-"+Zw,NO,[hk,vk,Zw]);QO(rk+"-"+Qw,RO,[hk,vk]);QO(rk+"-"+Kw,zO,[hk,vk]);QO(rk+"-"+ek,jO,[hk,vk]);QO(ik+"-"+Jw,LO,[hk,vk]);QO(ik+"-"+Zw,IO,[hk,vk,Zw]);QO(ik+"-"+Qw,UO,[hk,vk]);QO(ik+"-"+Kw,qO,[hk,vk]);QO(ik+"-"+ek,BO,[hk,vk]);QO(ak,vO,[pk,ak]);QO(ok,gO,pk);QO(uk,mO,pk);QO(ck,XO,[dk,pk]);QO(sk,Hk,dk);QO(fk,WO,dk);QO(lk,GO,dk);function KO(e){return Pk(JO,e)}function eS(e,t){var n=JO[e];return n&&n.metadata[t]}function tS(e){return eS(e,hk)}function nS(e){return eS(e,dk)}function rS(e){return eS(e,pk)}function iS(e){return eS(e,Zw)}function aS(e){return eS(e,vk)}function oS(e){return eS(e,ak)}var uS=["clamp","base","constant","exponent"];function sS(e,t){var n=t[0],r=Tk(t)-n;return function(t){return e(n+t*r)}}function lS(e,t,n){return uM(hS(t||"rgb",n),e)}function fS(e,t){var n=new Array(t),r=t+1;for(var i=0;i<t;)n[i]=e(++i/r);return n}function cS(e,t,n){var r=n-t,i,a,o;if(!r||!Number.isFinite(r)){return Rk(.5)}else{i=(a=e.type).indexOf("-");a=i<0?a:a.slice(i+1);o=QO(a)().domain([t,n]).range([0,1]);uS.forEach((function(t){return e[t]?o[t](e[t]()):0}));return o}}function hS(e,t){var n=lM[dS(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function dS(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}var pS={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"};var vS={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function gS(e){var t=e.length/6|0,n=new Array(t),r=0;while(r<t)n[r]="#"+e.slice(r*6,++r*6);return n}function mS(e,t){for(var n in e)bS(n,t(e[n]))}var yS={};mS(vS,gS);mS(pS,(function(e){return lS(gS(e))}));function bS(e,t){e=e&&e.toLowerCase();if(arguments.length>1){yS[e]=t;return this}else{return yS[e]}}function _S(e,t,n){e.fields=t||[];e.fname=n;return e}function xS(e){throw Error(e)}function wS(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)xS("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)xS("Access path missing closing bracket: "+e);if(n)xS("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var kS=Array.isArray;function AS(e){return e===Object(e)}function ES(e){return typeof e==="string"}function MS(e){return kS(e)?"["+e.map(MS)+"]":AS(e)||ES(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function OS(e,t){var n=wS(e),r="return _["+n.map(MS).join("][")+"];";return _S(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var SS=[];var DS=OS("id");var CS=_S((function(e){return e}),SS,"identity");var FS=_S((function(){return 0}),SS,"zero");var TS=_S((function(){return 1}),SS,"one");var NS=_S((function(){return true}),SS,"true");var jS=_S((function(){return false}),SS,"false");function RS(e){return e[e.length-1]}function zS(e){return e==null||e===""?null:+e}function PS(e){return function(t){return e*Math.exp(t)}}function LS(e){return function(t){return Math.log(e*t)}}function IS(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function BS(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function US(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function qS(e,t,n,r,i){var a=r(e[0]),o=r(RS(e)),u=t!=null?r(t):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function WS(e,t,n){return qS(e,t,n,zS,CS)}function HS(e,t,n){var r=Math.sign(e[0]);return qS(e,t,n,LS(r),PS(r))}function GS(e,t,n,r){return qS(e,t,n,US(r),US(1/r))}function $S(e,t,n,r){return qS(e,t,n,IS(r),BS(r))}function YS(e){return typeof e==="function"}function VS(e){return YS(e)?e:function(){return e}}var XS=Object.prototype.hasOwnProperty;function JS(e,t){return XS.call(e,t)}var ZS={};function QS(e){var t={},n,r;function i(e){return JS(t,e)&&t[e]!==ZS}n={size:0,empty:0,object:t,has:i,get:function(e){return i(e)?t[e]:undefined},set:function(e,r){if(!i(e)){++n.size;if(t[e]===ZS)--n.empty}t[e]=r;return this},delete:function(e){if(i(e)){--n.size;++n.empty;t[e]=ZS}return this},clear:function(){n.size=n.empty=0;n.object=t={}},test:function(e){if(arguments.length){r=e;return n}else{return r}},clean:function(){var e={},i=0,a,o;for(a in t){o=t[a];if(o!==ZS&&(!r||!r(o))){e[a]=o;++i}}n.size=i;n.empty=0;n.object=t=e}};if(e)Object.keys(e).forEach((function(t){n.set(t,e[t])}));return n}function KS(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function eD(e){return typeof e==="number"}function tD(e){return e&&RS(e)-e[0]||0}function nD(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=true;return t}function rD(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function iD(e){return e=rD(Math.abs(e)),e?e[1]:NaN}function aD(e,t){return function(n,r){var i=n.length,a=[],o=0,u=e[0],s=0;while(i>0&&u>0){if(s+u+1>r)u=Math.max(1,r-s);a.push(n.substring(i-=u,i+u));if((s+=u+1)>r)break;u=e[o=(o+1)%e.length]}return a.reverse().join(t)}}function oD(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}var uD=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function sD(e){if(!(t=uD.exec(e)))throw new Error("invalid format: "+e);var t;return new lD({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}sD.prototype=lD.prototype;function lD(e){this.fill=e.fill===undefined?" ":e.fill+"";this.align=e.align===undefined?">":e.align+"";this.sign=e.sign===undefined?"-":e.sign+"";this.symbol=e.symbol===undefined?"":e.symbol+"";this.zero=!!e.zero;this.width=e.width===undefined?undefined:+e.width;this.comma=!!e.comma;this.precision=e.precision===undefined?undefined:+e.precision;this.trim=!!e.trim;this.type=e.type===undefined?"":e.type+""}lD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function fD(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n){switch(e[n]){case".":r=i=n;break;case"0":if(r===0)r=n;i=n;break;default:if(!+e[n])break e;if(r>0)r=0;break}}return r>0?e.slice(0,r)+e.slice(i+1):e}var cD;function hD(e,t){var n=rD(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(cD=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+rD(e,Math.max(0,t+a-1))[0]}function dD(e,t){var n=rD(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var pD={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return dD(e*100,t)},r:dD,s:hD,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function vD(e){return e}var gD=Array.prototype.map,mD=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function yD(e){var t=e.grouping===undefined||e.thousands===undefined?vD:aD(gD.call(e.grouping,Number),e.thousands+""),n=e.currency===undefined?"":e.currency[0]+"",r=e.currency===undefined?"":e.currency[1]+"",i=e.decimal===undefined?".":e.decimal+"",a=e.numerals===undefined?vD:oD(gD.call(e.numerals,String)),o=e.percent===undefined?"%":e.percent+"",u=e.minus===undefined?"-":e.minus+"",s=e.nan===undefined?"NaN":e.nan+"";function l(e){e=sD(e);var l=e.fill,f=e.align,c=e.sign,h=e.symbol,d=e.zero,p=e.width,v=e.comma,g=e.precision,m=e.trim,y=e.type;if(y==="n")v=true,y="g";else if(!pD[y])g===undefined&&(g=12),m=true,y="g";if(d||l==="0"&&f==="=")d=true,l="0",f="=";var b=h==="$"?n:h==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",_=h==="$"?r:/[%p]/.test(y)?o:"";var x=pD[y],w=/[defgprs%]/.test(y);g=g===undefined?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function k(e){var n=b,r=_,o,h,k;if(y==="c"){r=x(e)+r;e=""}else{e=+e;var A=e<0;e=isNaN(e)?s:x(Math.abs(e),g);if(m)e=fD(e);if(A&&+e===0)A=false;n=(A?c==="("?c:u:c==="-"||c==="("?"":c)+n;r=(y==="s"?mD[8+cD/3]:"")+r+(A&&c==="("?")":"");if(w){o=-1,h=e.length;while(++o<h){if(k=e.charCodeAt(o),48>k||k>57){r=(k===46?i+e.slice(o+1):e.slice(o))+r;e=e.slice(0,o);break}}}}if(v&&!d)e=t(e,Infinity);var E=n.length+e.length+r.length,M=E<p?new Array(p-E+1).join(l):"";if(v&&d)e=t(M+e,M.length?p-r.length:Infinity),M="";switch(f){case"<":e=n+e+r+M;break;case"=":e=n+M+e+r;break;case"^":e=M.slice(0,E=M.length>>1)+n+e+r+M.slice(E);break;default:e=M+n+e+r;break}return a(e)}k.toString=function(){return e+""};return k}function f(e,t){var n=l((e=sD(e),e.type="f",e)),r=Math.max(-8,Math.min(8,Math.floor(iD(t)/3)))*3,i=Math.pow(10,-r),a=mD[8+r/3];return function(e){return n(i*e)+a}}return{format:l,formatPrefix:f}}var bD;var _D;xD({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function xD(e){bD=yD(e);_D=bD.format;return bD}function wD(e,t,n){var r;if(eD(t)){if(e.bins){t=Math.max(t,e.bins.length)}if(n!=null){t=Math.min(t,~~(tD(e.domain())/n)||1)}}if(AS(t)){r=t.step;t=t.interval}if(ES(t)){t=e.type===tk?md(t):e.type==nk?yd(t):xS("Only time and utc scales accept interval strings.");if(r)t=t.every(r)}return t}function kD(e,t,n){var r=e.range(),i=Math.floor(r[0]),a=Math.ceil(RS(r));if(i>a){r=a;a=i;i=r}t=t.filter((function(t){t=e(t);return i<=t&&t<=a}));if(n>0&&t.length>1){var o=[t[0],RS(t)];while(t.length>n&&t.length>=3){t=t.filter((function(e,t){return!(t%2)}))}if(t.length<3){t=o}}return t}function AD(e,t){return e.bins?kD(e,e.bins):e.ticks?e.ticks(t):e.domain()}function ED(e,t,n,r,i){var a=e.type,o=a===tk||r===tk?Od(n):a===nk||r===nk?Sd(n):e.tickFormat?e.tickFormat(t,n):n?_D(n):String;if(iS(a)){var u=OD(n);o=i||e.bins?u:MD(o,u)}return o}function MD(e,t){return function(n){return e(n)?t(n):""}}function OD(e){var t=sD(e||",");if(t.precision==null){t.precision=12;switch(t.type){case"%":t.precision-=2;break;case"e":t.precision-=1;break}return SD(_D(t),_D(".1f")(1)[1])}else{return _D(t)}}function SD(e,t){return function(n){var r=e(n),i=r.indexOf(t),a,o;if(i<0)return r;a=DD(r,i);o=a<r.length?r.slice(a):"";while(--a>i)if(r[a]!=="0"){++a;break}return r.slice(0,a)+o}}function DD(e,t){var n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;){r=e.charCodeAt(n);if(r>=48&&r<=57)return n+1}}function CD(e,t,n){e.fields=t||[];e.fname=n;return e}function FD(e){throw Error(e)}function TD(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);o=++u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)FD("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)FD("Access path missing closing bracket: "+e);if(n)FD("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var ND=Array.isArray;function jD(e){return e===Object(e)}function RD(e){return typeof e==="string"}function zD(e){return ND(e)?"["+e.map(zD)+"]":jD(e)||RD(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function PD(e,t){var n=TD(e),r="return _["+n.map(zD).join("][")+"];";return CD(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var LD=[];var ID=PD("id");var BD=CD((function(e){return e}),LD,"identity");var UD=CD((function(){return 0}),LD,"zero");var qD=CD((function(){return 1}),LD,"one");var WD=CD((function(){return true}),LD,"true");var HD=CD((function(){return false}),LD,"false");function GD(e){return e!=null?ND(e)?e:[e]:[]}function $D(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function YD(e,t,n){if(e){var r=0,i=e.length,a;if(t){for(;r<i;++r){if(a=t(e[r]))n(a,r,e)}}else{e.forEach(n)}}}function VD(e){var t=e||BD,n=[],r={};n.add=function(e){var i=t(e);if(!r[i]){r[i]=1;n.push(e)}return n};n.remove=function(e){var i=t(e),a;if(r[i]){r[i]=0;if((a=n.indexOf(e))>=0){n.splice(a,1)}}return n};return n}var XD=Symbol("vega_id"),JD=1;function ZD(e){return e[XD]}function QD(e,t){e[XD]=t;return e}function KD(e){var t=e===Object(e)?e:{data:e};return ZD(t)?t:QD(t,JD++)}function eC(e,t){return!e?null:t?function(n,r){return e(n,r)||ZD(t(n))-ZD(t(r))}:function(t,n){return e(t,n)||ZD(t)-ZD(n)}}var tC="_:mod:_";function nC(){Object.defineProperty(this,tC,{writable:true,value:{}})}var rC=nC.prototype;rC.set=function(e,t,n,r){var i=this,a=i[e],o=i[tC];if(t!=null&&t>=0){if(a[t]!==n||r){a[t]=n;o[t+":"+e]=-1;o[e]=-1}}else if(a!==n||r){i[e]=n;o[e]=ND(n)?1+n.length:-1}return i};rC.modified=function(e,t){var n=this[tC],r;if(!arguments.length){for(r in n){if(n[r])return true}return false}else if(ND(e)){for(r=0;r<e.length;++r){if(n[e[r]])return true}return false}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]};rC.clear=function(){this[tC]={};return this};var iC=0;var aC="pulse";var oC=new nC;var uC=1,sC=2;function lC(e,t,n,r){this.id=++iC;this.value=e;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(t){this._update=t}if(n)this.parameters(n,r)}var fC=lC.prototype;fC.targets=function(){return this._targets||(this._targets=VD(ID))};fC.set=function(e){if(this.value!==e){this.value=e;return 1}else{return 0}};function cC(e){return function(t){var n=this.flags;if(arguments.length===0)return!!(n&e);this.flags=t?n|e:n&~e;return this}}fC.skip=cC(uC);fC.modified=cC(sC);fC.parameters=function(e,t,n){t=t!==false;var r=this,i=r._argval=r._argval||new nC,a=r._argops=r._argops||[],o=[],u,s,l,f;function c(e,n,u){if(u instanceof lC){if(u!==r){if(t)u.targets().add(r);o.push(u)}a.push({op:u,name:e,index:n})}else{i.set(e,n,u)}}for(u in e){s=e[u];if(u===aC){GD(s).forEach((function(e){if(!(e instanceof lC)){FD("Pulse parameters must be operator instances.")}else if(e!==r){e.targets().add(r);o.push(e)}}));r.source=s}else if(ND(s)){i.set(u,-1,Array(l=s.length));for(f=0;f<l;++f)c(u,f,s[f])}else{c(u,-1,s)}}this.marshall().clear();if(n)a.initonly=true;return o};fC.marshall=function(e){var t=this._argval||oC,n=this._argops,r,i,a,o,u;if(n){for(i=0,a=n.length;i<a;++i){r=n[i];o=r.op;u=o.modified()&&o.stamp===e;t.set(r.name,r.index,o.value,u)}if(n.initonly){for(i=0;i<a;++i){r=n[i];r.op.targets().remove(this)}this._argops=null;this._update=null}}return t};fC.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);n.clear();if(r!==this.value){this.value=r}else if(!this.modified()){return e.StopPropagation}}};fC.run=function(e){if(e.stamp<this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false);t=0}else{t=this.evaluate(e)}return this.pulse=t||e};var hC={};var dC=1<<0,pC=1<<1,vC=1<<2,gC=dC|pC,mC=dC|vC,yC=dC|pC|vC,bC=1<<3,_C=1<<4,xC=1<<5,wC=1<<6;function kC(e,t,n){this.dataflow=e;this.stamp=t==null?-1:t;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}var AC=kC.prototype;AC.StopPropagation=hC;AC.ADD=dC;AC.REM=pC;AC.MOD=vC;AC.ADD_REM=gC;AC.ADD_MOD=mC;AC.ALL=yC;AC.REFLOW=bC;AC.SOURCE=_C;AC.NO_SOURCE=xC;AC.NO_FIELDS=wC;AC.fork=function(e){return new kC(this.dataflow).init(this,e)};AC.clone=function(){var e=this.fork(yC);e.add=e.add.slice();e.rem=e.rem.slice();e.mod=e.mod.slice();if(e.source)e.source=e.source.slice();return e.materialize(yC|_C)};AC.addAll=function(){var e=this;if(!this.source||this.source.length===this.add.length){return e}else{e=new kC(this.dataflow).init(this);e.add=e.source;return e}};AC.init=function(e,t){var n=this;n.stamp=e.stamp;n.encode=e.encode;if(e.fields&&!(t&wC)){n.fields=e.fields}if(t&dC){n.addF=e.addF;n.add=e.add}else{n.addF=null;n.add=[]}if(t&pC){n.remF=e.remF;n.rem=e.rem}else{n.remF=null;n.rem=[]}if(t&vC){n.modF=e.modF;n.mod=e.mod}else{n.modF=null;n.mod=[]}if(t&xC){n.srcF=null;n.source=null}else{n.srcF=e.srcF;n.source=e.source}return n};AC.runAfter=function(e){this.dataflow.runAfter(e)};AC.changed=function(e){var t=e||yC;return t&dC&&this.add.length||t&pC&&this.rem.length||t&vC&&this.mod.length};AC.reflow=function(e){if(e)return this.fork(yC).reflow();var t=this.add.length,n=this.source&&this.source.length;if(n&&n!==t){this.mod=this.source;if(t)this.filter(vC,OC(this,dC))}return this};AC.modifies=function(e){var t=this.fields||(this.fields={});if(ND(e)){e.forEach((function(e){return t[e]=true}))}else{t[e]=true}return this};AC.modified=function(e,t){var n=this.fields;return!((t||this.mod.length)&&n)?false:!arguments.length?!!n:ND(e)?e.some((function(e){return n[e]})):n[e]};AC.filter=function(e,t){var n=this;if(e&dC)n.addF=EC(n.addF,t);if(e&pC)n.remF=EC(n.remF,t);if(e&vC)n.modF=EC(n.modF,t);if(e&_C)n.srcF=EC(n.srcF,t);return n};function EC(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}AC.materialize=function(e){e=e||yC;var t=this;if(e&dC&&t.addF){t.add=MC(t.add,t.addF);t.addF=null}if(e&pC&&t.remF){t.rem=MC(t.rem,t.remF);t.remF=null}if(e&vC&&t.modF){t.mod=MC(t.mod,t.modF);t.modF=null}if(e&_C&&t.srcF){t.source=t.source.filter(t.srcF);t.srcF=null}return t};function MC(e,t){var n=[];YD(e,t,(function(e){n.push(e)}));return n}function OC(e,t){var n={};e.visit(t,(function(e){n[ZD(e)]=1}));return function(e){return n[ZD(e)]?null:e}}AC.visit=function(e,t){var n=this,r=t,i,a;if(e&_C){YD(n.source,n.srcF,r);return n}if(e&dC)YD(n.add,n.addF,r);if(e&pC)YD(n.rem,n.remF,r);if(e&vC)YD(n.mod,n.modF,r);if(e&bC&&(i=n.source)){a=n.add.length+n.mod.length;if(a===i.length);else if(a){YD(i,OC(n,mC),r)}else{YD(i,n.srcF,r)}}return n};function SC(e,t,n,r){var i=this,a=0,o,u,s,l,f;this.dataflow=e;this.stamp=t;this.fields=null;this.encode=r||null;this.pulses=n;for(s=0,l=n.length;s<l;++s){o=n[s];if(o.stamp!==t)continue;if(o.fields){u=i.fields||(i.fields={});for(f in o.fields){u[f]=1}}if(o.changed(i.ADD))a|=i.ADD;if(o.changed(i.REM))a|=i.REM;if(o.changed(i.MOD))a|=i.MOD}this.changes=a}var DC=$D(SC,kC);DC.fork=function(e){var t=new kC(this.dataflow).init(this,e&this.NO_FIELDS);if(e!==undefined){if(e&t.ADD){this.visit(t.ADD,(function(e){return t.add.push(e)}))}if(e&t.REM){this.visit(t.REM,(function(e){return t.rem.push(e)}))}if(e&t.MOD){this.visit(t.MOD,(function(e){return t.mod.push(e)}))}}return t};DC.changed=function(e){return this.changes&e};DC.modified=function(e){var t=this,n=t.fields;return!(n&&t.changes&t.MOD)?0:ND(e)?e.some((function(e){return n[e]})):n[e]};DC.filter=function(){FD("MultiPulse does not support filtering.")};DC.materialize=function(){FD("MultiPulse does not support materialization.")};DC.visit=function(e,t){var n=this,r=n.pulses,i=r.length,a=0;if(e&n.SOURCE){for(;a<i;++a){r[a].visit(e,t)}}else{for(;a<i;++a){if(r[a].stamp===n.stamp){r[a].visit(e,t)}}}return n};function CC(e,t){lC.call(this,e,null,t)}var FC=$D(CC,lC);FC.run=function(e){var t=this;if(e.stamp<this.stamp)return e.StopPropagation;var n;if(this.skip()){this.skip(false)}else{n=this.evaluate(e)}n=n||e;if(n.then){n=n.then((function(e){return t.pulse=e}))}else if(n!==e.StopPropagation){this.pulse=n}return n};FC.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);t.clear();return n};FC.transform=function(){};function TC(e){CC.call(this,null,e)}var NC=KS(TC,CC);NC.transform=function(e,t){if(this.value&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,i=e.scale,a=e.count==null?e.values?e.values.length:10:e.count,o=wD(i,a,e.minstep),u=e.format||ED(i,o,e.formatSpecifier,e.formatType,!!e.values),s=e.values?kD(i,e.values,o):AD(i,o);if(r)n.rem=r;r=s.map((function(e,t){return KD({index:t/(s.length-1||1),value:e,label:u(e)})}));if(e.extra&&r.length){r.push(KD({index:-1,extra:{value:r[0].value},label:""}))}n.source=r;n.add=r;this.value=r;return n};function jC(e){CC.call(this,null,e)}var RC=KS(jC,CC);function zC(){return KD({})}function PC(e){return e.exit}RC.transform=function(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||zC,a=e.key||ZD,o=this.value;if(kS(r.encode)){r.encode=null}if(o&&(e.modified("key")||t.modified(a))){xS("DataJoin does not support modified key function or fields.")}if(!o){t=t.addAll();this.value=o=QS().test(PC);o.lookup=function(e){return o.get(a(e))}}t.visit(t.ADD,(function(e){var t=a(e),n=o.get(t);if(n){if(n.exit){o.empty--;r.add.push(n)}else{r.mod.push(n)}}else{o.set(t,n=i(e));r.add.push(n)}n.datum=e;n.exit=false}));t.visit(t.MOD,(function(e){var t=a(e),n=o.get(t);if(n){n.datum=e;r.mod.push(n)}}));t.visit(t.REM,(function(e){var t=a(e),n=o.get(t);if(e===n.datum&&!n.exit){r.rem.push(n);n.exit=true;++o.empty}}));if(t.changed(t.ADD_MOD))r.modifies("datum");if(e.clean&&o.empty>n.cleanThreshold)n.runAfter(o.clean);return r};function LC(e){CC.call(this,null,e)}var IC=KS(LC,CC);IC.transform=function(e,t){var n=t.fork(t.ADD_REM),r=e.mod||false,i=e.encoders,a=t.encode;if(kS(a)){if(n.changed()||a.every((function(e){return i[e]}))){a=a[0];n.encode=null}else{return t.StopPropagation}}var o=a==="enter",u=i.update||jS,s=i.enter||jS,l=i.exit||jS,f=(a&&!o?i[a]:u)||jS;if(t.changed(t.ADD)){t.visit(t.ADD,(function(t){s(t,e);u(t,e)}));n.modifies(s.output);n.modifies(u.output);if(f!==jS&&f!==u){t.visit(t.ADD,(function(t){f(t,e)}));n.modifies(f.output)}}if(t.changed(t.REM)&&l!==jS){t.visit(t.REM,(function(t){l(t,e)}));n.modifies(l.output)}if(o||f!==jS){var c=t.MOD|(e.modified()?t.REFLOW:0);if(o){t.visit(c,(function(t){var i=s(t,e)||r;if(f(t,e)||i)n.mod.push(t)}));if(n.mod.length)n.modifies(s.output)}else{t.visit(c,(function(t){if(f(t,e)||r)n.mod.push(t)}))}if(n.mod.length)n.modifies(f.output)}return n.changed()?n:t.StopPropagation};var BC="symbol";var UC="discrete";var qC="gradient";var WC=(l={},l[ak]="quantiles",l[ok]="thresholds",l[uk]="domain",l);var HC=(f={},f[ak]="quantiles",f[ok]="domain",f);function GC(e,t){return e.bins?XC(e.bins):e.type===Zw?$C(e,t):WC[e.type]?VC(e[WC[e.type]]()):AD(e,t)}function $C(e,t){var n=AD(e,t),r=e.base(),i=Math.log(r),a=Math.max(1,r*t/n.length);return n.filter((function(e){var t=e/Math.pow(r,Math.round(Math.log(e)/i));if(t*r<r-.5)t*=r;return t<=a}))}function YC(e,t){var n=e[HC[e.type]](),r=n.length,i=r>1?n[1]-n[0]:n[0],a;for(a=1;a<r;++a){i=Math.min(i,n[a]-n[a-1])}return HM(0,i,3*10,t)}function VC(e){var t=[-Infinity].concat(e);t.max=+Infinity;return t}function XC(e){var t=e.slice(0,-1);t.max=RS(e);return t}function JC(e){return WC[e.type]||e.bins}function ZC(e,t,n,r,i,a){var o=HC[e.type]&&i!==tk&&i!==nk?YC(e,r):ED(e,t,r,i,a);return n===BC&&JC(e)?QC(o):n===UC?eF(o):tF(o)}function QC(e){return function(t,n,r){var i=KC(r[n+1],KC(r.max,+Infinity)),a=nF(t,e),o=nF(i,e);return a&&o?a+" – "+o:o?"< "+o:"≥ "+a}}function KC(e,t){return e!=null?e:t}function eF(e){return function(t,n){return n?e(t):null}}function tF(e){return function(t){return e(t)}}function nF(e,t){return Number.isFinite(e)?t(e):null}function rF(e){var t=e.domain(),n=t.length-1,r=+t[0],i=+RS(t),a=i-r;if(e.type===uk){var o=n?a/n:.1;r-=o;i+=o;a=i-r}return function(e){return(e-r)/a}}function iF(e){CC.call(this,[],e)}var aF=KS(iF,CC);aF.transform=function(e,t){if(this.value!=null&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,i=e.type||BC,a=e.scale,o=+e.limit,u=wD(a,e.count==null?5:e.count,e.minstep),s=!!e.values||i===BC,l=e.format||ZC(a,u,i,e.formatSpecifier,e.formatType,s),f=e.values||GC(a,u),c,h,d,p,v;if(r)n.rem=r;if(i===BC){if(o&&f.length>o){t.dataflow.warn("Symbol legend count exceeds limit, filtering items.");r=f.slice(0,o-1);v=true}else{r=f}if(YS(d=e.size)){if(!e.values&&a(r[0])===0){r=r.slice(1)}p=r.reduce((function(t,n){return Math.max(t,d(n,e))}),0)}else{d=VS(p=d||8)}r=r.map((function(t,n){return KD({index:n,label:l(t,n,r),value:t,offset:p,size:d(t,e)})}));if(v){v=f[r.length];r.push(KD({index:r.length,label:"…"+(f.length-r.length)+" entries",value:v,offset:p,size:d(v,e)}))}}else if(i===qC){c=a.domain(),h=cS(a,c[0],RS(c));if(f.length<3&&!e.values&&c[0]!==RS(c)){f=[c[0],RS(c)]}r=f.map((function(e,t){return KD({index:t,label:l(e,t,f),value:e,perc:h(e)})}))}else{d=f.length-1;h=rF(a);r=f.map((function(e,t){return KD({index:t,label:l(e,t,f),value:e,perc:t?h(e):0,perc2:t===d?1:h(f[t+1])})}))}n.source=r;n.add=r;this.value=r;return n};var oF=QS({line:dF,"line-radial":pF,arc:vF,"arc-radial":gF,curve:mF,"curve-radial":yF,"orthogonal-horizontal":bF,"orthogonal-vertical":_F,"orthogonal-radial":xF,"diagonal-horizontal":wF,"diagonal-vertical":kF,"diagonal-radial":AF});function uF(e){return e.source.x}function sF(e){return e.source.y}function lF(e){return e.target.x}function fF(e){return e.target.y}function cF(e){CC.call(this,{},e)}cF.Definition={type:"LinkPath",metadata:{modifies:true},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};var hF=KS(cF,CC);hF.transform=function(e,t){var n=e.sourceX||uF,r=e.sourceY||sF,i=e.targetX||lF,a=e.targetY||fF,o=e.as||"path",u=e.orient||"vertical",s=e.shape||"line",l=oF.get(s+"-"+u)||oF.get(s);if(!l){xS("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:""))}t.visit(t.SOURCE,(function(e){e[o]=l(n(e),r(e),i(e),a(e))}));return t.reflow(e.modified()).modifies(o)};function dF(e,t,n,r){return"M"+e+","+t+"L"+n+","+r}function pF(e,t,n,r){return dF(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function vF(e,t,n,r){var i=n-e,a=r-t,o=Math.sqrt(i*i+a*a)/2,u=180*Math.atan2(a,i)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+u+" 0 1"+" "+n+","+r}function gF(e,t,n,r){return vF(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function mF(e,t,n,r){var i=n-e,a=r-t,o=.2*(i+a),u=.2*(a-i);return"M"+e+","+t+"C"+(e+o)+","+(t+u)+" "+(n+u)+","+(r-o)+" "+n+","+r}function yF(e,t,n,r){return mF(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function bF(e,t,n,r){return"M"+e+","+t+"V"+r+"H"+n}function _F(e,t,n,r){return"M"+e+","+t+"H"+n+"V"+r}function xF(e,t,n,r){var i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),u=Math.sin(n),s=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*a+"A"+t+","+t+" 0 0,"+(s?1:0)+" "+t*o+","+t*u+"L"+r*o+","+r*u}function wF(e,t,n,r){var i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r}function kF(e,t,n,r){var i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r}function AF(e,t,n,r){var i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),u=Math.sin(n),s=(t+r)/2;return"M"+t*i+","+t*a+"C"+s*i+","+s*a+" "+s*o+","+s*u+" "+r*o+","+r*u}function EF(e){CC.call(this,null,e)}EF.Definition={type:"Pie",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:false},{name:"as",type:"string",array:true,length:2,default:["startAngle","endAngle"]}]};var MF=KS(EF,CC);MF.transform=function(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],a=e.field||TS,o=e.startAngle||0,u=e.endAngle!=null?e.endAngle:2*Math.PI,s=t.source,l=s.map(a),f=l.length,c=o,h=(u-o)/Vl(l),d=Cl(f),p,v,g;if(e.sort){d.sort((function(e,t){return l[e]-l[t]}))}for(p=0;p<f;++p){g=l[d[p]];v=s[d[p]];v[r]=c;v[i]=c+=g*h}this.value=l;return t.reflow(e.modified()).modifies(n)};var OF=5;function SF(e){var t=e.type;return!e.bins&&(t===Jw||t===Qw||t===Kw)}function DF(e){return tS(e)&&e!==rk}var CF=nD(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function FF(e){CC.call(this,null,e);this.modified(true)}var TF=KS(FF,CC);TF.transform=function(e,t){var n=t.dataflow,r=this.value,i=NF(e);if(!r||i!==r.type){this.value=r=QO(i)()}for(i in e)if(!CF[i]){if(i==="padding"&&DF(r.type))continue;YS(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}BF(r,e,IF(r,e,RF(r,e,n)));return t.fork(t.NO_SOURCE|t.NO_FIELDS)};function NF(e){var t=e.type,n="",r;if(t===rk)return rk+"-"+Jw;if(jF(e)){r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0;n=r===2?rk+"-":r===3?ik+"-":""}return(n+t||Jw).toLowerCase()}function jF(e){var t=e.type;return tS(t)&&t!==tk&&t!==nk&&(e.scheme||e.range&&e.range.length&&e.range.every(ES))}function RF(e,t,n){var r=zF(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,a=e.type,o=t.zero||t.zero===undefined&&SF(e),u,s;if(!i)return 0;if(DF(a)&&t.padding&&i[0]!==RS(i)){i=PF(a,i,t.range,t.padding,t.exponent,t.constant)}if(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null){u=(i=i.slice()).length-1||1;if(o){if(i[0]>0)i[0]=0;if(i[u]<0)i[u]=0}if(t.domainMin!=null)i[0]=t.domainMin;if(t.domainMax!=null)i[u]=t.domainMax;if(t.domainMid!=null){s=t.domainMid;if(s<i[0]||s>i[u]){n.warn("Scale domainMid exceeds domain min or max.",s)}i.splice(u,0,s)}}e.domain(LF(a,i,n));if(a===sk){e.unknown(t.domainImplicit?Wk:undefined)}if(t.nice&&e.nice){e.nice(t.nice!==true&&wD(e,t.nice)||null)}return i.length}function zF(e,t,n){if(t){e.domain(LF(e.type,t,n));return t.length}else{return-1}}function PF(e,t,n,r,i,a){var o=Math.abs(RS(n)-n[0]),u=o/(o-2*r),s=e===Zw?HS(t,null,u):e===Kw?GS(t,null,u,.5):e===Qw?GS(t,null,u,i||1):e===ek?$S(t,null,u,a||1):WS(t,null,u);t=t.slice();t[0]=s[0];t[t.length-1]=s[1];return t}function LF(e,t,n){if(iS(e)){var r=Math.abs(t.reduce((function(e,t){return e+(t<0?-1:t>0?1:0)}),0));if(r!==t.length){n.warn("Log scale domain includes zero: "+MS(t))}}return t}function IF(e,t,n){var r=t.bins;if(r&&!kS(r)){var i=e.domain(),a=i[0],o=RS(i),u=r.start==null?a:r.start,s=r.stop==null?o:r.stop,l=r.step;if(!l)xS("Scale bins parameter missing step property.");if(u<a)u=l*Math.ceil(a/l);if(s>o)s=l*Math.floor(o/l);r=Cl(u,s+l/2,l)}if(r){e.bins=r}else if(e.bins){delete e.bins}if(e.type===ck){if(!r){e.bins=e.domain()}else if(!t.domain&&!t.domainRaw){e.domain(r);n=r.length}}return n}function BF(e,t,n){var r=e.type,i=t.round||false,a=t.range;if(t.rangeStep!=null){a=UF(r,t,n)}else if(t.scheme){a=qF(r,t,n);if(YS(a)){if(e.interpolator){return e.interpolator(a)}else{xS("Scale type "+r+" does not support interpolating color schemes.")}}}if(a&&aS(r)){return e.interpolator(lS(HF(a,t.reverse),t.interpolate,t.interpolateGamma))}if(a&&t.interpolate&&e.interpolate){e.interpolate(hS(t.interpolate,t.interpolateGamma))}else if(YS(e.round)){e.round(i)}else if(YS(e.rangeRound)){e.interpolate(i?CE:OE)}if(a)e.range(HF(a,t.reverse))}function UF(e,t,n){if(e!==fk&&e!==lk){xS("Only band and point scales support rangeStep.")}var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===lk?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*Vw(n,i,r)]}function qF(e,t,n){var r=t.schemeExtent,i,a;if(kS(t.scheme)){a=lS(t.scheme,t.interpolate,t.interpolateGamma)}else{i=t.scheme.toLowerCase();a=bS(i);if(!a)xS("Unrecognized scheme name: "+t.scheme)}n=e===uk?n+1:e===ck?n-1:e===ak||e===ok?+t.schemeCount||OF:n;return aS(e)?WF(a,r,t.reverse):YS(a)?fS(WF(a,r),n):e===sk?a:a.slice(0,n)}function WF(e,t,n){return YS(e)&&(t||n)?sS(e,HF(t||[0,1],n)):e}function HF(e,t){return t?e.slice().reverse():e}function GF(e){CC.call(this,null,e)}var $F=KS(GF,CC);$F.transform=function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");if(n)t.source.sort(eC(e.sort));this.modified(n);return t};var YF="zero",VF="center",XF="normalize",JF=["y0","y1"];function ZF(e){CC.call(this,null,e)}ZF.Definition={type:"Stack",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:true},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:YF,values:[YF,VF,XF]},{name:"as",type:"string",array:true,length:2,default:JF}]};var QF=KS(ZF,CC);QF.transform=function(e,t){var n=e.as||JF,r=n[0],i=n[1],a=eC(e.sort),o=e.field||TS,u=e.offset===VF?KF:e.offset===XF?eT:tT,s,l,f,c;s=nT(t.source,e.groupby,a,o);for(l=0,f=s.length,c=s.max;l<f;++l){u(s[l],c,o,r,i)}return t.reflow(e.modified()).modifies(n)};function KF(e,t,n,r,i){var a=(t-e.sum)/2,o=e.length,u=0,s;for(;u<o;++u){s=e[u];s[r]=a;s[i]=a+=Math.abs(n(s))}}function eT(e,t,n,r,i){var a=1/e.sum,o=0,u=e.length,s=0,l=0,f;for(;s<u;++s){f=e[s];f[r]=o;f[i]=o=a*(l+=Math.abs(n(f)))}}function tT(e,t,n,r,i){var a=0,o=0,u=e.length,s=0,l,f;for(;s<u;++s){f=e[s];l=+n(f);if(l<0){f[r]=o;f[i]=o+=l}else{f[r]=a;f[i]=a+=l}}}function nT(e,t,n,r){var i=[],a=function(e){return e(f)},o,u,s,l,f,c,h,d,p;if(t==null){i.push(e.slice())}else{for(o={},u=0,s=e.length;u<s;++u){f=e[u];c=t.map(a);h=o[c];if(!h){o[c]=h=[];i.push(h)}h.push(f)}}for(c=0,p=0,l=i.length;c<l;++c){h=i[c];for(u=0,d=0,s=h.length;u<s;++u){d+=Math.abs(r(h[u]))}h.sum=d;if(d>p)p=d;if(n)h.sort(n)}i.max=p;return i}var rT=Object.freeze({__proto__:null,axisticks:TC,datajoin:jC,encode:LC,legendentries:iF,linkpath:cF,pie:EF,scale:FF,sortitems:GF,stack:ZF,validTicks:kD});function iT(e,t,n){e.fields=t||[];e.fname=n;return e}function aT(e){return e==null?null:e.fname}function oT(e){return e==null?null:e.fields}function uT(e){throw Error(e)}function sT(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)uT("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)uT("Access path missing closing bracket: "+e);if(n)uT("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var lT=Array.isArray;function fT(e){return e===Object(e)}function cT(e){return typeof e==="string"}function hT(e){return lT(e)?"["+e.map(hT)+"]":fT(e)||cT(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function dT(e,t){var n=sT(e),r="return _["+n.map(hT).join("][")+"];";return iT(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var pT=[];var vT=dT("id");var gT=iT((function(e){return e}),pT,"identity");var mT=iT((function(){return 0}),pT,"zero");var yT=iT((function(){return 1}),pT,"one");var bT=iT((function(){return true}),pT,"true");var _T=iT((function(){return false}),pT,"false");function xT(e){return e!=null?lT(e)?e:[e]:[]}function wT(e){return typeof e==="function"}function kT(e){return wT(e)?e:function(){return e}}function AT(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}function ET(e,t){var n=0,r,i,a,o;if(e&&(r=e.length)){if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);a=o=i;for(;n<r;++n){i=e[n];if(i!=null){if(i<a)a=i;if(i>o)o=i}}}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));a=o=i;for(;n<r;++n){i=t(e[n]);if(i!=null){if(i<a)a=i;if(i>o)o=i}}}}return[a,o]}function MT(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function OT(e){return typeof e==="number"}function ST(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=true;return t}function DT(){}var CT=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function FT(){var e=1,t=1,n=u;function r(e,t){return t.map((function(t){return i(e,t)}))}function i(e,t){var r=[],i=[];a(e,t,(function(a){n(a,e,t);if(TT(a)>0)r.push([a]);else i.push(a)}));i.forEach((function(e){for(var t=0,n=r.length,i;t<n;++t){if(NT((i=r[t])[0],e)!==-1){i.push(e);return}}}));return{type:"MultiPolygon",value:t,coordinates:r}}function a(n,r,i){var a=new Array,u=new Array,s,l,f,c,h,d;s=l=-1;c=n[0]>=r;CT[c<<1].forEach(p);while(++s<e-1){f=c,c=n[s+1]>=r;CT[f|c<<1].forEach(p)}CT[c<<0].forEach(p);while(++l<t-1){s=-1;c=n[l*e+e]>=r;h=n[l*e]>=r;CT[c<<1|h<<2].forEach(p);while(++s<e-1){f=c,c=n[l*e+e+s+1]>=r;d=h,h=n[l*e+s+1]>=r;CT[f|c<<1|h<<2|d<<3].forEach(p)}CT[c|h<<3].forEach(p)}s=-1;h=n[l*e]>=r;CT[h<<2].forEach(p);while(++s<e-1){d=h,h=n[l*e+s+1]>=r;CT[h<<2|d<<3].forEach(p)}CT[h<<3].forEach(p);function p(e){var t=[e[0][0]+s,e[0][1]+l],n=[e[1][0]+s,e[1][1]+l],r=o(t),f=o(n),c,h;if(c=u[r]){if(h=a[f]){delete u[c.end];delete a[h.start];if(c===h){c.ring.push(n);i(c.ring)}else{a[c.start]=u[h.end]={start:c.start,end:h.end,ring:c.ring.concat(h.ring)}}}else{delete u[c.end];c.ring.push(n);u[c.end=f]=c}}else if(c=a[f]){if(h=u[r]){delete a[c.start];delete u[h.end];if(c===h){c.ring.push(n);i(c.ring)}else{a[h.start]=u[c.end]={start:h.start,end:c.end,ring:h.ring.concat(c.ring)}}}else{delete a[c.start];c.ring.unshift(t);a[c.start=r]=c}}else{a[r]=u[f]={start:r,end:f,ring:[t,n]}}}}function o(t){return t[0]*2+t[1]*(e+1)*4}function u(n,r,i){n.forEach((function(n){var a=n[0],o=n[1],u=a|0,s=o|0,l,f=r[s*e+u];if(a>0&&a<e&&u===a){l=r[s*e+u-1];n[0]=a+(i-l)/(f-l)-.5}if(o>0&&o<t&&s===o){l=r[(s-1)*e+u];n[1]=o+(i-l)/(f-l)-.5}}))}r.contour=i;r.size=function(n){if(!arguments.length)return[e,t];var i=Math.ceil(n[0]),a=Math.ceil(n[1]);if(!(i>0)||!(a>0))uT("invalid size");return e=i,t=a,r};r.smooth=function(e){return arguments.length?(n=e?u:DT,r):n===u};return r}function TT(e){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];while(++t<n)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function NT(e,t){var n=-1,r=t.length,i;while(++n<r)if(i=jT(e,t[n]))return i;return 0}function jT(e,t){var n=t[0],r=t[1],i=-1;for(var a=0,o=e.length,u=o-1;a<o;u=a++){var s=e[a],l=s[0],f=s[1],c=e[u],h=c[0],d=c[1];if(RT(s,c,t))return 0;if(f>r!==d>r&&n<(h-l)*(r-f)/(d-f)+l)i=-i}return i}function RT(e,t,n){var r;return zT(e,t,n)&&PT(e[r=+(e[0]===t[0])],n[r],t[r])}function zT(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function PT(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function LT(e,t,n){return function(r){var i=ET(r),a=n?Math.min(i[0],0):i[0],o=i[1],u=o-a,s=t?zl(a,o,e):u/(e+1);return Cl(s,o,s)}}function IT(e){zv.call(this,null,e)}IT.Definition={type:"Isocontour",metadata:{generates:true},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:true},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:false},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:true},{name:"smooth",type:"boolean",default:true},{name:"scale",type:"number",expr:true},{name:"translate",type:"number",array:true,expr:true},{name:"as",type:"string",null:true,default:"contour"}]};var BT=MT(IT,zv);BT.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||gT,a=FT().smooth(e.smooth!==false),o=e.thresholds||UT(r,i,e),u=e.as===null?null:e.as||"contour",s=[];r.forEach((function(t){var n=i(t);var r=a.size([n.width,n.height])(n.values,lT(o)?o:o(n.values));qT(r,n,t,e);r.forEach((function(e){var n;s.push(iv(t,rv(u!=null?(n={},n[u]=e,n):e)))}))}));if(this.value)n.rem=this.value;this.value=n.source=n.add=s;return n};function UT(e,t,n){var r=LT(n.levels||10,n.nice,n.zero!==false);return n.resolve!=="shared"?r:r(e.map((function(e){return Pl(t(e).values)})))}function qT(e,t,n,r){var i=r.scale||t.scale,a=r.translate||t.translate;if(wT(i))i=i(n,r);if(wT(a))a=a(n,r);if((i===1||i==null)&&!a)return;var o=(OT(i)?i:i[0])||1,u=(OT(i)?i:i[1])||1,s=a&&a[0]||0,l=a&&a[1]||0;e.forEach(WT(t,o,u,s,l))}function WT(e,t,n,r,i){var a=e.x1||0,o=e.y1||0,u=t*n<0;function s(e){e.forEach(l)}function l(e){if(u)e.reverse();e.forEach(f)}function f(e){e[0]=(e[0]-a)*t+r;e[1]=(e[1]-o)*n+i}return function(e){e.coordinates.forEach(s);return e}}function HT(e,t,n){var r=e>=0?e:Zl(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function GT(e){return wT(e)?e:kT(+e)}function $T(){var e=function(e){return e[0]},t=function(e){return e[1]},n=yT,r=[-1,-1],i=960,a=500,o=2;function u(u,s){var l=HT(r[0],u,e)>>o,f=HT(r[1],u,t)>>o,c=l?l+2:0,h=f?f+2:0,d=2*c+(i>>o),p=2*h+(a>>o),v=new Float32Array(d*p),g=new Float32Array(d*p);var m=v;u.forEach((function(r){var i=c+(+e(r)>>o),a=h+(+t(r)>>o);if(i>=0&&i<d&&a>=0&&a<p){v[i+a*d]+=+n(r)}}));if(l>0&&f>0){YT(d,p,v,g,l);VT(d,p,g,v,f);YT(d,p,v,g,l);VT(d,p,g,v,f);YT(d,p,v,g,l);VT(d,p,g,v,f)}else if(l>0){YT(d,p,v,g,l);YT(d,p,g,v,l);YT(d,p,v,g,l);m=g}else if(f>0){VT(d,p,v,g,f);VT(d,p,g,v,f);VT(d,p,v,g,f);m=g}var y=s?Math.pow(2,-2*o):1/Vl(m);for(var b=0,_=d*p;b<_;++b)m[b]*=y;return{values:m,scale:1<<o,width:d,height:p,x1:c,y1:h,x2:c+(i>>o),y2:h+(a>>o)}}u.x=function(t){return arguments.length?(e=GT(t),u):e};u.y=function(e){return arguments.length?(t=GT(e),u):t};u.weight=function(e){return arguments.length?(n=GT(e),u):n};u.size=function(e){if(!arguments.length)return[i,a];var t=Math.ceil(e[0]),n=Math.ceil(e[1]);if(!(t>=0)&&!(t>=0))uT("invalid size");return i=t,a=n,u};u.cellSize=function(e){if(!arguments.length)return 1<<o;if(!((e=+e)>=1))uT("invalid cell size");o=Math.floor(Math.log(e)/Math.LN2);return u};u.bandwidth=function(e){if(!arguments.length)return r;e=xT(e);if(e.length===1)e=[+e[0],+e[0]];if(e.length!==2)uT("invalid bandwidth");return r=e,u};return u}function YT(e,t,n,r,i){var a=(i<<1)+1;for(var o=0;o<t;++o){for(var u=0,s=0;u<e+i;++u){if(u<e){s+=n[u+o*e]}if(u>=i){if(u>=a){s-=n[u-a+o*e]}r[u-i+o*e]=s/Math.min(u+1,e-1+a-u,a)}}}}function VT(e,t,n,r,i){var a=(i<<1)+1;for(var o=0;o<e;++o){for(var u=0,s=0;u<t+i;++u){if(u<t){s+=n[o+u*e]}if(u>=i){if(u>=a){s-=n[o+(u-a)*e]}r[o+(u-i)*e]=s/Math.min(u+1,t-1+a-u,a)}}}}function XT(e){zv.call(this,null,e)}XT.Definition={type:"KDE2D",metadata:{generates:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"weight",type:"field"},{name:"groupby",type:"field",array:true},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:true,length:2},{name:"counts",type:"boolean",default:false},{name:"as",type:"string",default:"grid"}]};var JT=MT(XT,zv);var ZT=["x","y","weight","size","cellSize","bandwidth"];function QT(e,t){ZT.forEach((function(n){return t[n]!=null?e[n](t[n]):0}));return e}JT.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=KT(r,e.groupby),a=(e.groupby||[]).map(aT),o=QT($T(),e),u=e.as||"grid",s=[];function l(e,t){for(var n=0;n<a.length;++n)e[a[n]]=t[n];return e}s=i.map((function(t){var n;return rv(l((n={},n[u]=o(t,e.counts),n),t.dims))}));if(this.value)n.rem=this.value;this.value=n.source=n.add=s;return n};function KT(e,t){var n=[],r=function(e){return e(u)},i,a,o,u,s,l;if(t==null){n.push(e)}else{for(i={},a=0,o=e.length;a<o;++a){u=e[a];s=t.map(r);l=i[s];if(!l){i[s]=l=[];l.dims=s;n.push(l)}l.push(u)}}return n}function eN(e){zv.call(this,null,e)}eN.Definition={type:"Contour",metadata:{generates:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"values",type:"number",array:true},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:false},{name:"thresholds",type:"number",array:true},{name:"smooth",type:"boolean",default:true}]};var tN=MT(eN,zv);tN.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=FT().smooth(e.smooth!==false),i=e.values,a=e.thresholds||LT(e.count||10,e.nice,!!i),o=e.size,u,s;if(!i){i=t.materialize(t.SOURCE).source;u=QT($T(),e)(i,true);s=WT(u,u.scale||1,u.scale||1,0,0);o=[u.width,u.height];i=u.values}a=lT(a)?a:a(i);i=r.size(o)(i,a);if(s)i.forEach(s);if(this.value)n.rem=this.value;this.value=n.source=n.add=(i||[]).map(rv);return n};var nN="Feature";var rN="FeatureCollection";var iN="MultiPoint";function aN(e){zv.call(this,null,e)}aN.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:true,length:2},{name:"geojson",type:"field"}]};var oN=MT(aN,zv);oN.transform=function(e,t){var n=this._features,r=this._points,i=e.fields,a=i&&i[0],o=i&&i[1],u=e.geojson||!i&&gT,s=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(oT(u))||a&&t.modified(oT(a))||o&&t.modified(oT(o));if(!this.value||l){s=t.SOURCE;this._features=n=[];this._points=r=[]}if(u){t.visit(s,(function(e){n.push(u(e))}))}if(a&&o){t.visit(s,(function(e){var t=a(e),n=o(e);if(t!=null&&n!=null&&(t=+t)===t&&(n=+n)===n){r.push([t,n])}}));n=n.concat({type:nN,geometry:{type:iN,coordinates:r}})}this.value={type:rN,features:n}};function uN(){return new sN}function sN(){this.reset()}sN.prototype={constructor:sN,reset:function(){this.s=this.t=0},add:function(e){fN(lN,e,this.t);fN(this,lN.s,this.s);if(this.s)this.t+=lN.t;else this.s=lN.t},valueOf:function(){return this.s}};var lN=new sN;function fN(e,t,n){var r=e.s=t+n,i=r-t,a=r-i;e.t=t-a+(n-i)}var cN=1e-6;var hN=1e-12;var dN=Math.PI;var pN=dN/2;var vN=dN/4;var gN=dN*2;var mN=180/dN;var yN=dN/180;var bN=Math.abs;var _N=Math.atan;var xN=Math.atan2;var wN=Math.cos;var kN=Math.ceil;var AN=Math.exp;var EN=Math.log;var MN=Math.pow;var ON=Math.sin;var SN=Math.sign||function(e){return e>0?1:e<0?-1:0};var DN=Math.sqrt;var CN=Math.tan;function FN(e){return e>1?0:e<-1?dN:Math.acos(e)}function TN(e){return e>1?pN:e<-1?-pN:Math.asin(e)}function NN(){}function jN(e,t){if(e&&zN.hasOwnProperty(e.type)){zN[e.type](e,t)}}var RN={Feature:function(e,t){jN(e.geometry,t)},FeatureCollection:function(e,t){var n=e.features,r=-1,i=n.length;while(++r<i)jN(n[r].geometry,t)}};var zN={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates;t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){PN(e.coordinates,t,0)},MultiLineString:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)PN(n[r],t,0)},Polygon:function(e,t){LN(e.coordinates,t)},MultiPolygon:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)LN(n[r],t)},GeometryCollection:function(e,t){var n=e.geometries,r=-1,i=n.length;while(++r<i)jN(n[r],t)}};function PN(e,t,n){var r=-1,i=e.length-n,a;t.lineStart();while(++r<i)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function LN(e,t){var n=-1,r=e.length;t.polygonStart();while(++n<r)PN(e[n],t,1);t.polygonEnd()}function IN(e,t){if(e&&RN.hasOwnProperty(e.type)){RN[e.type](e,t)}else{jN(e,t)}}var BN=uN();var UN=uN(),qN,WN,HN,GN,$N;var YN={point:NN,lineStart:NN,lineEnd:NN,polygonStart:function(){BN.reset();YN.lineStart=VN;YN.lineEnd=XN},polygonEnd:function(){var e=+BN;UN.add(e<0?gN+e:e);this.lineStart=this.lineEnd=this.point=NN},sphere:function(){UN.add(gN)}};function VN(){YN.point=JN}function XN(){ZN(qN,WN)}function JN(e,t){YN.point=ZN;qN=e,WN=t;e*=yN,t*=yN;HN=e,GN=wN(t=t/2+vN),$N=ON(t)}function ZN(e,t){e*=yN,t*=yN;t=t/2+vN;var n=e-HN,r=n>=0?1:-1,i=r*n,a=wN(t),o=ON(t),u=$N*o,s=GN*a+u*wN(i),l=u*r*ON(i);BN.add(xN(l,s));HN=e,GN=a,$N=o}function QN(e){UN.reset();IN(e,YN);return UN*2}function KN(e){return[xN(e[1],e[0]),TN(e[2])]}function ej(e){var t=e[0],n=e[1],r=wN(n);return[r*wN(t),r*ON(t),ON(n)]}function tj(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function nj(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function rj(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function ij(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function aj(e){var t=DN(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var oj,uj,sj,lj,fj,cj,hj,dj,pj=uN(),vj,gj;var mj={point:yj,lineStart:_j,lineEnd:xj,polygonStart:function(){mj.point=wj;mj.lineStart=kj;mj.lineEnd=Aj;pj.reset();YN.polygonStart()},polygonEnd:function(){YN.polygonEnd();mj.point=yj;mj.lineStart=_j;mj.lineEnd=xj;if(BN<0)oj=-(sj=180),uj=-(lj=90);else if(pj>cN)lj=90;else if(pj<-cN)uj=-90;gj[0]=oj,gj[1]=sj},sphere:function(){oj=-(sj=180),uj=-(lj=90)}};function yj(e,t){vj.push(gj=[oj=e,sj=e]);if(t<uj)uj=t;if(t>lj)lj=t}function bj(e,t){var n=ej([e*yN,t*yN]);if(dj){var r=nj(dj,n),i=[r[1],-r[0],0],a=nj(i,r);aj(a);a=KN(a);var o=e-fj,u=o>0?1:-1,s=a[0]*mN*u,l,f=bN(o)>180;if(f^(u*fj<s&&s<u*e)){l=a[1]*mN;if(l>lj)lj=l}else if(s=(s+360)%360-180,f^(u*fj<s&&s<u*e)){l=-a[1]*mN;if(l<uj)uj=l}else{if(t<uj)uj=t;if(t>lj)lj=t}if(f){if(e<fj){if(Ej(oj,e)>Ej(oj,sj))sj=e}else{if(Ej(e,sj)>Ej(oj,sj))oj=e}}else{if(sj>=oj){if(e<oj)oj=e;if(e>sj)sj=e}else{if(e>fj){if(Ej(oj,e)>Ej(oj,sj))sj=e}else{if(Ej(e,sj)>Ej(oj,sj))oj=e}}}}else{vj.push(gj=[oj=e,sj=e])}if(t<uj)uj=t;if(t>lj)lj=t;dj=n,fj=e}function _j(){mj.point=bj}function xj(){gj[0]=oj,gj[1]=sj;mj.point=yj;dj=null}function wj(e,t){if(dj){var n=e-fj;pj.add(bN(n)>180?n+(n>0?360:-360):n)}else{cj=e,hj=t}YN.point(e,t);bj(e,t)}function kj(){YN.lineStart()}function Aj(){wj(cj,hj);YN.lineEnd();if(bN(pj)>cN)oj=-(sj=180);gj[0]=oj,gj[1]=sj;dj=null}function Ej(e,t){return(t-=e)<0?t+360:t}function Mj(e,t){return e[0]-t[0]}function Oj(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Sj(e){var t,n,r,i,a,o,u;lj=sj=-(oj=uj=Infinity);vj=[];IN(e,mj);if(n=vj.length){vj.sort(Mj);for(t=1,r=vj[0],a=[r];t<n;++t){i=vj[t];if(Oj(r,i[0])||Oj(r,i[1])){if(Ej(r[0],i[1])>Ej(r[0],r[1]))r[1]=i[1];if(Ej(i[0],r[1])>Ej(r[0],r[1]))r[0]=i[0]}else{a.push(r=i)}}for(o=-Infinity,n=a.length-1,t=0,r=a[n];t<=n;r=i,++t){i=a[t];if((u=Ej(r[1],i[0]))>o)o=u,oj=i[0],sj=r[1]}}vj=gj=null;return oj===Infinity||uj===Infinity?[[NaN,NaN],[NaN,NaN]]:[[oj,uj],[sj,lj]]}var Dj,Cj,Fj,Tj,Nj,jj,Rj,zj,Pj,Lj,Ij,Bj,Uj,qj,Wj,Hj;var Gj={sphere:NN,point:$j,lineStart:Vj,lineEnd:Zj,polygonStart:function(){Gj.lineStart=Qj;Gj.lineEnd=Kj},polygonEnd:function(){Gj.lineStart=Vj;Gj.lineEnd=Zj}};function $j(e,t){e*=yN,t*=yN;var n=wN(t);Yj(n*wN(e),n*ON(e),ON(t))}function Yj(e,t,n){++Dj;Fj+=(e-Fj)/Dj;Tj+=(t-Tj)/Dj;Nj+=(n-Nj)/Dj}function Vj(){Gj.point=Xj}function Xj(e,t){e*=yN,t*=yN;var n=wN(t);qj=n*wN(e);Wj=n*ON(e);Hj=ON(t);Gj.point=Jj;Yj(qj,Wj,Hj)}function Jj(e,t){e*=yN,t*=yN;var n=wN(t),r=n*wN(e),i=n*ON(e),a=ON(t),o=xN(DN((o=Wj*a-Hj*i)*o+(o=Hj*r-qj*a)*o+(o=qj*i-Wj*r)*o),qj*r+Wj*i+Hj*a);Cj+=o;jj+=o*(qj+(qj=r));Rj+=o*(Wj+(Wj=i));zj+=o*(Hj+(Hj=a));Yj(qj,Wj,Hj)}function Zj(){Gj.point=$j}function Qj(){Gj.point=eR}function Kj(){tR(Bj,Uj);Gj.point=$j}function eR(e,t){Bj=e,Uj=t;e*=yN,t*=yN;Gj.point=tR;var n=wN(t);qj=n*wN(e);Wj=n*ON(e);Hj=ON(t);Yj(qj,Wj,Hj)}function tR(e,t){e*=yN,t*=yN;var n=wN(t),r=n*wN(e),i=n*ON(e),a=ON(t),o=Wj*a-Hj*i,u=Hj*r-qj*a,s=qj*i-Wj*r,l=DN(o*o+u*u+s*s),f=TN(l),c=l&&-f/l;Pj+=c*o;Lj+=c*u;Ij+=c*s;Cj+=f;jj+=f*(qj+(qj=r));Rj+=f*(Wj+(Wj=i));zj+=f*(Hj+(Hj=a));Yj(qj,Wj,Hj)}function nR(e){Dj=Cj=Fj=Tj=Nj=jj=Rj=zj=Pj=Lj=Ij=0;IN(e,Gj);var t=Pj,n=Lj,r=Ij,i=t*t+n*n+r*r;if(i<hN){t=jj,n=Rj,r=zj;if(Cj<cN)t=Fj,n=Tj,r=Nj;i=t*t+n*n+r*r;if(i<hN)return[NaN,NaN]}return[xN(n,t)*mN,TN(r/DN(i))*mN]}function rR(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}if(e.invert&&t.invert)n.invert=function(n,r){return n=t.invert(n,r),n&&e.invert(n[0],n[1])};return n}function iR(e,t){return[bN(e)>dN?e+Math.round(-e/gN)*gN:e,t]}iR.invert=iR;function aR(e,t,n){return(e%=gN)?t||n?rR(uR(e),sR(t,n)):uR(e):t||n?sR(t,n):iR}function oR(e){return function(t,n){return t+=e,[t>dN?t-gN:t<-dN?t+gN:t,n]}}function uR(e){var t=oR(e);t.invert=oR(-e);return t}function sR(e,t){var n=wN(e),r=ON(e),i=wN(t),a=ON(t);function o(e,t){var o=wN(t),u=wN(e)*o,s=ON(e)*o,l=ON(t),f=l*n+u*r;return[xN(s*i-f*a,u*n-l*r),TN(f*i+s*a)]}o.invert=function(e,t){var o=wN(t),u=wN(e)*o,s=ON(e)*o,l=ON(t),f=l*i-s*a;return[xN(s*i+l*a,u*n+f*r),TN(f*n-u*r)]};return o}function lR(e){e=aR(e[0]*yN,e[1]*yN,e.length>2?e[2]*yN:0);function t(t){t=e(t[0]*yN,t[1]*yN);return t[0]*=mN,t[1]*=mN,t}t.invert=function(t){t=e.invert(t[0]*yN,t[1]*yN);return t[0]*=mN,t[1]*=mN,t};return t}function fR(e,t,n,r,i,a){if(!n)return;var o=wN(t),u=ON(t),s=r*n;if(i==null){i=t+r*gN;a=t-s/2}else{i=cR(o,i);a=cR(o,a);if(r>0?i<a:i>a)i+=r*gN}for(var l,f=i;r>0?f>a:f<a;f-=s){l=KN([o,-u*wN(f),-u*ON(f)]);e.point(l[0],l[1])}}function cR(e,t){t=ej(t),t[0]-=e;aj(t);var n=FN(-t[1]);return((-t[2]<0?-n:n)+gN-cN)%gN}function hR(){var e=[],t;return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:NN,rejoin:function(){if(e.length>1)e.push(e.pop().concat(e.shift()))},result:function(){var n=e;e=[];t=null;return n}}}function dR(e,t){return bN(e[0]-t[0])<cN&&bN(e[1]-t[1])<cN}function pR(e,t,n,r){this.x=e;this.z=t;this.o=n;this.e=r;this.v=false;this.n=this.p=null}function vR(e,t,n,r,i){var a=[],o=[],u,s;e.forEach((function(e){if((t=e.length-1)<=0)return;var t,n=e[0],r=e[t],s;if(dR(n,r)){i.lineStart();for(u=0;u<t;++u)i.point((n=e[u])[0],n[1]);i.lineEnd();return}a.push(s=new pR(n,e,null,true));o.push(s.o=new pR(n,null,s,false));a.push(s=new pR(r,e,null,false));o.push(s.o=new pR(r,null,s,true))}));if(!a.length)return;o.sort(t);gR(a);gR(o);for(u=0,s=o.length;u<s;++u){o[u].e=n=!n}var l=a[0],f,c;while(1){var h=l,d=true;while(h.v)if((h=h.n)===l)return;f=h.z;i.lineStart();do{h.v=h.o.v=true;if(h.e){if(d){for(u=0,s=f.length;u<s;++u)i.point((c=f[u])[0],c[1])}else{r(h.x,h.n.x,1,i)}h=h.n}else{if(d){f=h.p.z;for(u=f.length-1;u>=0;--u)i.point((c=f[u])[0],c[1])}else{r(h.x,h.p.x,-1,i)}h=h.p}h=h.o;f=h.z;d=!d}while(!h.v);i.lineEnd()}}function gR(e){if(!(t=e.length))return;var t,n=0,r=e[0],i;while(++n<t){r.n=i=e[n];i.p=r;r=i}r.n=i=e[0];i.p=r}var mR=uN();function yR(e){if(bN(e[0])<=dN)return e[0];else return SN(e[0])*((bN(e[0])+dN)%gN-dN)}function bR(e,t){var n=yR(t),r=t[1],i=ON(r),a=[ON(n),-wN(n),0],o=0,u=0;mR.reset();if(i===1)r=pN+cN;else if(i===-1)r=-pN-cN;for(var s=0,l=e.length;s<l;++s){if(!(c=(f=e[s]).length))continue;var f,c,h=f[c-1],d=yR(h),p=h[1]/2+vN,v=ON(p),g=wN(p);for(var m=0;m<c;++m,d=b,v=x,g=w,h=y){var y=f[m],b=yR(y),_=y[1]/2+vN,x=ON(_),w=wN(_),k=b-d,A=k>=0?1:-1,E=A*k,M=E>dN,O=v*x;mR.add(xN(O*A*ON(E),g*w+O*wN(E)));o+=M?k+A*gN:k;if(M^d>=n^b>=n){var S=nj(ej(h),ej(y));aj(S);var D=nj(a,S);aj(D);var C=(M^k>=0?-1:1)*TN(D[2]);if(r>C||r===C&&(S[0]||S[1])){u+=M^k>=0?1:-1}}}}return(o<-cN||o<cN&&mR<-cN)^u&1}function _R(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);while(++r<i){a[r]=e+r*n}return a}function xR(e){var t=e.length,n,r=-1,i=0,a,o;while(++r<t)i+=e[r].length;a=new Array(i);while(--t>=0){o=e[t];n=o.length;while(--n>=0){a[--i]=o[n]}}return a}function wR(e,t,n,r){return function(i){var a=t(i),o=hR(),u=t(o),s=false,l,f,c;var h={point:d,lineStart:v,lineEnd:g,polygonStart:function(){h.point=m;h.lineStart=y;h.lineEnd=b;f=[];l=[]},polygonEnd:function(){h.point=d;h.lineStart=v;h.lineEnd=g;f=xR(f);var e=bR(l,r);if(f.length){if(!s)i.polygonStart(),s=true;vR(f,AR,e,n,i)}else if(e){if(!s)i.polygonStart(),s=true;i.lineStart();n(null,null,1,i);i.lineEnd()}if(s)i.polygonEnd(),s=false;f=l=null},sphere:function(){i.polygonStart();i.lineStart();n(null,null,1,i);i.lineEnd();i.polygonEnd()}};function d(t,n){if(e(t,n))i.point(t,n)}function p(e,t){a.point(e,t)}function v(){h.point=p;a.lineStart()}function g(){h.point=d;a.lineEnd()}function m(e,t){c.push([e,t]);u.point(e,t)}function y(){u.lineStart();c=[]}function b(){m(c[0][0],c[0][1]);u.lineEnd();var e=u.clean(),t=o.result(),n,r=t.length,a,h,d;c.pop();l.push(c);c=null;if(!r)return;if(e&1){h=t[0];if((a=h.length-1)>0){if(!s)i.polygonStart(),s=true;i.lineStart();for(n=0;n<a;++n)i.point((d=h[n])[0],d[1]);i.lineEnd()}return}if(r>1&&e&2)t.push(t.pop().concat(t.shift()));f.push(t.filter(kR))}return h}}function kR(e){return e.length>1}function AR(e,t){return((e=e.x)[0]<0?e[1]-pN-cN:pN-e[1])-((t=t.x)[0]<0?t[1]-pN-cN:pN-t[1])}var ER=wR((function(){return true}),MR,SR,[-dN,-pN]);function MR(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart();i=1},point:function(a,o){var u=a>0?dN:-dN,s=bN(a-t);if(bN(s-dN)<cN){e.point(t,n=(n+o)/2>0?pN:-pN);e.point(r,n);e.lineEnd();e.lineStart();e.point(u,n);e.point(a,n);i=0}else if(r!==u&&s>=dN){if(bN(t-r)<cN)t-=r*cN;if(bN(a-u)<cN)a-=u*cN;n=OR(t,n,a,o);e.point(r,n);e.lineEnd();e.lineStart();e.point(u,n);i=0}e.point(t=a,n=o);r=u},lineEnd:function(){e.lineEnd();t=n=NaN},clean:function(){return 2-i}}}function OR(e,t,n,r){var i,a,o=ON(e-n);return bN(o)>cN?_N((ON(t)*(a=wN(r))*ON(n)-ON(r)*(i=wN(t))*ON(e))/(i*a*o)):(t+r)/2}function SR(e,t,n,r){var i;if(e==null){i=n*pN;r.point(-dN,i);r.point(0,i);r.point(dN,i);r.point(dN,0);r.point(dN,-i);r.point(0,-i);r.point(-dN,-i);r.point(-dN,0);r.point(-dN,i)}else if(bN(e[0]-t[0])>cN){var a=e[0]<t[0]?dN:-dN;i=n*a/2;r.point(-a,i);r.point(0,i);r.point(a,i)}else{r.point(t[0],t[1])}}function DR(e){var t=wN(e),n=6*yN,r=t>0,i=bN(t)>cN;function a(t,r,i,a){fR(a,e,n,i,t,r)}function o(e,n){return wN(e)*wN(n)>t}function u(e){var t,n,a,u,f;return{lineStart:function(){u=a=false;f=1},point:function(c,h){var d=[c,h],p,v=o(c,h),g=r?v?0:l(c,h):v?l(c+(c<0?dN:-dN),h):0;if(!t&&(u=a=v))e.lineStart();if(v!==a){p=s(t,d);if(!p||dR(t,p)||dR(d,p)){d[0]+=cN;d[1]+=cN;v=o(d[0],d[1])}}if(v!==a){f=0;if(v){e.lineStart();p=s(d,t);e.point(p[0],p[1])}else{p=s(t,d);e.point(p[0],p[1]);e.lineEnd()}t=p}else if(i&&t&&r^v){var m;if(!(g&n)&&(m=s(d,t,true))){f=0;if(r){e.lineStart();e.point(m[0][0],m[0][1]);e.point(m[1][0],m[1][1]);e.lineEnd()}else{e.point(m[1][0],m[1][1]);e.lineEnd();e.lineStart();e.point(m[0][0],m[0][1])}}}if(v&&(!t||!dR(t,d))){e.point(d[0],d[1])}t=d,a=v,n=g},lineEnd:function(){if(a)e.lineEnd();t=null},clean:function(){return f|(u&&a)<<1}}}function s(e,n,r){var i=ej(e),a=ej(n);var o=[1,0,0],u=nj(i,a),s=tj(u,u),l=u[0],f=s-l*l;if(!f)return!r&&e;var c=t*s/f,h=-t*l/f,d=nj(o,u),p=ij(o,c),v=ij(u,h);rj(p,v);var g=d,m=tj(p,g),y=tj(g,g),b=m*m-y*(tj(p,p)-1);if(b<0)return;var _=DN(b),x=ij(g,(-m-_)/y);rj(x,p);x=KN(x);if(!r)return x;var w=e[0],k=n[0],A=e[1],E=n[1],M;if(k<w)M=w,w=k,k=M;var O=k-w,S=bN(O-dN)<cN,D=S||O<cN;if(!S&&E<A)M=A,A=E,E=M;if(D?S?A+E>0^x[1]<(bN(x[0]-w)<cN?A:E):A<=x[1]&&x[1]<=E:O>dN^(w<=x[0]&&x[0]<=k)){var C=ij(g,(-m+_)/y);rj(C,p);return[x,KN(C)]}}function l(t,n){var i=r?e:dN-e,a=0;if(t<-i)a|=1;else if(t>i)a|=2;if(n<-i)a|=4;else if(n>i)a|=8;return a}return wR(o,u,a,r?[0,-e]:[-dN,e-dN])}function CR(e,t,n,r,i,a){var o=e[0],u=e[1],s=t[0],l=t[1],f=0,c=1,h=s-o,d=l-u,p;p=n-o;if(!h&&p>0)return;p/=h;if(h<0){if(p<f)return;if(p<c)c=p}else if(h>0){if(p>c)return;if(p>f)f=p}p=i-o;if(!h&&p<0)return;p/=h;if(h<0){if(p>c)return;if(p>f)f=p}else if(h>0){if(p<f)return;if(p<c)c=p}p=r-u;if(!d&&p>0)return;p/=d;if(d<0){if(p<f)return;if(p<c)c=p}else if(d>0){if(p>c)return;if(p>f)f=p}p=a-u;if(!d&&p<0)return;p/=d;if(d<0){if(p>c)return;if(p>f)f=p}else if(d>0){if(p<f)return;if(p<c)c=p}if(f>0)e[0]=o+f*h,e[1]=u+f*d;if(c<1)t[0]=o+c*h,t[1]=u+c*d;return true}var FR=1e9,TR=-FR;function NR(e,t,n,r){function i(i,a){return e<=i&&i<=n&&t<=a&&a<=r}function a(i,a,u,l){var f=0,c=0;if(i==null||(f=o(i,u))!==(c=o(a,u))||s(i,a)<0^u>0){do{l.point(f===0||f===3?e:n,f>1?r:t)}while((f=(f+u+4)%4)!==c)}else{l.point(a[0],a[1])}}function o(r,i){return bN(r[0]-e)<cN?i>0?0:3:bN(r[0]-n)<cN?i>0?2:1:bN(r[1]-t)<cN?i>0?1:0:i>0?3:2}function u(e,t){return s(e.x,t.x)}function s(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:n===0?t[1]-e[1]:n===1?e[0]-t[0]:n===2?e[1]-t[1]:t[0]-e[0]}return function(o){var s=o,l=hR(),f,c,h,d,p,v,g,m,y,b,_;var x={point:w,lineStart:M,lineEnd:O,polygonStart:A,polygonEnd:E};function w(e,t){if(i(e,t))s.point(e,t)}function k(){var t=0;for(var n=0,i=c.length;n<i;++n){for(var a=c[n],o=1,u=a.length,s=a[0],l,f,h=s[0],d=s[1];o<u;++o){l=h,f=d,s=a[o],h=s[0],d=s[1];if(f<=r){if(d>r&&(h-l)*(r-f)>(d-f)*(e-l))++t}else{if(d<=r&&(h-l)*(r-f)<(d-f)*(e-l))--t}}}return t}function A(){s=l,f=[],c=[],_=true}function E(){var e=k(),t=_&&e,n=(f=xR(f)).length;if(t||n){o.polygonStart();if(t){o.lineStart();a(null,null,1,o);o.lineEnd()}if(n){vR(f,u,e,a,o)}o.polygonEnd()}s=o,f=c=h=null}function M(){x.point=S;if(c)c.push(h=[]);b=true;y=false;g=m=NaN}function O(){if(f){S(d,p);if(v&&y)l.rejoin();f.push(l.result())}x.point=w;if(y)s.lineEnd()}function S(a,o){var u=i(a,o);if(c)h.push([a,o]);if(b){d=a,p=o,v=u;b=false;if(u){s.lineStart();s.point(a,o)}}else{if(u&&y)s.point(a,o);else{var l=[g=Math.max(TR,Math.min(FR,g)),m=Math.max(TR,Math.min(FR,m))],f=[a=Math.max(TR,Math.min(FR,a)),o=Math.max(TR,Math.min(FR,o))];if(CR(l,f,e,t,n,r)){if(!y){s.lineStart();s.point(l[0],l[1])}s.point(f[0],f[1]);if(!u)s.lineEnd();_=false}else if(u){s.lineStart();s.point(a,o);_=false}}}g=a,m=o,y=u}return x}}function jR(e,t,n){var r=_R(e,t-cN,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function RR(e,t,n){var r=_R(e,t-cN,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}function zR(){var e,t,n,r,i,a,o,u,s=10,l=s,f=90,c=360,h,d,p,v,g=2.5;function m(){return{type:"MultiLineString",coordinates:y()}}function y(){return _R(kN(r/f)*f,n,f).map(p).concat(_R(kN(u/c)*c,o,c).map(v)).concat(_R(kN(t/s)*s,e,s).filter((function(e){return bN(e%f)>cN})).map(h)).concat(_R(kN(a/l)*l,i,l).filter((function(e){return bN(e%c)>cN})).map(d))}m.lines=function(){return y().map((function(e){return{type:"LineString",coordinates:e}}))};m.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(v(o).slice(1),p(n).reverse().slice(1),v(u).reverse().slice(1))]}};m.extent=function(e){if(!arguments.length)return m.extentMinor();return m.extentMajor(e).extentMinor(e)};m.extentMajor=function(e){if(!arguments.length)return[[r,u],[n,o]];r=+e[0][0],n=+e[1][0];u=+e[0][1],o=+e[1][1];if(r>n)e=r,r=n,n=e;if(u>o)e=u,u=o,o=e;return m.precision(g)};m.extentMinor=function(n){if(!arguments.length)return[[t,a],[e,i]];t=+n[0][0],e=+n[1][0];a=+n[0][1],i=+n[1][1];if(t>e)n=t,t=e,e=n;if(a>i)n=a,a=i,i=n;return m.precision(g)};m.step=function(e){if(!arguments.length)return m.stepMinor();return m.stepMajor(e).stepMinor(e)};m.stepMajor=function(e){if(!arguments.length)return[f,c];f=+e[0],c=+e[1];return m};m.stepMinor=function(e){if(!arguments.length)return[s,l];s=+e[0],l=+e[1];return m};m.precision=function(s){if(!arguments.length)return g;g=+s;h=jR(a,i,90);d=RR(t,e,g);p=jR(u,o,90);v=RR(r,n,g);return m};return m.extentMajor([[-180,-90+cN],[180,90-cN]]).extentMinor([[-180,-80-cN],[180,80+cN]])}function PR(e){return e}var LR=uN(),IR=uN(),BR,UR,qR,WR;var HR={point:NN,lineStart:NN,lineEnd:NN,polygonStart:function(){HR.lineStart=GR;HR.lineEnd=VR},polygonEnd:function(){HR.lineStart=HR.lineEnd=HR.point=NN;LR.add(bN(IR));IR.reset()},result:function(){var e=LR/2;LR.reset();return e}};function GR(){HR.point=$R}function $R(e,t){HR.point=YR;BR=qR=e,UR=WR=t}function YR(e,t){IR.add(WR*e-qR*t);qR=e,WR=t}function VR(){YR(BR,UR)}var XR=Infinity,JR=XR,ZR=-XR,QR=ZR;var KR={point:ez,lineStart:NN,lineEnd:NN,polygonStart:NN,polygonEnd:NN,result:function(){var e=[[XR,JR],[ZR,QR]];ZR=QR=-(JR=XR=Infinity);return e}};function ez(e,t){if(e<XR)XR=e;if(e>ZR)ZR=e;if(t<JR)JR=t;if(t>QR)QR=t}var tz=0,nz=0,rz=0,iz=0,az=0,oz=0,uz=0,sz=0,lz=0,fz,cz,hz,dz;var pz={point:vz,lineStart:gz,lineEnd:bz,polygonStart:function(){pz.lineStart=_z;pz.lineEnd=xz},polygonEnd:function(){pz.point=vz;pz.lineStart=gz;pz.lineEnd=bz},result:function(){var e=lz?[uz/lz,sz/lz]:oz?[iz/oz,az/oz]:rz?[tz/rz,nz/rz]:[NaN,NaN];tz=nz=rz=iz=az=oz=uz=sz=lz=0;return e}};function vz(e,t){tz+=e;nz+=t;++rz}function gz(){pz.point=mz}function mz(e,t){pz.point=yz;vz(hz=e,dz=t)}function yz(e,t){var n=e-hz,r=t-dz,i=DN(n*n+r*r);iz+=i*(hz+e)/2;az+=i*(dz+t)/2;oz+=i;vz(hz=e,dz=t)}function bz(){pz.point=vz}function _z(){pz.point=wz}function xz(){kz(fz,cz)}function wz(e,t){pz.point=kz;vz(fz=hz=e,cz=dz=t)}function kz(e,t){var n=e-hz,r=t-dz,i=DN(n*n+r*r);iz+=i*(hz+e)/2;az+=i*(dz+t)/2;oz+=i;i=dz*e-hz*t;uz+=i*(hz+e);sz+=i*(dz+t);lz+=i*3;vz(hz=e,dz=t)}function Az(e){this._context=e}Az.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._context.closePath();this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t);this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t);this._context.arc(e,t,this._radius,0,gN);break}}},result:NN};var Ez=uN(),Mz,Oz,Sz,Dz,Cz;var Fz={point:NN,lineStart:function(){Fz.point=Tz},lineEnd:function(){if(Mz)Nz(Oz,Sz);Fz.point=NN},polygonStart:function(){Mz=true},polygonEnd:function(){Mz=null},result:function(){var e=+Ez;Ez.reset();return e}};function Tz(e,t){Fz.point=Nz;Oz=Dz=e,Sz=Cz=t}function Nz(e,t){Dz-=e,Cz-=t;Ez.add(DN(Dz*Dz+Cz*Cz));Dz=e,Cz=t}function jz(){this._string=[]}jz.prototype={_radius:4.5,_circle:Rz(4.5),pointRadius:function(e){if((e=+e)!==this._radius)this._radius=e,this._circle=null;return this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._string.push("Z");this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t);this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{if(this._circle==null)this._circle=Rz(this._radius);this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");this._string=[];return e}else{return null}}};function Rz(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function zz(e,t){var n=4.5,r,i;function a(e){if(e){if(typeof n==="function")i.pointRadius(+n.apply(this,arguments));IN(e,r(i))}return i.result()}a.area=function(e){IN(e,r(HR));return HR.result()};a.measure=function(e){IN(e,r(Fz));return Fz.result()};a.bounds=function(e){IN(e,r(KR));return KR.result()};a.centroid=function(e){IN(e,r(pz));return pz.result()};a.projection=function(t){return arguments.length?(r=t==null?(e=null,PR):(e=t).stream,a):e};a.context=function(e){if(!arguments.length)return t;i=e==null?(t=null,new jz):new Az(t=e);if(typeof n!=="function")i.pointRadius(n);return a};a.pointRadius=function(e){if(!arguments.length)return n;n=typeof e==="function"?e:(i.pointRadius(+e),+e);return a};return a.projection(e).context(t)}function Pz(e){return function(t){var n=new Lz;for(var r in e)n[r]=e[r];n.stream=t;return n}}function Lz(){}Lz.prototype={constructor:Lz,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Iz(e,t,n){var r=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]);if(r!=null)e.clipExtent(null);IN(n,e.stream(KR));t(KR.result());if(r!=null)e.clipExtent(r);return e}function Bz(e,t,n){return Iz(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+t[0][0]+(r-a*(n[1][0]+n[0][0]))/2,u=+t[0][1]+(i-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([o,u])}),n)}function Uz(e,t,n){return Bz(e,[[0,0],t],n)}function qz(e,t,n){return Iz(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];e.scale(150*i).translate([a,o])}),n)}function Wz(e,t,n){return Iz(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([a,o])}),n)}var Hz=16,Gz=wN(30*yN);function $z(e,t){return+t?Vz(e,t):Yz(e)}function Yz(e){return Pz({point:function(t,n){t=e(t,n);this.stream.point(t[0],t[1])}})}function Vz(e,t){function n(r,i,a,o,u,s,l,f,c,h,d,p,v,g){var m=l-r,y=f-i,b=m*m+y*y;if(b>4*t&&v--){var _=o+h,x=u+d,w=s+p,k=DN(_*_+x*x+w*w),A=TN(w/=k),E=bN(bN(w)-1)<cN||bN(a-c)<cN?(a+c)/2:xN(x,_),M=e(E,A),O=M[0],S=M[1],D=O-r,C=S-i,F=y*D-m*C;if(F*F/b>t||bN((m*D+y*C)/b-.5)>.3||o*h+u*d+s*p<Gz){n(r,i,a,o,u,s,O,S,E,_/=k,x/=k,w,v,g);g.point(O,S);n(O,S,E,_,x,w,l,f,c,h,d,p,v,g)}}}return function(t){var r,i,a,o,u,s,l,f,c,h,d,p;var v={point:g,lineStart:m,lineEnd:b,polygonStart:function(){t.polygonStart();v.lineStart=_},polygonEnd:function(){t.polygonEnd();v.lineStart=m}};function g(n,r){n=e(n,r);t.point(n[0],n[1])}function m(){f=NaN;v.point=y;t.lineStart()}function y(r,i){var a=ej([r,i]),o=e(r,i);n(f,c,l,h,d,p,f=o[0],c=o[1],l=r,h=a[0],d=a[1],p=a[2],Hz,t);t.point(f,c)}function b(){v.point=g;t.lineEnd()}function _(){m();v.point=x;v.lineEnd=w}function x(e,t){y(r=e,t),i=f,a=c,o=h,u=d,s=p;v.point=y}function w(){n(f,c,l,h,d,p,i,a,r,o,u,s,Hz,t);v.lineEnd=b;b()}return v}}var Xz=Pz({point:function(e,t){this.stream.point(e*yN,t*yN)}});function Jz(e){return Pz({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function Zz(e,t,n){function r(r,i){return[t+e*r,n-e*i]}r.invert=function(r,i){return[(r-t)/e,(n-i)/e]};return r}function Qz(e,t,n,r){var i=wN(r),a=ON(r),o=i*e,u=a*e,s=i/e,l=a/e,f=(a*n-i*t)/e,c=(a*t+i*n)/e;function h(e,r){return[o*e-u*r+t,n-u*e-o*r]}h.invert=function(e,t){return[s*e-l*t+f,c-l*e-s*t]};return h}function Kz(e){return eP((function(){return e}))()}function eP(e){var t,n=150,r=480,i=250,a=0,o=0,u=0,s=0,l=0,f,c=0,h=null,d=ER,p=null,v,g,m,y=PR,b=.5,_,x,w,k,A;function E(e){return w(e[0]*yN,e[1]*yN)}function M(e){e=w.invert(e[0],e[1]);return e&&[e[0]*mN,e[1]*mN]}E.stream=function(e){return k&&A===e?k:k=Xz(Jz(f)(d(_(y(A=e)))))};E.preclip=function(e){return arguments.length?(d=e,h=undefined,S()):d};E.postclip=function(e){return arguments.length?(y=e,p=v=g=m=null,S()):y};E.clipAngle=function(e){return arguments.length?(d=+e?DR(h=e*yN):(h=null,ER),S()):h*mN};E.clipExtent=function(e){return arguments.length?(y=e==null?(p=v=g=m=null,PR):NR(p=+e[0][0],v=+e[0][1],g=+e[1][0],m=+e[1][1]),S()):p==null?null:[[p,v],[g,m]]};E.scale=function(e){return arguments.length?(n=+e,O()):n};E.translate=function(e){return arguments.length?(r=+e[0],i=+e[1],O()):[r,i]};E.center=function(e){return arguments.length?(a=e[0]%360*yN,o=e[1]%360*yN,O()):[a*mN,o*mN]};E.rotate=function(e){return arguments.length?(u=e[0]%360*yN,s=e[1]%360*yN,l=e.length>2?e[2]%360*yN:0,O()):[u*mN,s*mN,l*mN]};E.angle=function(e){return arguments.length?(c=e%360*yN,O()):c*mN};E.precision=function(e){return arguments.length?(_=$z(x,b=e*e),S()):DN(b)};E.fitExtent=function(e,t){return Bz(E,e,t)};E.fitSize=function(e,t){return Uz(E,e,t)};E.fitWidth=function(e,t){return qz(E,e,t)};E.fitHeight=function(e,t){return Wz(E,e,t)};function O(){var e=Qz(n,0,0,c).apply(null,t(a,o)),h=(c?Qz:Zz)(n,r-e[0],i-e[1],c);f=aR(u,s,l);x=rR(t,h);w=rR(f,x);_=$z(x,b);return S()}function S(){k=A=null;return E}return function(){t=e.apply(this,arguments);E.invert=t.invert&&M;return O()}}function tP(e){var t=0,n=dN/3,r=eP(e),i=r(t,n);i.parallels=function(e){return arguments.length?r(t=e[0]*yN,n=e[1]*yN):[t*mN,n*mN]};return i}function nP(e){var t=wN(e);function n(e,n){return[e*t,ON(n)/t]}n.invert=function(e,n){return[e/t,TN(n*t)]};return n}function rP(e,t){var n=ON(e),r=(n+ON(t))/2;if(bN(r)<cN)return nP(e);var i=1+n*(2*r-n),a=DN(i)/r;function o(e,t){var n=DN(i-2*r*ON(t))/r;return[n*ON(e*=r),a-n*wN(e)]}o.invert=function(e,t){var n=a-t;return[xN(e,bN(n))/r*SN(n),TN((i-(e*e+n*n)*r*r)/(2*r))]};return o}function iP(){return tP(rP).scale(155.424).center([0,33.6442])}function aP(){return iP().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function oP(e){var t=e.length;return{point:function(n,r){var i=-1;while(++i<t)e[i].point(n,r)},sphere:function(){var n=-1;while(++n<t)e[n].sphere()},lineStart:function(){var n=-1;while(++n<t)e[n].lineStart()},lineEnd:function(){var n=-1;while(++n<t)e[n].lineEnd()},polygonStart:function(){var n=-1;while(++n<t)e[n].polygonStart()},polygonEnd:function(){var n=-1;while(++n<t)e[n].polygonEnd()}}}function uP(){var e,t,n=aP(),r,i=iP().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=iP().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,s,l={point:function(e,t){s=[e,t]}};function f(e){var t=e[0],n=e[1];return s=null,(r.point(t,n),s)||(a.point(t,n),s)||(u.point(t,n),s)}f.invert=function(e){var t=n.scale(),r=n.translate(),a=(e[0]-r[0])/t,u=(e[1]-r[1])/t;return(u>=.12&&u<.234&&a>=-.425&&a<-.214?i:u>=.166&&u<.234&&a>=-.214&&a<-.115?o:n).invert(e)};f.stream=function(r){return e&&t===r?e:e=oP([n.stream(t=r),i.stream(r),o.stream(r)])};f.precision=function(e){if(!arguments.length)return n.precision();n.precision(e),i.precision(e),o.precision(e);return c()};f.scale=function(e){if(!arguments.length)return n.scale();n.scale(e),i.scale(e*.35),o.scale(e);return f.translate(n.translate())};f.translate=function(e){if(!arguments.length)return n.translate();var t=n.scale(),s=+e[0],f=+e[1];r=n.translate(e).clipExtent([[s-.455*t,f-.238*t],[s+.455*t,f+.238*t]]).stream(l);a=i.translate([s-.307*t,f+.201*t]).clipExtent([[s-.425*t+cN,f+.12*t+cN],[s-.214*t-cN,f+.234*t-cN]]).stream(l);u=o.translate([s-.205*t,f+.212*t]).clipExtent([[s-.214*t+cN,f+.166*t+cN],[s-.115*t-cN,f+.234*t-cN]]).stream(l);return c()};f.fitExtent=function(e,t){return Bz(f,e,t)};f.fitSize=function(e,t){return Uz(f,e,t)};f.fitWidth=function(e,t){return qz(f,e,t)};f.fitHeight=function(e,t){return Wz(f,e,t)};function c(){e=t=null;return f}return f.scale(1070)}function sP(e){return function(t,n){var r=wN(t),i=wN(n),a=e(r*i);return[a*i*ON(t),a*ON(n)]}}function lP(e){return function(t,n){var r=DN(t*t+n*n),i=e(r),a=ON(i),o=wN(i);return[xN(t*a,r*o),TN(r&&n*a/r)]}}var fP=sP((function(e){return DN(2/(1+e))}));fP.invert=lP((function(e){return 2*TN(e/2)}));function cP(){return Kz(fP).scale(124.75).clipAngle(180-.001)}var hP=sP((function(e){return(e=FN(e))&&e/ON(e)}));hP.invert=lP((function(e){return e}));function dP(){return Kz(hP).scale(79.4188).clipAngle(180-.001)}function pP(e,t){return[e,EN(CN((pN+t)/2))]}pP.invert=function(e,t){return[e,2*_N(AN(t))-pN]};function vP(){return gP(pP).scale(961/gN)}function gP(e){var t=Kz(e),n=t.center,r=t.scale,i=t.translate,a=t.clipExtent,o=null,u,s,l;t.scale=function(e){return arguments.length?(r(e),f()):r()};t.translate=function(e){return arguments.length?(i(e),f()):i()};t.center=function(e){return arguments.length?(n(e),f()):n()};t.clipExtent=function(e){return arguments.length?(e==null?o=u=s=l=null:(o=+e[0][0],u=+e[0][1],s=+e[1][0],l=+e[1][1]),f()):o==null?null:[[o,u],[s,l]]};function f(){var n=dN*r(),i=t(lR(t.rotate()).invert([0,0]));return a(o==null?[[i[0]-n,i[1]-n],[i[0]+n,i[1]+n]]:e===pP?[[Math.max(i[0]-n,o),u],[Math.min(i[0]+n,s),l]]:[[o,Math.max(i[1]-n,u)],[s,Math.min(i[1]+n,l)]])}return f()}function mP(e){return CN((pN+e)/2)}function yP(e,t){var n=wN(e),r=e===t?ON(e):EN(n/wN(t))/EN(mP(t)/mP(e)),i=n*MN(mP(e),r)/r;if(!r)return pP;function a(e,t){if(i>0){if(t<-pN+cN)t=-pN+cN}else{if(t>pN-cN)t=pN-cN}var n=i/MN(mP(t),r);return[n*ON(r*e),i-n*wN(r*e)]}a.invert=function(e,t){var n=i-t,a=SN(r)*DN(e*e+n*n);return[xN(e,bN(n))/r*SN(n),2*_N(MN(i/a,1/r))-pN]};return a}function bP(){return tP(yP).scale(109.5).parallels([30,30])}function _P(e,t){return[e,t]}_P.invert=_P;function xP(){return Kz(_P).scale(152.63)}function wP(e,t){var n=wN(e),r=e===t?ON(e):(n-wN(t))/(t-e),i=n/r+e;if(bN(r)<cN)return _P;function a(e,t){var n=i-t,a=r*e;return[n*ON(a),i-n*wN(a)]}a.invert=function(e,t){var n=i-t;return[xN(e,bN(n))/r*SN(n),i-SN(r)*DN(e*e+n*n)]};return a}function kP(){return tP(wP).scale(131.154).center([0,13.9389])}var AP=1.340264,EP=-.081106,MP=893e-6,OP=.003796,SP=DN(3)/2,DP=12;function CP(e,t){var n=TN(SP*ON(t)),r=n*n,i=r*r*r;return[e*wN(n)/(SP*(AP+3*EP*r+i*(7*MP+9*OP*r))),n*(AP+EP*r+i*(MP+OP*r))]}CP.invert=function(e,t){var n=t,r=n*n,i=r*r*r;for(var a=0,o,u,s;a<DP;++a){u=n*(AP+EP*r+i*(MP+OP*r))-t;s=AP+3*EP*r+i*(7*MP+9*OP*r);n-=o=u/s,r=n*n,i=r*r*r;if(bN(o)<hN)break}return[SP*e*(AP+3*EP*r+i*(7*MP+9*OP*r))/wN(n),TN(ON(n)/SP)]};function FP(){return Kz(CP).scale(177.158)}function TP(e,t){var n=wN(t),r=wN(e)*n;return[n*ON(e)/r,ON(t)/r]}TP.invert=lP(_N);function NP(){return Kz(TP).scale(144.049).clipAngle(60)}function jP(e,t,n,r){return e===1&&t===1&&n===0&&r===0?PR:Pz({point:function(i,a){this.stream.point(i*e+n,a*t+r)}})}function RP(){var e=1,t=0,n=0,r=1,i=1,a=PR,o=null,u,s,l,f=PR,c,h,d;function p(){c=h=null;return d}return d={stream:function(e){return c&&h===e?c:c=a(f(h=e))},postclip:function(e){return arguments.length?(f=e,o=u=s=l=null,p()):f},clipExtent:function(e){return arguments.length?(f=e==null?(o=u=s=l=null,PR):NR(o=+e[0][0],u=+e[0][1],s=+e[1][0],l=+e[1][1]),p()):o==null?null:[[o,u],[s,l]]},scale:function(o){return arguments.length?(a=jP((e=+o)*r,e*i,t,n),p()):e},translate:function(o){return arguments.length?(a=jP(e*r,e*i,t=+o[0],n=+o[1]),p()):[t,n]},reflectX:function(o){return arguments.length?(a=jP(e*(r=o?-1:1),e*i,t,n),p()):r<0},reflectY:function(o){return arguments.length?(a=jP(e*r,e*(i=o?-1:1),t,n),p()):i<0},fitExtent:function(e,t){return Bz(d,e,t)},fitSize:function(e,t){return Uz(d,e,t)},fitWidth:function(e,t){return qz(d,e,t)},fitHeight:function(e,t){return Wz(d,e,t)}}}function zP(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}zP.invert=function(e,t){var n=t,r=25,i;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-t)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(bN(i)>cN&&--r>0);return[e/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function PP(){return Kz(zP).scale(175.295)}function LP(e,t){return[wN(t)*ON(e),ON(t)]}LP.invert=lP(TN);function IP(){return Kz(LP).scale(249.5).clipAngle(90+cN)}function BP(e,t){var n=wN(t),r=1+wN(e)*n;return[n*ON(e)/r,ON(t)/r]}BP.invert=lP((function(e){return 2*_N(e)}));function UP(){return Kz(BP).scale(250).clipAngle(142)}function qP(e,t){return[EN(CN((pN+t)/2)),-e]}qP.invert=function(e,t){return[-t,2*_N(AN(e))-pN]};function WP(){var e=gP(qP),t=e.center,n=e.rotate;e.center=function(e){return arguments.length?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])};e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])};return n([0,0,90]).scale(159.155)}var HP=Math.abs;var GP=Math.cos;var $P=Math.sin;var YP=1e-6;var VP=Math.PI;var XP=VP/2;var JP=QP(2);function ZP(e){return e>1?XP:e<-1?-XP:Math.asin(e)}function QP(e){return e>0?Math.sqrt(e):0}function KP(e,t){var n=e*$P(t),r=30,i;do{t-=i=(t+$P(t)-n)/(1+GP(t))}while(HP(i)>YP&&--r>0);return t/2}function eL(e,t,n){function r(r,i){return[e*r*GP(i=KP(n,i)),t*$P(i)]}r.invert=function(r,i){return i=ZP(i/t),[r/(e*GP(i)),ZP((2*i+$P(2*i))/n)]};return r}var tL=eL(JP/XP,JP,VP);function nL(){return Kz(tL).scale(169.529)}var rL=zz();var iL=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function aL(e,t){return function n(){var r=t();r.type=e;r.path=zz().projection(r);r.copy=r.copy||function(){var e=n();iL.forEach((function(t){if(r[t])e[t](r[t]())}));e.path.pointRadius(r.path.pointRadius());return e};return r}}function oL(e,t){if(!e||typeof e!=="string"){throw new Error("Projection type must be a name string.")}e=e.toLowerCase();if(arguments.length>1){sL[e]=aL(e,t);return this}else{return sL[e]||null}}function uL(e){return e&&e.path||rL}var sL={albers:aP,albersusa:uP,azimuthalequalarea:cP,azimuthalequidistant:dP,conicconformal:bP,conicequalarea:iP,conicequidistant:kP,equalEarth:FP,equirectangular:xP,gnomonic:NP,identity:RP,mercator:vP,mollweide:nL,naturalEarth1:PP,orthographic:IP,stereographic:UP,transversemercator:WP};for(var lL in sL){oL(lL,sL[lL])}function fL(e){zv.call(this,null,e)}fL.Definition={type:"GeoPath",metadata:{modifies:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"path"}]};var cL=MT(fL,zv);cL.transform=function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||gT,a=e.as||"path",o=n.SOURCE;function u(e){e[a]=r(i(e))}if(!r||e.modified()){this.value=r=uL(e.projection);n.materialize().reflow()}else{o=i===gT||t.modified(i.fields)?n.ADD_MOD:n.ADD}var s=hL(r,e.pointRadius);n.visit(o,u);r.pointRadius(s);return n.modifies(a)};function hL(e,t){var n=e.pointRadius();e.context(null);if(t!=null){e.pointRadius(t)}return n}function dL(e){zv.call(this,null,e)}dL.Definition={type:"GeoPoint",metadata:{modifies:true},params:[{name:"projection",type:"projection",required:true},{name:"fields",type:"field",array:true,required:true,length:2},{name:"as",type:"string",array:true,length:2,default:["x","y"]}]};var pL=MT(dL,zv);pL.transform=function(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],a=e.as||["x","y"],o=a[0],u=a[1],s;function l(e){var t=n([r(e),i(e)]);if(t){e[o]=t[0];e[u]=t[1]}else{e[o]=undefined;e[u]=undefined}}if(e.modified()){t=t.materialize().reflow(true).visit(t.SOURCE,l)}else{s=t.modified(r.fields)||t.modified(i.fields);t.visit(s?t.ADD_MOD:t.ADD,l)}return t.modifies(a)};function vL(e){zv.call(this,null,e)}vL.Definition={type:"GeoShape",metadata:{modifies:true,nomod:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"shape"}]};var gL=MT(vL,zv);gL.transform=function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",a=n.ADD;if(!r||e.modified()){this.value=r=mL(uL(e.projection),e.field||dT("datum"),e.pointRadius);n.materialize().reflow();a=n.SOURCE}n.visit(a,(function(e){e[i]=r}));return n.modifies(i)};function mL(e,t,n){var r=n==null?function(n){return e(t(n))}:function(r){var i=e.pointRadius(),a=e.pointRadius(n)(t(r));e.pointRadius(i);return a};r.context=function(t){e.context(t);return r};return r}function yL(e){zv.call(this,[],e);this.generator=zR()}yL.Definition={type:"Graticule",metadata:{changes:true,generates:true},params:[{name:"extent",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMajor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMinor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"step",type:"number",array:true,length:2},{name:"stepMajor",type:"number",array:true,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:true,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};var bL=MT(yL,zv);bL.transform=function(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified()){for(var a in e){if(wT(r[a])){r[a](e[a])}}}i=r();if(n.length){t.mod.push(av(n[0],i))}else{t.add.push(rv(i))}n[0]=i;return t};function _L(e){zv.call(this,null,e)}_L.Definition={type:"heatmap",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:true},{name:"opacity",type:"number",expr:true},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};var xL=MT(_L,zv);xL.transform=function(e,t){if(!t.changed()&&!e.modified()){return t.StopPropagation}var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||gT,a=kL(e.opacity,e),o=wL(e.color,e),u=e.as||"image",s={$x:0,$y:0,$value:0,$max:r?Pl(n.map((function(e){return Pl(i(e).values)}))):0};n.forEach((function(e){var t=i(e);var n=AT({},e,s);if(!r)n.$max=Pl(t.values||[]);e[u]=EL(t,n,o.dep?o:kT(o(n)),a.dep?a:kT(a(n)))}));return t.reflow(true).modifies(u)};function wL(e,t){var n;if(wT(e)){n=function(n){return pA(e(n,t))};n.dep=AL(e)}else{n=kT(pA(e||"#888"))}return n}function kL(e,t){var n;if(wT(e)){n=function(n){return e(n,t)};n.dep=AL(e)}else if(e){n=kT(e)}else{n=function(e){return e.$value/e.$max||0};n.dep=true}return n}function AL(e){if(!wT(e))return false;var t=ST(oT(e));return t.$x||t.$y||t.$value||t.$max}function EL(e,t,n,r){var i=e.width,a=e.height,o=e.x1||0,u=e.y1||0,s=e.x2||i,l=e.y2||a,f=e.values,c=f?function(e){return f[e]}:mT,h=Yv(s-o,l-u),d=h.getContext("2d"),p=d.getImageData(0,0,s-o,l-u),v=p.data;for(var g=u,m=0;g<l;++g){t.$y=g-u;for(var y=o,b=g*i;y<s;++y,m+=4){t.$x=y-o;t.$value=c(y+b);var _=n(t);v[m+0]=_.r;v[m+1]=_.g;v[m+2]=_.b;v[m+3]=~~(255*r(t))}}d.putImageData(p,0,0);return h}function ML(e){zv.call(this,null,e);this.modified(true)}var OL=MT(ML,zv);OL.transform=function(e,t){var n=this.value;if(!n||e.modified("type")){this.value=n=DL(e.type);iL.forEach((function(t){if(e[t]!=null)CL(n,t,e[t])}))}else{iL.forEach((function(t){if(e.modified(t))CL(n,t,e[t])}))}if(e.pointRadius!=null)n.path.pointRadius(e.pointRadius);if(e.fit)SL(n,e);return t.fork(t.NO_SOURCE|t.NO_FIELDS)};function SL(e,t){var n=FL(t.fit);t.extent?e.fitExtent(t.extent,n):t.size?e.fitSize(t.size,n):0}function DL(e){var t=oL((e||"mercator").toLowerCase());if(!t)uT("Unrecognized projection type: "+e);return t()}function CL(e,t,n){if(wT(e[t]))e[t](n)}function FL(e){e=xT(e);return e.length===1?e[0]:{type:rN,features:e.reduce((function(e,t){return e.concat(TL(t))}),[])}}function TL(e){return e.type===rN?e.features:xT(e).filter((function(e){return e!=null})).map((function(e){return e.type===nN?e:{type:nN,geometry:e}}))}var NL=Object.freeze({__proto__:null,contour:eN,geojson:aN,geopath:fL,geopoint:dL,geoshape:vL,graticule:yL,heatmap:_L,isocontour:IT,kde2d:XT,projection:ML});function jL(e,t){var n;if(e==null)e=0;if(t==null)t=0;function r(){var r,i=n.length,a,o=0,u=0;for(r=0;r<i;++r){a=n[r],o+=a.x,u+=a.y}for(o=o/i-e,u=u/i-t,r=0;r<i;++r){a=n[r],a.x-=o,a.y-=u}}r.initialize=function(e){n=e};r.x=function(t){return arguments.length?(e=+t,r):e};r.y=function(e){return arguments.length?(t=+e,r):t};return r}function RL(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return zL(this.cover(t,n),t,n,e)}function zL(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},u=e._x0,s=e._y0,l=e._x1,f=e._y1,c,h,d,p,v,g,m,y;if(!a)return e._root=o,e;while(a.length){if(v=t>=(c=(u+l)/2))u=c;else l=c;if(g=n>=(h=(s+f)/2))s=h;else f=h;if(i=a,!(a=a[m=g<<1|v]))return i[m]=o,e}d=+e._x.call(null,a.data);p=+e._y.call(null,a.data);if(t===d&&n===p)return o.next=a,i?i[m]=o:e._root=o,e;do{i=i?i[m]=new Array(4):e._root=new Array(4);if(v=t>=(c=(u+l)/2))u=c;else l=c;if(g=n>=(h=(s+f)/2))s=h;else f=h}while((m=g<<1|v)===(y=(p>=h)<<1|d>=c));return i[y]=a,i[m]=o,e}function PL(e){var t,n,r=e.length,i,a,o=new Array(r),u=new Array(r),s=Infinity,l=Infinity,f=-Infinity,c=-Infinity;for(n=0;n<r;++n){if(isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t)))continue;o[n]=i;u[n]=a;if(i<s)s=i;if(i>f)f=i;if(a<l)l=a;if(a>c)c=a}if(s>f||l>c)return this;this.cover(s,l).cover(f,c);for(n=0;n<r;++n){zL(this,o[n],u[n],e[n])}return this}function LL(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n)){i=(n=Math.floor(e))+1;a=(r=Math.floor(t))+1}else{var o=i-n,u=this._root,s,l;while(n>e||e>=i||r>t||t>=a){l=(t<r)<<1|e<n;s=new Array(4),s[l]=u,u=s,o*=2;switch(l){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}}if(this._root&&this._root.length)this._root=u}this._x0=n;this._y0=r;this._x1=i;this._y1=a;return this}function IL(){var e=[];this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}));return e}function BL(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?undefined:[[this._x0,this._y0],[this._x1,this._y1]]}function UL(e,t,n,r,i){this.node=e;this.x0=t;this.y0=n;this.x1=r;this.y1=i}function qL(e,t,n){var r,i=this._x0,a=this._y0,o,u,s,l,f=this._x1,c=this._y1,h=[],d=this._root,p,v;if(d)h.push(new UL(d,i,a,f,c));if(n==null)n=Infinity;else{i=e-n,a=t-n;f=e+n,c=t+n;n*=n}while(p=h.pop()){if(!(d=p.node)||(o=p.x0)>f||(u=p.y0)>c||(s=p.x1)<i||(l=p.y1)<a)continue;if(d.length){var g=(o+s)/2,m=(u+l)/2;h.push(new UL(d[3],g,m,s,l),new UL(d[2],o,m,g,l),new UL(d[1],g,u,s,m),new UL(d[0],o,u,g,m));if(v=(t>=m)<<1|e>=g){p=h[h.length-1];h[h.length-1]=h[h.length-1-v];h[h.length-1-v]=p}}else{var y=e-+this._x.call(null,d.data),b=t-+this._y.call(null,d.data),_=y*y+b*b;if(_<n){var x=Math.sqrt(n=_);i=e-x,a=t-x;f=e+x,c=t+x;r=d.data}}}return r}function WL(e){if(isNaN(f=+this._x.call(null,e))||isNaN(c=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,u=this._y0,s=this._x1,l=this._y1,f,c,h,d,p,v,g,m;if(!n)return this;if(n.length)while(true){if(p=f>=(h=(o+s)/2))o=h;else s=h;if(v=c>=(d=(u+l)/2))u=d;else l=d;if(!(t=n,n=n[g=v<<1|p]))return this;if(!n.length)break;if(t[g+1&3]||t[g+2&3]||t[g+3&3])r=t,m=g}while(n.data!==e)if(!(i=n,n=n.next))return this;if(a=n.next)delete n.next;if(i)return a?i.next=a:delete i.next,this;if(!t)return this._root=a,this;a?t[g]=a:delete t[g];if((n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length){if(r)r[m]=n;else this._root=n}return this}function HL(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function GL(){return this._root}function $L(){var e=0;this.visit((function(t){if(!t.length)do{++e}while(t=t.next)}));return e}function YL(e){var t=[],n,r=this._root,i,a,o,u,s;if(r)t.push(new UL(r,this._x0,this._y0,this._x1,this._y1));while(n=t.pop()){if(!e(r=n.node,a=n.x0,o=n.y0,u=n.x1,s=n.y1)&&r.length){var l=(a+u)/2,f=(o+s)/2;if(i=r[3])t.push(new UL(i,l,f,u,s));if(i=r[2])t.push(new UL(i,a,f,l,s));if(i=r[1])t.push(new UL(i,l,o,u,f));if(i=r[0])t.push(new UL(i,a,o,l,f))}}return this}function VL(e){var t=[],n=[],r;if(this._root)t.push(new UL(this._root,this._x0,this._y0,this._x1,this._y1));while(r=t.pop()){var i=r.node;if(i.length){var a,o=r.x0,u=r.y0,s=r.x1,l=r.y1,f=(o+s)/2,c=(u+l)/2;if(a=i[0])t.push(new UL(a,o,u,f,c));if(a=i[1])t.push(new UL(a,f,u,s,c));if(a=i[2])t.push(new UL(a,o,c,f,l));if(a=i[3])t.push(new UL(a,f,c,s,l))}n.push(r)}while(r=n.pop()){e(r.node,r.x0,r.y0,r.x1,r.y1)}return this}function XL(e){return e[0]}function JL(e){return arguments.length?(this._x=e,this):this._x}function ZL(e){return e[1]}function QL(e){return arguments.length?(this._y=e,this):this._y}function KL(e,t,n){var r=new eI(t==null?XL:t,n==null?ZL:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function eI(e,t,n,r,i,a){this._x=e;this._y=t;this._x0=n;this._y0=r;this._x1=i;this._y1=a;this._root=undefined}function tI(e){var t={data:e.data},n=t;while(e=e.next)n=n.next={data:e.data};return t}var nI=KL.prototype=eI.prototype;nI.copy=function(){var e=new eI(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=tI(t),e;n=[{source:t,target:e._root=new Array(4)}];while(t=n.pop()){for(var i=0;i<4;++i){if(r=t.source[i]){if(r.length)n.push({source:r,target:t.target[i]=new Array(4)});else t.target[i]=tI(r)}}}return e};nI.add=RL;nI.addAll=PL;nI.cover=LL;nI.data=IL;nI.extent=BL;nI.find=qL;nI.remove=WL;nI.removeAll=HL;nI.root=GL;nI.size=$L;nI.visit=YL;nI.visitAfter=VL;nI.x=JL;nI.y=QL;function rI(e){return function(){return e}}function iI(){return(Math.random()-.5)*1e-6}function aI(e){return e.x+e.vx}function oI(e){return e.y+e.vy}function uI(e){var t,n,r=1,i=1;if(typeof e!=="function")e=rI(e==null?1:+e);function a(){var e,a=t.length,u,s,l,f,c,h;for(var d=0;d<i;++d){u=KL(t,aI,oI).visitAfter(o);for(e=0;e<a;++e){s=t[e];c=n[s.index],h=c*c;l=s.x+s.vx;f=s.y+s.vy;u.visit(p)}}function p(e,t,n,i,a){var o=e.data,u=e.r,d=c+u;if(o){if(o.index>s.index){var p=l-o.x-o.vx,v=f-o.y-o.vy,g=p*p+v*v;if(g<d*d){if(p===0)p=iI(),g+=p*p;if(v===0)v=iI(),g+=v*v;g=(d-(g=Math.sqrt(g)))/g*r;s.vx+=(p*=g)*(d=(u*=u)/(h+u));s.vy+=(v*=g)*d;o.vx-=p*(d=1-d);o.vy-=v*d}}return}return t>l+d||i<l-d||n>f+d||a<f-d}}function o(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t){if(e[t]&&e[t].r>e.r){e.r=e[t].r}}}function u(){if(!t)return;var r,i=t.length,a;n=new Array(i);for(r=0;r<i;++r)a=t[r],n[a.index]=+e(a,r,t)}a.initialize=function(e){t=e;u()};a.iterations=function(e){return arguments.length?(i=+e,a):i};a.strength=function(e){return arguments.length?(r=+e,a):r};a.radius=function(t){return arguments.length?(e=typeof t==="function"?t:rI(+t),u(),a):e};return a}function sI(e){return e.index}function lI(e,t){var n=e.get(t);if(!n)throw new Error("missing: "+t);return n}function fI(e){var t=sI,n=f,r,i=rI(30),a,o,u,s,l=1;if(e==null)e=[];function f(e){return 1/Math.min(u[e.source.index],u[e.target.index])}function c(t){for(var n=0,i=e.length;n<l;++n){for(var o=0,u,f,c,h,d,p,v;o<i;++o){u=e[o],f=u.source,c=u.target;h=c.x+c.vx-f.x-f.vx||iI();d=c.y+c.vy-f.y-f.vy||iI();p=Math.sqrt(h*h+d*d);p=(p-a[o])/p*t*r[o];h*=p,d*=p;c.vx-=h*(v=s[o]);c.vy-=d*v;f.vx+=h*(v=1-v);f.vy+=d*v}}}function h(){if(!o)return;var n,i=o.length,l=e.length,f=new Map(o.map((function(e,n){return[t(e,n,o),e]}))),c;for(n=0,u=new Array(i);n<l;++n){c=e[n],c.index=n;if(typeof c.source!=="object")c.source=lI(f,c.source);if(typeof c.target!=="object")c.target=lI(f,c.target);u[c.source.index]=(u[c.source.index]||0)+1;u[c.target.index]=(u[c.target.index]||0)+1}for(n=0,s=new Array(l);n<l;++n){c=e[n],s[n]=u[c.source.index]/(u[c.source.index]+u[c.target.index])}r=new Array(l),d();a=new Array(l),p()}function d(){if(!o)return;for(var t=0,i=e.length;t<i;++t){r[t]=+n(e[t],t,e)}}function p(){if(!o)return;for(var t=0,n=e.length;t<n;++t){a[t]=+i(e[t],t,e)}}c.initialize=function(e){o=e;h()};c.links=function(t){return arguments.length?(e=t,h(),c):e};c.id=function(e){return arguments.length?(t=e,c):t};c.iterations=function(e){return arguments.length?(l=+e,c):l};c.strength=function(e){return arguments.length?(n=typeof e==="function"?e:rI(+e),d(),c):n};c.distance=function(e){return arguments.length?(i=typeof e==="function"?e:rI(+e),p(),c):i};return c}var cI={value:function(){}};function hI(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n)throw new Error("illegal type: "+r);n[r]=[]}return new dI(n)}function dI(e){this._=e}function pI(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0)n=e.slice(r+1),e=e.slice(0,r);if(e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}dI.prototype=hI.prototype={constructor:dI,on:function(e,t){var n=this._,r=pI(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){while(++a<o)if((i=(e=r[a]).type)&&(i=vI(n[i],e.name)))return i;return}if(t!=null&&typeof t!=="function")throw new Error("invalid callback: "+t);while(++a<o){if(i=(e=r[a]).type)n[i]=gI(n[i],e.name,t);else if(t==null)for(i in n)n[i]=gI(n[i],e.name,null)}return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new dI(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function vI(e,t){for(var n=0,r=e.length,i;n<r;++n){if((i=e[n]).name===t){return i.value}}}function gI(e,t,n){for(var r=0,i=e.length;r<i;++r){if(e[r].name===t){e[r]=cI,e=e.slice(0,r).concat(e.slice(r+1));break}}if(n!=null)e.push({name:t,value:n});return e}var mI=0,yI=0,bI=0,_I=1e3,xI,wI,kI=0,AI=0,EI=0,MI=typeof performance==="object"&&performance.now?performance:Date,OI=typeof window==="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function SI(){return AI||(OI(DI),AI=MI.now()+EI)}function DI(){AI=0}function CI(){this._call=this._time=this._next=null}CI.prototype=FI.prototype={constructor:CI,restart:function(e,t,n){if(typeof e!=="function")throw new TypeError("callback is not a function");n=(n==null?SI():+n)+(t==null?0:+t);if(!this._next&&wI!==this){if(wI)wI._next=this;else xI=this;wI=this}this._call=e;this._time=n;zI()},stop:function(){if(this._call){this._call=null;this._time=Infinity;zI()}}};function FI(e,t,n){var r=new CI;r.restart(e,t,n);return r}function TI(){SI();++mI;var e=xI,t;while(e){if((t=AI-e._time)>=0)e._call.call(null,t);e=e._next}--mI}function NI(){AI=(kI=MI.now())+EI;mI=yI=0;try{TI()}finally{mI=0;RI();AI=0}}function jI(){var e=MI.now(),t=e-kI;if(t>_I)EI-=t,kI=e}function RI(){var e,t=xI,n,r=Infinity;while(t){if(t._call){if(r>t._time)r=t._time;e=t,t=t._next}else{n=t._next,t._next=null;t=e?e._next=n:xI=n}}wI=e;zI(r)}function zI(e){if(mI)return;if(yI)yI=clearTimeout(yI);var t=e-AI;if(t>24){if(e<Infinity)yI=setTimeout(NI,e-MI.now()-EI);if(bI)bI=clearInterval(bI)}else{if(!bI)kI=MI.now(),bI=setInterval(jI,_I);mI=1,OI(NI)}}function PI(e){return e.x}function LI(e){return e.y}var II=10,BI=Math.PI*(3-Math.sqrt(5));function UI(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,u=new Map,s=FI(f),l=hI("tick","end");if(e==null)e=[];function f(){c();l.call("tick",t);if(n<r){s.stop();l.call("end",t)}}function c(r){var s,l=e.length,f;if(r===undefined)r=1;for(var c=0;c<r;++c){n+=(a-n)*i;u.forEach((function(e){e(n)}));for(s=0;s<l;++s){f=e[s];if(f.fx==null)f.x+=f.vx*=o;else f.x=f.fx,f.vx=0;if(f.fy==null)f.y+=f.vy*=o;else f.y=f.fy,f.vy=0}}return t}function h(){for(var t=0,n=e.length,r;t<n;++t){r=e[t],r.index=t;if(r.fx!=null)r.x=r.fx;if(r.fy!=null)r.y=r.fy;if(isNaN(r.x)||isNaN(r.y)){var i=II*Math.sqrt(t),a=t*BI;r.x=i*Math.cos(a);r.y=i*Math.sin(a)}if(isNaN(r.vx)||isNaN(r.vy)){r.vx=r.vy=0}}}function d(t){if(t.initialize)t.initialize(e);return t}h();return t={tick:c,restart:function(){return s.restart(f),t},stop:function(){return s.stop(),t},nodes:function(n){return arguments.length?(e=n,h(),u.forEach(d),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(a=+e,t):a},velocityDecay:function(e){return arguments.length?(o=1-e,t):1-o},force:function(e,n){return arguments.length>1?(n==null?u.delete(e):u.set(e,d(n)),t):u.get(e)},find:function(t,n,r){var i=0,a=e.length,o,u,s,l,f;if(r==null)r=Infinity;else r*=r;for(i=0;i<a;++i){l=e[i];o=t-l.x;u=n-l.y;s=o*o+u*u;if(s<r)f=l,r=s}return f},on:function(e,n){return arguments.length>1?(l.on(e,n),t):l.on(e)}}}function qI(){var e,t,n,r=rI(-30),i,a=1,o=Infinity,u=.81;function s(r){var i,a=e.length,o=KL(e,PI,LI).visitAfter(f);for(n=r,i=0;i<a;++i)t=e[i],o.visit(c)}function l(){if(!e)return;var t,n=e.length,a;i=new Array(n);for(t=0;t<n;++t)a=e[t],i[a.index]=+r(a,t,e)}function f(e){var t=0,n,r,a=0,o,u,s;if(e.length){for(o=u=s=0;s<4;++s){if((n=e[s])&&(r=Math.abs(n.value))){t+=n.value,a+=r,o+=r*n.x,u+=r*n.y}}e.x=o/a;e.y=u/a}else{n=e;n.x=n.data.x;n.y=n.data.y;do{t+=i[n.data.index]}while(n=n.next)}e.value=t}function c(e,r,s,l){if(!e.value)return true;var f=e.x-t.x,c=e.y-t.y,h=l-r,d=f*f+c*c;if(h*h/u<d){if(d<o){if(f===0)f=iI(),d+=f*f;if(c===0)c=iI(),d+=c*c;if(d<a)d=Math.sqrt(a*d);t.vx+=f*e.value*n/d;t.vy+=c*e.value*n/d}return true}else if(e.length||d>=o)return;if(e.data!==t||e.next){if(f===0)f=iI(),d+=f*f;if(c===0)c=iI(),d+=c*c;if(d<a)d=Math.sqrt(a*d)}do{if(e.data!==t){h=i[e.data.index]*n/d;t.vx+=f*h;t.vy+=c*h}}while(e=e.next)}s.initialize=function(t){e=t;l()};s.strength=function(e){return arguments.length?(r=typeof e==="function"?e:rI(+e),l(),s):r};s.distanceMin=function(e){return arguments.length?(a=e*e,s):Math.sqrt(a)};s.distanceMax=function(e){return arguments.length?(o=e*e,s):Math.sqrt(o)};s.theta=function(e){return arguments.length?(u=e*e,s):Math.sqrt(u)};return s}function WI(e){var t=rI(.1),n,r,i;if(typeof e!=="function")e=rI(e==null?0:+e);function a(e){for(var t=0,a=n.length,o;t<a;++t){o=n[t],o.vx+=(i[t]-o.x)*r[t]*e}}function o(){if(!n)return;var a,o=n.length;r=new Array(o);i=new Array(o);for(a=0;a<o;++a){r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}a.initialize=function(e){n=e;o()};a.strength=function(e){return arguments.length?(t=typeof e==="function"?e:rI(+e),o(),a):t};a.x=function(t){return arguments.length?(e=typeof t==="function"?t:rI(+t),o(),a):e};return a}function HI(e){var t=rI(.1),n,r,i;if(typeof e!=="function")e=rI(e==null?0:+e);function a(e){for(var t=0,a=n.length,o;t<a;++t){o=n[t],o.vy+=(i[t]-o.y)*r[t]*e}}function o(){if(!n)return;var a,o=n.length;r=new Array(o);i=new Array(o);for(a=0;a<o;++a){r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}a.initialize=function(e){n=e;o()};a.strength=function(e){return arguments.length?(t=typeof e==="function"?e:rI(+e),o(),a):t};a.y=function(t){return arguments.length?(e=typeof t==="function"?t:rI(+t),o(),a):e};return a}var GI={center:jL,collide:uI,nbody:qI,link:fI,x:WI,y:HI};var $I="forces",YI=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],VI=["static","iterations"],XI=["x","y","vx","vy"];function JI(e){zv.call(this,null,e)}JI.Definition={type:"Force",metadata:{modifies:true},params:[{name:"static",type:"boolean",default:false},{name:"restart",type:"boolean",default:false},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:true,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:true},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:true},{name:"strength",type:"number",expr:true},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:true,modify:false,default:XI}]};var ZI=or(JI,zv);ZI.transform=function(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(YI),a=e.iterations||300;if(!n){this.value=n=KI(t.source,e);n.on("tick",QI(t.dataflow,this));if(!e.static){r=true;n.tick()}t.modifies("index")}else{if(r){t.modifies("index");n.nodes(t.source)}if(i||t.changed(t.MOD)){eB(n,e,0,t)}}if(i||r||e.modified(VI)||t.changed()&&e.restart){n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a));if(e.static){for(n.stop();--a>=0;)n.tick()}else{if(n.stopped())n.restart();if(!r)return t.StopPropagation}}return this.finish(e,t)};ZI.finish=function(e,t){var n=t.dataflow;for(var r=this._argops,i=0,a=r.length,o;i<a;++i){o=r[i];if(o.name!==$I||o.op._argval.force!=="link"){continue}for(var u=o.op._argops,s=0,l=u.length,f;s<l;++s){if(u[s].name==="links"&&(f=u[s].op.source)){n.pulse(f,n.changeset().reflow());break}}}return t.reflow(e.modified()).modifies(XI)};function QI(e,t){return function(){e.touch(t).run()}}function KI(e,t){var n=UI(e),r=false,i=n.stop,a=n.restart;n.stopped=function(){return r};n.restart=function(){r=false;return a()};n.stop=function(){r=true;return i()};return eB(n,t,true).on("end",(function(){r=true}))}function eB(e,t,n,r){var i=Kn(t.forces),a,o,u,s;for(a=0,o=YI.length;a<o;++a){u=YI[a];if(u!==$I&&t.modified(u))e[u](t[u])}for(a=0,o=i.length;a<o;++a){s=$I+a;u=n||t.modified($I,a)?nB(i[a]):r&&tB(i[a],r)?e.force(s):null;if(u)e.force(s,u)}for(o=e.numForces||0;a<o;++a){e.force($I+a,null)}e.numForces=i.length;return e}function tB(e,t){var n,r;for(n in e){if(er(r=e[n])&&t.modified(Nn(r)))return 1}return 0}function nB(e){var t,n;if(!ar(GI,e.force)){jn("Unrecognized force: "+e.force)}t=GI[e.force]();for(n in e){if(er(t[n]))rB(t[n],e[n],e)}return t}function rB(e,t,n){e(er(t)?function(e){return t(e,n)}:t)}var iB=Object.freeze({__proto__:null,force:JI});function aB(e,t,n){var r={};e.each((function(e){var i=e.data;if(n(i))r[t(i)]=e}));e.lookup=r;return e}function oB(e,t){return e.parent===t.parent?1:2}function uB(e){return e.reduce(sB,0)/e.length}function sB(e,t){return e+t.x}function lB(e){return 1+e.reduce(fB,0)}function fB(e,t){return Math.max(e,t.y)}function cB(e){var t;while(t=e.children)e=t[0];return e}function hB(e){var t;while(t=e.children)e=t[t.length-1];return e}function dB(){var e=oB,t=1,n=1,r=false;function i(i){var a,o=0;i.eachAfter((function(t){var n=t.children;if(n){t.x=uB(n);t.y=lB(n)}else{t.x=a?o+=e(t,a):0;t.y=0;a=t}}));var u=cB(i),s=hB(i),l=u.x-e(u,s)/2,f=s.x+e(s,u)/2;return i.eachAfter(r?function(e){e.x=(e.x-i.x)*t;e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-l)/(f-l)*t;e.y=(1-(i.y?e.y/i.y:1))*n})}i.separation=function(t){return arguments.length?(e=t,i):e};i.size=function(e){return arguments.length?(r=false,t=+e[0],n=+e[1],i):r?null:[t,n]};i.nodeSize=function(e){return arguments.length?(r=true,t=+e[0],n=+e[1],i):r?[t,n]:null};return i}function pB(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else while(--r>=0)t+=n[r].value;e.value=t}function vB(){return this.eachAfter(pB)}function gB(e){var t=this,n,r=[t],i,a,o;do{n=r.reverse(),r=[];while(t=n.pop()){e(t),i=t.children;if(i)for(a=0,o=i.length;a<o;++a){r.push(i[a])}}}while(r.length);return this}function mB(e){var t=this,n=[t],r,i;while(t=n.pop()){e(t),r=t.children;if(r)for(i=r.length-1;i>=0;--i){n.push(r[i])}}return this}function yB(e){var t=this,n=[t],r=[],i,a,o;while(t=n.pop()){r.push(t),i=t.children;if(i)for(a=0,o=i.length;a<o;++a){n.push(i[a])}}while(t=r.pop()){e(t)}return this}function bB(e){return this.eachAfter((function(t){var n=+e(t.data)||0,r=t.children,i=r&&r.length;while(--i>=0)n+=r[i].value;t.value=n}))}function _B(e){return this.eachBefore((function(t){if(t.children){t.children.sort(e)}}))}function xB(e){var t=this,n=wB(t,e),r=[t];while(t!==n){t=t.parent;r.push(t)}var i=r.length;while(e!==n){r.splice(i,0,e);e=e.parent}return r}function wB(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;e=n.pop();t=r.pop();while(e===t){i=e;e=n.pop();t=r.pop()}return i}function kB(){var e=this,t=[e];while(e=e.parent){t.push(e)}return t}function AB(){var e=[];this.each((function(t){e.push(t)}));return e}function EB(){var e=[];this.eachBefore((function(t){if(!t.children){e.push(t)}}));return e}function MB(){var e=this,t=[];e.each((function(n){if(n!==e){t.push({source:n.parent,target:n})}}));return t}function OB(e,t){var n=new TB(e),r=+e.value&&(n.value=e.value),i,a=[n],o,u,s,l;if(t==null)t=DB;while(i=a.pop()){if(r)i.value=+i.data.value;if((u=t(i.data))&&(l=u.length)){i.children=new Array(l);for(s=l-1;s>=0;--s){a.push(o=i.children[s]=new TB(u[s]));o.parent=i;o.depth=i.depth+1}}}return n.eachBefore(FB)}function SB(){return OB(this).eachBefore(CB)}function DB(e){return e.children}function CB(e){e.data=e.data.data}function FB(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function TB(e){this.data=e;this.depth=this.height=0;this.parent=null}TB.prototype=OB.prototype={constructor:TB,count:vB,each:gB,eachAfter:yB,eachBefore:mB,sum:bB,sort:_B,path:xB,ancestors:kB,descendants:AB,leaves:EB,links:MB,copy:SB};var NB=Array.prototype.slice;function jB(e){var t=e.length,n,r;while(t){r=Math.random()*t--|0;n=e[t];e[t]=e[r];e[r]=n}return e}function RB(e){var t=0,n=(e=jB(NB.call(e))).length,r=[],i,a;while(t<n){i=e[t];if(a&&LB(a,i))++t;else a=BB(r=zB(r,i)),t=0}return a}function zB(e,t){var n,r;if(IB(t,e))return[t];for(n=0;n<e.length;++n){if(PB(t,e[n])&&IB(qB(e[n],t),e)){return[e[n],t]}}for(n=0;n<e.length-1;++n){for(r=n+1;r<e.length;++r){if(PB(qB(e[n],e[r]),t)&&PB(qB(e[n],t),e[r])&&PB(qB(e[r],t),e[n])&&IB(WB(e[n],e[r],t),e)){return[e[n],e[r],t]}}}throw new Error}function PB(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function LB(e,t){var n=e.r-t.r+1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function IB(e,t){for(var n=0;n<t.length;++n){if(!LB(e,t[n])){return false}}return true}function BB(e){switch(e.length){case 1:return UB(e[0]);case 2:return qB(e[0],e[1]);case 3:return WB(e[0],e[1],e[2])}}function UB(e){return{x:e.x,y:e.y,r:e.r}}function qB(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,o=t.y,u=t.r,s=a-n,l=o-r,f=u-i,c=Math.sqrt(s*s+l*l);return{x:(n+a+s/c*f)/2,y:(r+o+l/c*f)/2,r:(c+i+u)/2}}function WB(e,t,n){var r=e.x,i=e.y,a=e.r,o=t.x,u=t.y,s=t.r,l=n.x,f=n.y,c=n.r,h=r-o,d=r-l,p=i-u,v=i-f,g=s-a,m=c-a,y=r*r+i*i-a*a,b=y-o*o-u*u+s*s,_=y-l*l-f*f+c*c,x=d*p-h*v,w=(p*_-v*b)/(x*2)-r,k=(v*g-p*m)/x,A=(d*b-h*_)/(x*2)-i,E=(h*m-d*g)/x,M=k*k+E*E-1,O=2*(a+w*k+A*E),S=w*w+A*A-a*a,D=-(M?(O+Math.sqrt(O*O-4*M*S))/(2*M):S/O);return{x:r+w+k*D,y:i+A+E*D,r:D}}function HB(e,t,n){var r=e.x-t.x,i,a,o=e.y-t.y,u,s,l=r*r+o*o;if(l){a=t.r+n.r,a*=a;s=e.r+n.r,s*=s;if(a>s){i=(l+s-a)/(2*l);u=Math.sqrt(Math.max(0,s/l-i*i));n.x=e.x-i*r-u*o;n.y=e.y-i*o+u*r}else{i=(l+a-s)/(2*l);u=Math.sqrt(Math.max(0,a/l-i*i));n.x=t.x+i*r-u*o;n.y=t.y+i*o+u*r}}else{n.x=t.x+n.r;n.y=t.y}}function GB(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function $B(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,a=(t.y*n.r+n.y*t.r)/r;return i*i+a*a}function YB(e){this._=e;this.next=null;this.previous=null}function VB(e){if(!(i=e.length))return 0;var t,n,r,i,a,o,u,s,l,f,c;t=e[0],t.x=0,t.y=0;if(!(i>1))return t.r;n=e[1],t.x=-n.r,n.x=t.r,n.y=0;if(!(i>2))return t.r+n.r;HB(n,t,r=e[2]);t=new YB(t),n=new YB(n),r=new YB(r);t.next=r.previous=n;n.next=t.previous=r;r.next=n.previous=t;e:for(u=3;u<i;++u){HB(t._,n._,r=e[u]),r=new YB(r);s=n.next,l=t.previous,f=n._.r,c=t._.r;do{if(f<=c){if(GB(s._,r._)){n=s,t.next=n,n.previous=t,--u;continue e}f+=s._.r,s=s.next}else{if(GB(l._,r._)){t=l,t.next=n,n.previous=t,--u;continue e}c+=l._.r,l=l.previous}}while(s!==l.next);r.previous=t,r.next=n,t.next=n.previous=n=r;a=$B(t);while((r=r.next)!==n){if((o=$B(r))<a){t=r,a=o}}n=t.next}t=[n._],r=n;while((r=r.next)!==n)t.push(r._);r=RB(t);for(u=0;u<i;++u)t=e[u],t.x-=r.x,t.y-=r.y;return r.r}function XB(e){return e==null?null:JB(e)}function JB(e){if(typeof e!=="function")throw new Error;return e}function ZB(){return 0}function QB(e){return function(){return e}}function KB(e){return Math.sqrt(e.value)}function eU(){var e=null,t=1,n=1,r=ZB;function i(i){i.x=t/2,i.y=n/2;if(e){i.eachBefore(tU(e)).eachAfter(nU(r,.5)).eachBefore(rU(1))}else{i.eachBefore(tU(KB)).eachAfter(nU(ZB,1)).eachAfter(nU(r,i.r/Math.min(t,n))).eachBefore(rU(Math.min(t,n)/(2*i.r)))}return i}i.radius=function(t){return arguments.length?(e=XB(t),i):e};i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]};i.padding=function(e){return arguments.length?(r=typeof e==="function"?e:QB(+e),i):r};return i}function tU(e){return function(t){if(!t.children){t.r=Math.max(0,+e(t)||0)}}}function nU(e,t){return function(n){if(r=n.children){var r,i,a=r.length,o=e(n)*t||0,u;if(o)for(i=0;i<a;++i)r[i].r+=o;u=VB(r);if(o)for(i=0;i<a;++i)r[i].r-=o;n.r=u+o}}}function rU(e){return function(t){var n=t.parent;t.r*=e;if(n){t.x=n.x+e*t.x;t.y=n.y+e*t.y}}}function iU(e){e.x0=Math.round(e.x0);e.y0=Math.round(e.y0);e.x1=Math.round(e.x1);e.y1=Math.round(e.y1)}function aU(e,t,n,r,i){var a=e.children,o,u=-1,s=a.length,l=e.value&&(r-t)/e.value;while(++u<s){o=a[u],o.y0=n,o.y1=i;o.x0=t,o.x1=t+=o.value*l}}function oU(){var e=1,t=1,n=0,r=false;function i(i){var o=i.height+1;i.x0=i.y0=n;i.x1=e;i.y1=t/o;i.eachBefore(a(t,o));if(r)i.eachBefore(iU);return i}function a(e,t){return function(r){if(r.children){aU(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t)}var i=r.x0,a=r.y0,o=r.x1-n,u=r.y1-n;if(o<i)i=o=(i+o)/2;if(u<a)a=u=(a+u)/2;r.x0=i;r.y0=a;r.x1=o;r.y1=u}}i.round=function(e){return arguments.length?(r=!!e,i):r};i.size=function(n){return arguments.length?(e=+n[0],t=+n[1],i):[e,t]};i.padding=function(e){return arguments.length?(n=+e,i):n};return i}var uU="$",sU={depth:-1},lU={};function fU(e){return e.id}function cU(e){return e.parentId}function hU(){var e=fU,t=cU;function n(n){var r,i,a=n.length,o,u,s,l=new Array(a),f,c,h={};for(i=0;i<a;++i){r=n[i],s=l[i]=new TB(r);if((f=e(r,i,n))!=null&&(f+="")){c=uU+(s.id=f);h[c]=c in h?lU:s}}for(i=0;i<a;++i){s=l[i],f=t(n[i],i,n);if(f==null||!(f+="")){if(o)throw new Error("multiple roots");o=s}else{u=h[uU+f];if(!u)throw new Error("missing: "+f);if(u===lU)throw new Error("ambiguous: "+f);if(u.children)u.children.push(s);else u.children=[s];s.parent=u}}if(!o)throw new Error("no root");o.parent=sU;o.eachBefore((function(e){e.depth=e.parent.depth+1;--a})).eachBefore(FB);o.parent=null;if(a>0)throw new Error("cycle");return o}n.id=function(t){return arguments.length?(e=JB(t),n):e};n.parentId=function(e){return arguments.length?(t=JB(e),n):t};return n}function dU(e,t){return e.parent===t.parent?1:2}function pU(e){var t=e.children;return t?t[0]:e.t}function vU(e){var t=e.children;return t?t[t.length-1]:e.t}function gU(e,t,n){var r=n/(t.i-e.i);t.c-=r;t.s+=n;e.c+=r;t.z+=n;t.m+=n}function mU(e){var t=0,n=0,r=e.children,i=r.length,a;while(--i>=0){a=r[i];a.z+=t;a.m+=t;t+=a.s+(n+=a.c)}}function yU(e,t,n){return e.a.parent===t.parent?e.a:n}function bU(e,t){this._=e;this.parent=null;this.children=null;this.A=null;this.a=this;this.z=0;this.m=0;this.c=0;this.s=0;this.t=null;this.i=t}bU.prototype=Object.create(TB.prototype);function _U(e){var t=new bU(e,0),n,r=[t],i,a,o,u;while(n=r.pop()){if(a=n._.children){n.children=new Array(u=a.length);for(o=u-1;o>=0;--o){r.push(i=n.children[o]=new bU(a[o],o));i.parent=n}}}(t.parent=new bU(null,0)).children=[t];return t}function xU(){var e=dU,t=1,n=1,r=null;function i(i){var u=_U(i);u.eachAfter(a),u.parent.m=-u.z;u.eachBefore(o);if(r)i.eachBefore(s);else{var l=i,f=i,c=i;i.eachBefore((function(e){if(e.x<l.x)l=e;if(e.x>f.x)f=e;if(e.depth>c.depth)c=e}));var h=l===f?1:e(l,f)/2,d=h-l.x,p=t/(f.x+h+d),v=n/(c.depth||1);i.eachBefore((function(e){e.x=(e.x+d)*p;e.y=e.depth*v}))}return i}function a(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){mU(t);var a=(n[0].z+n[n.length-1].z)/2;if(i){t.z=i.z+e(t._,i._);t.m=t.z-a}else{t.z=a}}else if(i){t.z=i.z+e(t._,i._)}t.parent.A=u(t,i,t.parent.A||r[0])}function o(e){e._.x=e.z+e.parent.m;e.m+=e.parent.m}function u(t,n,r){if(n){var i=t,a=t,o=n,u=i.parent.children[0],s=i.m,l=a.m,f=o.m,c=u.m,h;while(o=vU(o),i=pU(i),o&&i){u=pU(u);a=vU(a);a.a=t;h=o.z+f-i.z-s+e(o._,i._);if(h>0){gU(yU(o,t,r),t,h);s+=h;l+=h}f+=o.m;s+=i.m;c+=u.m;l+=a.m}if(o&&!vU(a)){a.t=o;a.m+=f-l}if(i&&!pU(u)){u.t=i;u.m+=s-c;r=t}}return r}function s(e){e.x*=t;e.y=e.depth*n}i.separation=function(t){return arguments.length?(e=t,i):e};i.size=function(e){return arguments.length?(r=false,t=+e[0],n=+e[1],i):r?null:[t,n]};i.nodeSize=function(e){return arguments.length?(r=true,t=+e[0],n=+e[1],i):r?[t,n]:null};return i}function wU(e,t,n,r,i){var a=e.children,o,u=-1,s=a.length,l=e.value&&(i-n)/e.value;while(++u<s){o=a[u],o.x0=t,o.x1=r;o.y0=n,o.y1=n+=o.value*l}}var kU=(1+Math.sqrt(5))/2;function AU(e,t,n,r,i,a){var o=[],u=t.children,s,l,f=0,c=0,h=u.length,d,p,v=t.value,g,m,y,b,_,x,w;while(f<h){d=i-n,p=a-r;do{g=u[c++].value}while(!g&&c<h);m=y=g;x=Math.max(p/d,d/p)/(v*e);w=g*g*x;_=Math.max(y/w,w/m);for(;c<h;++c){g+=l=u[c].value;if(l<m)m=l;if(l>y)y=l;w=g*g*x;b=Math.max(y/w,w/m);if(b>_){g-=l;break}_=b}o.push(s={value:g,dice:d<p,children:u.slice(f,c)});if(s.dice)aU(s,n,r,i,v?r+=p*g/v:a);else wU(s,n,r,v?n+=d*g/v:i,a);v-=g,f=c}return o}var EU=function e(t){function n(e,n,r,i,a){AU(t,e,n,r,i,a)}n.ratio=function(t){return e((t=+t)>1?t:1)};return n}(kU);function MU(){var e=EU,t=false,n=1,r=1,i=[0],a=ZB,o=ZB,u=ZB,s=ZB,l=ZB;function f(e){e.x0=e.y0=0;e.x1=n;e.y1=r;e.eachBefore(c);i=[0];if(t)e.eachBefore(iU);return e}function c(t){var n=i[t.depth],r=t.x0+n,f=t.y0+n,c=t.x1-n,h=t.y1-n;if(c<r)r=c=(r+c)/2;if(h<f)f=h=(f+h)/2;t.x0=r;t.y0=f;t.x1=c;t.y1=h;if(t.children){n=i[t.depth+1]=a(t)/2;r+=l(t)-n;f+=o(t)-n;c-=u(t)-n;h-=s(t)-n;if(c<r)r=c=(r+c)/2;if(h<f)f=h=(f+h)/2;e(t,r,f,c,h)}}f.round=function(e){return arguments.length?(t=!!e,f):t};f.size=function(e){return arguments.length?(n=+e[0],r=+e[1],f):[n,r]};f.tile=function(t){return arguments.length?(e=JB(t),f):e};f.padding=function(e){return arguments.length?f.paddingInner(e).paddingOuter(e):f.paddingInner()};f.paddingInner=function(e){return arguments.length?(a=typeof e==="function"?e:QB(+e),f):a};f.paddingOuter=function(e){return arguments.length?f.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):f.paddingTop()};f.paddingTop=function(e){return arguments.length?(o=typeof e==="function"?e:QB(+e),f):o};f.paddingRight=function(e){return arguments.length?(u=typeof e==="function"?e:QB(+e),f):u};f.paddingBottom=function(e){return arguments.length?(s=typeof e==="function"?e:QB(+e),f):s};f.paddingLeft=function(e){return arguments.length?(l=typeof e==="function"?e:QB(+e),f):l};return f}function OU(e,t,n,r,i){var a=e.children,o,u=a.length,s,l=new Array(u+1);for(l[0]=s=o=0;o<u;++o){l[o+1]=s+=a[o].value}f(0,u,e.value,t,n,r,i);function f(e,t,n,r,i,o,u){if(e>=t-1){var s=a[e];s.x0=r,s.y0=i;s.x1=o,s.y1=u;return}var c=l[e],h=n/2+c,d=e+1,p=t-1;while(d<p){var v=d+p>>>1;if(l[v]<h)d=v+1;else p=v}if(h-l[d-1]<l[d]-h&&e+1<d)--d;var g=l[d]-c,m=n-g;if(o-r>u-i){var y=(r*m+o*g)/n;f(e,d,g,r,i,y,u);f(d,t,m,y,i,o,u)}else{var b=(i*m+u*g)/n;f(e,d,g,r,i,o,b);f(d,t,m,r,b,o,u)}}}function SU(e,t,n,r,i){(e.depth&1?wU:aU)(e,t,n,r,i)}var DU=function e(t){function n(e,n,r,i,a){if((o=e._squarify)&&o.ratio===t){var o,u,s,l,f=-1,c,h=o.length,d=e.value;while(++f<h){u=o[f],s=u.children;for(l=u.value=0,c=s.length;l<c;++l)u.value+=s[l].value;if(u.dice)aU(u,n,r,i,r+=(a-r)*u.value/d);else wU(u,n,r,n+=(i-n)*u.value/d,a);d-=u.value}}else{e._squarify=o=AU(t,e,n,r,i,a);o.ratio=t}}n.ratio=function(t){return e((t=+t)>1?t:1)};return n}(kU);function CU(e){zv.call(this,null,e)}CU.Definition={type:"Nest",metadata:{treesource:true,changes:true},params:[{name:"keys",type:"field",array:true},{name:"generate",type:"boolean"}]};var FU=or(CU,zv);function TU(e){return e.values}FU.transform=function(e,t){if(!t.source){jn("Nest transform requires an upstream data source.")}var n=e.generate,r=e.modified(),i=t.clone(),a=this.value;if(!a||r||t.changed()){if(a){a.each((function(e){if(e.children&&ev(e.data)){i.rem.push(e.data)}}))}this.value=a=OB({values:Kn(e.keys).reduce((function(e,t){e.key(t);return e}),NU()).entries(i.source)},TU);if(n){a.each((function(e){if(e.children){e=rv(e.data);i.add.push(e);i.source.push(e)}}))}aB(a,tv,tv)}i.source.root=a;return i};function NU(){var e=[],t;function n(t,r){if(r>=e.length){return t}var i=-1,a=t.length,o=e[r++],u,s,l={},f,c={};while(++i<a){u=o(s=t[i])+"";if(f=l[u]){f.push(s)}else{l[u]=[s]}}for(u in l){c[u]=n(l[u],r)}return c}function r(t,n){if(++n>e.length)return t;var i=[],a;for(a in t){i.push({key:a,values:r(t[a],n)})}return i}return t={entries:function(e){return r(n(e,0),0)},key:function(n){e.push(n);return t}}}function jU(e){zv.call(this,null,e)}var RU=or(jU,zv);RU.transform=function(e,t){if(!t.source||!t.source.root){jn(this.constructor.name+" transform requires a backing tree data source.")}var n=this.layout(e.method),r=this.fields,i=t.source.root,a=e.as||r;if(e.field)i.sum(e.field);else i.count();if(e.sort)i.sort(ov(e.sort,(function(e){return e.data})));zU(n,this.params,e);if(n.separation){n.separation(e.separation!==false?LU:Gn)}try{this.value=n(i)}catch(o){jn(o)}i.each((function(e){PU(e,r,a)}));return t.reflow(e.modified()).modifies(a).modifies("leaf")};function zU(e,t,n){for(var r,i=0,a=t.length;i<a;++i){r=t[i];if(r in n)e[r](n[r])}}function PU(e,t,n){var r=e.data;for(var i=0,a=t.length-1;i<a;++i){r[n[i]]=e[t[i]]}r[n[a]]=e.children?e.children.length:0}function LU(e,t){return e.parent===t.parent?1:2}var IU=["x","y","r","depth","children"];function BU(e){jU.call(this,e)}BU.Definition={type:"Pack",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:IU.length,default:IU}]};var UU=or(BU,jU);UU.layout=eU;UU.params=["radius","size","padding"];UU.fields=IU;var qU=["x0","y0","x1","y1","depth","children"];function WU(e){jU.call(this,e)}WU.Definition={type:"Partition",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:qU.length,default:qU}]};var HU=or(WU,jU);HU.layout=oU;HU.params=["size","round","padding"];HU.fields=qU;function GU(e){zv.call(this,null,e)}GU.Definition={type:"Stratify",metadata:{treesource:true},params:[{name:"key",type:"field",required:true},{name:"parentKey",type:"field",required:true}]};var $U=or(GU,zv);$U.transform=function(e,t){if(!t.source){jn("Stratify transform requires an upstream data source.")}var n=this.value,r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),a=!this.value||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);i.source=i.source.slice();if(a){if(i.source.length){n=aB(hU().id(e.key).parentId(e.parentKey)(i.source),e.key,$n)}else{n=aB(hU()([{}]),e.key,e.key)}}i.source.root=this.value=n;return i};var YU={tidy:xU,cluster:dB};var VU=["x","y","depth","children"];function XU(e){jU.call(this,e)}XU.Definition={type:"Tree",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:true,length:2},{name:"nodeSize",type:"number",array:true,length:2},{name:"separation",type:"boolean",default:true},{name:"as",type:"string",array:true,length:VU.length,default:VU}]};var JU=or(XU,jU);JU.layout=function(e){var t=e||"tidy";if(ar(YU,t))return YU[t]();else jn("Unrecognized Tree layout method: "+t)};JU.params=["size","nodeSize"];JU.fields=VU;function ZU(e){zv.call(this,[],e)}ZU.Definition={type:"TreeLinks",metadata:{tree:true,generates:true,changes:true},params:[]};var QU=or(ZU,zv);QU.transform=function(e,t){var n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),a={};if(!r)jn("TreeLinks transform requires a tree data source.");if(t.changed(t.ADD_REM)){i.rem=n;t.visit(t.SOURCE,(function(e){a[tv(e)]=1}));r.each((function(e){var t=e.data,n=e.parent&&e.parent.data;if(n&&a[tv(t)]&&a[tv(n)]){i.add.push(rv({source:n,target:t}))}}));this.value=i.add}else if(t.changed(t.MOD)){t.visit(t.MOD,(function(e){a[tv(e)]=1}));n.forEach((function(e){if(a[tv(e.source)]||a[tv(e.target)]){i.mod.push(e)}}))}return i};var KU={binary:OU,dice:aU,slice:wU,slicedice:SU,squarify:EU,resquarify:DU};var eq=["x0","y0","x1","y1","depth","children"];function tq(e){jU.call(this,e)}tq.Definition={type:"Treemap",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:eq.length,default:eq}]};var nq=or(tq,jU);nq.layout=function(){var e=MU();e.ratio=function(t){var n=e.tile();if(n.ratio)e.tile(n.ratio(t))};e.method=function(t){if(ar(KU,t))e.tile(KU[t]);else jn("Unrecognized Treemap layout method: "+t)};return e};nq.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"];nq.fields=eq;var rq=Object.freeze({__proto__:null,nest:CU,pack:BU,partition:WU,stratify:GU,tree:XU,treelinks:ZU,treemap:tq});function iq(e,t){var n=[],r=function(e){return e(u)},i,a,o,u,s,l;if(t==null){n.push(e)}else{for(i={},a=0,o=e.length;a<o;++a){u=e[a];s=t.map(r);l=i[s];if(!l){i[s]=l=[];l.dims=s;n.push(l)}l.push(u)}}return n}function aq(e,t,n){e.fields=t||[];e.fname=n;return e}function oq(e){return e==null?null:e.fname}function uq(e){throw Error(e)}function sq(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)uq("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)uq("Access path missing closing bracket: "+e);if(n)uq("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var lq=Array.isArray;function fq(e){return e===Object(e)}function cq(e){return typeof e==="string"}function hq(e){return lq(e)?"["+e.map(hq)+"]":fq(e)||cq(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function dq(e,t){var n=sq(e),r="return _["+n.map(hq).join("][")+"];";return aq(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var pq=[];var vq=dq("id");var gq=aq((function(e){return e}),pq,"identity");var mq=aq((function(){return 0}),pq,"zero");var yq=aq((function(){return 1}),pq,"one");var bq=aq((function(){return true}),pq,"true");var _q=aq((function(){return false}),pq,"false");function xq(e,t){var n=0,r,i,a,o;if(e&&(r=e.length)){if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);a=o=i;for(;n<r;++n){i=e[n];if(i!=null){if(i<a)a=i;if(i>o)o=i}}}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));a=o=i;for(;n<r;++n){i=t(e[n]);if(i!=null){if(i<a)a=i;if(i>o)o=i}}}}return[a,o]}var wq=Object.prototype.hasOwnProperty;function kq(e,t){return wq.call(e,t)}function Aq(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function Eq(e){zv.call(this,null,e)}Eq.Definition={type:"Loess",metadata:{generates:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:true}]};var Mq=Aq(Eq,zv);Mq.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,i=iq(r,e.groupby),a=(e.groupby||[]).map(oq),o=a.length,u=e.as||[oq(e.x),oq(e.y)],s=[];i.forEach((function(t){qf(t,e.x,e.y,e.bandwidth||.3).forEach((function(e){var n={};for(var r=0;r<o;++r){n[a[r]]=t.dims[r]}n[u[0]]=e[0];n[u[1]]=e[1];s.push(rv(n))}))}));if(this.value)n.rem=this.value;this.value=n.add=n.source=s}return n};var Oq={linear:Tf,log:Nf,exp:jf,pow:Rf,quad:zf,poly:Pf};function Sq(e,t){return e==="poly"?t:e==="quad"?2:1}function Dq(e){zv.call(this,null,e)}Dq.Definition={type:"Regression",metadata:{generates:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"method",type:"string",default:"linear",values:Object.keys(Oq)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:true,length:2},{name:"params",type:"boolean",default:false},{name:"as",type:"string",array:true}]};var Cq=Aq(Dq,zv);Cq.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,i=iq(r,e.groupby),a=(e.groupby||[]).map(oq),o=e.method||"linear",u=e.order||3,s=Sq(o,u),l=e.as||[oq(e.x),oq(e.y)],f=Oq[o],c=[];var h=e.extent;if(!kq(Oq,o)){uq("Invalid regression method: "+o)}if(h!=null){if(o==="log"&&h[0]<=0){t.dataflow.warn("Ignoring extent with values <= 0 for log regression.");h=null}}i.forEach((function(n){var r=n.length;if(r<=s){t.dataflow.warn("Skipping regression with more parameters than data points.");return}var i=f(n,e.x,e.y,u);if(e.params){c.push(rv({keys:n.dims,coef:i.coef,rSquared:i.rSquared}));return}var d=h||xq(n,e.x),p=function(e){var t={};for(var r=0;r<a.length;++r){t[a[r]]=n.dims[r]}t[l[0]]=e[0];t[l[1]]=e[1];c.push(rv(t))};if(o==="linear"){d.forEach((function(e){return p([e,i.predict(e)])}))}else{Yf(i.predict,d,25,200).forEach(p)}}));if(this.value)n.rem=this.value;this.value=n.add=n.source=c}return n};var Fq=Object.freeze({__proto__:null,loess:Eq,regression:Dq});var Tq=Math.pow(2,-52);var Nq=new Uint32Array(512);var jq=function(){function e(e){var t=e.length>>1;if(t>0&&typeof e[0]!=="number")throw new Error("Expected coords to contain numbers.");this.coords=e;var n=Math.max(2*t-5,0);this._triangles=new Uint32Array(n*3);this._halfedges=new Int32Array(n*3);this._hashSize=Math.ceil(Math.sqrt(t));this._hullPrev=new Uint32Array(t);this._hullNext=new Uint32Array(t);this._hullTri=new Uint32Array(t);this._hullHash=new Int32Array(this._hashSize).fill(-1);this._ids=new Uint32Array(t);this._dists=new Float64Array(t);this.update()}e.from=function(t,n,r){if(n===void 0){n=Hq}if(r===void 0){r=Gq}var i=t.length;var a=new Float64Array(i*2);for(var o=0;o<i;o++){var u=t[o];a[2*o]=n(u);a[2*o+1]=r(u)}return new e(a)};e.prototype.update=function(){var e=this,t=e.coords,n=e._hullPrev,r=e._hullNext,i=e._hullTri,a=e._hullHash;var o=t.length>>1;var u=Infinity;var s=Infinity;var l=-Infinity;var f=-Infinity;for(var c=0;c<o;c++){var h=t[2*c];var d=t[2*c+1];if(h<u)u=h;if(d<s)s=d;if(h>l)l=h;if(d>f)f=d;this._ids[c]=c}var p=(u+l)/2;var v=(s+f)/2;var g=Infinity;var m,y,b;for(var c=0;c<o;c++){var _=zq(p,v,t[2*c],t[2*c+1]);if(_<g){m=c;g=_}}var x=t[2*m];var w=t[2*m+1];g=Infinity;for(var c=0;c<o;c++){if(c===m)continue;var _=zq(x,w,t[2*c],t[2*c+1]);if(_<g&&_>0){y=c;g=_}}var k=t[2*y];var A=t[2*y+1];var E=Infinity;for(var c=0;c<o;c++){if(c===m||c===y)continue;var M=Bq(x,w,k,A,t[2*c],t[2*c+1]);if(M<E){b=c;E=M}}var O=t[2*b];var S=t[2*b+1];if(E===Infinity){for(var c=0;c<o;c++){this._dists[c]=t[2*c]-t[0]||t[2*c+1]-t[1]}qq(this._ids,this._dists,0,o-1);var D=new Uint32Array(o);var C=0;for(var c=0,F=-Infinity;c<o;c++){var T=this._ids[c];if(this._dists[T]>F){D[C++]=T;F=this._dists[T]}}this.hull=D.subarray(0,C);this.triangles=new Uint32Array(0);this.halfedges=new Uint32Array(0);return}if(Lq(x,w,k,A,O,S)){var c=y;var N=k;var j=A;y=b;k=O;A=S;b=c;O=N;S=j}var R=Uq(x,w,k,A,O,S);this._cx=R.x;this._cy=R.y;for(var c=0;c<o;c++){this._dists[c]=zq(t[2*c],t[2*c+1],R.x,R.y)}qq(this._ids,this._dists,0,o-1);this._hullStart=m;var z=3;r[m]=n[b]=y;r[y]=n[m]=b;r[b]=n[y]=m;i[m]=0;i[y]=1;i[b]=2;a.fill(-1);a[this._hashKey(x,w)]=m;a[this._hashKey(k,A)]=y;a[this._hashKey(O,S)]=b;this.trianglesLen=0;this._addTriangle(m,y,b,-1,-1,-1);for(var P=0,L=void 0,I=void 0;P<this._ids.length;P++){var c=this._ids[P];var B=t[2*c];var U=t[2*c+1];if(P>0&&Math.abs(B-L)<=Tq&&Math.abs(U-I)<=Tq)continue;L=B;I=U;if(c===m||c===y||c===b)continue;var q=0;for(var C=0,W=this._hashKey(B,U);C<this._hashSize;C++){q=a[(W+C)%this._hashSize];if(q!==-1&&q!==r[q])break}q=n[q];var H=q,G=void 0;while(G=r[H],!Lq(B,U,t[2*H],t[2*H+1],t[2*G],t[2*G+1])){H=G;if(H===q){H=-1;break}}if(H===-1)continue;var $=this._addTriangle(H,c,r[H],-1,-1,i[H]);i[c]=this._legalize($+2);i[H]=$;z++;var Y=r[H];while(G=r[Y],Lq(B,U,t[2*Y],t[2*Y+1],t[2*G],t[2*G+1])){$=this._addTriangle(Y,c,G,i[c],-1,i[Y]);i[c]=this._legalize($+2);r[Y]=Y;z--;Y=G}if(H===q){while(G=n[H],Lq(B,U,t[2*G],t[2*G+1],t[2*H],t[2*H+1])){$=this._addTriangle(G,c,H,-1,i[H],i[G]);this._legalize($+2);i[G]=$;r[H]=H;z--;H=G}}this._hullStart=n[c]=H;r[H]=n[Y]=c;r[c]=Y;a[this._hashKey(B,U)]=c;a[this._hashKey(t[2*H],t[2*H+1])]=H}this.hull=new Uint32Array(z);for(var c=0,H=this._hullStart;c<z;c++){this.hull[c]=H;H=r[H]}this.triangles=this._triangles.subarray(0,this.trianglesLen);this.halfedges=this._halfedges.subarray(0,this.trianglesLen)};e.prototype._hashKey=function(e,t){return Math.floor(Rq(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize};e.prototype._legalize=function(e){var t=this,n=t._triangles,r=t._halfedges,i=t.coords;var a=0;var o=0;while(true){var u=r[e];var s=e-e%3;o=s+(e+2)%3;if(u===-1){if(a===0)break;e=Nq[--a];continue}var l=u-u%3;var f=s+(e+1)%3;var c=l+(u+2)%3;var h=n[o];var d=n[e];var p=n[f];var v=n[c];var g=Iq(i[2*h],i[2*h+1],i[2*d],i[2*d+1],i[2*p],i[2*p+1],i[2*v],i[2*v+1]);if(g){n[e]=v;n[u]=h;var m=r[c];if(m===-1){var y=this._hullStart;do{if(this._hullTri[y]===c){this._hullTri[y]=e;break}y=this._hullPrev[y]}while(y!==this._hullStart)}this._link(e,m);this._link(u,r[o]);this._link(o,c);var b=l+(u+1)%3;if(a<Nq.length){Nq[a++]=b}}else{if(a===0)break;e=Nq[--a]}}return o};e.prototype._link=function(e,t){this._halfedges[e]=t;if(t!==-1)this._halfedges[t]=e};e.prototype._addTriangle=function(e,t,n,r,i,a){var o=this.trianglesLen;this._triangles[o]=e;this._triangles[o+1]=t;this._triangles[o+2]=n;this._link(o,r);this._link(o+1,i);this._link(o+2,a);this.trianglesLen+=3;return o};return e}();function Rq(e,t){var n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function zq(e,t,n,r){var i=e-n;var a=t-r;return i*i+a*a}function Pq(e,t,n,r,i,a){var o=(r-t)*(i-e);var u=(n-e)*(a-t);return Math.abs(o-u)>=33306690738754716e-32*Math.abs(o+u)?o-u:0}function Lq(e,t,n,r,i,a){var o=Pq(i,a,e,t,n,r)||Pq(e,t,n,r,i,a)||Pq(n,r,i,a,e,t);return o<0}function Iq(e,t,n,r,i,a,o,u){var s=e-o;var l=t-u;var f=n-o;var c=r-u;var h=i-o;var d=a-u;var p=s*s+l*l;var v=f*f+c*c;var g=h*h+d*d;return s*(c*g-v*d)-l*(f*g-v*h)+p*(f*d-c*h)<0}function Bq(e,t,n,r,i,a){var o=n-e;var u=r-t;var s=i-e;var l=a-t;var f=o*o+u*u;var c=s*s+l*l;var h=.5/(o*l-u*s);var d=(l*f-u*c)*h;var p=(o*c-s*f)*h;return d*d+p*p}function Uq(e,t,n,r,i,a){var o=n-e;var u=r-t;var s=i-e;var l=a-t;var f=o*o+u*u;var c=s*s+l*l;var h=.5/(o*l-u*s);var d=e+(l*f-u*c)*h;var p=t+(o*c-s*f)*h;return{x:d,y:p}}function qq(e,t,n,r){if(r-n<=20){for(var i=n+1;i<=r;i++){var a=e[i];var o=t[a];var u=i-1;while(u>=n&&t[e[u]]>o)e[u+1]=e[u--];e[u+1]=a}}else{var s=n+r>>1;var i=n+1;var u=r;Wq(e,s,i);if(t[e[n]]>t[e[r]])Wq(e,n,r);if(t[e[i]]>t[e[r]])Wq(e,i,r);if(t[e[n]]>t[e[i]])Wq(e,n,i);var l=e[i];var o=t[l];while(true){do{i++}while(t[e[i]]<o);do{u--}while(t[e[u]]>o);if(u<i)break;Wq(e,i,u)}e[n+1]=e[u];e[u]=l;if(r-i+1>=u-n){qq(e,t,i,r);qq(e,t,n,u-1)}else{qq(e,t,n,u-1);qq(e,t,i,r)}}}function Wq(e,t,n){var r=e[t];e[t]=e[n];e[n]=r}function Hq(e){return e[0]}function Gq(e){return e[1]}var $q=1e-6;var Yq=function(){function e(){this._x0=this._y0=this._x1=this._y1=null;this._=""}e.prototype.moveTo=function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)};e.prototype.closePath=function(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}};e.prototype.lineTo=function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)};e.prototype.arc=function(e,t,n){e=+e,t=+t,n=+n;var r=e+n;var i=t;if(n<0)throw new Error("negative radius");if(this._x1===null)this._+="M"+r+","+i;else if(Math.abs(this._x1-r)>$q||Math.abs(this._y1-i)>$q)this._+="L"+r+","+i;if(!n)return;this._+="A"+n+","+n+",0,1,1,"+(e-n)+","+t+"A"+n+","+n+",0,1,1,"+(this._x1=r)+","+(this._y1=i)};e.prototype.rect=function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"};e.prototype.value=function(){return this._||null};return e}();var Vq=function(){function e(){this._=[]}e.prototype.moveTo=function(e,t){this._.push([e,t])};e.prototype.closePath=function(){this._.push(this._[0].slice())};e.prototype.lineTo=function(e,t){this._.push([e,t])};e.prototype.value=function(){return this._.length?this._:null};return e}();var Xq=function(){function e(e,t){var n=t===void 0?[0,0,960,500]:t,r=n[0],i=n[1],a=n[2],o=n[3];if(!((a=+a)>=(r=+r))||!((o=+o)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=e;this._circumcenters=new Float64Array(e.points.length*2);this.vectors=new Float64Array(e.points.length*2);this.xmax=a,this.xmin=r;this.ymax=o,this.ymin=i;this._init()}e.prototype.update=function(){this.delaunay.update();this._init();return this};e.prototype._init=function(){var e=this,t=e.delaunay,n=t.points,r=t.hull,i=t.triangles,a=e.vectors;var o=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(var u=0,s=0,l=i.length,f,c;u<l;u+=3,s+=2){var h=i[u]*2;var d=i[u+1]*2;var p=i[u+2]*2;var v=n[h];var g=n[h+1];var m=n[d];var y=n[d+1];var b=n[p];var _=n[p+1];var x=m-v;var w=y-g;var k=b-v;var A=_-g;var E=x*x+w*w;var M=k*k+A*A;var O=(x*A-w*k)*2;if(!O){f=(v+b)/2-1e8*A;c=(g+_)/2+1e8*k}else if(Math.abs(O)<1e-8){f=(v+b)/2;c=(g+_)/2}else{var S=1/O;f=v+(A*E-w*M)*S;c=g+(x*M-k*E)*S}o[s]=f;o[s+1]=c}var D=r[r.length-1];var C,F=D*4;var T,N=n[2*D];var j,R=n[2*D+1];a.fill(0);for(var u=0;u<r.length;++u){D=r[u];C=F,T=N,j=R;F=D*4,N=n[2*D],R=n[2*D+1];a[C+2]=a[F]=j-R;a[C+3]=a[F+1]=N-T}};e.prototype.render=function(e){var t=e==null?e=new Yq:undefined;var n=this,r=n.delaunay,i=r.halfedges,a=r.inedges,o=r.hull,u=n.circumcenters,s=n.vectors;if(o.length<=1)return null;for(var l=0,f=i.length;l<f;++l){var c=i[l];if(c<l)continue;var h=Math.floor(l/3)*2;var d=Math.floor(c/3)*2;var p=u[h];var v=u[h+1];var g=u[d];var m=u[d+1];this._renderSegment(p,v,g,m,e)}var y,b=o[o.length-1];for(var l=0;l<o.length;++l){y=b,b=o[l];var _=Math.floor(a[b]/3)*2;var x=u[_];var w=u[_+1];var k=y*4;var A=this._project(x,w,s[k+2],s[k+3]);if(A)this._renderSegment(x,w,A[0],A[1],e)}return t&&t.value()};e.prototype.renderBounds=function(e){var t=e==null?e=new Yq:undefined;e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin);return t&&t.value()};e.prototype.renderCell=function(e,t){var n=t==null?t=new Yq:undefined;var r=this._clip(e);if(r===null)return;t.moveTo(r[0],r[1]);var i=r.length;while(r[0]===r[i-2]&&r[1]===r[i-1]&&i>1)i-=2;for(var a=2;a<i;a+=2){if(r[a]!==r[a-2]||r[a+1]!==r[a-1])t.lineTo(r[a],r[a+1])}t.closePath();return n&&n.value()};e.prototype.cellPolygons=function(){var e,t,n,r;return __generator(this,(function(i){switch(i.label){case 0:e=this.delaunay.points;t=0,n=e.length/2;i.label=1;case 1:if(!(t<n))return[3,4];r=this.cellPolygon(t);if(!r)return[3,3];return[4,r];case 2:i.sent();i.label=3;case 3:++t;return[3,1];case 4:return[2]}}))};e.prototype.cellPolygon=function(e){var t=new Vq;this.renderCell(e,t);return t.value()};e.prototype._renderSegment=function(e,t,n,r,i){var a;var o=this._regioncode(e,t);var u=this._regioncode(n,r);if(o===0&&u===0){i.moveTo(e,t);i.lineTo(n,r)}else if(a=this._clipSegment(e,t,n,r,o,u)){i.moveTo(a[0],a[1]);i.lineTo(a[2],a[3])}};e.prototype.contains=function(e,t,n){if((t=+t,t!==t)||(n=+n,n!==n))return false;return this.delaunay._step(e,t,n)===e};e.prototype._cell=function(e){var t=this,n=t.circumcenters,r=t.delaunay,i=r.inedges,a=r.halfedges,o=r.triangles;var u=i[e];if(u===-1)return null;var s=[];var l=u;do{var f=Math.floor(l/3);s.push(n[f*2],n[f*2+1]);l=l%3===2?l-2:l+1;if(o[l]!==e)break;l=a[l]}while(l!==u&&l!==-1);return s};e.prototype._clip=function(e){if(e===0&&this.delaunay.hull.length===1){return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]}var t=this._cell(e);if(t===null)return null;var n=this.vectors;var r=e*4;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)};e.prototype._clipFinite=function(e,t){var n=t.length;var r=null;var i,a,o=t[n-2],u=t[n-1];var s,l=this._regioncode(o,u);var f,c;for(var h=0;h<n;h+=2){i=o,a=u,o=t[h],u=t[h+1];s=l,l=this._regioncode(o,u);if(s===0&&l===0){f=c,c=0;if(r)r.push(o,u);else r=[o,u]}else{var d=void 0,p=void 0,v=void 0,g=void 0,m=void 0;if(s===0){if((d=this._clipSegment(i,a,o,u,s,l))===null)continue;p=d[0],v=d[1],g=d[2],m=d[3]}else{if((d=this._clipSegment(o,u,i,a,l,s))===null)continue;g=d[0],m=d[1],p=d[2],v=d[3];f=c,c=this._edgecode(p,v);if(f&&c)this._edge(e,f,c,r,r.length);if(r)r.push(p,v);else r=[p,v]}f=c,c=this._edgecode(g,m);if(f&&c)this._edge(e,f,c,r,r.length);if(r)r.push(g,m);else r=[g,m]}}if(r){f=c,c=this._edgecode(r[0],r[1]);if(f&&c)this._edge(e,f,c,r,r.length)}else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)){return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]}return r};e.prototype._clipSegment=function(e,t,n,r,i,a){while(true){if(i===0&&a===0)return[e,t,n,r];if(i&a)return null;var o=void 0,u=void 0,s=i||a;if(s&8)o=e+(n-e)*(this.ymax-t)/(r-t),u=this.ymax;else if(s&4)o=e+(n-e)*(this.ymin-t)/(r-t),u=this.ymin;else if(s&2)u=t+(r-t)*(this.xmax-e)/(n-e),o=this.xmax;else u=t+(r-t)*(this.xmin-e)/(n-e),o=this.xmin;if(i)e=o,t=u,i=this._regioncode(e,t);else n=o,r=u,a=this._regioncode(n,r)}};e.prototype._clipInfinite=function(e,t,n,r,i,a){var o=Array.from(t),u;if(u=this._project(o[0],o[1],n,r))o.unshift(u[0],u[1]);if(u=this._project(o[o.length-2],o[o.length-1],i,a))o.push(u[0],u[1]);if(o=this._clipFinite(e,o)){for(var s=0,l=o.length,f=void 0,c=this._edgecode(o[l-2],o[l-1]);s<l;s+=2){f=c,c=this._edgecode(o[s],o[s+1]);if(f&&c)s=this._edge(e,f,c,o,s),l=o.length}}else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)){o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]}return o};e.prototype._edge=function(e,t,n,r,i){while(t!==n){var a=void 0,o=void 0;switch(t){case 5:t=4;continue;case 4:t=6,a=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,a=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,a=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,a=this.xmin,o=this.ymin;break}if((r[i]!==a||r[i+1]!==o)&&this.contains(e,a,o)){r.splice(i,0,a,o),i+=2}}if(r.length>4){for(var u=0;u<r.length;u+=2){var s=(u+2)%r.length,l=(u+4)%r.length;if(r[u]===r[s]&&r[s]===r[l]||r[u+1]===r[s+1]&&r[s+1]===r[l+1])r.splice(s,2),u-=2}}return i};e.prototype._project=function(e,t,n,r){var i=Infinity,a,o,u;if(r<0){if(t<=this.ymin)return null;if((a=(this.ymin-t)/r)<i)u=this.ymin,o=e+(i=a)*n}else if(r>0){if(t>=this.ymax)return null;if((a=(this.ymax-t)/r)<i)u=this.ymax,o=e+(i=a)*n}if(n>0){if(e>=this.xmax)return null;if((a=(this.xmax-e)/n)<i)o=this.xmax,u=t+(i=a)*r}else if(n<0){if(e<=this.xmin)return null;if((a=(this.xmin-e)/n)<i)o=this.xmin,u=t+(i=a)*r}return[o,u]};e.prototype._edgecode=function(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)};e.prototype._regioncode=function(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)};return e}();var Jq=2*Math.PI;function Zq(e){return e[0]}function Qq(e){return e[1]}function Kq(e){var t=e.triangles,n=e.coords;for(var r=0;r<t.length;r+=3){var i=2*t[r],a=2*t[r+1],o=2*t[r+2],u=(n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1]);if(u>1e-10)return false}return true}function eW(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var tW=function(){function e(e){this._delaunator=new jq(e);this.inedges=new Int32Array(e.length/2);this._hullIndex=new Int32Array(e.length/2);this.points=this._delaunator.coords;this._init()}e.prototype.update=function(){this._delaunator.update();this._init();return this};e.prototype._init=function(){var e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&Kq(e)){this.collinear=Int32Array.from({length:t.length/2},(function(e,t){return t})).sort((function(e,n){return t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]}));var n=this.collinear[0],r=this.collinear[this.collinear.length-1],i=[t[2*n],t[2*n+1],t[2*r],t[2*r+1]],a=1e-8*Math.sqrt(Math.pow(i[3]-i[1],2)+Math.pow(i[2]-i[0],2));for(var o=0,u=t.length/2;o<u;++o){var s=eW(t[2*o],t[2*o+1],a);t[2*o]=s[0];t[2*o+1]=s[1]}this._delaunator=new jq(t)}else{delete this.collinear}var l=this.halfedges=this._delaunator.halfedges;var f=this.hull=this._delaunator.hull;var c=this.triangles=this._delaunator.triangles;var h=this.inedges.fill(-1);var d=this._hullIndex.fill(-1);for(var n=0,u=l.length;n<u;++n){var s=c[n%3===2?n-2:n+1];if(l[n]===-1||h[s]===-1)h[s]=n}for(var o=0,u=f.length;o<u;++o){d[f[o]]=o}if(f.length<=2&&f.length>0){this.triangles=new Int32Array(3).fill(-1);this.halfedges=new Int32Array(3).fill(-1);this.triangles[0]=f[0];this.triangles[1]=f[1];this.triangles[2]=f[1];h[f[0]]=1;if(f.length===2)h[f[1]]=0}};e.prototype.voronoi=function(e){return new Xq(this,e)};e.prototype.neighbors=function(e){var t,n,r,i,a,o,u,s,l,f,c;return __generator(this,(function(h){switch(h.label){case 0:t=this,n=t.inedges,r=t.hull,i=t._hullIndex,a=t.halfedges,o=t.triangles;if(!this.collinear)return[3,5];u=this.collinear.indexOf(e);if(!(u>0))return[3,2];return[4,this.collinear[u-1]];case 1:h.sent();h.label=2;case 2:if(!(u<this.collinear.length-1))return[3,4];return[4,this.collinear[u+1]];case 3:h.sent();h.label=4;case 4:return[2];case 5:s=n[e];if(s===-1)return[2];l=s,f=-1;h.label=6;case 6:return[4,f=o[l]];case 7:h.sent();l=l%3===2?l-2:l+1;if(o[l]!==e)return[2];l=a[l];if(!(l===-1))return[3,10];c=r[(i[e]+1)%r.length];if(!(c!==f))return[3,9];return[4,c];case 8:h.sent();h.label=9;case 9:return[2];case 10:if(l!==s)return[3,6];h.label=11;case 11:return[2]}}))};e.prototype.find=function(e,t,n){if(n===void 0){n=0}if((e=+e,e!==e)||(t=+t,t!==t))return-1;var r=n;var i;while((i=this._step(n,e,t))>=0&&i!==n&&i!==r)n=i;return i};e.prototype._step=function(e,t,n){var r=this,i=r.inedges,a=r.hull,o=r._hullIndex,u=r.halfedges,s=r.triangles,l=r.points;if(i[e]===-1||!l.length)return(e+1)%(l.length>>1);var f=e;var c=Math.pow(t-l[e*2],2)+Math.pow(n-l[e*2+1],2);var h=i[e];var d=h;do{var p=s[d];var v=Math.pow(t-l[p*2],2)+Math.pow(n-l[p*2+1],2);if(v<c)c=v,f=p;d=d%3===2?d-2:d+1;if(s[d]!==e)break;d=u[d];if(d===-1){d=a[(o[e]+1)%a.length];if(d!==p){if(Math.pow(t-l[d*2],2)+Math.pow(n-l[d*2+1],2)<c)return d}break}}while(d!==h);return f};e.prototype.render=function(e){var t=e==null?e=new Yq:undefined;var n=this,r=n.points,i=n.halfedges,a=n.triangles;for(var o=0,u=i.length;o<u;++o){var s=i[o];if(s<o)continue;var l=a[o]*2;var f=a[s]*2;e.moveTo(r[l],r[l+1]);e.lineTo(r[f],r[f+1])}this.renderHull(e);return t&&t.value()};e.prototype.renderPoints=function(e,t){if(t===void 0){t=2}var n=e==null?e=new Yq:undefined;var r=this.points;for(var i=0,a=r.length;i<a;i+=2){var o=r[i],u=r[i+1];e.moveTo(o+t,u);e.arc(o,u,t,0,Jq)}return n&&n.value()};e.prototype.renderHull=function(e){var t=e==null?e=new Yq:undefined;var n=this,r=n.hull,i=n.points;var a=r[0]*2,o=r.length;e.moveTo(i[a],i[a+1]);for(var u=1;u<o;++u){var s=2*r[u];e.lineTo(i[s],i[s+1])}e.closePath();return t&&t.value()};e.prototype.hullPolygon=function(){var e=new Vq;this.renderHull(e);return e.value()};e.prototype.renderTriangle=function(e,t){var n=t==null?t=new Yq:undefined;var r=this,i=r.points,a=r.triangles;var o=a[e*=3]*2;var u=a[e+1]*2;var s=a[e+2]*2;t.moveTo(i[o],i[o+1]);t.lineTo(i[u],i[u+1]);t.lineTo(i[s],i[s+1]);t.closePath();return n&&n.value()};e.prototype.trianglePolygons=function(){var e,t,n;return __generator(this,(function(r){switch(r.label){case 0:e=this.triangles;t=0,n=e.length/3;r.label=1;case 1:if(!(t<n))return[3,4];return[4,this.trianglePolygon(t)];case 2:r.sent();r.label=3;case 3:++t;return[3,1];case 4:return[2]}}))};e.prototype.trianglePolygon=function(e){var t=new Vq;this.renderTriangle(e,t);return t.value()};return e}();tW.from=function(e,t,n,r){if(t===void 0){t=Zq}if(n===void 0){n=Qq}return new tW("length"in e?nW(e,t,n,r):Float64Array.from(rW(e,t,n,r)))};function nW(e,t,n,r){var i=e.length;var a=new Float64Array(i*2);for(var o=0;o<i;++o){var u=e[o];a[o*2]=t.call(r,u,o,e);a[o*2+1]=n.call(r,u,o,e)}return a}function rW(e,t,n,r){var i,a,o,u;return __generator(this,(function(s){switch(s.label){case 0:i=0;a=0,o=e;s.label=1;case 1:if(!(a<o.length))return[3,5];u=o[a];return[4,t.call(r,u,i,e)];case 2:s.sent();return[4,n.call(r,u,i,e)];case 3:s.sent();++i;s.label=4;case 4:a++;return[3,1];case 5:return[2]}}))}function iW(e){zv.call(this,null,e)}iW.Definition={type:"Voronoi",metadata:{modifies:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"size",type:"number",array:true,length:2},{name:"extent",type:"array",array:true,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:true,length:2}},{name:"as",type:"string",default:"path"}]};var aW=or(iW,zv);var oW=[-1e5,-1e5,1e5,1e5];aW.transform=function(e,t){var n=e.as||"path",r=t.source;if(!r||!r.length)return t;var i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:oW;var a=this.value=tW.from(r,e.x,e.y).voronoi(i);for(var o=0,u=r.length;o<u;++o){var s=a.cellPolygon(o);r[o][n]=s?uW(s):null}return t.reflow(e.modified()).modifies(n)};function uW(e){var t=e[0][0],n=e[0][1];var r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}var sW=Object.freeze({__proto__:null,voronoi:iW});var lW=Math.PI/180,fW=1<<11>>5,cW=1<<11;function hW(){var e=[256,256],t,n,r,i,a,o,u,s=mW,l=[],f=Math.random,c={};c.layout=function(){var s=h(Yv()),c=bW((e[0]>>5)*e[1]),p=null,v=l.length,g=-1,m=[],y=l.map((function(e){return{text:t(e),font:n(e),style:i(e),weight:a(e),rotate:o(e),size:~~(r(e)+1e-14),padding:u(e),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:false,sprite:null,datum:e}})).sort((function(e,t){return t.size-e.size}));while(++g<v){var b=y[g];b.x=e[0]*(f()+.5)>>1;b.y=e[1]*(f()+.5)>>1;dW(s,b,y,g);if(b.hasText&&d(c,b,p)){m.push(b);if(p)vW(p,b);else p=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}];b.x-=e[0]>>1;b.y-=e[1]>>1}}return m};function h(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(fW<<5)/t;e.height=cW/t;var n=e.getContext("2d");n.fillStyle=n.strokeStyle="red";n.textAlign="center";return{context:n,ratio:t}}function d(t,n,r){var i=n.x,a=n.y,o=Math.sqrt(e[0]*e[0]+e[1]*e[1]),u=s(e),l=f()<.5?1:-1,c=-l,h,d,p;while(h=u(c+=l)){d=~~h[0];p=~~h[1];if(Math.min(Math.abs(d),Math.abs(p))>=o)break;n.x=i+d;n.y=a+p;if(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>e[0]||n.y+n.y1>e[1])continue;if(!r||!pW(n,t,e[0])){if(!r||gW(n,r)){var v=n.sprite,g=n.width>>5,m=e[0]>>5,y=n.x-(g<<4),b=y&127,_=32-b,x=n.y1-n.y0,w=(n.y+n.y0)*m+(y>>5),k;for(var A=0;A<x;A++){k=0;for(var E=0;E<=g;E++){t[w+E]|=k<<_|(E<g?(k=v[A*g+E])>>>b:0)}w+=m}n.sprite=null;return true}}}return false}c.words=function(e){if(arguments.length){l=e;return c}else{return l}};c.size=function(t){if(arguments.length){e=[+t[0],+t[1]];return c}else{return e}};c.font=function(e){if(arguments.length){n=_W(e);return c}else{return n}};c.fontStyle=function(e){if(arguments.length){i=_W(e);return c}else{return i}};c.fontWeight=function(e){if(arguments.length){a=_W(e);return c}else{return a}};c.rotate=function(e){if(arguments.length){o=_W(e);return c}else{return o}};c.text=function(e){if(arguments.length){t=_W(e);return c}else{return t}};c.spiral=function(e){if(arguments.length){s=xW[e]||e;return c}else{return s}};c.fontSize=function(e){if(arguments.length){r=_W(e);return c}else{return r}};c.padding=function(e){if(arguments.length){u=_W(e);return c}else{return u}};c.random=function(e){if(arguments.length){f=e;return c}else{return f}};return c}function dW(e,t,n,r){if(t.sprite)return;var i=e.context,a=e.ratio;i.clearRect(0,0,(fW<<5)/a,cW/a);var o=0,u=0,s=0,l=n.length,f,c,h,d,p;--r;while(++r<l){t=n[r];i.save();i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font;f=i.measureText(t.text+"m").width*a;h=t.size<<1;if(t.rotate){var v=Math.sin(t.rotate*lW),g=Math.cos(t.rotate*lW),m=f*g,y=f*v,b=h*g,_=h*v;f=Math.max(Math.abs(m+_),Math.abs(m-_))+31>>5<<5;h=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else{f=f+31>>5<<5}if(h>s)s=h;if(o+f>=fW<<5){o=0;u+=s;s=0}if(u+h>=cW)break;i.translate((o+(f>>1))/a,(u+(h>>1))/a);if(t.rotate)i.rotate(t.rotate*lW);i.fillText(t.text,0,0);if(t.padding){i.lineWidth=2*t.padding;i.strokeText(t.text,0,0)}i.restore();t.width=f;t.height=h;t.xoff=o;t.yoff=u;t.x1=f>>1;t.y1=h>>1;t.x0=-t.x1;t.y0=-t.y1;t.hasText=true;o+=f}var x=i.getImageData(0,0,(fW<<5)/a,cW/a).data,w=[];while(--r>=0){t=n[r];if(!t.hasText)continue;f=t.width;c=f>>5;h=t.y1-t.y0;for(d=0;d<h*c;d++)w[d]=0;o=t.xoff;if(o==null)return;u=t.yoff;var k=0,A=-1;for(p=0;p<h;p++){for(d=0;d<f;d++){var E=c*p+(d>>5),M=x[(u+p)*(fW<<5)+(o+d)<<2]?1<<31-d%32:0;w[E]|=M;k|=M}if(k)A=p;else{t.y0++;h--;p--;u++}}t.y1=t.y0+A;t.sprite=w.slice(0,(t.y1-t.y0)*c)}}function pW(e,t,n){n>>=5;var r=e.sprite,i=e.width>>5,a=e.x-(i<<4),o=a&127,u=32-o,s=e.y1-e.y0,l=(e.y+e.y0)*n+(a>>5),f;for(var c=0;c<s;c++){f=0;for(var h=0;h<=i;h++){if((f<<u|(h<i?(f=r[c*i+h])>>>o:0))&t[l+h])return true}l+=n}return false}function vW(e,t){var n=e[0],r=e[1];if(t.x+t.x0<n.x)n.x=t.x+t.x0;if(t.y+t.y0<n.y)n.y=t.y+t.y0;if(t.x+t.x1>r.x)r.x=t.x+t.x1;if(t.y+t.y1>r.y)r.y=t.y+t.y1}function gW(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function mW(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function yW(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(e){var a=e<0?-1:1;switch(Math.sqrt(1+4*a*e)-a&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function bW(e){var t=[],n=-1;while(++n<e)t[n]=0;return t}function _W(e){return typeof e==="function"?e:function(){return e}}var xW={archimedean:mW,rectangular:yW};function wW(e,t,n){e.fields=t||[];e.fname=n;return e}function kW(e){throw Error(e)}function AW(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)kW("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)kW("Access path missing closing bracket: "+e);if(n)kW("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var EW=Array.isArray;function MW(e){return e===Object(e)}function OW(e){return typeof e==="string"}function SW(e){return EW(e)?"["+e.map(SW)+"]":MW(e)||OW(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function DW(e,t){var n=AW(e),r="return _["+n.map(SW).join("][")+"];";return wW(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var CW=[];var FW=DW("id");var TW=wW((function(e){return e}),CW,"identity");var NW=wW((function(){return 0}),CW,"zero");var jW=wW((function(){return 1}),CW,"one");var RW=wW((function(){return true}),CW,"true");var zW=wW((function(){return false}),CW,"false");function PW(e){return typeof e==="function"}function LW(e){return PW(e)?e:function(){return e}}function IW(e,t){var n=0,r,i,a,o;if(e&&(r=e.length)){if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);a=o=i;for(;n<r;++n){i=e[n];if(i!=null){if(i<a)a=i;if(i>o)o=i}}}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));a=o=i;for(;n<r;++n){i=t(e[n]);if(i!=null){if(i<a)a=i;if(i>o)o=i}}}}return[a,o]}function BW(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}var UW=["x","y","font","fontSize","fontStyle","fontWeight","angle"];var qW=["text","font","rotate","fontSize","fontStyle","fontWeight"];function WW(e){zv.call(this,hW(),e)}WW.Definition={type:"Wordcloud",metadata:{modifies:true},params:[{name:"size",type:"number",array:true,length:2},{name:"font",type:"string",expr:true,default:"sans-serif"},{name:"fontStyle",type:"string",expr:true,default:"normal"},{name:"fontWeight",type:"string",expr:true,default:"normal"},{name:"fontSize",type:"number",expr:true,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:true,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:true},{name:"as",type:"string",array:true,length:7,default:UW}]};var HW=BW(WW,zv);HW.transform=function(e,t){if(e.size&&!(e.size[0]&&e.size[1])){kW("Wordcloud size dimensions must be non-zero.")}function n(n){var r=e[n];return PW(r)&&t.modified(r.fields)}var r=e.modified();if(!(r||t.changed(t.ADD_REM)||qW.some(n)))return;var i=t.materialize(t.SOURCE).source,a=this.value,o=e.as||UW,u=e.fontSize||14,s;PW(u)?s=e.fontSizeRange:u=LW(u);if(s){var l=u,f=QO("sqrt")().domain(IW(i,l)).range(s);u=function(e){return f(l(e))}}i.forEach((function(e){e[o[0]]=NaN;e[o[1]]=NaN;e[o[3]]=0}));var c=a.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(u).random(Kl).layout();var h=a.size(),d=h[0]>>1,p=h[1]>>1,v=0,g=c.length,m,y;for(;v<g;++v){m=c[v];y=m.datum;y[o[0]]=m.x+d;y[o[1]]=m.y+p;y[o[2]]=m.font;y[o[3]]=m.size;y[o[4]]=m.style;y[o[5]]=m.weight;y[o[6]]=m.rotate}return t.reflow(r).modifies(o)};var GW=Object.freeze({__proto__:null,wordcloud:WW});function $W(e){return new Uint8Array(e)}function YW(e){return new Uint16Array(e)}function VW(e){return new Uint32Array(e)}function XW(){var e=8,t=[],n=VW(0),r=ZW(0,e),i=ZW(0,e);return{data:function(){return t},seen:function(){return n=JW(n,t.length)},add:function(e){for(var n=0,r=t.length,i=e.length,a;n<i;++n){a=e[n];a._index=r++;t.push(a)}},remove:function(e,n){var a=t.length,o=Array(a-e),u=t,s,l,f;for(l=0;!n[l]&&l<a;++l){o[l]=t[l];u[l]=l}for(f=l;l<a;++l){s=t[l];if(!n[l]){u[l]=f;r[f]=r[l];i[f]=i[l];o[f]=s;s._index=f++}else{u[l]=-1}r[l]=0}t=o;return u},size:function(){return t.length},curr:function(){return r},prev:function(){return i},reset:function(e){i[e]=r[e]},all:function(){return e<257?255:e<65537?65535:4294967295},set:function(e,t){r[e]|=t},clear:function(e,t){r[e]&=~t},resize:function(t,n){var a=r.length;if(t>a||n>e){e=Math.max(n,e);r=ZW(t,e,r);i=ZW(t,e)}}}}function JW(e,t,n){if(e.length>=t)return e;n=n||new e.constructor(t);n.set(e);return n}function ZW(e,t,n){var r=(t<257?$W:t<65537?YW:VW)(e);if(n)r.set(n);return r}function QW(e,t,n){var r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n=this,i=n.bisect(n.range,e.value),a=e.index,o=i[0],u=i[1],s=a.length,l;for(l=0;l<o;++l)t[a[l]]|=r;for(l=u;l<s;++l)t[a[l]]|=r;return n}}}function KW(){var e=VW(0),t=[],n=0;function r(r,i,a){if(!i.length)return[];var o=n,u=i.length,s=Array(u),l=VW(u),f,c,h;for(h=0;h<u;++h){s[h]=r(i[h]);l[h]=h}s=eH(s,l);if(o){f=t;c=e;t=Array(o+u);e=VW(o+u);tH(a,f,c,o,s,l,u,t,e)}else{if(a>0)for(h=0;h<u;++h){l[h]+=a}t=s;e=l}n=o+u;return{index:l,value:s}}function i(r,i){var a=n,o,u,s;for(u=0;!i[e[u]]&&u<a;++u);for(s=u;u<a;++u){if(!i[o=e[u]]){e[s]=o;t[s]=t[u];++s}}n=a-r}function a(t){for(var r=0,i=n;r<i;++r){e[r]=t[e[r]]}}function o(e,r){var i;if(r){i=r.length}else{r=t;i=n}return[Ol(r,e[0],0,i),Ml(r,e[1],0,i)]}return{insert:r,remove:i,bisect:o,reindex:a,index:function(){return e},size:function(){return n}}}function eH(e,t){e.sort.call(t,(function(t,n){var r=e[t],i=e[n];return r<i?-1:r>i?1:0}));return Yl(e,t)}function tH(e,t,n,r,i,a,o,u,s){var l=0,f=0,c;for(c=0;l<r&&f<o;++c){if(t[l]<i[f]){u[c]=t[l];s[c]=n[l++]}else{u[c]=i[f];s[c]=a[f++]+e}}for(;l<r;++l,++c){u[c]=t[l];s[c]=n[l]}for(;f<o;++f,++c){u[c]=i[f];s[c]=a[f]+e}}function nH(e){zv.call(this,XW(),e);this._indices=null;this._dims=null}nH.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:true,required:true},{name:"query",type:"array",array:true,required:true,content:{type:"number",array:true,length:2}}]};var rH=or(nH,zv);rH.transform=function(e,t){if(!this._dims){return this.init(e,t)}else{var n=e.modified("fields")||e.fields.some((function(e){return t.modified(e.fields)}));return n?this.reinit(e,t):this.eval(e,t)}};rH.init=function(e,t){var n=e.fields,r=e.query,i=this._indices={},a=this._dims=[],o=r.length,u=0,s,l;for(;u<o;++u){s=n[u].fname;l=i[s]||(i[s]=KW());a.push(QW(l,u,r[u]))}return this.eval(e,t)};rH.reinit=function(e,t){var n=t.materialize().fork(),r=e.fields,i=e.query,a=this._indices,o=this._dims,u=this.value,s=u.curr(),l=u.prev(),f=u.all(),c=n.rem=n.add,h=n.mod,d=i.length,p={},v,g,m,y,b,_,x,w,k;l.set(s);if(t.rem.length){b=this.remove(e,t,n)}if(t.add.length){u.add(t.add)}if(t.mod.length){_={};for(y=t.mod,x=0,w=y.length;x<w;++x){_[y[x]._index]=1}}for(x=0;x<d;++x){k=r[x];if(!o[x]||e.modified("fields",x)||t.modified(k.fields)){m=k.fname;if(!(v=p[m])){a[m]=g=KW();p[m]=v=g.insert(k,t.source,0)}o[x]=QW(g,x,i[x]).onAdd(v,s)}}for(x=0,w=u.data().length;x<w;++x){if(b[x]){continue}else if(l[x]!==s[x]){c.push(x)}else if(_[x]&&s[x]!==f){h.push(x)}}u.mask=(1<<d)-1;return n};rH.eval=function(e,t){var n=t.materialize().fork(),r=this._dims.length,i=0;if(t.rem.length){this.remove(e,t,n);i|=(1<<r)-1}if(e.modified("query")&&!e.modified("fields")){i|=this.update(e,t,n)}if(t.add.length){this.insert(e,t,n);i|=(1<<r)-1}if(t.mod.length){this.modify(t,n);i|=(1<<r)-1}this.value.mask=i;return n};rH.insert=function(e,t,n){var r=t.add,i=this.value,a=this._dims,o=this._indices,u=e.fields,s={},l=n.add,f=i.size(),c=f+r.length,h=a.length,d,p,v;i.resize(c,h);i.add(r);var g=i.curr(),m=i.prev(),y=i.all();for(d=0;d<h;++d){p=u[d].fname;v=s[p]||(s[p]=o[p].insert(u[d],r,f));a[d].onAdd(v,g)}for(;f<c;++f){m[f]=y;if(g[f]!==y)l.push(f)}};rH.modify=function(e,t){var n=t.mod,r=this.value,i=r.curr(),a=r.all(),o=e.mod,u,s,l;for(u=0,s=o.length;u<s;++u){l=o[u]._index;if(i[l]!==a)n.push(l)}};rH.remove=function(e,t,n){var r=this._indices,i=this.value,a=i.curr(),o=i.prev(),u=i.all(),s={},l=n.rem,f=t.rem,c,h,d,p;for(c=0,h=f.length;c<h;++c){d=f[c]._index;s[d]=1;o[d]=p=a[d];a[d]=u;if(p!==u)l.push(d)}for(d in r){r[d].remove(h,s)}this.reindex(t,h,s);return s};rH.reindex=function(e,t,n){var r=this._indices,i=this.value;e.runAfter((function(){var e=i.remove(t,n);for(var a in r)r[a].reindex(e)}))};rH.update=function(e,t,n){var r=this._dims,i=e.query,a=t.stamp,o=r.length,u=0,s,l;n.filters=0;for(l=0;l<o;++l){if(e.modified("query",l)){s=l;++u}}if(u===1){u=r[s].one;this.incrementOne(r[s],i[s],n.add,n.rem)}else{for(l=0,u=0;l<o;++l){if(!e.modified("query",l))continue;u|=r[l].one;this.incrementAll(r[l],i[l],a,n.add);n.rem=n.add}}return u};rH.incrementAll=function(e,t,n,r){var i=this.value,a=i.seen(),o=i.curr(),u=i.prev(),s=e.index(),l=e.bisect(e.range),f=e.bisect(t),c=f[0],h=f[1],d=l[0],p=l[1],v=e.one,g,m,y;if(c<d){for(g=c,m=Math.min(d,h);g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}else if(c>d){for(g=d,m=Math.min(c,p);g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}if(h>p){for(g=Math.max(c,p),m=h;g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}else if(h<p){for(g=Math.max(d,h),m=p;g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}e.range=t.slice()};rH.incrementOne=function(e,t,n,r){var i=this.value,a=i.curr(),o=e.index(),u=e.bisect(e.range),s=e.bisect(t),l=s[0],f=s[1],c=u[0],h=u[1],d=e.one,p,v,g;if(l<c){for(p=l,v=Math.min(c,f);p<v;++p){g=o[p];a[g]^=d;n.push(g)}}else if(l>c){for(p=c,v=Math.min(l,h);p<v;++p){g=o[p];a[g]^=d;r.push(g)}}if(f>h){for(p=Math.max(l,h),v=f;p<v;++p){g=o[p];a[g]^=d;n.push(g)}}else if(f<h){for(p=Math.max(c,f),v=h;p<v;++p){g=o[p];a[g]^=d;r.push(g)}}e.range=t.slice()};function iH(e){zv.call(this,null,e)}iH.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:true,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:true,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};var aH=or(iH,zv);aH.transform=function(e,t){var n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)===0)return t.StopPropagation;var a=t.fork(t.ALL),o=r.data(),u=r.curr(),s=r.prev(),l=function(e){return!(u[e]&n)?o[e]:null};a.filter(a.MOD,l);if(!(i&i-1)){a.filter(a.ADD,l);a.filter(a.REM,(function(e){return(u[e]&n)===i?o[e]:null}))}else{a.filter(a.ADD,(function(e){var t=u[e]&n,r=!t&&t^s[e]&n;return r?o[e]:null}));a.filter(a.REM,(function(e){var t=u[e]&n,r=t&&!(t^(t^s[e]&n));return r?o[e]:null}))}return a.filter(a.SOURCE,(function(e){return l(e._index)}))};var oH=Object.freeze({__proto__:null,crossfilter:nH,resolvefilter:iH});var uH="5.9.1";function sH(e){this.clear();if(e)this.union(e)}var lH=sH.prototype;lH.clone=function(){return new sH(this)};lH.clear=function(){this.x1=+Number.MAX_VALUE;this.y1=+Number.MAX_VALUE;this.x2=-Number.MAX_VALUE;this.y2=-Number.MAX_VALUE;return this};lH.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE};lH.equals=function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2};lH.set=function(e,t,n,r){if(n<e){this.x2=e;this.x1=n}else{this.x1=e;this.x2=n}if(r<t){this.y2=t;this.y1=r}else{this.y1=t;this.y2=r}return this};lH.add=function(e,t){if(e<this.x1)this.x1=e;if(t<this.y1)this.y1=t;if(e>this.x2)this.x2=e;if(t>this.y2)this.y2=t;return this};lH.expand=function(e){this.x1-=e;this.y1-=e;this.x2+=e;this.y2+=e;return this};lH.round=function(){this.x1=Math.floor(this.x1);this.y1=Math.floor(this.y1);this.x2=Math.ceil(this.x2);this.y2=Math.ceil(this.y2);return this};lH.translate=function(e,t){this.x1+=e;this.x2+=e;this.y1+=t;this.y2+=t;return this};lH.rotate=function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])};lH.rotatedPoints=function(e,t,n){var r=this,i=r.x1,a=r.y1,o=r.x2,u=r.y2,s=Math.cos(e),l=Math.sin(e),f=t-t*s+n*l,c=n-t*l-n*s;return[s*i-l*a+f,l*i+s*a+c,s*i-l*u+f,l*i+s*u+c,s*o-l*a+f,l*o+s*a+c,s*o-l*u+f,l*o+s*u+c]};lH.union=function(e){if(e.x1<this.x1)this.x1=e.x1;if(e.y1<this.y1)this.y1=e.y1;if(e.x2>this.x2)this.x2=e.x2;if(e.y2>this.y2)this.y2=e.y2;return this};lH.intersect=function(e){if(e.x1>this.x1)this.x1=e.x1;if(e.y1>this.y1)this.y1=e.y1;if(e.x2<this.x2)this.x2=e.x2;if(e.y2<this.y2)this.y2=e.y2;return this};lH.encloses=function(e){return e&&(this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2)};lH.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)};lH.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)};lH.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)};lH.width=function(){return this.x2-this.x1};lH.height=function(){return this.y2-this.y1};var fH=0;var cH="p_";function hH(e){return e&&e.gradient}function dH(e,t,n){var r=e.id,i=e.gradient,a=i==="radial"?cH:"";if(!r){r=e.id="gradient_"+fH++;if(i==="radial"){e.x1=pH(e.x1,.5);e.y1=pH(e.y1,.5);e.r1=pH(e.r1,0);e.x2=pH(e.x2,.5);e.y2=pH(e.y2,.5);e.r2=pH(e.r2,.5);a=cH}else{e.x1=pH(e.x1,0);e.y1=pH(e.y1,0);e.x2=pH(e.x2,1);e.y2=pH(e.y2,0)}}t[r]=e;return"url("+(n||"")+"#"+a+r+")"}function pH(e,t){return e!=null?e:t}function vH(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(e,t){n.push({offset:e,color:t});return r}}}function gH(e){this.mark=e;this.bounds=this.bounds||new sH}function mH(e,t,n){e.fields=t||[];e.fname=n;return e}function yH(e){throw Error(e)}function bH(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)yH("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)yH("Access path missing closing bracket: "+e);if(n)yH("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var _H=Array.isArray;function xH(e){return e===Object(e)}function wH(e){return typeof e==="string"}function kH(e){return _H(e)?"["+e.map(kH)+"]":xH(e)||wH(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function AH(e,t){var n=bH(e),r="return _["+n.map(kH).join("][")+"];";return mH(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var EH=[];var MH=AH("id");var OH=mH((function(e){return e}),EH,"identity");var SH=mH((function(){return 0}),EH,"zero");var DH=mH((function(){return 1}),EH,"one");var CH=mH((function(){return true}),EH,"true");var FH=mH((function(){return false}),EH,"false");function TH(e){return typeof e==="function"}var NH=Object.prototype.hasOwnProperty;function jH(e,t){return NH.call(e,t)}function RH(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function zH(e){return typeof e==="number"}function PH(e){gH.call(this,e);this.items=this.items||[]}RH(PH,gH);function LH(e){this._pending=0;this._loader=e||Oo()}var IH=LH.prototype;IH.pending=function(){return this._pending};function BH(e){e._pending+=1}function UH(e){e._pending-=1}IH.sanitizeURL=function(e){var t=this;BH(t);return t._loader.sanitize(e,{context:"href"}).then((function(e){UH(t);return e})).catch((function(){UH(t);return null}))};IH.loadImage=function(e){var t=this,n=Vv();BH(t);return t._loader.sanitize(e,{context:"image"}).then((function(e){var r=e.href;if(!r||!n)throw{url:r};var i=new n;i.onload=function(){UH(t)};i.onerror=function(){UH(t)};i.src=r;return i})).catch((function(e){UH(t);return{complete:false,width:0,height:0,src:e&&e.url||""}}))};IH.ready=function(){var e=this;return new Promise((function(t){function n(r){if(!e.pending())t(r);else setTimeout((function(){n(true)}),10)}n(false)}))};function qH(e){return function t(){return e}}var WH=Math.abs;var HH=Math.atan2;var GH=Math.cos;var $H=Math.max;var YH=Math.min;var VH=Math.sin;var XH=Math.sqrt;var JH=1e-12;var ZH=Math.PI;var QH=ZH/2;var KH=2*ZH;function eG(e){return e>1?0:e<-1?ZH:Math.acos(e)}function tG(e){return e>=1?QH:e<=-1?-QH:Math.asin(e)}function nG(e){return e.innerRadius}function rG(e){return e.outerRadius}function iG(e){return e.startAngle}function aG(e){return e.endAngle}function oG(e){return e&&e.padAngle}function uG(e,t,n,r,i,a,o,u){var s=n-e,l=r-t,f=o-i,c=u-a,h=c*s-f*l;if(h*h<JH)return;h=(f*(t-a)-c*(e-i))/h;return[e+h*s,t+h*l]}function sG(e,t,n,r,i,a,o){var u=e-n,s=t-r,l=(o?a:-a)/XH(u*u+s*s),f=l*s,c=-l*u,h=e+f,d=t+c,p=n+f,v=r+c,g=(h+p)/2,m=(d+v)/2,y=p-h,b=v-d,_=y*y+b*b,x=i-a,w=h*v-p*d,k=(b<0?-1:1)*XH($H(0,x*x*_-w*w)),A=(w*b-y*k)/_,E=(-w*y-b*k)/_,M=(w*b+y*k)/_,O=(-w*y+b*k)/_,S=A-g,D=E-m,C=M-g,F=O-m;if(S*S+D*D>C*C+F*F)A=M,E=O;return{cx:A,cy:E,x01:-f,y01:-c,x11:A*(i/x-1),y11:E*(i/x-1)}}function lG(){var e=nG,t=rG,n=qH(0),r=null,i=iG,a=aG,o=oG,u=null;function s(){var s,l,f=+e.apply(this,arguments),c=+t.apply(this,arguments),h=i.apply(this,arguments)-QH,d=a.apply(this,arguments)-QH,p=WH(d-h),v=d>h;if(!u)u=s=ig();if(c<f)l=c,c=f,f=l;if(!(c>JH))u.moveTo(0,0);else if(p>KH-JH){u.moveTo(c*GH(h),c*VH(h));u.arc(0,0,c,h,d,!v);if(f>JH){u.moveTo(f*GH(d),f*VH(d));u.arc(0,0,f,d,h,v)}}else{var g=h,m=d,y=h,b=d,_=p,x=p,w=o.apply(this,arguments)/2,k=w>JH&&(r?+r.apply(this,arguments):XH(f*f+c*c)),A=YH(WH(c-f)/2,+n.apply(this,arguments)),E=A,M=A,O,S;if(k>JH){var D=tG(k/f*VH(w)),C=tG(k/c*VH(w));if((_-=D*2)>JH)D*=v?1:-1,y+=D,b-=D;else _=0,y=b=(h+d)/2;if((x-=C*2)>JH)C*=v?1:-1,g+=C,m-=C;else x=0,g=m=(h+d)/2}var F=c*GH(g),T=c*VH(g),N=f*GH(b),j=f*VH(b);if(A>JH){var R=c*GH(m),z=c*VH(m),P=f*GH(y),L=f*VH(y),I;if(p<ZH&&(I=uG(F,T,P,L,R,z,N,j))){var B=F-I[0],U=T-I[1],q=R-I[0],W=z-I[1],H=1/VH(eG((B*q+U*W)/(XH(B*B+U*U)*XH(q*q+W*W)))/2),G=XH(I[0]*I[0]+I[1]*I[1]);E=YH(A,(f-G)/(H-1));M=YH(A,(c-G)/(H+1))}}if(!(x>JH))u.moveTo(F,T);else if(M>JH){O=sG(P,L,F,T,c,M,v);S=sG(R,z,N,j,c,M,v);u.moveTo(O.cx+O.x01,O.cy+O.y01);if(M<A)u.arc(O.cx,O.cy,M,HH(O.y01,O.x01),HH(S.y01,S.x01),!v);else{u.arc(O.cx,O.cy,M,HH(O.y01,O.x01),HH(O.y11,O.x11),!v);u.arc(0,0,c,HH(O.cy+O.y11,O.cx+O.x11),HH(S.cy+S.y11,S.cx+S.x11),!v);u.arc(S.cx,S.cy,M,HH(S.y11,S.x11),HH(S.y01,S.x01),!v)}}else u.moveTo(F,T),u.arc(0,0,c,g,m,!v);if(!(f>JH)||!(_>JH))u.lineTo(N,j);else if(E>JH){O=sG(N,j,R,z,f,-E,v);S=sG(F,T,P,L,f,-E,v);u.lineTo(O.cx+O.x01,O.cy+O.y01);if(E<A)u.arc(O.cx,O.cy,E,HH(O.y01,O.x01),HH(S.y01,S.x01),!v);else{u.arc(O.cx,O.cy,E,HH(O.y01,O.x01),HH(O.y11,O.x11),!v);u.arc(0,0,f,HH(O.cy+O.y11,O.cx+O.x11),HH(S.cy+S.y11,S.cx+S.x11),v);u.arc(S.cx,S.cy,E,HH(S.y11,S.x11),HH(S.y01,S.x01),!v)}}else u.arc(0,0,f,b,y,v)}u.closePath();if(s)return u=null,s+""||null}s.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-ZH/2;return[GH(r)*n,VH(r)*n]};s.innerRadius=function(t){return arguments.length?(e=typeof t==="function"?t:qH(+t),s):e};s.outerRadius=function(e){return arguments.length?(t=typeof e==="function"?e:qH(+e),s):t};s.cornerRadius=function(e){return arguments.length?(n=typeof e==="function"?e:qH(+e),s):n};s.padRadius=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:qH(+e),s):r};s.startAngle=function(e){return arguments.length?(i=typeof e==="function"?e:qH(+e),s):i};s.endAngle=function(e){return arguments.length?(a=typeof e==="function"?e:qH(+e),s):a};s.padAngle=function(e){return arguments.length?(o=typeof e==="function"?e:qH(+e),s):o};s.context=function(e){return arguments.length?(u=e==null?null:e,s):u};return s}function fG(e){this._context=e}fG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function cG(e){return new fG(e)}function hG(e){return e[0]}function dG(e){return e[1]}function pG(){var e=hG,t=dG,n=qH(true),r=null,i=cG,a=null;function o(o){var u,s=o.length,l,f=false,c;if(r==null)a=i(c=ig());for(u=0;u<=s;++u){if(!(u<s&&n(l=o[u],u,o))===f){if(f=!f)a.lineStart();else a.lineEnd()}if(f)a.point(+e(l,u,o),+t(l,u,o))}if(c)return a=null,c+""||null}o.x=function(t){return arguments.length?(e=typeof t==="function"?t:qH(+t),o):e};o.y=function(e){return arguments.length?(t=typeof e==="function"?e:qH(+e),o):t};o.defined=function(e){return arguments.length?(n=typeof e==="function"?e:qH(!!e),o):n};o.curve=function(e){return arguments.length?(i=e,r!=null&&(a=i(r)),o):i};o.context=function(e){return arguments.length?(e==null?r=a=null:a=i(r=e),o):r};return o}function vG(){var e=hG,t=null,n=qH(0),r=dG,i=qH(true),a=null,o=cG,u=null;function s(s){var l,f,c,h=s.length,d,p=false,v,g=new Array(h),m=new Array(h);if(a==null)u=o(v=ig());for(l=0;l<=h;++l){if(!(l<h&&i(d=s[l],l,s))===p){if(p=!p){f=l;u.areaStart();u.lineStart()}else{u.lineEnd();u.lineStart();for(c=l-1;c>=f;--c){u.point(g[c],m[c])}u.lineEnd();u.areaEnd()}}if(p){g[l]=+e(d,l,s),m[l]=+n(d,l,s);u.point(t?+t(d,l,s):g[l],r?+r(d,l,s):m[l])}}if(v)return u=null,v+""||null}function l(){return pG().defined(i).curve(o).context(a)}s.x=function(n){return arguments.length?(e=typeof n==="function"?n:qH(+n),t=null,s):e};s.x0=function(t){return arguments.length?(e=typeof t==="function"?t:qH(+t),s):e};s.x1=function(e){return arguments.length?(t=e==null?null:typeof e==="function"?e:qH(+e),s):t};s.y=function(e){return arguments.length?(n=typeof e==="function"?e:qH(+e),r=null,s):n};s.y0=function(e){return arguments.length?(n=typeof e==="function"?e:qH(+e),s):n};s.y1=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:qH(+e),s):r};s.lineX0=s.lineY0=function(){return l().x(e).y(n)};s.lineY1=function(){return l().x(e).y(r)};s.lineX1=function(){return l().x(t).y(n)};s.defined=function(e){return arguments.length?(i=typeof e==="function"?e:qH(!!e),s):i};s.curve=function(e){return arguments.length?(o=e,a!=null&&(u=o(a)),s):o};s.context=function(e){return arguments.length?(e==null?a=u=null:u=o(a=e),s):a};return s}var gG={draw:function(e,t){var n=Math.sqrt(t/ZH);e.moveTo(n,0);e.arc(0,0,n,0,KH)}};function mG(){var e=qH(gG),t=qH(64),n=null;function r(){var r;if(!n)n=r=ig();e.apply(this,arguments).draw(n,+t.apply(this,arguments));if(r)return n=null,r+""||null}r.type=function(t){return arguments.length?(e=typeof t==="function"?t:qH(t),r):e};r.size=function(e){return arguments.length?(t=typeof e==="function"?e:qH(+e),r):t};r.context=function(e){return arguments.length?(n=e==null?null:e,r):n};return r}function yG(){}function bG(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function _G(e){this._context=e}_G.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){switch(this._point){case 3:bG(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:bG(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function xG(e){return new _G(e)}function wG(e){this._context=e}wG.prototype={areaStart:yG,areaEnd:yG,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2);this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3);this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3);this._context.closePath();break}case 3:{this.point(this._x2,this._y2);this.point(this._x3,this._y3);this.point(this._x4,this._y4);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x2=e,this._y2=t;break;case 1:this._point=2;this._x3=e,this._y3=t;break;case 2:this._point=3;this._x4=e,this._y4=t;this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:bG(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function kG(e){return new wG(e)}function AG(e){this._context=e}AG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:bG(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function EG(e){return new AG(e)}function MG(e,t){this._basis=new _G(e);this._beta=t}MG.prototype={lineStart:function(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0){var r=e[0],i=t[0],a=e[n]-r,o=t[n]-i,u=-1,s;while(++u<=n){s=u/n;this._basis.point(this._beta*e[u]+(1-this._beta)*(r+s*a),this._beta*t[u]+(1-this._beta)*(i+s*o))}}this._x=this._y=null;this._basis.lineEnd()},point:function(e,t){this._x.push(+e);this._y.push(+t)}};var OG=function e(t){function n(e){return t===1?new _G(e):new MG(e,t)}n.beta=function(t){return e(+t)};return n}(.85);function SG(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function DG(e,t){this._context=e;this._k=(1-t)/6}DG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:SG(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;this._x1=e,this._y1=t;break;case 2:this._point=3;default:SG(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var CG=function e(t){function n(e){return new DG(e,t)}n.tension=function(t){return e(+t)};return n}(0);function FG(e,t){this._context=e;this._k=(1-t)/6}FG.prototype={areaStart:yG,areaEnd:yG,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:SG(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var TG=function e(t){function n(e){return new FG(e,t)}n.tension=function(t){return e(+t)};return n}(0);function NG(e,t){this._context=e;this._k=(1-t)/6}NG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:SG(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var jG=function e(t){function n(e){return new NG(e,t)}n.tension=function(t){return e(+t)};return n}(0);function RG(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>JH){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,s=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/s;i=(i*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/s}if(e._l23_a>JH){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/f;o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/f}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function zG(e,t){this._context=e;this._alpha=t}zG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:RG(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var PG=function e(t){function n(e){return t?new zG(e,t):new DG(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function LG(e,t){this._context=e;this._alpha=t}LG.prototype={areaStart:yG,areaEnd:yG,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:RG(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var IG=function e(t){function n(e){return t?new LG(e,t):new FG(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function BG(e,t){this._context=e;this._alpha=t}BG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:RG(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var UG=function e(t){function n(e){return t?new BG(e,t):new NG(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function qG(e){this._context=e}qG.prototype={areaStart:yG,areaEnd:yG,lineStart:function(){this._point=0},lineEnd:function(){if(this._point)this._context.closePath()},point:function(e,t){e=+e,t=+t;if(this._point)this._context.lineTo(e,t);else this._point=1,this._context.moveTo(e,t)}};function WG(e){return new qG(e)}function HG(e){return e<0?-1:1}function GG(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),u=(a*i+o*r)/(r+i);return(HG(a)+HG(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function $G(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function YG(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,u=(a-r)/3;e._context.bezierCurveTo(r+u,i+u*t,a-u,o-u*n,a,o)}function VG(e){this._context=e}VG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:YG(this,this._t0,$G(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){var n=NaN;e=+e,t=+t;if(e===this._x1&&t===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;YG(this,$G(this,n=GG(this,e,t)),n);break;default:YG(this,this._t0,n=GG(this,e,t));break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t;this._t0=n}};function XG(e){this._context=new JG(e)}(XG.prototype=Object.create(VG.prototype)).point=function(e,t){VG.prototype.point.call(this,t,e)};function JG(e){this._context=e}JG.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function ZG(e){return new VG(e)}function QG(e){return new XG(e)}function KG(e){this._context=e}KG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[];this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n){this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]);if(n===2){this._context.lineTo(e[1],t[1])}else{var r=e$(e),i=e$(t);for(var a=0,o=1;o<n;++a,++o){this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o])}}}if(this._line||this._line!==0&&n===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function(e,t){this._x.push(+e);this._y.push(+t)}};function e$(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);i[0]=0,a[0]=2,o[0]=e[0]+2*e[1];for(t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n];for(t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];i[n-1]=o[n-1]/a[n-1];for(t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];a[n-1]=(e[n]+i[n-1])/2;for(t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function t$(e){return new KG(e)}function n$(e,t){this._context=e;this._t=t}n$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN;this._point=0},lineEnd:function(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,t);this._context.lineTo(e,t)}else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y);this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function r$(e){return new n$(e,.5)}function i$(e){return new n$(e,0)}function a$(e){return new n$(e,1)}var o$={basis:{curve:xG},"basis-closed":{curve:kG},"basis-open":{curve:EG},bundle:{curve:OG,tension:"beta",value:.85},cardinal:{curve:CG,tension:"tension",value:0},"cardinal-open":{curve:jG,tension:"tension",value:0},"cardinal-closed":{curve:TG,tension:"tension",value:0},"catmull-rom":{curve:PG,tension:"alpha",value:.5},"catmull-rom-closed":{curve:IG,tension:"alpha",value:.5},"catmull-rom-open":{curve:UG,tension:"alpha",value:.5},linear:{curve:cG},"linear-closed":{curve:WG},monotone:{horizontal:QG,vertical:ZG},natural:{curve:t$},step:{curve:r$},"step-after":{curve:a$},"step-before":{curve:i$}};function u$(e,t,n){var r=jH(o$,e)&&o$[e],i=null;if(r){i=r.curve||r[t||"vertical"];if(r.tension&&n!=null){i=i[r.tension](n)}}return i}var s$={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},l$=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];function f$(e){var t=[],n,r,i,a,o,u,s,l,f,c,h;n=e.slice().replace(l$[0],"###$1").split(l$[1]).slice(1);for(l=0,c=n.length;l<c;++l){r=n[l];i=r.slice(1).trim().replace(l$[2],"$1###$2").split(l$[3]);u=r.charAt(0);a=[u];for(f=0,h=i.length;f<h;++f){if((o=+i[f])===o){a.push(o)}}s=s$[u.toLowerCase()];if(a.length-1>s){for(f=1,h=a.length;f<h;f+=s){t.push([u].concat(a.slice(f,f+s)))}}else{t.push(a)}}return t}var c$=Math.PI/180;var h$=1e-14;var d$=Math.PI/2;var p$=Math.PI*2;var v$=Math.sqrt(3)/2;var g$={};var m$={};var y$=[].join;function b$(e,t,n,r,i,a,o,u,s){var l=y$.call(arguments);if(g$[l]){return g$[l]}var f=o*c$;var c=Math.sin(f);var h=Math.cos(f);n=Math.abs(n);r=Math.abs(r);var d=h*(u-e)*.5+c*(s-t)*.5;var p=h*(s-t)*.5-c*(u-e)*.5;var v=d*d/(n*n)+p*p/(r*r);if(v>1){v=Math.sqrt(v);n*=v;r*=v}var g=h/n;var m=c/n;var y=-c/r;var b=h/r;var _=g*u+m*s;var x=y*u+b*s;var w=g*e+m*t;var k=y*e+b*t;var A=(w-_)*(w-_)+(k-x)*(k-x);var E=1/A-.25;if(E<0)E=0;var M=Math.sqrt(E);if(a==i)M=-M;var O=.5*(_+w)-M*(k-x);var S=.5*(x+k)+M*(w-_);var D=Math.atan2(x-S,_-O);var C=Math.atan2(k-S,w-O);var F=C-D;if(F<0&&a===1){F+=p$}else if(F>0&&a===0){F-=p$}var T=Math.ceil(Math.abs(F/(d$+.001)));var N=[];for(var j=0;j<T;++j){var R=D+j*F/T;var z=D+(j+1)*F/T;N[j]=[O,S,R,z,n,r,c,h]}return g$[l]=N}function _$(e){var t=y$.call(e);if(m$[t]){return m$[t]}var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7];var f=l*o;var c=-s*u;var h=s*o;var d=l*u;var p=Math.cos(i);var v=Math.sin(i);var g=Math.cos(a);var m=Math.sin(a);var y=.5*(a-i);var b=Math.sin(y*.5);var _=8/3*b*b/Math.sin(y);var x=n+p-_*v;var w=r+v+_*p;var k=n+g;var A=r+m;var E=k+_*m;var M=A-_*g;return m$[t]=[f*x+c*w,h*x+d*w,f*E+c*M,h*E+d*M,f*k+c*A,h*k+d*A]}var x$=["l",0,0,0,0,0,0,0];function w$(e,t,n){var r=x$[0]=e[0];if(r==="a"||r==="A"){x$[1]=t*e[1];x$[2]=n*e[2];x$[3]=e[3];x$[4]=e[4];x$[5]=e[5];x$[6]=t*e[6];x$[7]=n*e[7]}else if(r==="h"||r==="H"){x$[1]=t*e[1]}else if(r==="v"||r==="V"){x$[1]=n*e[1]}else{for(var i=1,a=e.length;i<a;++i){x$[i]=(i%2==1?t:n)*e[i]}}return x$}function k$(e,t,n,r,i,a){var o,u=null,s=0,l=0,f=0,c=0,h,d,p,v;if(n==null)n=0;if(r==null)r=0;if(i==null)i=1;if(a==null)a=i;if(e.beginPath)e.beginPath();for(var g=0,m=t.length;g<m;++g){o=t[g];if(i!==1||a!==1){o=w$(o,i,a)}switch(o[0]){case"l":s+=o[1];l+=o[2];e.lineTo(s+n,l+r);break;case"L":s=o[1];l=o[2];e.lineTo(s+n,l+r);break;case"h":s+=o[1];e.lineTo(s+n,l+r);break;case"H":s=o[1];e.lineTo(s+n,l+r);break;case"v":l+=o[1];e.lineTo(s+n,l+r);break;case"V":l=o[1];e.lineTo(s+n,l+r);break;case"m":s+=o[1];l+=o[2];e.moveTo(s+n,l+r);break;case"M":s=o[1];l=o[2];e.moveTo(s+n,l+r);break;case"c":h=s+o[5];d=l+o[6];f=s+o[3];c=l+o[4];e.bezierCurveTo(s+o[1]+n,l+o[2]+r,f+n,c+r,h+n,d+r);s=h;l=d;break;case"C":s=o[5];l=o[6];f=o[3];c=o[4];e.bezierCurveTo(o[1]+n,o[2]+r,f+n,c+r,s+n,l+r);break;case"s":h=s+o[3];d=l+o[4];f=2*s-f;c=2*l-c;e.bezierCurveTo(f+n,c+r,s+o[1]+n,l+o[2]+r,h+n,d+r);f=s+o[1];c=l+o[2];s=h;l=d;break;case"S":h=o[3];d=o[4];f=2*s-f;c=2*l-c;e.bezierCurveTo(f+n,c+r,o[1]+n,o[2]+r,h+n,d+r);s=h;l=d;f=o[1];c=o[2];break;case"q":h=s+o[3];d=l+o[4];f=s+o[1];c=l+o[2];e.quadraticCurveTo(f+n,c+r,h+n,d+r);s=h;l=d;break;case"Q":h=o[3];d=o[4];e.quadraticCurveTo(o[1]+n,o[2]+r,h+n,d+r);s=h;l=d;f=o[1];c=o[2];break;case"t":h=s+o[1];d=l+o[2];if(u[0].match(/[QqTt]/)===null){f=s;c=l}else if(u[0]==="t"){f=2*s-p;c=2*l-v}else if(u[0]==="q"){f=2*s-f;c=2*l-c}p=f;v=c;e.quadraticCurveTo(f+n,c+r,h+n,d+r);s=h;l=d;f=s+o[1];c=l+o[2];break;case"T":h=o[1];d=o[2];f=2*s-f;c=2*l-c;e.quadraticCurveTo(f+n,c+r,h+n,d+r);s=h;l=d;break;case"a":A$(e,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+s+n,o[7]+l+r]);s+=o[6];l+=o[7];break;case"A":A$(e,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]);s=o[6];l=o[7];break;case"z":case"Z":e.closePath();break}u=o}}function A$(e,t,n,r){var i=b$(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(var a=0;a<i.length;++a){var o=_$(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var E$=.5773502691896257;var M$={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0);e.arc(0,0,n,0,p$)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r);e.lineTo(-n,r);e.lineTo(-r,r);e.lineTo(-r,n);e.lineTo(r,n);e.lineTo(r,r);e.lineTo(n,r);e.lineTo(n,-r);e.lineTo(r,-r);e.lineTo(r,-n);e.lineTo(-r,-n);e.lineTo(-r,-r);e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0);e.lineTo(0,-n);e.lineTo(n,0);e.lineTo(0,n);e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,a=n/8;e.moveTo(-r,n);e.lineTo(r,n);e.lineTo(r,-a);e.lineTo(i,-a);e.lineTo(0,-n);e.lineTo(-i,-a);e.lineTo(-r,-a);e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=v$*n,i=r-n*E$,a=n/4;e.moveTo(0,-r-i);e.lineTo(-a,r-i);e.lineTo(a,r-i);e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=v$*n,i=r-n*E$;e.moveTo(0,-r-i);e.lineTo(-n,r-i);e.lineTo(n,r-i);e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v$*n;e.moveTo(0,-r);e.lineTo(-n,r);e.lineTo(n,r);e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v$*n;e.moveTo(0,r);e.lineTo(-n,-r);e.lineTo(n,-r);e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v$*n;e.moveTo(r,0);e.lineTo(-r,-n);e.lineTo(-r,n);e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=v$*n;e.moveTo(-r,0);e.lineTo(r,-n);e.lineTo(r,n);e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0);e.lineTo(n,0)}}};function O$(e){return jH(M$,e)?M$[e]:D$(e)}var S$={};function D$(e){if(!jH(S$,e)){var t=f$(e);S$[e]={draw:function(e,n){k$(e,t,0,0,Math.sqrt(n)/2)}}}return S$[e]}var C$=Math.PI,F$=2*C$,T$=1e-6,N$=F$-T$;function j$(){this._x0=this._y0=this._x1=this._y1=null;this._=""}function R$(){return new j$}j$.prototype=R$.prototype={constructor:j$,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,u=n-e,s=r-t,l=a-e,f=o-t,c=l*l+f*f;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null){this._+="M"+(this._x1=e)+","+(this._y1=t)}else if(!(c>T$));else if(!(Math.abs(f*u-s*l)>T$)||!i){this._+="L"+(this._x1=e)+","+(this._y1=t)}else{var h=n-a,d=r-o,p=u*u+s*s,v=h*h+d*d,g=Math.sqrt(p),m=Math.sqrt(c),y=i*Math.tan((C$-Math.acos((p+c-v)/(2*g*m)))/2),b=y/m,_=y/g;if(Math.abs(b-1)>T$){this._+="L"+(e+b*l)+","+(t+b*f)}this._+="A"+i+","+i+",0,0,"+ +(f*h>l*d)+","+(this._x1=e+_*u)+","+(this._y1=t+_*s)}},arc:function(e,t,n,r,i,a){e=+e,t=+t,n=+n,a=!!a;var o=n*Math.cos(r),u=n*Math.sin(r),s=e+o,l=t+u,f=1^a,c=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);if(this._x1===null){this._+="M"+s+","+l}else if(Math.abs(this._x1-s)>T$||Math.abs(this._y1-l)>T$){this._+="L"+s+","+l}if(!n)return;if(c<0)c=c%F$+F$;if(c>N$){this._+="A"+n+","+n+",0,1,"+f+","+(e-o)+","+(t-u)+"A"+n+","+n+",0,1,"+f+","+(this._x1=s)+","+(this._y1=l)}else if(c>T$){this._+="A"+n+","+n+",0,"+ +(c>=C$)+","+f+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))}},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var z$=.448084975506;function P$(e){return e.x}function L$(e){return e.y}function I$(e){return e.width}function B$(e){return e.height}function U$(e){return typeof e==="function"?e:function(){return+e}}function q$(e,t,n){return Math.max(t,Math.min(e,n))}function W$(){var e=P$,t=L$,n=I$,r=B$,i=U$(0),a=i,o=i,u=i,s=null;function l(l,f,c){var h,d=f!=null?f:+e.call(this,l),p=c!=null?c:+t.call(this,l),v=+n.call(this,l),g=+r.call(this,l),m=Math.min(v,g)/2,y=q$(+i.call(this,l),0,m),b=q$(+a.call(this,l),0,m),_=q$(+o.call(this,l),0,m),x=q$(+u.call(this,l),0,m);if(!s)s=h=R$();if(y<=0&&b<=0&&_<=0&&x<=0){s.rect(d,p,v,g)}else{var w=d+v,k=p+g;s.moveTo(d+y,p);s.lineTo(w-b,p);s.bezierCurveTo(w-z$*b,p,w,p+z$*b,w,p+b);s.lineTo(w,k-x);s.bezierCurveTo(w,k-z$*x,w-z$*x,k,w-x,k);s.lineTo(d+_,k);s.bezierCurveTo(d+z$*_,k,d,k-z$*_,d,k-_);s.lineTo(d,p+y);s.bezierCurveTo(d,p+z$*y,d+z$*y,p,d+y,p);s.closePath()}if(h){s=null;return h+""||null}}l.x=function(t){if(arguments.length){e=U$(t);return l}else{return e}};l.y=function(e){if(arguments.length){t=U$(e);return l}else{return t}};l.width=function(e){if(arguments.length){n=U$(e);return l}else{return n}};l.height=function(e){if(arguments.length){r=U$(e);return l}else{return r}};l.cornerRadius=function(e,t,n,r){if(arguments.length){i=U$(e);a=t!=null?U$(t):i;u=n!=null?U$(n):i;o=r!=null?U$(r):a;return l}else{return i}};l.context=function(e){if(arguments.length){s=e==null?null:e;return l}else{return s}};return l}function H$(){var e,t,n,r,i=null,a,o,u,s;function l(e,t,n){var r=n/2;if(a){var l=u-t,f=e-o;if(l||f){var c=Math.sqrt(l*l+f*f),h=(l/=c)*s,d=(f/=c)*s,p=Math.atan2(f,l);i.moveTo(o-h,u-d);i.lineTo(e-l*r,t-f*r);i.arc(e,t,r,p-Math.PI,p);i.lineTo(o+h,u+d);i.arc(o,u,s,p,p+Math.PI)}else{i.arc(e,t,r,0,p$)}i.closePath()}else{a=1}o=e;u=t;s=r}function f(o){var u,s=o.length,f,c=false,h;if(i==null)i=h=R$();for(u=0;u<=s;++u){if(!(u<s&&r(f=o[u],u,o))===c){if(c=!c)a=0}if(c)l(+e(f,u,o),+t(f,u,o),+n(f,u,o))}if(h){i=null;return h+""||null}}f.x=function(t){if(arguments.length){e=t;return f}else{return e}};f.y=function(e){if(arguments.length){t=e;return f}else{return t}};f.size=function(e){if(arguments.length){n=e;return f}else{return n}};f.defined=function(e){if(arguments.length){r=e;return f}else{return r}};f.context=function(e){if(arguments.length){if(e==null){i=null}else{i=e}return f}else{return i}};return f}function G$(e,t){return e!=null?e:t}var $$=function(e){return e.x||0},Y$=function(e){return e.y||0},V$=function(e){return e.width||0},X$=function(e){return e.height||0},J$=function(e){return(e.x||0)+(e.width||0)},Z$=function(e){return(e.y||0)+(e.height||0)},Q$=function(e){return e.startAngle||0},K$=function(e){return e.endAngle||0},eY=function(e){return e.padAngle||0},tY=function(e){return e.innerRadius||0},nY=function(e){return e.outerRadius||0},rY=function(e){return e.cornerRadius||0},iY=function(e){return G$(e.cornerRadiusTopLeft,e.cornerRadius)||0},aY=function(e){return G$(e.cornerRadiusTopRight,e.cornerRadius)||0},oY=function(e){return G$(e.cornerRadiusBottomRight,e.cornerRadius)||0},uY=function(e){return G$(e.cornerRadiusBottomLeft,e.cornerRadius)||0},sY=function(e){return G$(e.size,64)},lY=function(e){return e.size||1},fY=function(e){return!(e.defined===false)},cY=function(e){return O$(e.shape||"circle")};var hY=lG().startAngle(Q$).endAngle(K$).padAngle(eY).innerRadius(tY).outerRadius(nY).cornerRadius(rY),dY=vG().x($$).y1(Y$).y0(Z$).defined(fY),pY=vG().y(Y$).x1($$).x0(J$).defined(fY),vY=pG().x($$).y(Y$).defined(fY),gY=W$().x($$).y(Y$).width(V$).height(X$).cornerRadius(iY,aY,oY,uY),mY=mG().type(cY).size(sY),yY=H$().x($$).y(Y$).defined(fY).size(lY);function bY(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function _Y(e,t){return hY.context(e)(t)}function xY(e,t){var n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?pY:dY).curve(u$(r,n.orient,n.tension)).context(e)(t)}function wY(e,t){var n=t[0],r=n.interpolate||"linear";return vY.curve(u$(r,n.orient,n.tension)).context(e)(t)}function kY(e,t,n,r){return gY.context(e)(t,n,r)}function AY(e,t){return(t.mark.shape||t.shape).context(e)(t)}function EY(e,t){return mY.context(e)(t)}function MY(e,t){return yY.context(e)(t)}function OY(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){var r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?SY(t,r):0))}return e}function SY(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}var DY,CY,FY,TY=p$-1e-8;function NY(e){DY=e;return NY}function jY(){}function RY(e,t){DY.add(e,t)}function zY(e,t){RY(CY=e,FY=t)}function PY(e){RY(e,DY.y1)}function LY(e){RY(DY.x1,e)}NY.beginPath=jY;NY.closePath=jY;NY.moveTo=zY;NY.lineTo=zY;NY.rect=function(e,t,n,r){RY(e+n,t+r);zY(e,t)};NY.quadraticCurveTo=function(e,t,n,r){IY(CY,e,n,PY);IY(FY,t,r,LY);zY(n,r)};function IY(e,t,n,r){var i=(e-t)/(e+n-2*t);if(0<i&&i<1)r(e+(t-e)*i)}NY.bezierCurveTo=function(e,t,n,r,i,a){BY(CY,e,n,i,PY);BY(FY,t,r,a,LY);zY(i,a)};function BY(e,t,n,r,i){var a=r-e+3*t-3*n,o=e+n-2*t,u=e-t;var s=0,l=0,f;if(Math.abs(a)>h$){f=o*o+u*a;if(f>=0){f=Math.sqrt(f);s=(-o+f)/a;l=(-o-f)/a}}else{s=.5*u/o}if(0<s&&s<1)i(UY(s,e,t,n,r));if(0<l&&l<1)i(UY(l,e,t,n,r))}function UY(e,t,n,r,i){var a=1-e,o=a*a,u=e*e;return o*a*t+3*o*e*n+3*a*u*r+u*e*i}NY.arc=function(e,t,n,r,i,a){CY=n*Math.cos(i)+e;FY=n*Math.sin(i)+t;if(Math.abs(i-r)>TY){RY(e-n,t-n);RY(e+n,t+n)}else{var o=function(r){return RY(n*Math.cos(r)+e,n*Math.sin(r)+t)};var u=void 0,s=void 0;o(r);o(i);if(i!==r){r=r%p$;if(r<0)r+=p$;i=i%p$;if(i<0)i+=p$;if(i<r){a=!a;u=r;r=i;i=u}if(a){i-=p$;u=r-r%d$;for(s=0;s<4&&u>i;++s,u-=d$)o(u)}else{u=r-r%d$+d$;for(s=0;s<4&&u<i;++s,u=u+d$)o(u)}}}};var qY=(qY=Yv(1,1))?qY.getContext("2d"):null;var WY=new sH;function HY(e){return function(t,n){if(!qY)return true;e(qY,t);WY.clear().union(t.bounds).intersect(n).round();var r=WY.x1,i=WY.y1,a=WY.x2,o=WY.y2;for(var u=i;u<=o;++u){for(var s=r;s<=a;++s){if(qY.isPointInPath(s,u)){return true}}}return false}}function GY(e,t){return t.contains(e.x||0,e.y||0)}function $Y(e,t){var n=e.x||0,r=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(WY.set(n,r,n+i,r+a))}function YY(e,t){var n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,a=e.y2!=null?e.y2:r;return VY(t,n,r,i,a)}function VY(e,t,n,r,i){var a=e.x1,o=e.y1,u=e.x2,s=e.y2,l=r-t,f=i-n;var c=0,h=1,d,p,v,g;for(g=0;g<4;++g){if(g===0){d=-l;p=-(a-t)}if(g===1){d=l;p=u-t}if(g===2){d=-f;p=-(o-n)}if(g===3){d=f;p=s-n}if(Math.abs(d)<1e-10&&p<0)return false;v=p/d;if(d<0){if(v>h)return false;else if(v>c)c=v}else if(d>0){if(v<c)return false;else if(v<h)h=v}}return true}function XY(e,t,n){var r=n.width(),i=n.height(),a=t.stops,o=a.length;var u=t.gradient==="radial"?e.createRadialGradient(n.x1+JY(t.x1,.5)*r,n.y1+JY(t.y1,.5)*i,Math.max(r,i)*JY(t.r1,0),n.x1+JY(t.x2,.5)*r,n.y1+JY(t.y2,.5)*i,Math.max(r,i)*JY(t.r2,.5)):e.createLinearGradient(n.x1+JY(t.x1,0)*r,n.y1+JY(t.y1,0)*i,n.x1+JY(t.x2,1)*r,n.y1+JY(t.y2,0)*i);for(var s=0;s<o;++s){u.addColorStop(a[s].offset,a[s].color)}return u}function JY(e,t){return e==null?t:e}function ZY(e,t,n){return hH(n)?XY(e,n,t.bounds):n}function QY(e,t,n){n*=t.fillOpacity==null?1:t.fillOpacity;if(n>0){e.globalAlpha=n;e.fillStyle=ZY(e,t,t.fill);return true}else{return false}}var KY=[];function eV(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;if(r<=0)return false;n*=t.strokeOpacity==null?1:t.strokeOpacity;if(n>0){e.globalAlpha=n;e.strokeStyle=ZY(e,t,t.stroke);e.lineWidth=r;e.lineCap=t.strokeCap||"butt";e.lineJoin=t.strokeJoin||"miter";e.miterLimit=t.strokeMiterLimit||10;if(e.setLineDash){e.setLineDash(t.strokeDash||KY);e.lineDashOffset=t.strokeDashOffset||0}return true}else{return false}}function tV(e,t){return e.zindex-t.zindex||e.index-t.index}function nV(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,a;for(i=0,a=t.length;i<a;++i){r=t[i];r.index=i;if(r.zindex)n.push(r)}e.zdirty=false;return e.zitems=n.sort(tV)}function rV(e,t){var n=e.items,r,i;if(!n||!n.length)return;var a=nV(e);if(a&&a.length){for(r=0,i=n.length;r<i;++r){if(!n[r].zindex)t(n[r])}n=a}for(r=0,i=n.length;r<i;++r){t(n[r])}}function iV(e,t){var n=e.items,r,i;if(!n||!n.length)return null;var a=nV(e);if(a&&a.length)n=a;for(i=n.length;--i>=0;){if(r=t(n[i]))return r}if(n===a){for(n=e.items,i=n.length;--i>=0;){if(!n[i].zindex){if(r=t(n[i]))return r}}}return null}function aV(e){return function(t,n,r){rV(n,(function(n){if(!r||r.intersects(n.bounds)){uV(e,t,n,n)}}))}}function oV(e){return function(t,n,r){if(n.items.length&&(!r||r.intersects(n.bounds))){uV(e,t,n.items[0],n.items)}}}function uV(e,t,n,r){var i=n.opacity==null?1:n.opacity;if(i===0)return;if(e(t,r))return;if(n.fill&&QY(t,n,i)){t.fill()}if(n.stroke&&eV(t,n,i)){t.stroke()}}function sV(e){e=e||CH;return function(t,n,r,i,a,o){r*=t.pixelRatio;i*=t.pixelRatio;return iV(n,(function(n){var u=n.bounds;if(u&&!u.contains(a,o)||!u)return;if(e(t,n,r,i,a,o))return n}))}}function lV(e,t){return function(n,r,i,a){var o=Array.isArray(r)?r[0]:r,u=t==null?o.fill:t,s=o.stroke&&n.isPointInStroke,l,f;if(s){l=o.strokeWidth;f=o.strokeCap;n.lineWidth=l!=null?l:1;n.lineCap=f!=null?f:"butt"}return e(n,r)?false:u&&n.isPointInPath(i,a)||s&&n.isPointInStroke(i,a)}}function fV(e){return sV(lV(e))}function cV(e,t){return"translate("+e+","+t+")"}function hV(e){return"rotate("+e+")"}function dV(e,t){return"scale("+e+","+t+")"}function pV(e){return cV(e.x||0,e.y||0)}function vV(e){return cV(e.x||0,e.y||0)+(e.angle?" "+hV(e.angle):"")+(e.scaleX||e.scaleY?" "+dV(e.scaleX||1,e.scaleY||1):"")}function gV(e,t,n){function r(e,n){e("transform",vV(n));e("d",t(null,n))}function i(e,n){var r=n.x||0,i=n.y||0;t(NY(e),n);OY(e,n).translate(r,i);if(n.angle){e.rotate(n.angle*c$,r,i)}return e}function a(e,n){var r=n.x||0,i=n.y||0,a=n.angle||0;e.translate(r,i);if(a)e.rotate(a*=c$);e.beginPath();t(e,n);if(a)e.rotate(-a);e.translate(-r,-i)}return{type:e,tag:"path",nested:false,attr:r,bound:i,draw:aV(a),pick:fV(a),isect:n||HY(a)}}var mV=gV("arc",_Y);function yV(e,t){var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,a=+Infinity,o,u;while(--i>=0){if(e[i].defined===false)continue;u=Math.abs(e[i][r]-n);if(u<a){a=u;o=e[i]}}return o}function bV(e,t){var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,a,o;while(--r>=0){if(e[r].defined===false)continue;i=e[r].x-t[0];a=e[r].y-t[1];o=i*i+a*a;if(o<n)return e[r]}return null}function _V(e,t){var n=e.length,r,i,a;while(--n>=0){if(e[n].defined===false)continue;r=e[n].x-t[0];i=e[n].y-t[1];a=r*r+i*i;r=e[n].size||1;if(a<r*r)return e[n]}return null}function xV(e,t,n){function r(e,n){var r=n.mark.items;if(r.length)e("d",t(null,r))}function i(e,n){var r=n.items;if(r.length===0){return e}else{t(NY(e),r);return OY(e,r[0])}}function a(e,n){e.beginPath();t(e,n)}var o=lV(a);function u(e,t,n,r,i,a){var u=t.items,s=t.bounds;if(!u||!u.length||s&&!s.contains(i,a)){return null}n*=e.pixelRatio;r*=e.pixelRatio;return o(e,u,n,r)?u[0]:null}return{type:e,tag:"path",nested:true,attr:r,bound:i,draw:oV(a),pick:u,isect:GY,tip:n}}var wV=xV("area",xY,yV);function kV(e,t){var n=t.clip;e.save();if(TH(n)){e.beginPath();n(e);e.clip()}else{AV(e,t.group)}}function AV(e,t){e.beginPath();bY(t)?kY(e,t,0,0):e.rect(0,0,t.width||0,t.height||0);e.clip()}var EV=1;function MV(){EV=1}function OV(e,t,n){var r=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+EV++),o=i.clipping[a]||(i.clipping[a]={id:a});if(TH(r)){o.path=r(null)}else if(bY(n)){o.path=kY(null,n,0,0)}else{o.width=n.width||0;o.height=n.height||0}return"url(#"+a+")"}function SV(e){var t=(t=e.strokeWidth)!=null?t:1;return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function DV(e,t){e("transform",pV(t))}function CV(e,t){var n=SV(t);e("d",kY(null,t,n,n))}function FV(e,t){e("class","background");CV(e,t)}function TV(e,t){e("class","foreground");if(t.strokeForeground){CV(e,t)}else{e("d","")}}function NV(e,t,n){var r=t.clip?OV(n,t,t):null;e("clip-path",r)}function jV(e,t){if(!t.clip&&t.items){var n=t.items;for(var r=0,i=n.length;r<i;++r){e.union(n[r].bounds)}}if((t.clip||t.width||t.height)&&!t.noBound){e.add(0,0).add(t.width||0,t.height||0)}OY(e,t);return e.translate(t.x||0,t.y||0)}function RV(e,t,n,r){var i=SV(t);e.beginPath();kY(e,t,(n||0)+i,(r||0)+i)}var zV=lV(RV);var PV=lV(RV,false);function LV(e,t,n){var r=this;rV(t,(function(t){var i=t.x||0,a=t.y||0,o=t.strokeForeground,u=t.opacity==null?1:t.opacity;if((t.stroke||t.fill)&&u){RV(e,t,i,a);if(t.fill&&QY(e,t,u)){e.fill()}if(t.stroke&&!o&&eV(e,t,u)){e.stroke()}}e.save();e.translate(i,a);if(t.clip)AV(e,t);if(n)n.translate(-i,-a);rV(t,(function(t){r.draw(e,t,n)}));if(n)n.translate(i,a);e.restore();if(o&&t.stroke&&u){RV(e,t,i,a);if(eV(e,t,u)){e.stroke()}}}))}function IV(e,t,n,r,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items){return null}var o=this,u=n*e.pixelRatio,s=r*e.pixelRatio;return iV(t,(function(l){var f,c,h,d,p,v,g,m,y;m=l.bounds;if(m&&!m.contains(i,a))return;d=l.x||0;p=l.y||0;v=d+(l.width||0);g=p+(l.height||0);y=l.clip;if(y&&(i<d||i>v||a<d||a>g))return;e.save();e.translate(d,p);d=i-d;p=a-p;if(y&&bY(l)&&!zV(e,l,u,s)){e.restore();return null}c=l.strokeForeground;h=t.interactive!==false;if(h&&c&&l.stroke&&PV(e,l,u,s)){e.restore();return l}f=iV(l,(function(e){return BV(e,d,p)?o.pick(e,n,r,d,p):null}));if(!f&&h&&(l.fill||!c&&l.stroke)&&zV(e,l,u,s)){f=l}e.restore();return f||null}))}function BV(e,t,n){return(e.interactive!==false||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var UV={type:"group",tag:"g",nested:false,attr:DV,bound:jV,draw:LV,pick:IV,isect:$Y,content:NV,background:FV,foreground:TV};function qV(e,t){var n=e.image;if(!n||e.url&&e.url!==n.url){n={complete:false,width:0,height:0};t.loadImage(e.url).then((function(t){e.image=t;e.image.url=e.url}))}return n}function WV(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==false&&e.height?e.height*t.width/t.height:t.width}function HV(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==false&&e.width?e.width*t.height/t.width:t.height}function GV(e,t){return e==="center"?t/2:e==="right"?t:0}function $V(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function YV(e,t,n){var r=qV(t,n),i=t.x||0,a=t.y||0,o=WV(t,r),u=HV(t,r),s=t.aspect===false?"none":"xMidYMid";i-=GV(t.align,o);a-=$V(t.baseline,u);if(!r.src&&r.toDataURL){e("href",r.toDataURL(),"http://www.w3.org/1999/xlink","xlink:href")}else{e("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href")}e("transform",cV(i,a));e("width",o);e("height",u);e("preserveAspectRatio",s)}function VV(e,t){var n=t.image,r=t.x||0,i=t.y||0,a=WV(t,n),o=HV(t,n);r-=GV(t.align,a);i-=$V(t.baseline,o);return e.set(r,i,r+a,i+o)}function XV(e,t,n){var r=this;rV(t,(function(t){if(n&&!n.intersects(t.bounds))return;var i=qV(t,r),a=t.x||0,o=t.y||0,u=WV(t,i),s=HV(t,i),l,f,c,h;a-=GV(t.align,u);o-=$V(t.baseline,s);if(t.aspect!==false){f=i.width/i.height;c=t.width/t.height;if(f===f&&c===c&&f!==c){if(c<f){h=u/f;o+=(s-h)/2;s=h}else{h=s*f;a+=(u-h)/2;u=h}}}if(i.complete||i.toDataURL){e.globalAlpha=(l=t.opacity)!=null?l:1;e.imageSmoothingEnabled=t.smooth!==false;e.drawImage(i,a,o,u,s)}}))}var JV={type:"image",tag:"image",nested:false,attr:YV,bound:VV,draw:XV,pick:sV(),isect:CH,get:qV,xOffset:GV,yOffset:$V};var ZV=xV("line",wY,bV);function QV(e,t){var n=t.scaleX||1,r=t.scaleY||1;if(n!==1||r!==1){e("vector-effect","non-scaling-stroke")}e("transform",vV(t));e("d",t.path)}function KV(e,t){var n=t.path;if(n==null)return true;var r=t.x||0,i=t.y||0,a=t.scaleX||1,o=t.scaleY||1,u=(t.angle||0)*c$,s=t.pathCache;if(!s||s.path!==n){(t.pathCache=s=f$(n)).path=n}if(u&&e.rotate&&e.translate){e.translate(r,i);e.rotate(u);k$(e,s,0,0,a,o);e.rotate(-u);e.translate(-r,-i)}else{k$(e,s,r,i,a,o)}}function eX(e,t){KV(NY(e),t)?e.set(0,0,0,0):OY(e,t,true);if(t.angle){e.rotate(t.angle*c$,t.x||0,t.y||0)}return e}var tX={type:"path",tag:"path",nested:false,attr:QV,bound:eX,draw:aV(KV),pick:fV(KV),isect:HY(KV)};function nX(e,t){e("d",kY(null,t))}function rX(e,t){var n,r;return OY(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function iX(e,t){e.beginPath();kY(e,t)}var aX={type:"rect",tag:"path",nested:false,attr:nX,bound:rX,draw:aV(iX),pick:fV(iX),isect:$Y};function oX(e,t){e("transform",pV(t));e("x2",t.x2!=null?t.x2-(t.x||0):0);e("y2",t.y2!=null?t.y2-(t.y||0):0)}function uX(e,t){var n,r;return OY(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function sX(e,t,n){var r,i,a,o;if(t.stroke&&eV(e,t,n)){r=t.x||0;i=t.y||0;a=t.x2!=null?t.x2:r;o=t.y2!=null?t.y2:i;e.beginPath();e.moveTo(r,i);e.lineTo(a,o);return true}return false}function lX(e,t,n){rV(t,(function(t){if(n&&!n.intersects(t.bounds))return;var r=t.opacity==null?1:t.opacity;if(r&&sX(e,t,r)){e.stroke()}}))}function fX(e,t,n,r){if(!e.isPointInStroke)return false;return sX(e,t,1)&&e.isPointInStroke(n,r)}var cX={type:"rule",tag:"line",nested:false,attr:oX,bound:uX,draw:lX,pick:sV(fX),isect:YY};var hX=gV("shape",AY);var dX=gV("symbol",EY,GY);var pX;var vX={height:_X,measureWidth:yX,estimateWidth:gX,width:gX,canvas:xX};xX(true);function gX(e,t){pX=_X(e);return mX(MX(e,t))}function mX(e){return~~(.8*e.length*pX)}function yX(e,t){return _X(e)<=0?0:(qY.font=DX(e),bX(MX(e,t)))}function bX(e){return qY.measureText(e).width}function _X(e){return e.fontSize!=null?e.fontSize:11}function xX(e){vX.width=e&&qY?yX:gX}function wX(e){return e.lineHeight!=null?e.lineHeight:_X(e)+2}function kX(e){return _H(e)?e.length>1?e:e[0]:e}function AX(e){return kX(e.lineBreak&&e.text&&!_H(e.text)?e.text.split(e.lineBreak):e.text)}function EX(e){var t=AX(e);return(_H(t)?t.length-1:0)*wX(e)}function MX(e,t){return t==null?"":e.limit>0?OX(e,t):t+""}function OX(e,t){var n=+e.limit,r=t+"",i;if(vX.width===yX){qY.font=DX(e);i=bX}else{pX=_X(e);i=mX}if(i(r)<n)return r;var a=e.ellipsis||"…",o=e.dir==="rtl",u=0,s=r.length,l;n-=i(a);if(o){while(u<s){l=u+s>>>1;if(i(r.slice(l))>n)u=l+1;else s=l}return a+r.slice(u)}else{while(u<s){l=1+(u+s>>>1);if(i(r.slice(0,l))<n)u=l;else s=l-1}return r.slice(0,u)+a}}function SX(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function DX(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+_X(e)+"px "+SX(e,t)}function CX(e){var t=e.baseline,n=_X(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:0)}var FX={left:"start",center:"middle",right:"end"};var TX=new sH;function NX(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;if(r){i=(e.theta||0)-d$;t+=r*Math.cos(i);n+=r*Math.sin(i)}TX.x1=t;TX.y1=n;return TX}function jX(e,t){var n=t.dx||0,r=(t.dy||0)+CX(t),i=NX(t),a=i.x1,o=i.y1,u=t.angle||0,s;e("text-anchor",FX[t.align]||"start");if(u){s=cV(a,o)+" "+hV(u);if(n||r)s+=" "+cV(n,r)}else{s=cV(a+n,o+r)}e("transform",s)}function RX(e,t,n){var r=vX.height(t),i=t.align,a=NX(t),o=a.x1,u=a.y1,s=t.dx||0,l=(t.dy||0)+CX(t)-Math.round(.8*r),f=AX(t),c;if(_H(f)){r+=wX(t)*(f.length-1);c=f.reduce((function(e,n){return Math.max(e,vX.width(t,n))}),0)}else{c=vX.width(t,f)}if(i==="center"){s-=c/2}else if(i==="right"){s-=c}e.set(s+=o,l+=u,s+c,l+r);if(t.angle&&!n){e.rotate(t.angle*c$,o,u)}else if(n===2){return e.rotatedPoints(t.angle*c$,o,u)}return e}function zX(e,t,n){rV(t,(function(t){var r=t.opacity==null?1:t.opacity,i,a,o,u,s,l,f;if(n&&!n.intersects(t.bounds)||r===0||t.fontSize<=0||t.text==null||t.text.length===0)return;e.font=DX(t);e.textAlign=t.align||"left";i=NX(t);a=i.x1,o=i.y1;if(t.angle){e.save();e.translate(a,o);e.rotate(t.angle*c$);a=o=0}a+=t.dx||0;o+=(t.dy||0)+CX(t);l=AX(t);if(_H(l)){s=wX(t);for(u=0;u<l.length;++u){f=MX(t,l[u]);if(t.fill&&QY(e,t,r)){e.fillText(f,a,o)}if(t.stroke&&eV(e,t,r)){e.strokeText(f,a,o)}o+=s}}else{f=MX(t,l);if(t.fill&&QY(e,t,r)){e.fillText(f,a,o)}if(t.stroke&&eV(e,t,r)){e.strokeText(f,a,o)}}if(t.angle)e.restore()}))}function PX(e,t,n,r,i,a){if(t.fontSize<=0)return false;if(!t.angle)return true;var o=NX(t),u=o.x1,s=o.y1,l=RX(TX,t,1),f=-t.angle*c$,c=Math.cos(f),h=Math.sin(f),d=c*i-h*a+(u-c*u+h*s),p=h*i+c*a+(s-h*u-c*s);return l.contains(d,p)}function LX(e,t){var n=RX(TX,e,2);return VY(t,n[0],n[1],n[2],n[3])||VY(t,n[0],n[1],n[4],n[5])||VY(t,n[4],n[5],n[6],n[7])||VY(t,n[2],n[3],n[6],n[7])}var IX={type:"text",tag:"text",nested:false,attr:jX,bound:RX,draw:zX,pick:sV(PX),isect:LX};var BX=xV("trail",MY,_V);var UX={arc:mV,area:wV,group:UV,image:JV,line:ZV,path:tX,rect:aX,rule:cX,shape:hX,symbol:dX,text:IX,trail:BX};function qX(e,t,n){var r=UX[e.mark.marktype],i=t||r.bound;if(r.nested)e=e.mark;return i(e.bounds||(e.bounds=new sH),e,n)}var WX={mark:null};function HX(e,t,n){var r=UX[e.marktype],i=r.bound,a=e.items,o=a&&a.length,u,s,l,f;if(r.nested){if(o){l=a[0]}else{WX.mark=e;l=WX}f=qX(l,i,n);t=t&&t.union(f)||f;return t}t=t||e.bounds&&e.bounds.clear()||new sH;if(o){for(u=0,s=a.length;u<s;++u){t.union(qX(a[u],i,n))}}return e.bounds=t}var GX=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant"];function $X(e,t){return JSON.stringify(e,GX,t)}function YX(e){var t=typeof e==="string"?JSON.parse(e):e;return VX(t)}function VX(e){var t=e.marktype,n=e.items,r,i,a;if(n){for(i=0,a=n.length;i<a;++i){r=t?"mark":"group";n[i][r]=e;if(n[i].zindex)n[i][r].zdirty=true;if("group"===(t||r))VX(n[i])}}if(t)HX(e);return e}function XX(e){if(arguments.length){this.root=YX(e)}else{this.root=ZX({marktype:"group",name:"root",role:"frame"});this.root.items=[new PH(this.root)]}}var JX=XX.prototype;JX.toJSON=function(e){return $X(this.root,e||0)};JX.mark=function(e,t,n){t=t||this.root.items[0];var r=ZX(e,t);t.items[n]=r;if(r.zindex)r.group.zdirty=true;return r};function ZX(e,t){return{bounds:new sH,clip:!!e.clip,group:t,interactive:e.interactive===false?false:true,items:[],marktype:e.marktype,name:e.name||undefined,role:e.role||undefined,zindex:e.zindex||0}}function QX(e,t,n){if(!e&&typeof document!=="undefined"&&document.createElement){e=document}return e?n?e.createElementNS(n,t):e.createElement(t):null}function KX(e,t){t=t.toLowerCase();var n=e.childNodes,r=0,i=n.length;for(;r<i;++r)if(n[r].tagName.toLowerCase()===t){return n[r]}}function eJ(e,t,n,r){var i=e.childNodes[t],a;if(!i||i.tagName.toLowerCase()!==n.toLowerCase()){a=i||null;i=QX(e.ownerDocument,n,r);e.insertBefore(i,a)}return i}function tJ(e,t){var n=e.childNodes,r=n.length;while(r>t)e.removeChild(n[--r]);return e}function nJ(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function rJ(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function iJ(e,t,n,r){var i=e&&e.mark,a,o;if(i&&(a=UX[i.marktype]).tip){o=rJ(t,n);o[0]-=r[0];o[1]-=r[1];while(e=e.mark.group){o[0]-=e.x||0;o[1]-=e.y||0}e=a.tip(i.items,o)}return e}function aJ(e,t){this._active=null;this._handlers={};this._loader=e||Oo();this._tooltip=t||oJ}function oJ(e,t,n,r){e.element().setAttribute("title",r||"")}var uJ=aJ.prototype;uJ.initialize=function(e,t,n){this._el=e;this._obj=n||null;return this.origin(t)};uJ.element=function(){return this._el};uJ.canvas=function(){return this._el&&this._el.firstChild};uJ.origin=function(e){if(arguments.length){this._origin=e||[0,0];return this}else{return this._origin.slice()}};uJ.scene=function(e){if(!arguments.length)return this._scene;this._scene=e;return this};uJ.on=function(){};uJ.off=function(){};uJ._handlerIndex=function(e,t,n){for(var r=e?e.length:0;--r>=0;){if(e[r].type===t&&(!n||e[r].handler===n)){return r}}return-1};uJ.handlers=function(e){var t=this._handlers,n=[],r;if(e){n.push.apply(n,t[this.eventName(e)])}else{for(r in t){n.push.apply(n,t[r])}}return n};uJ.eventName=function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)};uJ.handleHref=function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((function(t){var n=new MouseEvent(e.type,e),r=QX(null,"a");for(var i in t)r.setAttribute(i,t[i]);r.dispatchEvent(n)})).catch((function(){}))};uJ.handleTooltip=function(e,t,n){if(t&&t.tooltip!=null){t=iJ(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}};uJ.getItemBoundingClientRect=function(e){if(!(t=this.canvas()))return;var t,n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.x1+r[0]+n.left,o=i.y1+r[1]+n.top,u=i.width(),s=i.height();while(e.mark&&(e=e.mark.group)){a+=e.x||0;o+=e.y||0}return{x:a,y:o,width:u,height:s,left:a,top:o,right:a+u,bottom:o+s}};function sJ(e){this._el=null;this._bgcolor=null;this._loader=new LH(e)}var lJ=sJ.prototype;lJ.initialize=function(e,t,n,r,i){this._el=e;return this.resize(t,n,r,i)};lJ.element=function(){return this._el};lJ.canvas=function(){return this._el&&this._el.firstChild};lJ.background=function(e){if(arguments.length===0)return this._bgcolor;this._bgcolor=e;return this};lJ.resize=function(e,t,n,r){this._width=e;this._height=t;this._origin=n||[0,0];this._scale=r||1;return this};lJ.dirty=function(){};lJ.render=function(e){var t=this;t._call=function(){t._render(e)};t._call();t._call=null;return t};lJ._render=function(){};lJ.renderAsync=function(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)};lJ._load=function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then((function(e){if(e)i();n._ready=null}))}return r};lJ.sanitizeURL=function(e){return this._load("sanitizeURL",e)};lJ.loadImage=function(e){return this._load("loadImage",e)};var fJ=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"];var cJ="mousemove";var hJ="mouseout";var dJ="click";function pJ(e,t){aJ.call(this,e,t);this._down=null;this._touch=null;this._first=true}var vJ=RH(pJ,aJ);vJ.initialize=function(e,t,n){var r=this._canvas=e&&KX(e,"canvas");if(r){var i=this;this.events.forEach((function(e){r.addEventListener(e,(function(t){if(vJ[e]){vJ[e].call(i,t)}else{i.fire(e,t)}}))}))}return aJ.prototype.initialize.call(this,e,t,n)};vJ.canvas=function(){return this._canvas};vJ.context=function(){return this._canvas.getContext("2d")};vJ.events=fJ;vJ.DOMMouseScroll=function(e){this.fire("mousewheel",e)};function gJ(e,t,n){return function(r){var i=this._active,a=this.pickEvent(r);if(a===i){this.fire(e,r)}else{if(!i||!i.exit){this.fire(n,r)}this._active=a;this.fire(t,r);this.fire(e,r)}}}function mJ(e){return function(t){this.fire(e,t);this._active=null}}vJ.mousemove=gJ("mousemove","mouseover","mouseout");vJ.dragover=gJ("dragover","dragenter","dragleave");vJ.mouseout=mJ("mouseout");vJ.dragleave=mJ("dragleave");vJ.mousedown=function(e){this._down=this._active;this.fire("mousedown",e)};vJ.click=function(e){if(this._down===this._active){this.fire("click",e);this._down=null}};vJ.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]);if(this._first){this._active=this._touch;this._first=false}this.fire("touchstart",e,true)};vJ.touchmove=function(e){this.fire("touchmove",e,true)};vJ.touchend=function(e){this.fire("touchend",e,true);this._touch=null};vJ.fire=function(e,t,n){var r=n?this._touch:this._active,i=this._handlers[e],a,o;t.vegaType=e;if(e===dJ&&r&&r.href){this.handleHref(t,r,r.href)}else if(e===cJ||e===hJ){this.handleTooltip(t,r,e!==hJ)}if(i){for(a=0,o=i.length;a<o;++a){i[a].handler.call(this._obj,t,r)}}};vJ.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){(r[n]||(r[n]=[])).push({type:e,handler:t})}return this};vJ.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){r.splice(i,1)}return this};vJ.pickEvent=function(e){var t=rJ(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])};vJ.pick=function(e,t,n,r,i){var a=this.context(),o=UX[e.marktype];return o.pick.call(this,a,e,t,n,r,i)};function yJ(){return typeof window!=="undefined"?window.devicePixelRatio||1:1}var bJ=yJ();function _J(e,t,n,r,i,a){var o=typeof HTMLElement!=="undefined"&&e instanceof HTMLElement&&e.parentNode!=null;var u=e.getContext("2d"),s=o?bJ:i,l;e.width=t*s;e.height=n*s;for(l in a){u[l]=a[l]}if(o&&s!==1){e.style.width=t+"px";e.style.height=n+"px"}u.pixelRatio=s;u.setTransform(s,0,0,s,s*r[0],s*r[1]);return e}function xJ(e){sJ.call(this,e);this._redraw=false;this._dirty=new sH}var wJ=RH(xJ,sJ),kJ=sJ.prototype,AJ=new sH;wJ.initialize=function(e,t,n,r,i,a){this._options=a;this._canvas=Yv(1,1);if(e){tJ(e,0).appendChild(this._canvas);this._canvas.setAttribute("class","marks")}return kJ.initialize.call(this,e,t,n,r,i)};wJ.resize=function(e,t,n,r){kJ.resize.call(this,e,t,n,r);_J(this._canvas,this._width,this._height,this._origin,this._scale,this._options&&this._options.context);this._redraw=true;return this};wJ.canvas=function(){return this._canvas};wJ.context=function(){return this._canvas?this._canvas.getContext("2d"):null};wJ.dirty=function(e){var t=OJ(e.bounds,e.mark.group);this._dirty.union(t)};function EJ(e,t,n){t.expand(1).round();t.translate(-(n[0]%1),-(n[1]%1));e.beginPath();e.rect(t.x1,t.y1,t.width(),t.height());e.clip();return t}function MJ(e,t,n){return AJ.set(0,0,t,n).translate(-e[0],-e[1])}function OJ(e,t){if(t==null)return e;var n=AJ.clear().union(e);for(;t!=null;t=t.mark.group){n.translate(t.x||0,t.y||0)}return n}wJ._render=function(e){var t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty;t.save();if(this._redraw||a.empty()){this._redraw=false;a=MJ(n,r,i).expand(1)}else{a=EJ(t,a.intersect(MJ(n,r,i)),n)}this.clear(-n[0],-n[1],r,i);this.draw(t,e,a);t.restore();this._dirty.clear();return this};wJ.draw=function(e,t,n){var r=UX[t.marktype];if(t.clip)kV(e,t);r.draw.call(this,e,t,n);if(t.clip)e.restore()};wJ.clear=function(e,t,n,r){var i=this.context();i.clearRect(e,t,n,r);if(this._bgcolor!=null){i.fillStyle=this._bgcolor;i.fillRect(e,t,n,r)}};function SJ(e,t){aJ.call(this,e,t);var n=this;n._hrefHandler=CJ(n,(function(e,t){if(t&&t.href)n.handleHref(e,t,t.href)}));n._tooltipHandler=CJ(n,(function(e,t){n.handleTooltip(e,t,e.type!==hJ)}))}var DJ=RH(SJ,aJ);DJ.initialize=function(e,t,n){var r=this._svg;if(r){r.removeEventListener(dJ,this._hrefHandler);r.removeEventListener(cJ,this._tooltipHandler);r.removeEventListener(hJ,this._tooltipHandler)}this._svg=r=e&&KX(e,"svg");if(r){r.addEventListener(dJ,this._hrefHandler);r.addEventListener(cJ,this._tooltipHandler);r.addEventListener(hJ,this._tooltipHandler)}return aJ.prototype.initialize.call(this,e,t,n)};DJ.canvas=function(){return this._svg};function CJ(e,t){return function(n){var r=n.target,i=r.__data__;n.vegaType=n.type;i=Array.isArray(i)?i[0]:i;t.call(e._obj,n,i)}}DJ.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){var a={type:e,handler:t,listener:CJ(this,t)};(r[n]||(r[n]=[])).push(a);if(this._svg){this._svg.addEventListener(n,a.listener)}}return this};DJ.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){if(this._svg){this._svg.removeEventListener(n,r[i].listener)}r.splice(i,1)}return this};function FJ(e,t,n){var r="<"+e,i,a;if(t){for(i in t){a=t[i];if(a!=null){r+=" "+i+'="'+a+'"'}}}if(n)r+=" "+n;return r+">"}function TJ(e){return"</"+e+">"}var NJ={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};var jJ={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"};var RJ=Object.keys(jJ);var zJ=NJ.xmlns;function PJ(e){sJ.call(this,e);this._dirtyID=0;this._dirty=[];this._svg=null;this._root=null;this._defs=null}var LJ=RH(PJ,sJ);var IJ=sJ.prototype;LJ.initialize=function(e,t,n,r){if(e){this._svg=eJ(e,0,"svg",zJ);this._svg.setAttribute("class","marks");tJ(e,1);this._root=eJ(this._svg,0,"g",zJ);tJ(this._svg,1)}this._defs={gradient:{},clipping:{}};this.background(this._bgcolor);return IJ.initialize.call(this,e,t,n,r)};LJ.background=function(e){if(arguments.length&&this._svg){this._svg.style.setProperty("background-color",e)}return IJ.background.apply(this,arguments)};LJ.resize=function(e,t,n,r){IJ.resize.call(this,e,t,n,r);if(this._svg){this._svg.setAttribute("width",this._width*this._scale);this._svg.setAttribute("height",this._height*this._scale);this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height);this._root.setAttribute("transform","translate("+this._origin+")")}this._dirty=[];return this};LJ.canvas=function(){return this._svg};LJ.svg=function(){if(!this._svg)return null;var e={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var t in NJ){e[t]=NJ[t]}var n=!this._bgcolor?"":FJ("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+TJ("rect");return FJ("svg",e)+n+this._svg.innerHTML+TJ("svg")};LJ._render=function(e){if(this._dirtyCheck()){if(this._dirtyAll)this._resetDefs();this.draw(this._root,e);tJ(this._root,1)}this.updateDefs();this._dirty=[];++this._dirtyID;return this};LJ.updateDefs=function(){var e=this._svg,t=this._defs,n=t.el,r=0,i;for(i in t.gradient){if(!n)t.el=n=eJ(e,0,"defs",zJ);r=BJ(n,t.gradient[i],r)}for(i in t.clipping){if(!n)t.el=n=eJ(e,0,"defs",zJ);r=UJ(n,t.clipping[i],r)}if(n){if(r===0){e.removeChild(n);t.el=null}else{tJ(n,r)}}};function BJ(e,t,n){var r,i,a;if(t.gradient==="radial"){var o=eJ(e,n++,"pattern",zJ);o.setAttribute("id",cH+t.id);o.setAttribute("viewBox","0,0,1,1");o.setAttribute("width","100%");o.setAttribute("height","100%");o.setAttribute("preserveAspectRatio","xMidYMid slice");o=eJ(o,0,"rect",zJ);o.setAttribute("width","1");o.setAttribute("height","1");o.setAttribute("fill","url("+ZJ()+"#"+t.id+")");e=eJ(e,n++,"radialGradient",zJ);e.setAttribute("id",t.id);e.setAttribute("fx",t.x1);e.setAttribute("fy",t.y1);e.setAttribute("fr",t.r1);e.setAttribute("cx",t.x2);e.setAttribute("cy",t.y2);e.setAttribute("r",t.r2)}else{e=eJ(e,n++,"linearGradient",zJ);e.setAttribute("id",t.id);e.setAttribute("x1",t.x1);e.setAttribute("x2",t.x2);e.setAttribute("y1",t.y1);e.setAttribute("y2",t.y2)}for(r=0,i=t.stops.length;r<i;++r){a=eJ(e,r,"stop",zJ);a.setAttribute("offset",t.stops[r].offset);a.setAttribute("stop-color",t.stops[r].color)}tJ(e,r);return n}function UJ(e,t,n){var r;e=eJ(e,n,"clipPath",zJ);e.setAttribute("id",t.id);if(t.path){r=eJ(e,0,"path",zJ);r.setAttribute("d",t.path)}else{r=eJ(e,0,"rect",zJ);r.setAttribute("x",0);r.setAttribute("y",0);r.setAttribute("width",t.width);r.setAttribute("height",t.height)}tJ(e,1);return n+1}LJ._resetDefs=function(){var e=this._defs;e.gradient={};e.clipping={}};LJ.dirty=function(e){if(e.dirty!==this._dirtyID){e.dirty=this._dirtyID;this._dirty.push(e)}};LJ.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID};LJ._dirtyCheck=function(){this._dirtyAll=true;var e=this._dirty;if(!e.length||!this._dirtyID)return true;var t=++this._dirtyID,n,r,i,a,o,u,s;for(o=0,u=e.length;o<u;++o){n=e[o];r=n.mark;if(r.marktype!==i){i=r.marktype;a=UX[i]}if(r.zdirty&&r.dirty!==t){this._dirtyAll=false;qJ(n,t);r.items.forEach((function(e){e.dirty=t}))}if(r.zdirty)continue;if(n.exit){if(a.nested&&r.items.length){s=r.items[0];if(s._svg)this._update(a,s._svg,s)}else if(n._svg){s=n._svg.parentNode;if(s)s.removeChild(n._svg)}n._svg=null;continue}n=a.nested?r.items[0]:n;if(n._update===t)continue;if(!n._svg||!n._svg.ownerSVGElement){this._dirtyAll=false;qJ(n,t)}else{this._update(a,n._svg,n)}n._update=t}return!this._dirtyAll};function qJ(e,t){for(;e&&e.dirty!==t;e=e.mark.group){e.dirty=t;if(e.mark&&e.mark.dirty!==t){e.mark.dirty=t}else return}}LJ.draw=function(e,t,n){if(!this.isDirty(t))return t._svg;var r=this,i=this._svg,a=UX[t.marktype],o=t.interactive===false?"none":null,u=a.tag==="g",s=null,l=0,f;f=HJ(t,e,n,"g",i);f.setAttribute("class",nJ(t));if(!u){f.style.setProperty("pointer-events",o)}if(t.clip){f.setAttribute("clip-path",OV(r,t,t.group))}else{f.removeAttribute("clip-path")}function c(e){var t=r.isDirty(e),n=HJ(e,f,s,a.tag,i);if(t){r._update(a,n,e);if(u)WJ(r,n,e)}s=n;++l}if(a.nested){if(t.items.length)c(t.items[0])}else{rV(t,c)}tJ(f,l);return f};function WJ(e,t,n){t=t.lastChild.previousSibling;var r,i=0;rV(n,(function(n){r=e.draw(t,n,r);++i}));tJ(t,1+i)}function HJ(e,t,n,r,i){var a=e._svg,o;if(!a){o=t.ownerDocument;a=QX(o,r,zJ);e._svg=a;if(e.mark){a.__data__=e;a.__values__={fill:"default"};if(r==="g"){var u=QX(o,"path",zJ);a.appendChild(u);u.__data__=e;var s=QX(o,"g",zJ);a.appendChild(s);s.__data__=e;var l=QX(o,"path",zJ);a.appendChild(l);l.__data__=e;l.__values__={fill:"default"}}}}if(a.ownerSVGElement!==i||GJ(a,n)){t.insertBefore(a,n?n.nextSibling:t.firstChild)}return a}function GJ(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}var $J=null,YJ=null;var VJ={group:function(e,t,n){var r,i;$J=r=t.childNodes[2];YJ=r.__values__;e.foreground(JJ,n,this);YJ=t.__values__;$J=t.childNodes[1];e.content(JJ,n,this);$J=i=t.childNodes[0];e.background(JJ,n,this);var a=n.mark.interactive===false?"none":null;if(a!==YJ.events){r.style.setProperty("pointer-events",a);i.style.setProperty("pointer-events",a);YJ.events=a}if(n.strokeForeground&&n.stroke){var o=n.fill;r.style.removeProperty("display");this.style(i,n);i.style.removeProperty("stroke");if(o)n.fill=null;YJ=r.__values__;this.style(r,n);if(o)n.fill=o;$J=null}else{r.style.setProperty("display","none");r.style.setProperty("fill","none")}},image:function(e,t,n){if(n.smooth===false){XJ(t,"image-rendering","optimizeSpeed");XJ(t,"image-rendering","pixelated")}else{XJ(t,"image-rendering",null)}},text:function(e,t,n){var r=AX(n),i,a,o,u;if(_H(r)){a=r.map((function(e){return MX(n,e)}));i=a.join("\n");if(i!==YJ.text){tJ(t,0);o=t.ownerDocument;u=wX(n);a.forEach((function(e,r){var i=QX(o,"tspan",zJ);i.__data__=n;i.textContent=e;if(r){i.setAttribute("x",0);i.setAttribute("dy",u)}t.appendChild(i)}));YJ.text=i}}else{a=MX(n,r);if(a!==YJ.text){t.textContent=a;YJ.text=a}}XJ(t,"font-family",SX(n));XJ(t,"font-size",_X(n)+"px");XJ(t,"font-style",n.fontStyle);XJ(t,"font-variant",n.fontVariant);XJ(t,"font-weight",n.fontWeight)}};function XJ(e,t,n){if(n!==YJ[t]){if(n==null){e.style.removeProperty(t)}else{e.style.setProperty(t,n+"")}YJ[t]=n}}LJ._update=function(e,t,n){$J=t;YJ=t.__values__;e.attr(JJ,n,this);var r=VJ[e.type];if(r)r.call(this,e,t,n);if($J)this.style($J,n)};function JJ(e,t,n){if(t===YJ[e])return;if(t!=null){if(n){$J.setAttributeNS(n,e,t)}else{$J.setAttribute(e,t)}}else{if(n){$J.removeAttributeNS(n,e)}else{$J.removeAttribute(e)}}YJ[e]=t}LJ.style=function(e,t){if(t==null)return;var n,r,i,a,o;for(n=0,r=RJ.length;n<r;++n){i=RJ[n];o=t[i];if(i==="font"){o=SX(t)}if(o===YJ[i])continue;a=jJ[i];if(o==null){if(a==="fill"){e.style.setProperty(a,"none")}else{e.style.removeProperty(a)}}else{if(hH(o)){o=dH(o,this._defs.gradient,ZJ())}e.style.setProperty(a,o+"")}YJ[i]=o}};function ZJ(){var e;return typeof window==="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function QJ(e){sJ.call(this,e);this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""};this._defs={gradient:{},clipping:{}}}var KJ=RH(QJ,sJ);var eZ=sJ.prototype;KJ.resize=function(e,t,n,r){eZ.resize.call(this,e,t,n,r);var i=this._origin,a=this._text;var o={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var u in NJ){o[u]=NJ[u]}a.head=FJ("svg",o);var s=this._bgcolor;if(s==="transparent"||s==="none")s=null;if(s){a.bg=FJ("rect",{width:this._width,height:this._height,style:"fill: "+s+";"})+TJ("rect")}else{a.bg=""}a.root=FJ("g",{transform:"translate("+i+")"});a.foot=TJ("g")+TJ("svg");return this};KJ.background=function(){var e=eZ.background.apply(this,arguments);if(arguments.length&&this._text.head){this.resize(this._width,this._height,this._origin,this._scale)}return e};KJ.svg=function(){var e=this._text;return e.head+e.bg+e.defs+e.root+e.body+e.foot};KJ._render=function(e){this._text.body=this.mark(e);this._text.defs=this.buildDefs();return this};KJ.buildDefs=function(){var e=this._defs,t="",n,r,i,a,o;for(r in e.gradient){i=e.gradient[r];o=i.stops;if(i.gradient==="radial"){t+=FJ(a="pattern",{id:cH+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"});t+=FJ("rect",{width:"1",height:"1",fill:"url(#"+r+")"})+TJ("rect");t+=TJ(a);t+=FJ(a="radialGradient",{id:r,fx:i.x1,fy:i.y1,fr:i.r1,cx:i.x2,cy:i.y2,r:i.r2})}else{t+=FJ(a="linearGradient",{id:r,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2})}for(n=0;n<o.length;++n){t+=FJ("stop",{offset:o[n].offset,"stop-color":o[n].color})+TJ("stop")}t+=TJ(a)}for(r in e.clipping){i=e.clipping[r];t+=FJ("clipPath",{id:r});if(i.path){t+=FJ("path",{d:i.path})+TJ("path")}else{t+=FJ("rect",{x:0,y:0,width:i.width,height:i.height})+TJ("rect")}t+=TJ("clipPath")}return t.length>0?FJ("defs")+t+TJ("defs"):""};var tZ;function nZ(e,t,n,r){tZ[r||e]=t}KJ.attributes=function(e,t){tZ={};e(nZ,t,this);return tZ};KJ.href=function(e){var t=this,n=e.href,r;if(n){if(r=t._hrefs&&t._hrefs[n]){return r}else{t.sanitizeURL(n).then((function(e){e["xlink:href"]=e.href;e.href=null;(t._hrefs||(t._hrefs={}))[n]=e}))}}return null};KJ.mark=function(e){var t=this,n=UX[e.marktype],r=n.tag,i=this._defs,a="",o;if(r!=="g"&&e.interactive===false){o='style="pointer-events: none;"'}a+=FJ("g",{class:nJ(e),"clip-path":e.clip?OV(t,e,e.group):null},o);function u(u){var s=t.href(u);if(s)a+=FJ("a",s);o=r!=="g"?rZ(u,e,r,i):null;a+=FJ(r,t.attributes(n.attr,u),o);if(r==="text"){var l=AX(u);if(_H(l)){var f={x:0,dy:wX(u)};for(var c=0;c<l.length;++c){a+=FJ("tspan",c?f:null)+iZ(MX(u,l[c]))+TJ("tspan")}}else{a+=iZ(MX(u,l))}}else if(r==="g"){var h=u.strokeForeground,d=u.fill,p=u.stroke;if(h&&p){u.stroke=null}a+=FJ("path",t.attributes(n.background,u),rZ(u,e,"bgrect",i))+TJ("path");a+=FJ("g",t.attributes(n.content,u))+t.markGroup(u)+TJ("g");if(h&&p){if(d)u.fill=null;u.stroke=p;a+=FJ("path",t.attributes(n.foreground,u),rZ(u,e,"bgrect",i))+TJ("path");if(d)u.fill=d}else{a+=FJ("path",t.attributes(n.foreground,u),rZ({},e,"bgfore",i))+TJ("path")}}a+=TJ(r);if(s)a+=TJ("a")}if(n.nested){if(e.items&&e.items.length)u(e.items[0])}else{rV(e,u)}return a+TJ("g")};KJ.markGroup=function(e){var t=this,n="";rV(e,(function(e){n+=t.mark(e)}));return n};function rZ(e,t,n,r){if(e==null)return"";var i,a,o,u,s,l="";if(n==="bgrect"&&t.interactive===false){l+="pointer-events: none; "}if(n==="bgfore"){if(t.interactive===false){l+="pointer-events: none; "}l+="display: none; "}if(n==="image"){if(e.smooth===false){l+="image-rendering: optimizeSpeed; image-rendering: pixelated; "}}if(n==="text"){l+="font-family: "+SX(e)+"; ";l+="font-size: "+_X(e)+"px; ";if(e.fontStyle)l+="font-style: "+e.fontStyle+"; ";if(e.fontVariant)l+="font-variant: "+e.fontVariant+"; ";if(e.fontWeight)l+="font-weight: "+e.fontWeight+"; "}for(i=0,a=RJ.length;i<a;++i){o=RJ[i];u=jJ[o];s=e[o];if(s==null){if(u==="fill"){l+="fill: none; "}}else if(s==="transparent"&&(u==="fill"||u==="stroke")){l+=u+": none; "}else{if(hH(s)){s=dH(s,r.gradient,"")}l+=u+": "+s+"; "}}return l?'style="'+l.trim()+'"':null}function iZ(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var aZ="canvas";var oZ="png";var uZ="svg";var sZ="none";var lZ={Canvas:aZ,PNG:oZ,SVG:uZ,None:sZ};var fZ={};fZ[aZ]=fZ[oZ]={renderer:xJ,headless:xJ,handler:pJ};fZ[uZ]={renderer:PJ,headless:QJ,handler:SJ};fZ[sZ]={};function cZ(e,t){e=String(e||"").toLowerCase();if(arguments.length>1){fZ[e]=t;return this}else{return fZ[e]}}function hZ(e,t,n){var r=[],i=(new sH).union(t),a=e.marktype;return a?dZ(e,i,n,r):a==="group"?vZ(e,i,n,r):yH("Intersect scene must be mark node or group item.")}function dZ(e,t,n,r){if(pZ(e,t,n)){var i=e.items,a=e.marktype,o=i.length;var u=0;if(a==="group"){for(;u<o;++u){vZ(i[u],t,n,r)}}else{for(var s=UX[a].isect;u<o;++u){var l=i[u];if(gZ(l,t,s))r.push(l)}}}return r}function pZ(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==false&&(!n||n(e)))}function vZ(e,t,n,r){if(n&&n(e.mark)&&gZ(e,t,UX.group.isect)){r.push(e)}var i=e.items,a=i&&i.length;if(a){var o=e.x||0,u=e.y||0;t.translate(-o,-u);for(var s=0;s<a;++s){dZ(i[s],t,n,r)}t.translate(o,u)}return r}function gZ(e,t,n){var r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}var mZ=new sH;function yZ(e){var t=e.clip;if(TH(t)){t(NY(mZ.clear()))}else if(t){mZ.set(0,0,e.group.width,e.group.height)}else return;e.bounds.intersect(mZ)}var bZ=1e-9;function _Z(e,t,n){return e===t?true:n==="path"?xZ(e,t):e instanceof Date&&t instanceof Date?+e===+t:zH(e)&&zH(t)?Math.abs(e-t)<=bZ:!e||!t||!xH(e)&&!xH(t)?e==t:e==null||t==null?false:wZ(e,t)}function xZ(e,t){return _Z(f$(e),f$(t))}function wZ(e,t){var n=Object.keys(e),r=Object.keys(t),i,a;if(n.length!==r.length)return false;n.sort();r.sort();for(a=n.length-1;a>=0;a--){if(n[a]!=r[a])return false}for(a=n.length-1;a>=0;a--){i=n[a];if(!_Z(e[i],t[i],i))return false}return typeof e===typeof t}function kZ(e,t,n){e.fields=t||[];e.fname=n;return e}function AZ(e){throw Error(e)}function EZ(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)AZ("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)AZ("Access path missing closing bracket: "+e);if(n)AZ("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var MZ=Array.isArray;function OZ(e){return e===Object(e)}function SZ(e){return typeof e==="string"}function DZ(e){return MZ(e)?"["+e.map(DZ)+"]":OZ(e)||SZ(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function CZ(e,t){var n=EZ(e),r="return _["+n.map(DZ).join("][")+"];";return kZ(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var FZ=[];var TZ=CZ("id");var NZ=kZ((function(e){return e}),FZ,"identity");var jZ=kZ((function(){return 0}),FZ,"zero");var RZ=kZ((function(){return 1}),FZ,"one");var zZ=kZ((function(){return true}),FZ,"true");var PZ=kZ((function(){return false}),FZ,"false");function LZ(e){return typeof e==="function"}function IZ(e){return LZ(e)?e:function(){return e}}function BZ(e,t){var n,r;function i(){t(r);n=r=null}return function(t){r=t;if(n)clearTimeout(n);n=setTimeout(i,e)}}function UZ(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}var qZ=Object.prototype.hasOwnProperty;function WZ(e,t){return qZ.call(e,t)}function HZ(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function GZ(e){return Object.prototype.toString.call(e)==="[object Date]"}function $Z(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=true;return t}var YZ="default";function VZ(e){var t=e._signals.cursor;if(!t){e._signals.cursor=t=e.add({user:YZ,item:null})}e.on(e.events("view","mousemove"),t,(function(e,n){var r=t.value,i=r?SZ(r)?r:r.user:YZ,a=n.item&&n.item.cursor||null;return r&&i===r.user&&a==r.item?r:{user:i,item:a}}));e.add(null,(function(e){var t=e.cursor,n=this.value;if(!SZ(t)){n=t.item;t=t.user}XZ(t&&t!==YZ?t:n||t);return n}),{cursor:t})}function XZ(e){if(typeof document!=="undefined"&&document.body){document.body.style.cursor=e}}function JZ(e,t,n){e.fields=t||[];e.fname=n;return e}function ZZ(e){throw Error(e)}function QZ(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);o=++u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)ZZ("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)ZZ("Access path missing closing bracket: "+e);if(n)ZZ("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var KZ=Array.isArray;function eQ(e){return e===Object(e)}function tQ(e){return typeof e==="string"}function nQ(e){return KZ(e)?"["+e.map(nQ)+"]":eQ(e)||tQ(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function rQ(e,t){var n=QZ(e),r="return _["+n.map(nQ).join("][")+"];";return JZ(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var iQ=[];var aQ=rQ("id");var oQ=JZ((function(e){return e}),iQ,"identity");var uQ=JZ((function(){return 0}),iQ,"zero");var sQ=JZ((function(){return 1}),iQ,"one");var lQ=JZ((function(){return true}),iQ,"true");var fQ=JZ((function(){return false}),iQ,"false");function cQ(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var hQ=0;var dQ=1;var pQ=2;var vQ=3;var gQ=4;function mQ(e,t){var n=e||hQ;return{level:function(e){if(arguments.length){n=+e;return this}else{return n}},error:function(){if(n>=dQ)cQ(t||"error","ERROR",arguments);return this},warn:function(){if(n>=pQ)cQ(t||"warn","WARN",arguments);return this},info:function(){if(n>=vQ)cQ(t||"log","INFO",arguments);return this},debug:function(){if(n>=gQ)cQ(t||"log","DEBUG",arguments);return this}}}function yQ(e){return e!=null?KZ(e)?e:[e]:[]}function bQ(e){return typeof e==="function"}function _Q(e){return bQ(e)?e:function(){return e}}function xQ(e,t){var n,r;function i(){t(r);n=r=null}return function(t){r=t;if(n)clearTimeout(n);n=setTimeout(i,e)}}function wQ(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}function kQ(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function AQ(e,t,n){if(e){var r=0,i=e.length,a;if(t){for(;r<i;++r){if(a=t(e[r]))n(a,r,e)}}else{e.forEach(n)}}}function EQ(e){var t=e||oQ,n=[],r={};n.add=function(e){var i=t(e);if(!r[i]){r[i]=1;n.push(e)}return n};n.remove=function(e){var i=t(e),a;if(r[i]){r[i]=0;if((a=n.indexOf(e))>=0){n.splice(a,1)}}return n};return n}function MQ(e,t){return d(this,void 0,void 0,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,t(e)];case 1:r.sent();return[3,3];case 2:n=r.sent();e.error(n);return[3,3];case 3:return[2]}}))}))}var OQ=Symbol("vega_id"),SQ=1;function DQ(e){return e[OQ]}function CQ(e,t){e[OQ]=t;return e}function FQ(e){var t=e===Object(e)?e:{data:e};return DQ(t)?t:CQ(t,SQ++)}function TQ(e){return e&&e.constructor===NQ}function NQ(){var e=[],t=[],n=[],r=[],i=[],a=false;return{constructor:NQ,insert:function(t){var n=yQ(t),r=0,i=n.length;for(;r<i;++r)e.push(n[r]);return this},remove:function(e){var n=bQ(e)?r:t,i=yQ(e),a=0,o=i.length;for(;a<o;++a)n.push(i[a]);return this},modify:function(e,t,r){var a={field:t,value:_Q(r)};if(bQ(e)){a.filter=e;i.push(a)}else{a.tuple=e;n.push(a)}return this},encode:function(e,t){if(bQ(e))i.push({filter:e,field:t});else n.push({tuple:e,field:t});return this},reflow:function(){a=true;return this},pulse:function(o,u){var s={},l={},f,c,h,d,p,v;for(f=0,c=u.length;f<c;++f){s[DQ(u[f])]=1}for(f=0,c=t.length;f<c;++f){p=t[f];s[DQ(p)]=-1}for(f=0,c=r.length;f<c;++f){d=r[f];u.forEach((function(e){if(d(e))s[DQ(e)]=-1}))}for(f=0,c=e.length;f<c;++f){p=e[f];v=DQ(p);if(s[v]){s[v]=1}else{o.add.push(FQ(e[f]))}}for(f=0,c=u.length;f<c;++f){p=u[f];if(s[DQ(p)]<0)o.rem.push(p)}function g(e,t,n){if(n){e[t]=n(e)}else{o.encode=t}if(!a)l[DQ(e)]=e}for(f=0,c=n.length;f<c;++f){h=n[f];p=h.tuple;d=h.field;v=s[DQ(p)];if(v>0){g(p,d,h.value);o.modifies(d)}}for(f=0,c=i.length;f<c;++f){h=i[f];d=h.filter;u.forEach((function(e){if(d(e)&&s[DQ(e)]>0){g(e,h.field,h.value)}}));o.modifies(h.field)}if(a){o.mod=t.length||r.length?u.filter((function(e){return s[DQ(e)]>0})):u.slice()}else{for(v in l)o.mod.push(l[v])}return o}}}var jQ="_:mod:_";function RQ(){Object.defineProperty(this,jQ,{writable:true,value:{}})}var zQ=RQ.prototype;zQ.set=function(e,t,n,r){var i=this,a=i[e],o=i[jQ];if(t!=null&&t>=0){if(a[t]!==n||r){a[t]=n;o[t+":"+e]=-1;o[e]=-1}}else if(a!==n||r){i[e]=n;o[e]=KZ(n)?1+n.length:-1}return i};zQ.modified=function(e,t){var n=this[jQ],r;if(!arguments.length){for(r in n){if(n[r])return true}return false}else if(KZ(e)){for(r=0;r<e.length;++r){if(n[e[r]])return true}return false}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]};zQ.clear=function(){this[jQ]={};return this};var PQ=0;var LQ="pulse";var IQ=new RQ;var BQ=1,UQ=2;function qQ(e,t,n,r){this.id=++PQ;this.value=e;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(t){this._update=t}if(n)this.parameters(n,r)}var WQ=qQ.prototype;WQ.targets=function(){return this._targets||(this._targets=EQ(aQ))};WQ.set=function(e){if(this.value!==e){this.value=e;return 1}else{return 0}};function HQ(e){return function(t){var n=this.flags;if(arguments.length===0)return!!(n&e);this.flags=t?n|e:n&~e;return this}}WQ.skip=HQ(BQ);WQ.modified=HQ(UQ);WQ.parameters=function(e,t,n){t=t!==false;var r=this,i=r._argval=r._argval||new RQ,a=r._argops=r._argops||[],o=[],u,s,l,f;function c(e,n,u){if(u instanceof qQ){if(u!==r){if(t)u.targets().add(r);o.push(u)}a.push({op:u,name:e,index:n})}else{i.set(e,n,u)}}for(u in e){s=e[u];if(u===LQ){yQ(s).forEach((function(e){if(!(e instanceof qQ)){ZZ("Pulse parameters must be operator instances.")}else if(e!==r){e.targets().add(r);o.push(e)}}));r.source=s}else if(KZ(s)){i.set(u,-1,Array(l=s.length));for(f=0;f<l;++f)c(u,f,s[f])}else{c(u,-1,s)}}this.marshall().clear();if(n)a.initonly=true;return o};WQ.marshall=function(e){var t=this._argval||IQ,n=this._argops,r,i,a,o,u;if(n){for(i=0,a=n.length;i<a;++i){r=n[i];o=r.op;u=o.modified()&&o.stamp===e;t.set(r.name,r.index,o.value,u)}if(n.initonly){for(i=0;i<a;++i){r=n[i];r.op.targets().remove(this)}this._argops=null;this._update=null}}return t};WQ.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);n.clear();if(r!==this.value){this.value=r}else if(!this.modified()){return e.StopPropagation}}};WQ.run=function(e){if(e.stamp<this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false);t=0}else{t=this.evaluate(e)}return this.pulse=t||e};function GQ(e,t,n,r){var i=1,a;if(e instanceof qQ){a=e}else if(e&&e.prototype instanceof qQ){a=new e}else if(bQ(e)){a=new qQ(null,e)}else{i=0;a=new qQ(e,t)}this.rank(a);if(i){r=n;n=t}if(n)this.connect(a,a.parameters(n,r));this.touch(a);return a}function $Q(e,t){var n=e.rank,r,i;for(r=0,i=t.length;r<i;++r){if(n<t[r].rank){this.rerank(e);return}}}var YQ=0;function VQ(e,t,n){this.id=++YQ;this.value=null;if(n)this.receive=n;if(e)this._filter=e;if(t)this._apply=t}function XQ(e,t,n){return new VQ(e,t,n)}var JQ=VQ.prototype;JQ._filter=lQ;JQ._apply=oQ;JQ.targets=function(){return this._targets||(this._targets=EQ(aQ))};JQ.consume=function(e){if(!arguments.length)return!!this._consume;this._consume=!!e;return this};JQ.receive=function(e){if(this._filter(e)){var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0,i=0;for(;i<r;++i)n[i].receive(t);if(this._consume){e.preventDefault();e.stopPropagation()}}};JQ.filter=function(e){var t=XQ(e);this.targets().add(t);return t};JQ.apply=function(e){var t=XQ(null,e);this.targets().add(t);return t};JQ.merge=function(){var e=XQ();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t){arguments[t].targets().add(e)}return e};JQ.throttle=function(e){var t=-1;return this.filter((function(){var n=Date.now();if(n-t>e){t=n;return 1}else{return 0}}))};JQ.debounce=function(e){var t=XQ();this.targets().add(XQ(null,null,xQ(e,(function(e){var n=e.dataflow;t.receive(e);if(n&&n.run)n.run()}))));return t};JQ.between=function(e,t){var n=false;e.targets().add(XQ(null,null,(function(){n=true})));t.targets().add(XQ(null,null,(function(){n=false})));return this.filter((function(){return n}))};function ZQ(e,t,n,r){var i=this,a=XQ(n,r),o=function(e){e.dataflow=i;try{a.receive(e)}catch(ie){i.error(ie)}finally{i.run()}},u;if(typeof e==="string"&&typeof document!=="undefined"){u=document.querySelectorAll(e)}else{u=yQ(e)}for(var s=0,l=u.length;s<l;++s){u[s].addEventListener(t,o)}return a}var QQ=Eo;function KQ(e,t,n){return this.pulse(e,this.changeset().insert(QQ(t,n)))}function eK(e,t){return d(this,void 0,void 0,(function(){var n,r,i,a;return __generator(this,(function(o){switch(o.label){case 0:n=this;r=0;o.label=1;case 1:o.trys.push([1,3,,4]);return[4,n.loader().load(e,{context:"dataflow",response:_i(t&&t.type)})];case 2:i=o.sent();try{i=QQ(i,t)}catch(u){r=-2;n.warn("Data ingestion failed",e,u)}return[3,4];case 3:a=o.sent();r=-1;n.warn("Loading failed",e,a);return[3,4];case 4:return[2,{data:i,status:r}]}}))}))}function tK(e,t,n){return d(this,void 0,void 0,(function(){var r,i,a;return __generator(this,(function(o){switch(o.label){case 0:r=this,i=r._pending||nK(r);i.requests+=1;return[4,r.request(t,n)];case 1:a=o.sent();r.pulse(e,r.changeset().remove(lQ).insert(a.data||[]));i.done();return[2,a]}}))}))}function nK(e){var t=new Promise((function(e){n=e})),n;t.requests=0;t.done=function(){if(--t.requests===0){e._pending=null;n(e)}};return e._pending=t}var rK={skip:true};function iK(e,t,n,r,i){var a=e instanceof qQ?oK:aK;a(this,e,t,n,r,i);return this}function aK(e,t,n,r,i,a){var o=wQ({},a,rK),u,s;if(!bQ(n))n=_Q(n);if(r===undefined){u=function(t){return e.touch(n(t))}}else if(bQ(r)){s=new qQ(null,r,i,false);u=function(t){s.evaluate(t);var r=n(t),i=s.value;TQ(i)?e.pulse(r,i,a):e.update(r,i,o)}}else{u=function(t){return e.update(n(t),r,o)}}t.apply(u)}function oK(e,t,n,r,i,a){if(r===undefined){t.targets().add(n)}else{var o=a||{},u=new qQ(null,uK(n,r),i,false);u.modified(o.force);u.rank=t.rank;t.targets().add(u);if(n){u.skip(true);u.value=n.value;u.targets().add(n);e.connect(n,[u])}}}function uK(e,t){t=bQ(t)?t:_Q(t);return e?function(n,r){var i=t(n,r);if(!e.skip()){e.skip(i!==this.value).value=i}return i}:t}function sK(e){e.rank=++this._rank}function lK(e){var t=[e],n,r,i;while(t.length){this.rank(n=t.pop());if(r=n._targets){for(i=r.length;--i>=0;){t.push(n=r[i]);if(n===e)ZZ("Cycle detected in dataflow graph.")}}}}var fK={};var cK=1<<0,hK=1<<1,dK=1<<2,pK=cK|hK,vK=cK|dK,gK=cK|hK|dK,mK=1<<3,yK=1<<4,bK=1<<5,_K=1<<6;function xK(e,t,n){this.dataflow=e;this.stamp=t==null?-1:t;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}var wK=xK.prototype;wK.StopPropagation=fK;wK.ADD=cK;wK.REM=hK;wK.MOD=dK;wK.ADD_REM=pK;wK.ADD_MOD=vK;wK.ALL=gK;wK.REFLOW=mK;wK.SOURCE=yK;wK.NO_SOURCE=bK;wK.NO_FIELDS=_K;wK.fork=function(e){return new xK(this.dataflow).init(this,e)};wK.clone=function(){var e=this.fork(gK);e.add=e.add.slice();e.rem=e.rem.slice();e.mod=e.mod.slice();if(e.source)e.source=e.source.slice();return e.materialize(gK|yK)};wK.addAll=function(){var e=this;if(!this.source||this.source.length===this.add.length){return e}else{e=new xK(this.dataflow).init(this);e.add=e.source;return e}};wK.init=function(e,t){var n=this;n.stamp=e.stamp;n.encode=e.encode;if(e.fields&&!(t&_K)){n.fields=e.fields}if(t&cK){n.addF=e.addF;n.add=e.add}else{n.addF=null;n.add=[]}if(t&hK){n.remF=e.remF;n.rem=e.rem}else{n.remF=null;n.rem=[]}if(t&dK){n.modF=e.modF;n.mod=e.mod}else{n.modF=null;n.mod=[]}if(t&bK){n.srcF=null;n.source=null}else{n.srcF=e.srcF;n.source=e.source}return n};wK.runAfter=function(e){this.dataflow.runAfter(e)};wK.changed=function(e){var t=e||gK;return t&cK&&this.add.length||t&hK&&this.rem.length||t&dK&&this.mod.length};wK.reflow=function(e){if(e)return this.fork(gK).reflow();var t=this.add.length,n=this.source&&this.source.length;if(n&&n!==t){this.mod=this.source;if(t)this.filter(dK,EK(this,cK))}return this};wK.modifies=function(e){var t=this.fields||(this.fields={});if(KZ(e)){e.forEach((function(e){return t[e]=true}))}else{t[e]=true}return this};wK.modified=function(e,t){var n=this.fields;return!((t||this.mod.length)&&n)?false:!arguments.length?!!n:KZ(e)?e.some((function(e){return n[e]})):n[e]};wK.filter=function(e,t){var n=this;if(e&cK)n.addF=kK(n.addF,t);if(e&hK)n.remF=kK(n.remF,t);if(e&dK)n.modF=kK(n.modF,t);if(e&yK)n.srcF=kK(n.srcF,t);return n};function kK(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}wK.materialize=function(e){e=e||gK;var t=this;if(e&cK&&t.addF){t.add=AK(t.add,t.addF);t.addF=null}if(e&hK&&t.remF){t.rem=AK(t.rem,t.remF);t.remF=null}if(e&dK&&t.modF){t.mod=AK(t.mod,t.modF);t.modF=null}if(e&yK&&t.srcF){t.source=t.source.filter(t.srcF);t.srcF=null}return t};function AK(e,t){var n=[];AQ(e,t,(function(e){n.push(e)}));return n}function EK(e,t){var n={};e.visit(t,(function(e){n[DQ(e)]=1}));return function(e){return n[DQ(e)]?null:e}}wK.visit=function(e,t){var n=this,r=t,i,a;if(e&yK){AQ(n.source,n.srcF,r);return n}if(e&cK)AQ(n.add,n.addF,r);if(e&hK)AQ(n.rem,n.remF,r);if(e&dK)AQ(n.mod,n.modF,r);if(e&mK&&(i=n.source)){a=n.add.length+n.mod.length;if(a===i.length);else if(a){AQ(i,EK(n,vK),r)}else{AQ(i,n.srcF,r)}}return n};function MK(e,t,n,r){var i=this,a=0,o,u,s,l,f;this.dataflow=e;this.stamp=t;this.fields=null;this.encode=r||null;this.pulses=n;for(s=0,l=n.length;s<l;++s){o=n[s];if(o.stamp!==t)continue;if(o.fields){u=i.fields||(i.fields={});for(f in o.fields){u[f]=1}}if(o.changed(i.ADD))a|=i.ADD;if(o.changed(i.REM))a|=i.REM;if(o.changed(i.MOD))a|=i.MOD}this.changes=a}var OK=kQ(MK,xK);OK.fork=function(e){var t=new xK(this.dataflow).init(this,e&this.NO_FIELDS);if(e!==undefined){if(e&t.ADD){this.visit(t.ADD,(function(e){return t.add.push(e)}))}if(e&t.REM){this.visit(t.REM,(function(e){return t.rem.push(e)}))}if(e&t.MOD){this.visit(t.MOD,(function(e){return t.mod.push(e)}))}}return t};OK.changed=function(e){return this.changes&e};OK.modified=function(e){var t=this,n=t.fields;return!(n&&t.changes&t.MOD)?0:KZ(e)?e.some((function(e){return n[e]})):n[e]};OK.filter=function(){ZZ("MultiPulse does not support filtering.")};OK.materialize=function(){ZZ("MultiPulse does not support materialization.")};OK.visit=function(e,t){var n=this,r=n.pulses,i=r.length,a=0;if(e&n.SOURCE){for(;a<i;++a){r[a].visit(e,t)}}else{for(;a<i;++a){if(r[a].stamp===n.stamp){r[a].visit(e,t)}}}return n};function SK(e,t,n){return d(this,void 0,void 0,(function(){var r,i,a,o,u,s,l,f,c,h,d,p;return __generator(this,(function(v){switch(v.label){case 0:r=this,i=r.logLevel(),a=[];if(r._pulse)return[2,TK(r)];if(!r._pending)return[3,2];return[4,r._pending];case 1:v.sent();v.label=2;case 2:if(!t)return[3,4];return[4,MQ(r,t)];case 3:v.sent();v.label=4;case 4:if(!r._touched.length){r.info("Dataflow invoked, but nothing to do.");return[2,r]}o=++r._clock,u=0;r._pulse=new xK(r,o,e);if(i>=vQ){f=Date.now();r.debug("-- START PROPAGATION ("+o+") -----")}r._touched.forEach((function(e){return r._enqueue(e,true)}));r._touched=EQ(aQ);v.label=5;case 5:v.trys.push([5,11,,12]);v.label=6;case 6:if(!(r._heap.size()>0))return[3,10];s=r._heap.pop();if(s.rank!==s.qrank){r._enqueue(s,true);return[3,6]}l=s.run(r._getPulse(s,e));if(!l.then)return[3,8];return[4,l];case 7:l=v.sent();return[3,9];case 8:if(l.async){a.push(l.async);l=fK}v.label=9;case 9:if(i>=gQ){r.debug(s.id,l===fK?"STOP":l,s)}if(l!==fK){if(s._targets)s._targets.forEach((function(e){return r._enqueue(e)}))}++u;return[3,6];case 10:return[3,12];case 11:h=v.sent();r._heap.clear();c=h;return[3,12];case 12:r._input={};r._pulse=null;if(i>=vQ){f=Date.now()-f;r.info("> Pulse "+o+": "+u+" operators; "+f+"ms")}if(c){r._postrun=[];r.error(c)}if(!r._postrun.length)return[3,16];d=r._postrun.sort((function(e,t){return t.priority-e.priority}));r._postrun=[];p=0;v.label=13;case 13:if(!(p<d.length))return[3,16];return[4,MQ(r,d[p].callback)];case 14:v.sent();v.label=15;case 15:++p;return[3,13];case 16:if(!n)return[3,18];return[4,MQ(r,n)];case 17:v.sent();v.label=18;case 18:if(a.length){Promise.all(a).then((function(e){return r.runAsync(null,(function(){e.forEach((function(e){try{e(r)}catch(t){r.error(t)}}))}))}))}return[2,r]}}))}))}function DK(e,t,n){return d(this,void 0,void 0,(function(){var r;var i=this;return __generator(this,(function(a){switch(a.label){case 0:if(!this._running)return[3,2];return[4,this._running];case 1:a.sent();return[3,0];case 2:r=function(){return i._running=null};(this._running=this.evaluate(e,t,n)).then(r,r);return[2,this._running]}}))}))}function CK(e,t,n){return this._pulse?TK(this):(this.evaluate(e,t,n),this)}function FK(e,t,n){if(this._pulse||t){this._postrun.push({priority:n||0,callback:e})}else{try{e(this)}catch(r){this.error(r)}}}function TK(e){e.error("Dataflow already running. Use runAsync() to chain invocations.");return e}function NK(e,t){var n=e.stamp<this._clock;if(n)e.stamp=this._clock;if(n||t){e.qrank=e.rank;this._heap.push(e)}}function jK(e,t){var n=e.source,r=this._clock;return n&&KZ(n)?new MK(this,r,n.map((function(e){return e.pulse})),t):this._input[e.id]||RK(this._pulse,n&&n.pulse)}function RK(e,t){if(t&&t.stamp===e.stamp){return t}e=e.fork();if(t&&t!==fK){e.source=t.source}return e}var zK={skip:false,force:false};function PK(e,t){var n=t||zK;if(this._pulse){this._enqueue(e)}else{this._touched.add(e)}if(n.skip)e.skip(true);return this}function LK(e,t,n){var r=n||zK;if(e.set(t)||r.force){this.touch(e,r)}return this}function IK(e,t,n){this.touch(e,n||zK);var r=new xK(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];r.target=e;this._input[e.id]=t.pulse(r,i);return this}function BK(e){var t=[];return{clear:function(){return t=[]},size:function(){return t.length},peek:function(){return t[0]},push:function(n){t.push(n);return UK(t,0,t.length-1,e)},pop:function(){var n=t.pop(),r;if(t.length){r=t[0];t[0]=n;qK(t,0,e)}else{r=n}return r}}}function UK(e,t,n,r){var i,a,o;i=e[n];while(n>t){o=n-1>>1;a=e[o];if(r(i,a)<0){e[n]=a;n=o;continue}break}return e[n]=i}function qK(e,t,n){var r=t,i=e.length,a=e[t],o=(t<<1)+1,u;while(o<i){u=o+1;if(u<i&&n(e[o],e[u])>=0){o=u}e[t]=e[o];t=o;o=(t<<1)+1}e[t]=a;return UK(e,r,t,n)}function WK(){this.logger(mQ());this.logLevel(dQ);this._clock=0;this._rank=0;try{this._loader=Oo()}catch(e){}this._touched=EQ(aQ);this._input={};this._pulse=null;this._heap=BK((function(e,t){return e.qrank-t.qrank}));this._postrun=[]}var HK=WK.prototype;HK.stamp=function(){return this._clock};HK.loader=function(e){if(arguments.length){this._loader=e;return this}else{return this._loader}};HK.cleanThreshold=1e4;HK.add=GQ;HK.connect=$Q;HK.rank=sK;HK.rerank=lK;HK.pulse=IK;HK.touch=PK;HK.update=LK;HK.changeset=NQ;HK.ingest=KQ;HK.parse=QQ;HK.preload=tK;HK.request=eK;HK.events=ZQ;HK.on=iK;HK.evaluate=SK;HK.run=CK;HK.runAsync=DK;HK.runAfter=FK;HK._enqueue=NK;HK._getPulse=jK;function GK(e){return function(){return this._log[e].apply(this,arguments)}}HK.logger=function(e){if(arguments.length){this._log=e;return this}else{return this._log}};HK.error=GK("error");HK.warn=GK("warn");HK.info=GK("info");HK.debug=GK("debug");HK.logLevel=GK("level");function $K(e,t){qQ.call(this,e,null,t)}var YK=kQ($K,qQ);YK.run=function(e){var t=this;if(e.stamp<this.stamp)return e.StopPropagation;var n;if(this.skip()){this.skip(false)}else{n=this.evaluate(e)}n=n||e;if(n.then){n=n.then((function(e){return t.pulse=e}))}else if(n!==e.StopPropagation){this.pulse=n}return n};YK.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);t.clear();return n};YK.transform=function(){};var VK={};function XK(e,t){var n=e._runtime.data;if(!WZ(n,t)){AZ("Unrecognized data set: "+t)}return n[t]}function JK(e,t){return arguments.length<2?XK(this,e).values.value:ZK.call(this,e,NQ().remove(zZ).insert(t))}function ZK(e,t){if(!TQ(t)){AZ("Second argument to changes must be a changeset.")}var n=XK(this,e);n.modified=true;return this.pulse(n.input,t)}function QK(e,t){return ZK.call(this,e,NQ().insert(t))}function KK(e,t){return ZK.call(this,e,NQ().remove(t))}function e0(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function t0(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function n0(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function r0(e){var t=n0(e),n=e0(e),r=t0(e);e._renderer.background(e._background);e._renderer.resize(n,r,t);e._handler.origin(t);e._resizeListeners.forEach((function(t){try{t(n,r)}catch(ie){e.error(ie)}}))}function i0(e,t,n){var r=e._renderer,i=r&&r.canvas(),a,o,u;if(i){u=n0(e);o=t.changedTouches?t.changedTouches[0]:t;a=rJ(o,i);a[0]-=u[0];a[1]-=u[1]}t.dataflow=e;t.item=n;t.vega=a0(e,n,a);return t}function a0(e,t,n){var r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(e){var n=r,i;if(e)for(i=t;i;i=i.mark.group){if(i.mark.name===e){n=i;break}}return n&&n.mark&&n.mark.interactive?n:{}}function a(e){if(!e)return n;if(SZ(e))e=i(e);var t=n.slice();while(e){t[0]-=e.x||0;t[1]-=e.y||0;e=e.mark&&e.mark.group}return t}return{view:IZ(e),item:IZ(t||{}),group:i,xy:a,x:function(e){return a(e)[0]},y:function(e){return a(e)[1]}}}var o0="view",u0="timer",s0="window",l0={trap:false};function f0(e){var t=UZ({defaults:{}},e);var n=function(e,t){t.forEach((function(t){if(MZ(e[t]))e[t]=$Z(e[t])}))};n(t.defaults,["prevent","allow"]);n(t,["view","window","selector"]);return t}function c0(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===false||i===true?false:r===true||i===false?true:r?r[t]:i?!i[t]:e.preventDefault()}function h0(e,t,n){var r=e._eventConfig&&e._eventConfig[t];if(r===false||OZ(r)&&!r[n]){e.warn("Blocked "+t+" "+n+" event listener.");return false}return true}function d0(e,t,n){var r=this,i=new VQ(n),a=function(n,a){r.runAsync(null,(function(){if(e===o0&&c0(r,t)){n.preventDefault()}i.receive(i0(r,n,a))}))},o;if(e===u0){if(h0(r,"timer",t)){r.timer(a,t)}}else if(e===o0){if(h0(r,"view",t)){r.addEventListener(t,a,l0)}}else{if(e===s0){if(h0(r,"window",t)&&typeof window!=="undefined"){o=[window]}}else if(typeof document!=="undefined"){if(h0(r,"selector",t)){o=document.querySelectorAll(e)}}if(!o){r.warn("Can not resolve event source: "+e)}else{for(var u=0,s=o.length;u<s;++u){o[u].addEventListener(t,a)}r._eventListeners.push({type:t,sources:o,handler:a})}}return i}function p0(e){return e.item}function v0(e){return e.item.mark.source}function g0(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function m0(e,t){e=[e||"hover"];t=[t||"update",e[0]];this.on(this.events("view","mouseover",p0),v0,g0(e));this.on(this.events("view","mouseout",p0),v0,g0(t));return this}function y0(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,a;r=t.length;while(--r>=0){t[r].stop()}r=n.length;while(--r>=0){a=n[r];i=a.sources.length;while(--i>=0){a.sources[i].removeEventListener(a.type,a.handler)}}if(e){e.call(this,this._handler,null,null,null)}return this}function b0(e,t,n){var r=document.createElement(e);for(var i in t)r.setAttribute(i,t[i]);if(n!=null)r.textContent=n;return r}var _0="vega-bind",x0="vega-bind-name",w0="vega-bind-radio",k0="vega-option-";function A0(e,t,n){if(!t)return;var r=n.param,i=n.state;if(!i){i=n.state={elements:null,active:false,set:null,update:function(t){if(t!==e.signal(r.signal)){e.runAsync(null,(function(){i.source=true;e.signal(r.signal,t)}))}}};if(r.debounce){i.update=BZ(r.debounce,i.update)}}E0(i,t,r,e.signal(r.signal));if(!i.active){e.on(e._signals[r.signal],null,(function(){i.source?i.source=false:i.set(e.signal(r.signal))}));i.active=true}return i}function E0(e,t,n,r){var i=b0("div",{class:_0});i.appendChild(b0("span",{class:x0},n.name||n.signal));t.appendChild(i);var a=M0;switch(n.input){case"checkbox":a=O0;break;case"select":a=S0;break;case"radio":a=D0;break;case"range":a=C0;break}a(e,i,n,r)}function M0(e,t,n,r){var i=b0("input");for(var a in n){if(a!=="signal"&&a!=="element"){i.setAttribute(a==="input"?"type":a,n[a])}}i.setAttribute("name",n.signal);i.value=r;t.appendChild(i);i.addEventListener("input",(function(){e.update(i.value)}));e.elements=[i];e.set=function(e){i.value=e}}function O0(e,t,n,r){var i={type:"checkbox",name:n.signal};if(r)i.checked=true;var a=b0("input",i);t.appendChild(a);a.addEventListener("change",(function(){e.update(a.checked)}));e.elements=[a];e.set=function(e){a.checked=!!e||null}}function S0(e,t,n,r){var i=b0("select",{name:n.signal}),a=n.labels||[];n.options.forEach((function(e,t){var n={value:e};if(F0(e,r))n.selected=true;i.appendChild(b0("option",n,(a[t]||e)+""))}));t.appendChild(i);i.addEventListener("change",(function(){e.update(n.options[i.selectedIndex])}));e.elements=[i];e.set=function(e){for(var t=0,r=n.options.length;t<r;++t){if(F0(n.options[t],e)){i.selectedIndex=t;return}}}}function D0(e,t,n,r){var i=b0("span",{class:w0}),a=n.labels||[];t.appendChild(i);e.elements=n.options.map((function(t,o){var u=k0+n.signal+"-"+t;var s={id:u,type:"radio",name:n.signal,value:t};if(F0(t,r))s.checked=true;var l=b0("input",s);l.addEventListener("change",(function(){e.update(t)}));i.appendChild(l);i.appendChild(b0("label",{for:u},(a[o]||t)+""));return l}));e.set=function(t){var n=e.elements,r=0,i=n.length;for(;r<i;++r){if(F0(n[r].value,t))n[r].checked=true}}}function C0(e,t,n,r){r=r!==undefined?r:(+n.max+ +n.min)/2;var i=n.max!=null?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||zl(a,i,100);var u=b0("input",{type:"range",name:n.signal,min:a,max:i,step:o});u.value=r;var s=b0("label",{},+r);t.appendChild(u);t.appendChild(s);function l(){s.textContent=u.value;e.update(+u.value)}u.addEventListener("input",l);u.addEventListener("change",l);e.elements=[u];e.set=function(e){u.value=e;s.textContent=e}}function F0(e,t){return e===t||e+""===t+""}function T0(e,t,n,r,i,a){t=t||new r(e.loader());return t.initialize(n,e0(e),t0(e),n0(e),i,a).background(e._background)}function N0(e,t){return!t?null:function(){try{t.apply(this,arguments)}catch(ie){e.error(ie)}}}function j0(e,t,n,r){var i=new r(e.loader(),N0(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,n0(e),e);if(t){t.handlers().forEach((function(e){i.on(e.type,e.handler)}))}return i}function R0(e,t){var n=this,r=n._renderType,i=n._eventConfig.bind,a=cZ(r),o,u;e=n._el=e?z0(n,e):null;if(!a)n.error("Unrecognized renderer type: "+r);o=a.handler||pJ;u=e?a.renderer:a.headless;n._renderer=!u?null:T0(n,n._renderer,e,u);n._handler=j0(n,n._handler,e,o);n._redraw=true;if(e&&i!=="none"){t=t?n._elBind=z0(n,t):e.appendChild(b0("div",{class:"vega-bindings"}));n._bind.forEach((function(e){if(e.param.element&&i!=="container"){e.element=z0(n,e.param.element)}}));n._bind.forEach((function(e){A0(n,e.element||t,e)}))}return n}function z0(e,t){if(typeof t==="string"){if(typeof document!=="undefined"){t=document.querySelector(t);if(!t){e.error("Signal bind element not found: "+t);return null}}else{e.error("DOM document instance not found.");return null}}if(t){try{t.innerHTML=""}catch(n){t=null;e.error(n)}}return t}function P0(e,t,n,r){return d(this,void 0,void 0,(function(){var i,a;return __generator(this,(function(o){switch(o.label){case 0:i=cZ(t),a=i&&i.headless;if(!a)AZ("Unrecognized renderer type: "+t);return[4,e.runAsync()];case 1:o.sent();return[2,T0(e,null,null,a,n,r).renderAsync(e._scenegraph.root)]}}))}))}function L0(e,t){return d(this,void 0,void 0,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:if(e!==lZ.Canvas&&e!==lZ.SVG&&e!==lZ.PNG){AZ("Unrecognized image type: "+e)}return[4,P0(this,e,t)];case 1:n=r.sent();return[2,e===lZ.SVG?I0(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")]}}))}))}function I0(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function B0(e,t){return d(this,void 0,void 0,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:return[4,P0(this,lZ.Canvas,e,t)];case 1:n=r.sent();return[2,n.canvas()]}}))}))}function U0(e){return d(this,void 0,void 0,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return[4,P0(this,lZ.SVG,e)];case 1:t=n.sent();return[2,t.svg()]}}))}))}var q0="RawCode";var W0="Literal";var H0="Property";var G0="Identifier";var $0="ArrayExpression";var Y0="BinaryExpression";var V0="CallExpression";var X0="ConditionalExpression";var J0="LogicalExpression";var Z0="MemberExpression";var Q0="ObjectExpression";var K0="UnaryExpression";function e1(e){this.type=e}e1.prototype.visit=function(e){var t=this,n,r,i;if(e(t))return 1;for(n=t1(t),r=0,i=n.length;r<i;++r){if(n[r].visit(e))return 1}};function t1(e){switch(e.type){case $0:return e.elements;case Y0:case J0:return[e.left,e.right];case V0:var t=e.arguments.slice();t.unshift(e.callee);return t;case X0:return[e.test,e.consequent,e.alternate];case Z0:return[e.object,e.property];case Q0:return e.properties;case H0:return[e.key,e.value];case K0:return[e.argument];case G0:case W0:case q0:default:return[]}}var n1,r1,i1,a1,o1;var u1=1,s1=2,l1=3,f1=4,c1=5,h1=6,d1=7,p1=8,v1=9;n1={};n1[u1]="Boolean";n1[s1]="<end>";n1[l1]="Identifier";n1[f1]="Keyword";n1[c1]="Null";n1[h1]="Numeric";n1[d1]="Punctuator";n1[p1]="String";n1[v1]="RegularExpression";var g1="ArrayExpression",m1="BinaryExpression",y1="CallExpression",b1="ConditionalExpression",_1="Identifier",x1="Literal",w1="LogicalExpression",k1="MemberExpression",A1="ObjectExpression",E1="Property",M1="UnaryExpression";var O1="Unexpected token %0",S1="Unexpected number",D1="Unexpected string",C1="Unexpected identifier",F1="Unexpected reserved word",T1="Unexpected end of input",N1="Invalid regular expression",j1="Invalid regular expression: missing /",R1="Octal literals are not allowed in strict mode.",z1="Duplicate data property in object literal not allowed in strict mode";var P1="ILLEGAL",L1="Disabled.";var I1=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),B1=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function U1(e,t){if(!e){throw new Error("ASSERT: "+t)}}function q1(e){return e>=48&&e<=57}function W1(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function H1(e){return"01234567".indexOf(e)>=0}function G1(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function $1(e){return e===10||e===13||e===8232||e===8233}function Y1(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&I1.test(String.fromCharCode(e))}function V1(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&B1.test(String.fromCharCode(e))}var X1={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function J1(){var e;while(i1<a1){e=r1.charCodeAt(i1);if(G1(e)||$1(e)){++i1}else{break}}}function Z1(e){var t,n,r,i=0;n=e==="u"?4:2;for(t=0;t<n;++t){if(i1<a1&&W1(r1[i1])){r=r1[i1++];i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())}else{E2({},O1,P1)}}return String.fromCharCode(i)}function Q1(){var e,t,n,r;e=r1[i1];t=0;if(e==="}"){E2({},O1,P1)}while(i1<a1){e=r1[i1++];if(!W1(e)){break}t=t*16+"0123456789abcdef".indexOf(e.toLowerCase())}if(t>1114111||e!=="}"){E2({},O1,P1)}if(t<=65535){return String.fromCharCode(t)}n=(t-65536>>10)+55296;r=(t-65536&1023)+56320;return String.fromCharCode(n,r)}function K1(){var e,t;e=r1.charCodeAt(i1++);t=String.fromCharCode(e);if(e===92){if(r1.charCodeAt(i1)!==117){E2({},O1,P1)}++i1;e=Z1("u");if(!e||e==="\\"||!Y1(e.charCodeAt(0))){E2({},O1,P1)}t=e}while(i1<a1){e=r1.charCodeAt(i1);if(!V1(e)){break}++i1;t+=String.fromCharCode(e);if(e===92){t=t.substr(0,t.length-1);if(r1.charCodeAt(i1)!==117){E2({},O1,P1)}++i1;e=Z1("u");if(!e||e==="\\"||!V1(e.charCodeAt(0))){E2({},O1,P1)}t+=e}}return t}function e2(){var e,t;e=i1++;while(i1<a1){t=r1.charCodeAt(i1);if(t===92){i1=e;return K1()}if(V1(t)){++i1}else{break}}return r1.slice(e,i1)}function t2(){var e,t,n;e=i1;t=r1.charCodeAt(i1)===92?K1():e2();if(t.length===1){n=l1}else if(X1.hasOwnProperty(t)){n=f1}else if(t==="null"){n=c1}else if(t==="true"||t==="false"){n=u1}else{n=l1}return{type:n,value:t,start:e,end:i1}}function n2(){var e=i1,t=r1.charCodeAt(i1),n,r=r1[i1],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:++i1;return{type:d1,value:String.fromCharCode(t),start:e,end:i1};default:n=r1.charCodeAt(i1+1);if(n===61){switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:i1+=2;return{type:d1,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:i1};case 33:case 61:i1+=2;if(r1.charCodeAt(i1)===61){++i1}return{type:d1,value:r1.slice(e,i1),start:e,end:i1}}}}o=r1.substr(i1,4);if(o===">>>="){i1+=4;return{type:d1,value:o,start:e,end:i1}}a=o.substr(0,3);if(a===">>>"||a==="<<="||a===">>="){i1+=3;return{type:d1,value:a,start:e,end:i1}}i=a.substr(0,2);if(r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>"){i1+=2;return{type:d1,value:i,start:e,end:i1}}if("<>=!+-*%&|^/".indexOf(r)>=0){++i1;return{type:d1,value:r,start:e,end:i1}}E2({},O1,P1)}function r2(e){var t="";while(i1<a1){if(!W1(r1[i1])){break}t+=r1[i1++]}if(t.length===0){E2({},O1,P1)}if(Y1(r1.charCodeAt(i1))){E2({},O1,P1)}return{type:h1,value:parseInt("0x"+t,16),start:e,end:i1}}function i2(e){var t="0"+r1[i1++];while(i1<a1){if(!H1(r1[i1])){break}t+=r1[i1++]}if(Y1(r1.charCodeAt(i1))||q1(r1.charCodeAt(i1))){E2({},O1,P1)}return{type:h1,value:parseInt(t,8),octal:true,start:e,end:i1}}function a2(){var e,t,n;n=r1[i1];U1(q1(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point");t=i1;e="";if(n!=="."){e=r1[i1++];n=r1[i1];if(e==="0"){if(n==="x"||n==="X"){++i1;return r2(t)}if(H1(n)){return i2(t)}if(n&&q1(n.charCodeAt(0))){E2({},O1,P1)}}while(q1(r1.charCodeAt(i1))){e+=r1[i1++]}n=r1[i1]}if(n==="."){e+=r1[i1++];while(q1(r1.charCodeAt(i1))){e+=r1[i1++]}n=r1[i1]}if(n==="e"||n==="E"){e+=r1[i1++];n=r1[i1];if(n==="+"||n==="-"){e+=r1[i1++]}if(q1(r1.charCodeAt(i1))){while(q1(r1.charCodeAt(i1))){e+=r1[i1++]}}else{E2({},O1,P1)}}if(Y1(r1.charCodeAt(i1))){E2({},O1,P1)}return{type:h1,value:parseFloat(e),start:t,end:i1}}function o2(){var e="",t,n,r,i,a=false;t=r1[i1];U1(t==="'"||t==='"',"String literal must starts with a quote");n=i1;++i1;while(i1<a1){r=r1[i1++];if(r===t){t="";break}else if(r==="\\"){r=r1[i1++];if(!r||!$1(r.charCodeAt(0))){switch(r){case"u":case"x":if(r1[i1]==="{"){++i1;e+=Q1()}else{e+=Z1(r)}break;case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:if(H1(r)){i="01234567".indexOf(r);if(i!==0){a=true}if(i1<a1&&H1(r1[i1])){a=true;i=i*8+"01234567".indexOf(r1[i1++]);if("0123".indexOf(r)>=0&&i1<a1&&H1(r1[i1])){i=i*8+"01234567".indexOf(r1[i1++])}}e+=String.fromCharCode(i)}else{e+=r}break}}else{if(r==="\r"&&r1[i1]==="\n"){++i1}}}else if($1(r.charCodeAt(0))){break}else{e+=r}}if(t!==""){E2({},O1,P1)}return{type:p1,value:e,octal:a,start:n,end:i1}}function u2(e,t){var n=e;if(t.indexOf("u")>=0){n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111){return"x"}E2({},N1)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x")}try{return new RegExp(e,t)}catch(r){return null}}function s2(){var e,t,n,r,i;e=r1[i1];U1(e==="/","Regular expression literal must start with a slash");t=r1[i1++];n=false;r=false;while(i1<a1){e=r1[i1++];t+=e;if(e==="\\"){e=r1[i1++];if($1(e.charCodeAt(0))){E2({},j1)}t+=e}else if($1(e.charCodeAt(0))){E2({},j1)}else if(n){if(e==="]"){n=false}}else{if(e==="/"){r=true;break}else if(e==="["){n=true}}}if(!r){E2({},j1)}i=t.substr(1,t.length-2);return{value:i,literal:t}}function l2(){var e,t,n;t="";n="";while(i1<a1){e=r1[i1];if(!V1(e.charCodeAt(0))){break}++i1;if(e==="\\"&&i1<a1){E2({},O1,P1)}else{n+=e;t+=e}}if(n.search(/[^gimuy]/g)>=0){E2({},N1,n)}return{value:n,literal:t}}function f2(){var e,t,n,r;o1=null;J1();e=i1;t=s2();n=l2();r=u2(t.value,n.value);return{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:i1}}function c2(e){return e.type===l1||e.type===f1||e.type===u1||e.type===c1}function h2(){var e;J1();if(i1>=a1){return{type:s1,start:i1,end:i1}}e=r1.charCodeAt(i1);if(Y1(e)){return t2()}if(e===40||e===41||e===59){return n2()}if(e===39||e===34){return o2()}if(e===46){if(q1(r1.charCodeAt(i1+1))){return a2()}return n2()}if(q1(e)){return a2()}return n2()}function d2(){var e;e=o1;i1=e.end;o1=h2();i1=e.end;return e}function p2(){var e;e=i1;o1=h2();i1=e}function v2(e){var t=new e1(g1);t.elements=e;return t}function g2(e,t,n){var r=new e1(e==="||"||e==="&&"?w1:m1);r.operator=e;r.left=t;r.right=n;return r}function m2(e,t){var n=new e1(y1);n.callee=e;n.arguments=t;return n}function y2(e,t,n){var r=new e1(b1);r.test=e;r.consequent=t;r.alternate=n;return r}function b2(e){var t=new e1(_1);t.name=e;return t}function _2(e){var t=new e1(x1);t.value=e.value;t.raw=r1.slice(e.start,e.end);if(e.regex){if(t.raw==="//"){t.raw="/(?:)/"}t.regex=e.regex}return t}function x2(e,t,n){var r=new e1(k1);r.computed=e==="[";r.object=t;r.property=n;if(!r.computed)n.member=true;return r}function w2(e){var t=new e1(A1);t.properties=e;return t}function k2(e,t,n){var r=new e1(E1);r.key=t;r.value=n;r.kind=e;return r}function A2(e,t){var n=new e1(M1);n.operator=e;n.argument=t;n.prefix=true;return n}function E2(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(function(e,t){U1(t<r.length,"Message reference must be in range");return r[t]}));n=new Error(i);n.index=i1;n.description=i;throw n}function M2(e){if(e.type===s1){E2(e,T1)}if(e.type===h1){E2(e,S1)}if(e.type===p1){E2(e,D1)}if(e.type===l1){E2(e,C1)}if(e.type===f1){E2(e,F1)}E2(e,O1,e.value)}function O2(e){var t=d2();if(t.type!==d1||t.value!==e){M2(t)}}function S2(e){return o1.type===d1&&o1.value===e}function D2(e){return o1.type===f1&&o1.value===e}function C2(){var e=[];i1=o1.start;O2("[");while(!S2("]")){if(S2(",")){d2();e.push(null)}else{e.push($2());if(!S2("]")){O2(",")}}}d2();return v2(e)}function F2(){var e;i1=o1.start;e=d2();if(e.type===p1||e.type===h1){if(e.octal){E2(e,R1)}return _2(e)}return b2(e.value)}function T2(){var e,t,n,r;i1=o1.start;e=o1;if(e.type===l1){n=F2();O2(":");r=$2();return k2("init",n,r)}if(e.type===s1||e.type===d1){M2(e)}else{t=F2();O2(":");r=$2();return k2("init",t,r)}}function N2(){var e=[],t,n,r,i={},a=String;i1=o1.start;O2("{");while(!S2("}")){t=T2();if(t.key.type===_1){n=t.key.name}else{n=a(t.key.value)}r="$"+n;if(Object.prototype.hasOwnProperty.call(i,r)){E2({},z1)}else{i[r]=true}e.push(t);if(!S2("}")){O2(",")}}O2("}");return w2(e)}function j2(){var e;O2("(");e=Y2();O2(")");return e}var R2={if:1,this:1};function z2(){var e,t,n;if(S2("(")){return j2()}if(S2("[")){return C2()}if(S2("{")){return N2()}e=o1.type;i1=o1.start;if(e===l1||R2[o1.value]){n=b2(d2().value)}else if(e===p1||e===h1){if(o1.octal){E2(o1,R1)}n=_2(d2())}else if(e===f1){throw new Error(L1)}else if(e===u1){t=d2();t.value=t.value==="true";n=_2(t)}else if(e===c1){t=d2();t.value=null;n=_2(t)}else if(S2("/")||S2("/=")){n=_2(f2());p2()}else{M2(d2())}return n}function P2(){var e=[];O2("(");if(!S2(")")){while(i1<a1){e.push($2());if(S2(")")){break}O2(",")}}O2(")");return e}function L2(){var e;i1=o1.start;e=d2();if(!c2(e)){M2(e)}return b2(e.value)}function I2(){O2(".");return L2()}function B2(){var e;O2("[");e=Y2();O2("]");return e}function U2(){var e,t,n;e=z2();for(;;){if(S2(".")){n=I2();e=x2(".",e,n)}else if(S2("(")){t=P2();e=m2(e,t)}else if(S2("[")){n=B2();e=x2("[",e,n)}else{break}}return e}function q2(){var e=U2();if(o1.type===d1){if(S2("++")||S2("--")){throw new Error(L1)}}return e}function W2(){var e,t;if(o1.type!==d1&&o1.type!==f1){t=q2()}else if(S2("++")||S2("--")){throw new Error(L1)}else if(S2("+")||S2("-")||S2("~")||S2("!")){e=d2();t=W2();t=A2(e.value,t)}else if(D2("delete")||D2("void")||D2("typeof")){throw new Error(L1)}else{t=q2()}return t}function H2(e){var t=0;if(e.type!==d1&&e.type!==f1){return 0}switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function G2(){var e,t,n,r,i,a,o,u,s,l;e=o1;s=W2();r=o1;i=H2(r);if(i===0){return s}r.prec=i;d2();t=[e,o1];o=W2();a=[s,r,o];while((i=H2(o1))>0){while(a.length>2&&i<=a[a.length-2].prec){o=a.pop();u=a.pop().value;s=a.pop();t.pop();n=g2(u,s,o);a.push(n)}r=d2();r.prec=i;a.push(r);t.push(o1);n=W2();a.push(n)}l=a.length-1;n=a[l];t.pop();while(l>1){t.pop();n=g2(a[l-1].value,a[l-2],n);l-=2}return n}function $2(){var e,t,n;e=G2();if(S2("?")){d2();t=$2();O2(":");n=$2();e=y2(e,t,n)}return e}function Y2(){var e=$2();if(S2(",")){throw new Error(L1)}return e}function V2(e){r1=e;i1=0;a1=r1.length;o1=null;p2();var t=Y2();if(o1.type!==s1){throw new Error("Unexpect token after expression.")}return t}var X2={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function J2(e){function t(t,n,r,i){var a=e(n[0]);if(r){a=r+"("+a+")";if(r.lastIndexOf("new ",0)===0)a="("+a+")"}return a+"."+t+(i<0?"":i===0?"()":"("+n.slice(1).map(e).join(",")+")")}function n(e,n,r){return function(i){return t(e,i,n,r)}}var r="new Date",i="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){if(t.length<3)jn("Missing arguments to clamp function.");if(t.length>3)jn("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),join:n("join",null),indexof:n("indexOf",null),lastindexof:n("lastIndexOf",null),slice:n("slice",null),reverse:function(t){return"("+e(t[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),replace:n("replace",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(t){if(t.length<3)jn("Missing arguments to if function.");if(t.length>3)jn("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function Z2(e){var t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function Q2(e){e=e||{};var t=e.whitelist?mr(e.whitelist):{},n=e.blacklist?mr(e.blacklist):{},r=e.constants||X2,i=(e.functions||J2)(c),a=e.globalvar,o=e.fieldvar,u={},s={},l=0;var f=er(a)?a:function(e){return a+'["'+e+'"]'};function c(e){if(Ln(e))return e;var t=h[e.type];if(t==null)jn("Unsupported type: "+e.type);return t(e)}var h={Literal:function(e){return e.raw},Identifier:function(e){var i=e.name;if(l>0){return i}else if(ar(n,i)){return jn("Illegal identifier: "+i)}else if(ar(r,i)){return r[i]}else if(ar(t,i)){return i}else{u[i]=1;return f(i)}},MemberExpression:function(e){var t=!e.computed;var n=c(e.object);if(t)l+=1;var r=c(e.property);if(n===o){s[Z2(r)]=1}if(t)l-=1;return n+(t?"."+r:"["+r+"]")},CallExpression:function(e){if(e.callee.type!=="Identifier"){jn("Illegal callee type: "+e.callee.type)}var t=e.callee.name;var n=e.arguments;var r=ar(i,t)&&i[t];if(!r)jn("Unrecognized function: "+t);return er(r)?r(n):r+"("+n.map(c).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(c).join(",")+"]"},BinaryExpression:function(e){return"("+c(e.left)+e.operator+c(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+c(e.argument)+")"},ConditionalExpression:function(e){return"("+c(e.test)+"?"+c(e.consequent)+":"+c(e.alternate)+")"},LogicalExpression:function(e){return"("+c(e.left)+e.operator+c(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(c).join(",")+"}"},Property:function(e){l+=1;var t=c(e.key);l-=1;return t+":"+c(e.value)}};function d(e){var t={code:c(e),globals:Object.keys(u),fields:Object.keys(s)};u={};s={};return t}d.functions=i;d.constants=r;return d}function K2(e,t,n){e.fields=t||[];e.fname=n;return e}function e3(e){throw Error(e)}function t3(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);o=++u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)e3("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)e3("Access path missing closing bracket: "+e);if(n)e3("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var n3=Array.isArray;function r3(e){return e===Object(e)}function i3(e){return typeof e==="string"}function a3(e){return n3(e)?"["+e.map(a3)+"]":r3(e)||i3(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function o3(e,t){var n=t3(e),r="return _["+n.map(a3).join("][")+"];";return K2(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var u3=[];var s3=o3("id");var l3=K2((function(e){return e}),u3,"identity");var f3=K2((function(){return 0}),u3,"zero");var c3=K2((function(){return 1}),u3,"one");var h3=K2((function(){return true}),u3,"true");var d3=K2((function(){return false}),u3,"false");function p3(e){return e!=null?n3(e)?e:[e]:[]}function v3(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function g3(e,t,n){if(e){var r=0,i=e.length,a;if(t){for(;r<i;++r){if(a=t(e[r]))n(a,r,e)}}else{e.forEach(n)}}}function m3(e){var t=e||l3,n=[],r={};n.add=function(e){var i=t(e);if(!r[i]){r[i]=1;n.push(e)}return n};n.remove=function(e){var i=t(e),a;if(r[i]){r[i]=0;if((a=n.indexOf(e))>=0){n.splice(a,1)}}return n};return n}var y3=Symbol("vega_id");function b3(e){return!!(e&&_3(e))}function _3(e){return e[y3]}var x3="_:mod:_";function w3(){Object.defineProperty(this,x3,{writable:true,value:{}})}var k3=w3.prototype;k3.set=function(e,t,n,r){var i=this,a=i[e],o=i[x3];if(t!=null&&t>=0){if(a[t]!==n||r){a[t]=n;o[t+":"+e]=-1;o[e]=-1}}else if(a!==n||r){i[e]=n;o[e]=n3(n)?1+n.length:-1}return i};k3.modified=function(e,t){var n=this[x3],r;if(!arguments.length){for(r in n){if(n[r])return true}return false}else if(n3(e)){for(r=0;r<e.length;++r){if(n[e[r]])return true}return false}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]};k3.clear=function(){this[x3]={};return this};var A3=0;var E3="pulse";var M3=new w3;var O3=1,S3=2;function D3(e,t,n,r){this.id=++A3;this.value=e;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(t){this._update=t}if(n)this.parameters(n,r)}var C3=D3.prototype;C3.targets=function(){return this._targets||(this._targets=m3(s3))};C3.set=function(e){if(this.value!==e){this.value=e;return 1}else{return 0}};function F3(e){return function(t){var n=this.flags;if(arguments.length===0)return!!(n&e);this.flags=t?n|e:n&~e;return this}}C3.skip=F3(O3);C3.modified=F3(S3);C3.parameters=function(e,t,n){t=t!==false;var r=this,i=r._argval=r._argval||new w3,a=r._argops=r._argops||[],o=[],u,s,l,f;function c(e,n,u){if(u instanceof D3){if(u!==r){if(t)u.targets().add(r);o.push(u)}a.push({op:u,name:e,index:n})}else{i.set(e,n,u)}}for(u in e){s=e[u];if(u===E3){p3(s).forEach((function(e){if(!(e instanceof D3)){e3("Pulse parameters must be operator instances.")}else if(e!==r){e.targets().add(r);o.push(e)}}));r.source=s}else if(n3(s)){i.set(u,-1,Array(l=s.length));for(f=0;f<l;++f)c(u,f,s[f])}else{c(u,-1,s)}}this.marshall().clear();if(n)a.initonly=true;return o};C3.marshall=function(e){var t=this._argval||M3,n=this._argops,r,i,a,o,u;if(n){for(i=0,a=n.length;i<a;++i){r=n[i];o=r.op;u=o.modified()&&o.stamp===e;t.set(r.name,r.index,o.value,u)}if(n.initonly){for(i=0;i<a;++i){r=n[i];r.op.targets().remove(this)}this._argops=null;this._update=null}}return t};C3.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);n.clear();if(r!==this.value){this.value=r}else if(!this.modified()){return e.StopPropagation}}};C3.run=function(e){if(e.stamp<this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false);t=0}else{t=this.evaluate(e)}return this.pulse=t||e};var T3={};var N3=1<<0,j3=1<<1,R3=1<<2,z3=N3|j3,P3=N3|R3,L3=N3|j3|R3,I3=1<<3,B3=1<<4,U3=1<<5,q3=1<<6;function W3(e,t,n){this.dataflow=e;this.stamp=t==null?-1:t;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}var H3=W3.prototype;H3.StopPropagation=T3;H3.ADD=N3;H3.REM=j3;H3.MOD=R3;H3.ADD_REM=z3;H3.ADD_MOD=P3;H3.ALL=L3;H3.REFLOW=I3;H3.SOURCE=B3;H3.NO_SOURCE=U3;H3.NO_FIELDS=q3;H3.fork=function(e){return new W3(this.dataflow).init(this,e)};H3.clone=function(){var e=this.fork(L3);e.add=e.add.slice();e.rem=e.rem.slice();e.mod=e.mod.slice();if(e.source)e.source=e.source.slice();return e.materialize(L3|B3)};H3.addAll=function(){var e=this;if(!this.source||this.source.length===this.add.length){return e}else{e=new W3(this.dataflow).init(this);e.add=e.source;return e}};H3.init=function(e,t){var n=this;n.stamp=e.stamp;n.encode=e.encode;if(e.fields&&!(t&q3)){n.fields=e.fields}if(t&N3){n.addF=e.addF;n.add=e.add}else{n.addF=null;n.add=[]}if(t&j3){n.remF=e.remF;n.rem=e.rem}else{n.remF=null;n.rem=[]}if(t&R3){n.modF=e.modF;n.mod=e.mod}else{n.modF=null;n.mod=[]}if(t&U3){n.srcF=null;n.source=null}else{n.srcF=e.srcF;n.source=e.source}return n};H3.runAfter=function(e){this.dataflow.runAfter(e)};H3.changed=function(e){var t=e||L3;return t&N3&&this.add.length||t&j3&&this.rem.length||t&R3&&this.mod.length};H3.reflow=function(e){if(e)return this.fork(L3).reflow();var t=this.add.length,n=this.source&&this.source.length;if(n&&n!==t){this.mod=this.source;if(t)this.filter(R3,Y3(this,N3))}return this};H3.modifies=function(e){var t=this.fields||(this.fields={});if(n3(e)){e.forEach((function(e){return t[e]=true}))}else{t[e]=true}return this};H3.modified=function(e,t){var n=this.fields;return!((t||this.mod.length)&&n)?false:!arguments.length?!!n:n3(e)?e.some((function(e){return n[e]})):n[e]};H3.filter=function(e,t){var n=this;if(e&N3)n.addF=G3(n.addF,t);if(e&j3)n.remF=G3(n.remF,t);if(e&R3)n.modF=G3(n.modF,t);if(e&B3)n.srcF=G3(n.srcF,t);return n};function G3(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}H3.materialize=function(e){e=e||L3;var t=this;if(e&N3&&t.addF){t.add=$3(t.add,t.addF);t.addF=null}if(e&j3&&t.remF){t.rem=$3(t.rem,t.remF);t.remF=null}if(e&R3&&t.modF){t.mod=$3(t.mod,t.modF);t.modF=null}if(e&B3&&t.srcF){t.source=t.source.filter(t.srcF);t.srcF=null}return t};function $3(e,t){var n=[];g3(e,t,(function(e){n.push(e)}));return n}function Y3(e,t){var n={};e.visit(t,(function(e){n[_3(e)]=1}));return function(e){return n[_3(e)]?null:e}}H3.visit=function(e,t){var n=this,r=t,i,a;if(e&B3){g3(n.source,n.srcF,r);return n}if(e&N3)g3(n.add,n.addF,r);if(e&j3)g3(n.rem,n.remF,r);if(e&R3)g3(n.mod,n.modF,r);if(e&I3&&(i=n.source)){a=n.add.length+n.mod.length;if(a===i.length);else if(a){g3(i,Y3(n,P3),r)}else{g3(i,n.srcF,r)}}return n};function V3(e,t,n,r){var i=this,a=0,o,u,s,l,f;this.dataflow=e;this.stamp=t;this.fields=null;this.encode=r||null;this.pulses=n;for(s=0,l=n.length;s<l;++s){o=n[s];if(o.stamp!==t)continue;if(o.fields){u=i.fields||(i.fields={});for(f in o.fields){u[f]=1}}if(o.changed(i.ADD))a|=i.ADD;if(o.changed(i.REM))a|=i.REM;if(o.changed(i.MOD))a|=i.MOD}this.changes=a}var X3=v3(V3,W3);X3.fork=function(e){var t=new W3(this.dataflow).init(this,e&this.NO_FIELDS);if(e!==undefined){if(e&t.ADD){this.visit(t.ADD,(function(e){return t.add.push(e)}))}if(e&t.REM){this.visit(t.REM,(function(e){return t.rem.push(e)}))}if(e&t.MOD){this.visit(t.MOD,(function(e){return t.mod.push(e)}))}}return t};X3.changed=function(e){return this.changes&e};X3.modified=function(e){var t=this,n=t.fields;return!(n&&t.changes&t.MOD)?0:n3(e)?e.some((function(e){return n[e]})):n[e]};X3.filter=function(){e3("MultiPulse does not support filtering.")};X3.materialize=function(){e3("MultiPulse does not support materialization.")};X3.visit=function(e,t){var n=this,r=n.pulses,i=r.length,a=0;if(e&n.SOURCE){for(;a<i;++a){r[a].visit(e,t)}}else{for(;a<i;++a){if(r[a].stamp===n.stamp){r[a].visit(e,t)}}}return n};function J3(e,t){D3.call(this,e,null,t)}var Z3=v3(J3,D3);Z3.run=function(e){var t=this;if(e.stamp<this.stamp)return e.StopPropagation;var n;if(this.skip()){this.skip(false)}else{n=this.evaluate(e)}n=n||e;if(n.then){n=n.then((function(e){return t.pulse=e}))}else if(n!==e.StopPropagation){this.pulse=n}return n};Z3.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);t.clear();return n};Z3.transform=function(){};var Q3="intersect";var K3="union";var e5="vlMulti";var t5="or";var n5="and";var r5="E",i5="R",a5="R-E",o5="R-LE",u5="R-RE",s5="index:unit";function l5(e,t){var n=t.fields,r=t.values,i=n.length,a=0,o,u;for(;a<i;++a){u=n[a];u.getter=Bn.getter||Bn(u.field);o=u.getter(e);if(lr(o))o=Qn(o);if(lr(r[a]))r[a]=Qn(r[a]);if(lr(r[a][0]))r[a]=r[a].map(Qn);if(u.type===r5){if(zn(r[a])?r[a].indexOf(o)<0:o!==r[a]){return false}}else{if(u.type===i5){if(!ur(o,r[a]))return false}else if(u.type===u5){if(!ur(o,r[a],true,false))return false}else if(u.type===a5){if(!ur(o,r[a],false,false))return false}else if(u.type===o5){if(!ur(o,r[a],false,true))return false}}}return true}function f5(e,t,n){var r=this.context.data[e],i=r?r.values.value:[],a=r?r[s5]&&r[s5].value:undefined,o=n===Q3,u=i.length,s=0,l,f,c,h,d;for(;s<u;++s){l=i[s];if(a&&o){f=f||{};c=f[h=l.unit]||0;if(c===-1)continue;d=l5(t,l);f[h]=d?-1:++c;if(d&&a.size===1)return true;if(!d&&c===a.get(h).count)return false}else{d=l5(t,l);if(o^d)return d}}return u&&o}function c5(e,t,n){var r,i;var a=this.context.data[e],o=a?a.values.value:[],u={},s={},l={},f,c,h,d,p,v,g,m,y,b=o.length,_=0,x,w;for(;_<b;++_){f=o[_];d=f.unit;c=f.fields;h=f.values;for(x=0,w=c.length;x<w;++x){p=c[x];v=u[p.field]||(u[p.field]={});g=v[d]||(v[d]=[]);l[p.field]=m=p.type.charAt(0);y=h5[m+"_union"];v[d]=y(g,Kn(h[x]))}if(n){g=s[d]||(s[d]=[]);g.push(Kn(h).reduce((function(e,t,n){return e[c[n].field]=t,e}),{}))}}t=t||K3;Object.keys(u).forEach((function(e){u[e]=Object.keys(u[e]).map((function(t){return u[e][t]})).reduce((function(n,r){return n===undefined?r:h5[l[e]+"_"+t](n,r)}))}));o=Object.keys(s);if(n&&o.length){u[e5]=t===K3?(r={},r[t5]=o.reduce((function(e,t){return e.push.apply(e,s[t]),e}),[]),r):(i={},i[n5]=o.map((function(e){var t;return t={},t[t5]=s[e],t})),i)}return u}var h5={E_union:function(e,t){if(!e.length)return t;var n=0,r=t.length;for(;n<r;++n)if(e.indexOf(t[n])<0)e.push(t[n]);return e},E_intersect:function(e,t){return!e.length?t:e.filter((function(e){return t.indexOf(e)>=0}))},R_union:function(e,t){var n=Qn(t[0]),r=Qn(t[1]);if(n>r){n=t[1];r=t[0]}if(!e.length)return[n,r];if(e[0]>n)e[0]=n;if(e[1]<r)e[1]=r;return e},R_intersect:function(e,t){var n=Qn(t[0]),r=Qn(t[1]);if(n>r){n=t[1];r=t[0]}if(!e.length)return[n,r];if(r<e[0]||e[1]<n){return[]}else{if(e[0]<n)e[0]=n;if(e[1]>r)e[1]=r}return e}};var d5="Literal";var p5;var v5=1,g5=2,m5=3,y5=4,b5=5,_5=6,x5=7,w5=8,k5=9;p5={};p5[v5]="Boolean";p5[g5]="<end>";p5[m5]="Identifier";p5[y5]="Keyword";p5[b5]="Null";p5[_5]="Numeric";p5[x5]="Punctuator";p5[w5]="String";p5[k5]="RegularExpression";var A5=":",E5="@";function M5(e,t,n,r){if(t[0].type!==d5)jn("First argument to selection functions must be a string literal.");var i=t[0].value,a=t.length>=2&&Zn(t).value,o="unit",u=E5+o,s=A5+i;if(a===Q3&&!ar(r,u)){r[u]=n.getData(i).indataRef(n,o)}if(!ar(r,s)){r[s]=n.getData(i).tuplesRef()}}function O5(e,t,n){e.fields=t||[];e.fname=n;return e}function S5(e){throw Error(e)}function D5(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)S5("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)S5("Access path missing closing bracket: "+e);if(n)S5("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var C5=Array.isArray;function F5(e){return e===Object(e)}function T5(e){return typeof e==="string"}function N5(e){return C5(e)?"["+e.map(N5)+"]":F5(e)||T5(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function j5(e,t){var n=D5(e),r="return _["+n.map(N5).join("][")+"];";return O5(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var R5=[];var z5=j5("id");var P5=O5((function(e){return e}),R5,"identity");var L5=O5((function(){return 0}),R5,"zero");var I5=O5((function(){return 1}),R5,"one");var B5=O5((function(){return true}),R5,"true");var U5=O5((function(){return false}),R5,"false");function q5(e){return e[e.length-1]}function W5(e){return e==null||e===""?null:+e}function H5(e){return function(t){return e*Math.exp(t)}}function G5(e){return function(t){return Math.log(e*t)}}function $5(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Y5(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function V5(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function X5(e,t,n,r){var i=n(e[0]),a=n(q5(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function J5(e,t){return X5(e,t,W5,P5)}function Z5(e,t){var n=Math.sign(e[0]);return X5(e,t,G5(n),H5(n))}function Q5(e,t,n){return X5(e,t,V5(n),V5(1/n))}function K5(e,t,n){return X5(e,t,$5(n),Y5(n))}function e4(e,t,n,r,i){var a=r(e[0]),o=r(q5(e)),u=t!=null?r(t):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function t4(e,t,n){return e4(e,t,n,W5,P5)}function n4(e,t,n){var r=Math.sign(e[0]);return e4(e,t,n,G5(r),H5(r))}function r4(e,t,n,r){return e4(e,t,n,V5(r),V5(1/r))}function i4(e,t,n,r){return e4(e,t,n,$5(r),Y5(r))}function a4(e){return 1+~~(new Date(e).getMonth()/3)}function o4(e){return 1+~~(new Date(e).getUTCMonth()/3)}function u4(e){return e!=null?C5(e)?e:[e]:[]}function s4(e,t,n){var r=e[0],i=e[1],a;if(i<r){a=i;i=r;r=a}a=i-r;return a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]}function l4(e){return typeof e==="function"}function f4(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}function c4(e,t){var n=0,r,i,a,o;if(e&&(r=e.length)){if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);a=o=i;for(;n<r;++n){i=e[n];if(i!=null){if(i<a)a=i;if(i>o)o=i}}}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));a=o=i;for(;n<r;++n){i=t(e[n]);if(i!=null){if(i<a)a=i;if(i>o)o=i}}}}return[a,o]}var h4=Object.prototype.hasOwnProperty;function d4(e,t){return h4.call(e,t)}function p4(e,t,n,r,i,a){if(!n&&n!==0)return a;var o=e[0],u=q5(e),s=+n,l,f;if(u<o){l=o;o=u;u=l}l=Math.abs(t-o);f=Math.abs(u-t);return l<f&&l<=s?r:f<=s?i:a}function v4(e,t,n,r){var i=t[0],a=t[t.length-1],o;if(i>a){o=i;i=a;a=o}n=n===undefined||n;r=r===undefined||r;return(n?i<=e:i<e)&&(r?e<=a:e<a)}function g4(e){return typeof e==="boolean"}function m4(e){return Object.prototype.toString.call(e)==="[object Date]"}function y4(e){return typeof e==="number"}function b4(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function _4(e,t){var n=e[0],r=q5(e),i=+t;return!i?n:i===1?r:n+i*(r-n)}function x4(e,t){var n="";while(--t>=0)n+=e;return n}function w4(e,t,n,r){var i=n||" ",a=e+"",o=t-a.length;return o<=0?a:r==="left"?x4(i,o)+a:r==="center"?x4(i,~~(o/2))+a+x4(i,Math.ceil(o/2)):a+x4(i,o)}function k4(e){return e&&q5(e)-e[0]||0}function A4(e){return e==null||e===""?null:!e||e==="false"||e==="0"?false:!!e}function E4(e){return y4(e)?e:m4(e)?e:Date.parse(e)}function M4(e,t){t=t||E4;return e==null||e===""?null:t(e)}function O4(e){return e==null||e===""?null:e+""}function S4(e,t,n,r){var i=r!=null?r:"…",a=e+"",o=a.length,u=Math.max(0,t-i.length);return o<=t?a:n==="left"?i+a.slice(o-u):n==="center"?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i}function D4(e){var t=e/255;if(t<=.03928){return t/12.92}return Math.pow((t+.055)/1.055,2.4)}function C4(e){var t=pA(e),n=D4(t.r),r=D4(t.g),i=D4(t.b);return.2126*n+.7152*r+.0722*i}function F4(e,t){var n=C4(e),r=C4(t),i=Math.max(n,r),a=Math.min(n,r);return(i+.05)/(a+.05)}function T4(e){var t=this.context.data[e];return t?t.values.value:[]}function N4(e,t,n){var r=this.context.data[e]["index:"+t],i=r?r.value.get(n):undefined;return i?i.count:i}function j4(e,t){var n=this.context.dataflow,r=this.context.data[e],i=r.input;n.pulse(i,n.changeset().remove(B5).insert(t));return 1}function R4(e,t,n){if(e){var r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==undefined?n:e}function z4(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function P4(e){return e=z4(Math.abs(e)),e?e[1]:NaN}function L4(e,t){return function(n,r){var i=n.length,a=[],o=0,u=e[0],s=0;while(i>0&&u>0){if(s+u+1>r)u=Math.max(1,r-s);a.push(n.substring(i-=u,i+u));if((s+=u+1)>r)break;u=e[o=(o+1)%e.length]}return a.reverse().join(t)}}function I4(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}var B4=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function U4(e){if(!(t=B4.exec(e)))throw new Error("invalid format: "+e);var t;return new q4({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}U4.prototype=q4.prototype;function q4(e){this.fill=e.fill===undefined?" ":e.fill+"";this.align=e.align===undefined?">":e.align+"";this.sign=e.sign===undefined?"-":e.sign+"";this.symbol=e.symbol===undefined?"":e.symbol+"";this.zero=!!e.zero;this.width=e.width===undefined?undefined:+e.width;this.comma=!!e.comma;this.precision=e.precision===undefined?undefined:+e.precision;this.trim=!!e.trim;this.type=e.type===undefined?"":e.type+""}q4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function W4(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n){switch(e[n]){case".":r=i=n;break;case"0":if(r===0)r=n;i=n;break;default:if(!+e[n])break e;if(r>0)r=0;break}}return r>0?e.slice(0,r)+e.slice(i+1):e}var H4;function G4(e,t){var n=z4(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(H4=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+z4(e,Math.max(0,t+a-1))[0]}function $4(e,t){var n=z4(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var Y4={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return $4(e*100,t)},r:$4,s:G4,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function V4(e){return e}var X4=Array.prototype.map,J4=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Z4(e){var t=e.grouping===undefined||e.thousands===undefined?V4:L4(X4.call(e.grouping,Number),e.thousands+""),n=e.currency===undefined?"":e.currency[0]+"",r=e.currency===undefined?"":e.currency[1]+"",i=e.decimal===undefined?".":e.decimal+"",a=e.numerals===undefined?V4:I4(X4.call(e.numerals,String)),o=e.percent===undefined?"%":e.percent+"",u=e.minus===undefined?"-":e.minus+"",s=e.nan===undefined?"NaN":e.nan+"";function l(e){e=U4(e);var l=e.fill,f=e.align,c=e.sign,h=e.symbol,d=e.zero,p=e.width,v=e.comma,g=e.precision,m=e.trim,y=e.type;if(y==="n")v=true,y="g";else if(!Y4[y])g===undefined&&(g=12),m=true,y="g";if(d||l==="0"&&f==="=")d=true,l="0",f="=";var b=h==="$"?n:h==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",_=h==="$"?r:/[%p]/.test(y)?o:"";var x=Y4[y],w=/[defgprs%]/.test(y);g=g===undefined?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function k(e){var n=b,r=_,o,h,k;if(y==="c"){r=x(e)+r;e=""}else{e=+e;var A=e<0;e=isNaN(e)?s:x(Math.abs(e),g);if(m)e=W4(e);if(A&&+e===0)A=false;n=(A?c==="("?c:u:c==="-"||c==="("?"":c)+n;r=(y==="s"?J4[8+H4/3]:"")+r+(A&&c==="("?")":"");if(w){o=-1,h=e.length;while(++o<h){if(k=e.charCodeAt(o),48>k||k>57){r=(k===46?i+e.slice(o+1):e.slice(o))+r;e=e.slice(0,o);break}}}}if(v&&!d)e=t(e,Infinity);var E=n.length+e.length+r.length,M=E<p?new Array(p-E+1).join(l):"";if(v&&d)e=t(M+e,M.length?p-r.length:Infinity),M="";switch(f){case"<":e=n+e+r+M;break;case"=":e=n+M+e+r;break;case"^":e=M.slice(0,E=M.length>>1)+n+e+r+M.slice(E);break;default:e=M+n+e+r;break}return a(e)}k.toString=function(){return e+""};return k}function f(e,t){var n=l((e=U4(e),e.type="f",e)),r=Math.max(-8,Math.min(8,Math.floor(P4(t)/3)))*3,i=Math.pow(10,-r),a=J4[8+r/3];return function(e){return n(i*e)+a}}return{format:l,formatPrefix:f}}var Q4;var K4;e6({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function e6(e){Q4=Z4(e);K4=Q4.format;return Q4}function t6(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);t.setFullYear(e.y);return t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function n6(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));t.setUTCFullYear(e.y);return t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function r6(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function i6(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,u=e.months,s=e.shortMonths;var l=c6(i),f=h6(i),c=c6(a),h=h6(a),d=c6(o),p=h6(o),v=c6(u),g=h6(u),m=c6(s),y=h6(s);var b={a:N,A:j,b:R,B:z,c:null,d:N6,e:N6,f:L6,H:j6,I:R6,j:z6,L:P6,m:I6,M:B6,p:P,q:L,Q:p8,s:v8,S:U6,u:q6,U:W6,V:H6,w:G6,W:$6,x:null,X:null,y:Y6,Y:V6,Z:X6,"%":d8};var _={a:I,A:B,b:U,B:q,c:null,d:J6,e:J6,f:t8,H:Z6,I:Q6,j:K6,L:e8,m:n8,M:r8,p:W,q:H,Q:p8,s:v8,S:i8,u:a8,U:o8,V:u8,w:s8,W:l8,x:null,X:null,y:f8,Y:c8,Z:h8,"%":d8};var x={a:M,A:O,b:S,B:D,c:C,d:k6,e:k6,f:D6,H:E6,I:E6,j:A6,L:S6,m:w6,M:M6,p:E,q:x6,Q:F6,s:T6,S:O6,u:p6,U:v6,V:g6,w:d6,W:m6,x:F,X:T,y:b6,Y:y6,Z:_6,"%":C6};b.x=w(n,b);b.X=w(r,b);b.c=w(t,b);_.x=w(n,_);_.X=w(r,_);_.c=w(t,_);function w(e,t){return function(n){var r=[],i=-1,a=0,o=e.length,u,s,l;if(!(n instanceof Date))n=new Date(+n);while(++i<o){if(e.charCodeAt(i)===37){r.push(e.slice(a,i));if((s=a6[u=e.charAt(++i)])!=null)u=e.charAt(++i);else s=u==="e"?" ":"0";if(l=t[u])u=l(n,s);r.push(u);a=i+1}}r.push(e.slice(a,i));return r.join("")}}function k(e,t){return function(n){var r=r6(1900,undefined,1),i=A(r,e,n+="",0),a,o;if(i!=n.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(r.s*1e3+("L"in r?r.L:0));if(t&&!("Z"in r))r.Z=0;if("p"in r)r.H=r.H%12+r.p*12;if(r.m===undefined)r.m="q"in r?r.q:0;if("V"in r){if(r.V<1||r.V>53)return null;if(!("w"in r))r.w=1;if("Z"in r){a=n6(r6(r.y,0,1)),o=a.getUTCDay();a=o>4||o===0?Xi.ceil(a):Xi(a);a=$i.offset(a,(r.V-1)*7);r.y=a.getUTCFullYear();r.m=a.getUTCMonth();r.d=a.getUTCDate()+(r.w+6)%7}else{a=t6(r6(r.y,0,1)),o=a.getDay();a=o>4||o===0?zi.ceil(a):zi(a);a=Ni.offset(a,(r.V-1)*7);r.y=a.getFullYear();r.m=a.getMonth();r.d=a.getDate()+(r.w+6)%7}}else if("W"in r||"U"in r){if(!("w"in r))r.w="u"in r?r.u%7:"W"in r?1:0;o="Z"in r?n6(r6(r.y,0,1)).getUTCDay():t6(r6(r.y,0,1)).getDay();r.m=0;r.d="W"in r?(r.w+6)%7+r.W*7-(o+5)%7:r.w+r.U*7-(o+6)%7}if("Z"in r){r.H+=r.Z/100|0;r.M+=r.Z%100;return n6(r)}return t6(r)}}function A(e,t,n,r){var i=0,a=t.length,o=n.length,u,s;while(i<a){if(r>=o)return-1;u=t.charCodeAt(i++);if(u===37){u=t.charAt(i++);s=x[u in a6?t.charAt(i++):u];if(!s||(r=s(e,n,r))<0)return-1}else if(u!=n.charCodeAt(r++)){return-1}}return r}function E(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=f[r[0].toLowerCase()],n+r[0].length):-1}function M(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=p[r[0].toLowerCase()],n+r[0].length):-1}function O(e,t,n){var r=c.exec(t.slice(n));return r?(e.w=h[r[0].toLowerCase()],n+r[0].length):-1}function S(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=y[r[0].toLowerCase()],n+r[0].length):-1}function D(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=g[r[0].toLowerCase()],n+r[0].length):-1}function C(e,n,r){return A(e,t,n,r)}function F(e,t,r){return A(e,n,t,r)}function T(e,t,n){return A(e,r,t,n)}function N(e){return o[e.getDay()]}function j(e){return a[e.getDay()]}function R(e){return s[e.getMonth()]}function z(e){return u[e.getMonth()]}function P(e){return i[+(e.getHours()>=12)]}function L(e){return 1+~~(e.getMonth()/3)}function I(e){return o[e.getUTCDay()]}function B(e){return a[e.getUTCDay()]}function U(e){return s[e.getUTCMonth()]}function q(e){return u[e.getUTCMonth()]}function W(e){return i[+(e.getUTCHours()>=12)]}function H(e){return 1+~~(e.getUTCMonth()/3)}return{format:function(e){var t=w(e+="",b);t.toString=function(){return e};return t},parse:function(e){var t=k(e+="",false);t.toString=function(){return e};return t},utcFormat:function(e){var t=w(e+="",_);t.toString=function(){return e};return t},utcParse:function(e){var t=k(e+="",true);t.toString=function(){return e};return t}}}var a6={"-":"",_:" ",0:"0"},o6=/^\s*\d+/,u6=/^%/,s6=/[\\^$*+?|[\]().{}]/g;function l6(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function f6(e){return e.replace(s6,"\\$&")}function c6(e){return new RegExp("^(?:"+e.map(f6).join("|")+")","i")}function h6(e){var t={},n=-1,r=e.length;while(++n<r)t[e[n].toLowerCase()]=n;return t}function d6(e,t,n){var r=o6.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function p6(e,t,n){var r=o6.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function v6(e,t,n){var r=o6.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function g6(e,t,n){var r=o6.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function m6(e,t,n){var r=o6.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function y6(e,t,n){var r=o6.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function b6(e,t,n){var r=o6.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function _6(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function x6(e,t,n){var r=o6.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function w6(e,t,n){var r=o6.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function k6(e,t,n){var r=o6.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function A6(e,t,n){var r=o6.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function E6(e,t,n){var r=o6.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function M6(e,t,n){var r=o6.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function O6(e,t,n){var r=o6.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function S6(e,t,n){var r=o6.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function D6(e,t,n){var r=o6.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function C6(e,t,n){var r=u6.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function F6(e,t,n){var r=o6.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function T6(e,t,n){var r=o6.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function N6(e,t){return l6(e.getDate(),t,2)}function j6(e,t){return l6(e.getHours(),t,2)}function R6(e,t){return l6(e.getHours()%12||12,t,2)}function z6(e,t){return l6(1+Ni.count(Wi(e),e),t,3)}function P6(e,t){return l6(e.getMilliseconds(),t,3)}function L6(e,t){return P6(e,t)+"000"}function I6(e,t){return l6(e.getMonth()+1,t,2)}function B6(e,t){return l6(e.getMinutes(),t,2)}function U6(e,t){return l6(e.getSeconds(),t,2)}function q6(e){var t=e.getDay();return t===0?7:t}function W6(e,t){return l6(Ri.count(Wi(e)-1,e),t,2)}function H6(e,t){var n=e.getDay();e=n>=4||n===0?Ii(e):Ii.ceil(e);return l6(Ii.count(Wi(e),e)+(Wi(e).getDay()===4),t,2)}function G6(e){return e.getDay()}function $6(e,t){return l6(zi.count(Wi(e)-1,e),t,2)}function Y6(e,t){return l6(e.getFullYear()%100,t,2)}function V6(e,t){return l6(e.getFullYear()%1e4,t,4)}function X6(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+l6(t/60|0,"0",2)+l6(t%60,"0",2)}function J6(e,t){return l6(e.getUTCDate(),t,2)}function Z6(e,t){return l6(e.getUTCHours(),t,2)}function Q6(e,t){return l6(e.getUTCHours()%12||12,t,2)}function K6(e,t){return l6(1+$i.count(na(e),e),t,3)}function e8(e,t){return l6(e.getUTCMilliseconds(),t,3)}function t8(e,t){return e8(e,t)+"000"}function n8(e,t){return l6(e.getUTCMonth()+1,t,2)}function r8(e,t){return l6(e.getUTCMinutes(),t,2)}function i8(e,t){return l6(e.getUTCSeconds(),t,2)}function a8(e){var t=e.getUTCDay();return t===0?7:t}function o8(e,t){return l6(Vi.count(na(e)-1,e),t,2)}function u8(e,t){var n=e.getUTCDay();e=n>=4||n===0?Qi(e):Qi.ceil(e);return l6(Qi.count(na(e),e)+(na(e).getUTCDay()===4),t,2)}function s8(e){return e.getUTCDay()}function l8(e,t){return l6(Xi.count(na(e)-1,e),t,2)}function f8(e,t){return l6(e.getUTCFullYear()%100,t,2)}function c8(e,t){return l6(e.getUTCFullYear()%1e4,t,4)}function h8(){return"+0000"}function d8(){return"%"}function p8(e){return+e}function v8(e){return Math.floor(+e/1e3)}var g8;var m8;var y8;b8({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function b8(e){g8=i6(e);m8=g8.parse;y8=g8.utcParse;return g8}var _8={};function x8(e,t,n){var r=e+":"+n,i=_8[r];if(!i||i[0]!==t){_8[r]=i=[t,t(n)]}return i[1]}function w8(e,t){return x8("format",K4,t)(e)}function k8(e,t){return x8("timeFormat",Od,t)(e)}function A8(e,t){return x8("utcFormat",Sd,t)(e)}function E8(e,t){return x8("timeParse",m8,t)(e)}function M8(e,t){return x8("utcParse",y8,t)(e)}var O8=new Date(2e3,0,1);function S8(e,t,n){if(!Number.isInteger(e)||!Number.isInteger(t))return"";O8.setYear(2e3);O8.setMonth(e);O8.setDate(t);return k8(O8,n)}function D8(e){return S8(e,1,"%B")}function C8(e){return S8(e,1,"%b")}function F8(e){return S8(0,2+e,"%A")}function T8(e){return S8(0,2+e,"%a")}function N8(e,t){var n;return l4(e)?e:T5(e)?(n=t.scales[e])&&n.value:undefined}function j8(e,t){var n=N8(e,(t||this).context);return n&&n.range?n.range():[]}function R8(e,t){var n=N8(e,(t||this).context);return n?n.domain():[]}function z8(e,t){var n=N8(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function P8(e,t,n){return Vw(e||0,t||0,n||0)}function L8(e,t){var n=N8(e,(t||this).context);return n?n.copy():undefined}function I8(e,t,n){var r=N8(e,(n||this).context);return r&&t!==undefined?r(t):undefined}function B8(e,t,n){var r=N8(e,(n||this).context);return!r?undefined:C5(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t)}function U8(e,t){return function(n,r,i){if(n){var a=N8(n,(i||this).context);return a&&a.path[e](r)}else{return t(r)}}}var q8=U8("area",QN);var W8=U8("bounds",Sj);var H8=U8("centroid",nR);function G8(e){var t=this.context.group,n=false;if(t)while(e){if(e===t){n=true;break}e=e.mark.group}return n}function $8(e,t,n){if(!e)return[];var r=e[0],i=e[1],a=(new sH).set(r[0],r[1],i[0],i[1]),o=n||this.context.dataflow.scenegraph().root;return hZ(o,a,Y8(t))}function Y8(e){var t=null;if(e){var n=u4(e.marktype),r=u4(e.markname);t=function(e){return(!n.length||n.some((function(t){return e.marktype===t})))&&(!r.length||r.some((function(t){return e.name===t})))}}return t}function V8(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function X8(){return V8(this.context.dataflow,"warn",arguments)}function J8(){return V8(this.context.dataflow,"info",arguments)}function Z8(){return V8(this.context.dataflow,"debug",arguments)}function Q8(){var e=[].slice.call(arguments);e.unshift({});return f4.apply(null,e)}function K8(e,t){return e===t||e!==e&&t!==t?true:C5(e)?C5(t)&&e.length===t.length?e9(e,t):false:F5(e)&&F5(t)?t9(e,t):false}function e9(e,t){for(var n=0,r=e.length;n<r;++n){if(!K8(e[n],t[n]))return false}return true}function t9(e,t){for(var n in e){if(!K8(e[n],t[n]))return false}return true}function n9(e){return function(t){return t9(e,t)}}function r9(e,t,n,r,i,a){var o=this.context.dataflow,u=this.context.data[e],s=u.input,l=u.changes,f=o.stamp(),c,h;if(o._trigger===false||!(s.value.length||t||r)){return 0}if(!l||l.stamp<f){u.changes=l=o.changeset();l.stamp=f;o.runAfter((function(){u.modified=true;o.pulse(s,l).run()}),true,1)}if(n){c=n===true?B5:C5(n)||b3(n)?n:n9(n);l.remove(c)}if(t){l.insert(t)}if(r){c=n9(r);if(s.value.some(c)){l.remove(c)}else{l.insert(r)}}if(i){for(h in a){l.modify(i,h,a[h])}}return 1}function i9(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function a9(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}function o9(e,t,n,r,i){e=N8(e,(i||this).context);var a=vH(t,n);var o=e.domain(),u=o[0],s=q5(o),l=P5;if(!(s-u)){e=(e.interpolator?QO("sequential")().interpolator(e.interpolator()):QO("linear")().interpolate(e.interpolate()).range(e.range())).domain([u=0,s=1])}else{l=cS(e,u,s)}if(e.ticks){o=e.ticks(+r||15);if(u!==o[0])o.unshift(u);if(s!==q5(o))o.push(s)}o.forEach((function(t){return a.stop(l(t),e(t))}));return a}function u9(e,t,n){var r=N8(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}function s9(e){var t=null;return function(n){return n?k$(n,t=t||f$(e)):e}}var l9={};function f9(e){return e.data}function c9(e,t){var n=T4.call(t,e);return n.root&&n.root.lookup||l9}function h9(e,t,n){var r=c9(e,this),i=r[t],a=r[n];return i&&a?i.path(a).map(f9):undefined}function d9(e,t){var n=c9(e,this)[t];return n?n.ancestors().map(f9):undefined}var p9=typeof window!=="undefined"&&window||null;function v9(){return p9?p9.screen:{}}function g9(){return p9?[p9.innerWidth,p9.innerHeight]:[undefined,undefined]}function m9(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[undefined,undefined]}var y9=":";var b9="@";var _9="%";var x9="$";function w9(e,t,n,r){if(t[0].type!==W0){S5("First argument to data functions must be a string literal.")}var i=t[0].value,a=y9+i;if(!d4(a,r)){try{r[a]=n.getData(i).tuplesRef()}catch(o){}}}function k9(e,t,n,r){if(t[0].type!==W0)S5("First argument to indata must be a string literal.");if(t[1].type!==W0)S5("Second argument to indata must be a string literal.");var i=t[0].value,a=t[1].value,o=b9+a;if(!d4(o,r)){r[o]=n.getData(i).indataRef(n,a)}}function A9(e,t,n,r){if(t[0].type===W0){E9(n,r,t[0].value)}else if(t[0].type===G0){for(e in n.scales){E9(n,r,e)}}}function E9(e,t,n){var r=_9+n;if(!d4(t,r)){try{t[r]=e.scaleRef(n)}catch(i){}}}var M9={random:function(){return Kl()},cumulativeNormal:hf,cumulativeLogNormal:bf,cumulativeUniform:Ef,densityNormal:cf,densityLogNormal:yf,densityUniform:Af,quantileNormal:df,quantileLogNormal:_f,quantileUniform:Mf,sampleNormal:ff,sampleLogNormal:mf,sampleUniform:kf,isArray:C5,isBoolean:g4,isDate:m4,isDefined:function(e){return e!==undefined},isNumber:y4,isObject:F5,isRegExp:b4,isString:T5,isTuple:b3,isValid:function(e){return e!=null&&e===e},toBoolean:A4,toDate:M4,toNumber:W5,toString:O4,flush:p4,lerp:_4,merge:Q8,pad:w4,peek:q5,span:k4,inrange:v4,truncate:S4,rgb:pA,lab:RA,hcl:qA,hsl:xA,luminance:C4,contrast:F4,sequence:Cl,format:w8,utcFormat:A8,utcParse:M8,utcOffset:xd,utcSequence:Ad,timeFormat:k8,timeParse:E8,timeOffset:_d,timeSequence:kd,timeUnitSpecifier:Md,monthFormat:D8,monthAbbrevFormat:C8,dayFormat:F8,dayAbbrevFormat:T8,quarter:a4,utcquarter:o4,warn:X8,info:J8,debug:Z8,extent:c4,inScope:G8,intersect:$8,clampRange:s4,pinchDistance:i9,pinchAngle:a9,screen:v9,containerSize:m9,windowSize:g9,bandspace:P8,setdata:j4,pathShape:s9,panLinear:J5,panLog:Z5,panPow:Q5,panSymlog:K5,zoomLinear:t4,zoomLog:n4,zoomPow:r4,zoomSymlog:i4,encode:R4,modify:r9};var O9=["view","item","group","xy","x","y"],S9="event.vega.",D9="this.",C9={};function F9(e){var t=J2(e);O9.forEach((function(e){return t[e]=S9+e}));for(var n in M9){t[n]=D9+n}return t}function T9(e,t,n){if(arguments.length===1){return M9[e]}M9[e]=t;if(n)C9[e]=n;if(j9)j9.functions[e]=D9+e;return this}T9("bandwidth",z8,A9);T9("copy",L8,A9);T9("domain",R8,A9);T9("range",j8,A9);T9("invert",B8,A9);T9("scale",I8,A9);T9("gradient",o9,A9);T9("geoArea",q8,A9);T9("geoBounds",W8,A9);T9("geoCentroid",H8,A9);T9("geoShape",u9,A9);T9("indata",N4,k9);T9("data",T4,w9);T9("treePath",h9,w9);T9("treeAncestors",d9,w9);T9("vlSelectionTest",f5,M5);T9("vlSelectionResolve",c5,M5);var N9={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_["+N5(x9+e)+"]"},functions:F9,constants:X2,visitors:C9};var j9=Q2(N9);function R9(e,t,n){if(t[t.length-1]!==";"){t="return("+t+");"}var r=Function.apply(null,e.concat(t));return n&&n.functions?r.bind(n.functions):r}function z9(e,t){return R9(["_"],e,t)}function P9(e,t){return R9(["datum","_"],e,t)}function L9(e,t){return R9(["event"],e,t)}function I9(e,t){return R9(["_","event"],e,t)}function B9(e,t){return R9(["item","_"],e,t)}function U9(e,t,n){n=n||{};var r,i;for(r in e){i=e[r];n[r]=zn(i)?i.map((function(e){return q9(e,t,n)})):q9(i,t,n)}return n}function q9(e,t,n){if(!e||!Pn(e))return e;for(var r=0,i=W9.length,a;r<i;++r){a=W9[r];if(ar(e,a.key)){return a.parse(e,t,n)}}return e}var W9=[{key:"$ref",parse:H9},{key:"$key",parse:$9},{key:"$expr",parse:G9},{key:"$field",parse:Y9},{key:"$encode",parse:X9},{key:"$compare",parse:V9},{key:"$context",parse:J9},{key:"$subflow",parse:Z9},{key:"$tupleid",parse:Q9}];function H9(e,t){return t.get(e.$ref)||jn("Operator not defined: "+e.$ref)}function G9(e,t,n){if(e.$params){U9(e.$params,t,n)}var r="e:"+e.$expr+"_"+e.$name;return t.fn[r]||(t.fn[r]=Tn(P9(e.$expr,t),e.$fields,e.$name))}function $9(e,t){var n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=cr(e.$key,e.$flat))}function Y9(e,t){if(!e.$field)return null;var n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Bn(e.$field,e.$name))}function V9(e,t){var n="c:"+e.$compare+"_"+e.$order,r=Kn(e.$compare).map((function(e){return e&&e.$tupleid?tv:e}));return t.fn[n]||(t.fn[n]=tr(r,e.$order))}function X9(e,t){var n=e.$encode,r={},i,a;for(i in n){a=n[i];r[i]=Tn(B9(a.$expr,t),a.$fields);r[i].output=a.$output}return r}function J9(e,t){return t}function Z9(e,t){var n=e.$subflow;return function(e,r,i){var a=o7(n,t.fork()),o=a.get(n.operators[0].id),u=a.signals.parent;if(u)u.set(i);return o}}function Q9(){return tv}function K9(e){return(e+"").toLowerCase()}function e7(e){return K9(e)==="operator"}function t7(e){return K9(e)==="collect"}function n7(e,t){if(e7(e.type)||!e.type){t.operator(e,e.update?z9(e.update,t):null)}else{t.transform(e,e.type)}}function r7(e,t){if(e.params){var n=t.get(e.id);if(!n)jn("Invalid operator id: "+e.id);t.dataflow.connect(n,n.parameters(U9(e.params,t),e.react,e.initonly))}}function i7(e,t){var n=e.filter!=null?L9(e.filter,t):undefined,r=e.stream!=null?t.get(e.stream):undefined,i;if(e.source){r=t.events(e.source,e.type,n)}else if(e.merge){i=e.merge.map(t.get.bind(t));r=i[0].merge.apply(i[0],i.slice(1))}if(e.between){i=e.between.map(t.get.bind(t));r=r.between(i[0],i[1])}if(e.filter){r=r.filter(n)}if(e.throttle!=null){r=r.throttle(+e.throttle)}if(e.debounce!=null){r=r.debounce(+e.debounce)}if(r==null){jn("Invalid stream definition: "+JSON.stringify(e))}if(e.consume)r.consume(true);t.stream(e,r)}function a7(e,t){var n=Pn(n=e.source)?n.$ref:n,r=t.get(n),i=null,a=e.update,o=undefined;if(!r)jn("Source not defined: "+e.source);if(e.target&&e.target.$expr){i=L9(e.target.$expr,t)}else{i=t.get(e.target)}if(a&&a.$expr){if(a.$params){o=U9(a.$params,t)}a=I9(a.$expr,t)}t.update(e,r,i,a,o)}function o7(e,t){var n=e.operators||[];if(e.background){t.background=e.background}if(e.eventConfig){t.eventConfig=e.eventConfig}n.forEach((function(e){n7(e,t)}));n.forEach((function(e){r7(e,t)}));(e.streams||[]).forEach((function(e){i7(e,t)}));(e.updates||[]).forEach((function(e){a7(e,t)}));return t.resolve()}var u7={skip:true};function s7(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach((function(n){var i=t.signals[n];if(e.signals(n,i)){r[n]=i.value}}))}if(e.data){var i=n.data={};Object.keys(t.data).forEach((function(n){var r=t.data[n];if(e.data(n,r)){i[n]=r.input.value}}))}if(t.subcontext&&e.recurse!==false){n.subcontext=t.subcontext.map((function(t){return t.getState(e)}))}return n}function l7(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach((function(e){n.update(t.signals[e],i[e],u7)}));Object.keys(r||{}).forEach((function(e){n.pulse(t.data[e].input,n.changeset().remove($n).insert(r[e]))}));(e.subcontext||[]).forEach((function(e,n){var r=t.subcontext[n];if(r)r.setState(e)}))}function f7(e,t,n){return new c7(e,t,n)}function c7(e,t,n){this.dataflow=e;this.transforms=t;this.events=e.events.bind(e);this.signals={};this.scales={};this.nodes={};this.data={};this.fn={};if(n){this.functions=Object.create(n);this.functions.context=this}}function h7(e){this.dataflow=e.dataflow;this.transforms=e.transforms;this.functions=e.functions;this.events=e.events;this.signals=Object.create(e.signals);this.scales=Object.create(e.scales);this.nodes=Object.create(e.nodes);this.data=Object.create(e.data);this.fn=Object.create(e.fn);if(e.functions){this.functions=Object.create(e.functions);this.functions.context=this}}c7.prototype=h7.prototype={fork:function(){var e=new h7(this);(this.subcontext||(this.subcontext=[])).push(e);return e},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n=this,r=n.dataflow,i;n.set(e.id,t);if(t7(e.type)&&(i=e.value)){if(i.$ingest){r.ingest(t,i.$ingest,i.$format)}else if(i.$request){r.preload(t,i.$request,i.$format)}else{r.pulse(t,r.changeset().insert(i))}}if(e.root){n.root=t}if(e.parent){var a=n.get(e.parent.$ref);if(a){r.connect(a,[t]);t.targets().add(a)}else{(n.unresolved=n.unresolved||[]).push((function(){a=n.get(e.parent.$ref);r.connect(a,[t]);t.targets().add(a)}))}}if(e.signal){n.signals[e.signal]=t}if(e.scale){n.scales[e.scale]=t}if(e.data){for(var o in e.data){i=n.data[o]||(n.data[o]={});e.data[o].forEach((function(e){i[e]=t}))}}},resolve:function(){(this.unresolved||[]).forEach((function(e){e()}));delete this.unresolved;return this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[K9(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},getState:s7,setState:l7};function d7(e,t,n){var r=n||M9;return o7(t,f7(e,VK,r))}function p7(e){var t=this._runtime.scales;if(!WZ(t,e)){AZ("Unrecognized scale or projection: "+e)}return t[e].value}var v7="width",g7="height",m7="padding",y7={skip:true};function b7(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===m7?r.left+r.right:0)}function _7(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===m7?r.top+r.bottom:0)}function x7(e){var t=e._signals,n=t[v7],r=t[g7],i=t[m7];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(function(t){e._width=t.size;e._viewWidth=b7(e,t.size);a()}),{size:n});e._resizeHeight=e.add(null,(function(t){e._height=t.size;e._viewHeight=_7(e,t.size);a()}),{size:r});var o=e.add(null,a,{pad:i});e._resizeWidth.rank=n.rank+1;e._resizeHeight.rank=r.rank+1;o.rank=i.rank+1}function w7(e,t,n,r,i,a){this.runAfter((function(o){var u=0;o._autosize=0;if(o.width()!==n){u=1;o.signal(v7,n,y7);o._resizeWidth.skip(true)}if(o.height()!==r){u=1;o.signal(g7,r,y7);o._resizeHeight.skip(true)}if(o._viewWidth!==e){o._resize=1;o._viewWidth=e}if(o._viewHeight!==t){o._resize=1;o._viewHeight=t}if(o._origin[0]!==i[0]||o._origin[1]!==i[1]){o._resize=1;o._origin=i}if(u)o.run("enter");if(a)o.runAfter((function(e){return e.resize()}))}),false,1)}function k7(e){return this._runtime.getState(e||{data:A7,signals:E7,recurse:true})}function A7(e,t){return t.modified&&MZ(t.input.value)&&e.indexOf("_:vega:_")}function E7(e,t){return!(e==="parent"||t instanceof VK.proxy)}function M7(e){this.runAsync(null,(function(t){t._trigger=false;t._runtime.setState(e)}),(function(e){e._trigger=true}));return this}var O7=0,S7=0,D7=0,C7=1e3,F7,T7,N7=0,j7=0,R7=0,z7=typeof performance==="object"&&performance.now?performance:Date,P7=typeof window==="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function L7(){return j7||(P7(I7),j7=z7.now()+R7)}function I7(){j7=0}function B7(){this._call=this._time=this._next=null}B7.prototype=U7.prototype={constructor:B7,restart:function(e,t,n){if(typeof e!=="function")throw new TypeError("callback is not a function");n=(n==null?L7():+n)+(t==null?0:+t);if(!this._next&&T7!==this){if(T7)T7._next=this;else F7=this;T7=this}this._call=e;this._time=n;$7()},stop:function(){if(this._call){this._call=null;this._time=Infinity;$7()}}};function U7(e,t,n){var r=new B7;r.restart(e,t,n);return r}function q7(){L7();++O7;var e=F7,t;while(e){if((t=j7-e._time)>=0)e._call.call(null,t);e=e._next}--O7}function W7(){j7=(N7=z7.now())+R7;O7=S7=0;try{q7()}finally{O7=0;G7();j7=0}}function H7(){var e=z7.now(),t=e-N7;if(t>C7)R7-=t,N7=e}function G7(){var e,t=F7,n,r=Infinity;while(t){if(t._call){if(r>t._time)r=t._time;e=t,t=t._next}else{n=t._next,t._next=null;t=e?e._next=n:F7=n}}T7=e;$7(r)}function $7(e){if(O7)return;if(S7)S7=clearTimeout(S7);var t=e-j7;if(t>24){if(e<Infinity)S7=setTimeout(W7,e-z7.now()-R7);if(D7)D7=clearInterval(D7)}else{if(!D7)N7=z7.now(),D7=setInterval(H7,C7);O7=1,P7(W7)}}function Y7(e,t,n){var r=new B7,i=t;if(t==null)return r.restart(e,t,n),r;t=+t,n=n==null?L7():+n;r.restart((function a(o){o+=i;r.restart(a,i+=t,n);e(o)}),t,n);return r}function V7(e,t){function n(t){e({timestamp:Date.now(),elapsed:t})}this._timers.push(Y7(n,t))}function X7(e,t,n,r){var i=e.element();if(i)i.setAttribute("title",J7(r))}function J7(e){return e==null?"":MZ(e)?Q7(e):OZ(e)&&!GZ(e)?Z7(e):e+""}function Z7(e){return Object.keys(e).map((function(t){var n=e[t];return t+": "+(MZ(n)?Q7(n):K7(n))})).join("\n")}function Q7(e){return"["+e.map(K7).join(", ")+"]"}function K7(e){return MZ(e)?"[…]":OZ(e)&&!GZ(e)?"{…}":e}function eee(e,t){var n=this;t=t||{};WK.call(n);if(t.loader)n.loader(t.loader);if(t.logger)n.logger(t.logger);if(t.logLevel!=null)n.logLevel(t.logLevel);n._el=null;n._elBind=null;n._renderType=t.renderer||lZ.Canvas;n._scenegraph=new XX;var r=n._scenegraph.root;n._renderer=null;n._tooltip=t.tooltip||X7,n._redraw=true;n._handler=(new pJ).scene(r);n._preventDefault=false;n._timers=[];n._eventListeners=[];n._resizeListeners=[];n._eventConfig=f0(e.eventConfig);var i=d7(n,e,t.functions);n._runtime=i;n._signals=i.signals;n._bind=(e.bindings||[]).map((function(e){return{state:null,param:UZ({},e)}}));if(i.root)i.root.set(r);r.source=i.data.root.input;n.pulse(i.data.root.input,n.changeset().insert(r.items));n._background=t.background||i.background||null;n._width=n.width();n._height=n.height();n._viewWidth=b7(n,n._width);n._viewHeight=_7(n,n._height);n._origin=[0,0];n._resize=0;n._autosize=1;x7(n);VZ(n);if(t.hover)n.hover();if(t.container)n.initialize(t.container,t.bind)}var tee=HZ(eee,WK);tee.evaluate=function(e,t,n){return d(this,void 0,void 0,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:return[4,WK.prototype.evaluate.call(this,e,t)];case 1:i.sent();if(!(this._redraw||this._resize))return[3,6];i.label=2;case 2:i.trys.push([2,5,,6]);if(!this._renderer)return[3,4];if(this._resize){this._resize=0;r0(this)}return[4,this._renderer.renderAsync(this._scenegraph.root)];case 3:i.sent();i.label=4;case 4:this._redraw=false;return[3,6];case 5:r=i.sent();this.error(r);return[3,6];case 6:if(n)MQ(this,n);return[2,this]}}))}))};tee.dirty=function(e){this._redraw=true;this._renderer&&this._renderer.dirty(e)};tee.container=function(){return this._el};tee.scenegraph=function(){return this._scenegraph};tee.origin=function(){return this._origin.slice()};function nee(e,t){return WZ(e._signals,t)?e._signals[t]:AZ("Unrecognized signal name: "+DZ(t))}tee.signal=function(e,t,n){var r=nee(this,e);return arguments.length===1?r.value:this.update(r,t,n)};tee.background=function(e){if(arguments.length){this._background=e;this._resize=1;return this}else{return this._background}};tee.width=function(e){return arguments.length?this.signal("width",e):this.signal("width")};tee.height=function(e){return arguments.length?this.signal("height",e):this.signal("height")};tee.padding=function(e){return arguments.length?this.signal("padding",e):this.signal("padding")};tee.autosize=function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")};tee.renderer=function(e){if(!arguments.length)return this._renderType;if(!cZ(e))AZ("Unrecognized renderer type: "+e);if(e!==this._renderType){this._renderType=e;this._resetRenderer()}return this};tee.tooltip=function(e){if(!arguments.length)return this._tooltip;if(e!==this._tooltip){this._tooltip=e;this._resetRenderer()}return this};tee.loader=function(e){if(!arguments.length)return this._loader;if(e!==this._loader){WK.prototype.loader.call(this,e);this._resetRenderer()}return this};tee.resize=function(){this._autosize=1;return this.touch(nee(this,"autosize"))};tee._resetRenderer=function(){if(this._renderer){this._renderer=null;this.initialize(this._el,this._elBind)}};tee._resizeView=w7;tee.addEventListener=function(e,t,n){var r=t;if(!(n&&n.trap===false)){r=N0(this,t);r.raw=t}this._handler.on(e,r);return this};tee.removeEventListener=function(e,t){var n=this._handler.handlers(e),r=n.length,i,a;while(--r>=0){a=n[r].type;i=n[r].handler;if(e===a&&(t===i||t===i.raw)){this._handler.off(a,i);break}}return this};tee.addResizeListener=function(e){var t=this._resizeListeners;if(t.indexOf(e)<0){t.push(e)}return this};tee.removeResizeListener=function(e){var t=this._resizeListeners,n=t.indexOf(e);if(n>=0){t.splice(n,1)}return this};function ree(e,t){var n=e._targets||[],r=n.filter((function(e){var n=e._update;return n&&n.handler===t}));return r.length?r[0]:null}function iee(e,t,n,r){var i=ree(n,r);if(!i){i=N0(this,(function(){r(t,n.value)}));i.handler=r;e.on(n,null,i)}return e}function aee(e,t,n){var r=ree(t,n);if(r)t._targets.remove(r);return e}tee.addSignalListener=function(e,t){return iee(this,e,nee(this,e),t)};tee.removeSignalListener=function(e,t){return aee(this,nee(this,e),t)};tee.addDataListener=function(e,t){return iee(this,e,XK(this,e).values,t)};tee.removeDataListener=function(e,t){return aee(this,XK(this,e).values,t)};tee.preventDefault=function(e){if(arguments.length){this._preventDefault=e;return this}else{return this._preventDefault}};tee.timer=V7;tee.events=d0;tee.finalize=y0;tee.hover=m0;tee.data=JK;tee.change=ZK;tee.insert=QK;tee.remove=KK;tee.scale=p7;tee.initialize=R0;tee.toImageURL=L0;tee.toCanvas=B0;tee.toSVG=U0;tee.getState=k7;tee.setState=M7;function oee(e,t,n){e.fields=t||[];e.fname=n;return e}function uee(e){throw Error(e)}function see(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)uee("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)uee("Access path missing closing bracket: "+e);if(n)uee("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var lee=Array.isArray;function fee(e){return e===Object(e)}function cee(e){return typeof e==="string"}function hee(e){return lee(e)?"["+e.map(hee)+"]":fee(e)||cee(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function dee(e,t){var n=see(e),r="return _["+n.map(hee).join("][")+"];";return oee(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var pee=[];var vee=dee("id");var gee=oee((function(e){return e}),pee,"identity");var mee=oee((function(){return 0}),pee,"zero");var yee=oee((function(){return 1}),pee,"one");var bee=oee((function(){return true}),pee,"true");var _ee=oee((function(){return false}),pee,"false");function xee(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}return e.reduce((function(e,t){for(var n in t){if(n==="signals"){e.signals=kee(e.signals,t.signals)}else{var r=n==="legend"?{layout:1}:n==="style"?true:null;wee(e,n,t[n],r)}}return e}),{})}function wee(e,t,n,r){var i,a;if(fee(n)&&!lee(n)){a=fee(e[t])?e[t]:e[t]={};for(i in n){if(r&&(r===true||r[i])){wee(a,i,n[i])}else{a[i]=n[i]}}}else{e[t]=n}}function kee(e,t){if(e==null)return t;var n={},r=[];function i(e){if(!n[e.name]){n[e.name]=1;r.push(e)}}t.forEach(i);e.forEach(i);return r}function Aee(e){return e[e.length-1]}function Eee(e){return e!=null?lee(e)?e:[e]:[]}function Mee(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}var Oee=Object.prototype.hasOwnProperty;function See(e,t){return Oee.call(e,t)}function Dee(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=true;return t}function Cee(e,t){e=e||t.autosize;return fee(e)?e:{type:e||"pad"}}function Fee(e,t){e=e||t.padding;return fee(e)?{top:Tee(e.top),bottom:Tee(e.bottom),left:Tee(e.left),right:Tee(e.right)}:Nee(Tee(e))}function Tee(e){return+e||0}function Nee(e){return{top:e,bottom:e,left:e,right:e}}var jee="outer",Ree=["value","update","init","react","bind"];function zee(e,t){uee(e+' for "outer" push: '+hee(t))}function Pee(e,t){var n=e.name;if(e.push===jee){if(!t.signals[n])zee("No prior signal definition",n);Ree.forEach((function(t){if(e[t]!==undefined)zee("Invalid property ",t)}))}else{var r=t.addSignal(n,e.value);if(e.react===false)r.react=false;if(e.bind)t.addBinding(n,e.bind)}}var Lee="Literal";var Iee="Identifier";var Bee;var Uee=1,qee=2,Wee=3,Hee=4,Gee=5,$ee=6,Yee=7,Vee=8,Xee=9;Bee={};Bee[Uee]="Boolean";Bee[qee]="<end>";Bee[Wee]="Identifier";Bee[Hee]="Keyword";Bee[Gee]="Null";Bee[$ee]="Numeric";Bee[Yee]="Punctuator";Bee[Vee]="String";Bee[Xee]="RegularExpression";var Jee={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Zee(e,t,n){e.fields=t||[];e.fname=n;return e}function Qee(e){throw Error(e)}function Kee(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);o=++u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)Qee("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)Qee("Access path missing closing bracket: "+e);if(n)Qee("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var ete=Array.isArray;function tte(e){return e===Object(e)}function nte(e){return typeof e==="string"}function rte(e){return ete(e)?"["+e.map(rte)+"]":tte(e)||nte(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function ite(e,t){var n=Kee(e),r="return _["+n.map(rte).join("][")+"];";return Zee(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var ate=[];var ote=ite("id");var ute=Zee((function(e){return e}),ate,"identity");var ste=Zee((function(){return 0}),ate,"zero");var lte=Zee((function(){return 1}),ate,"one");var fte=Zee((function(){return true}),ate,"true");var cte=Zee((function(){return false}),ate,"false");function hte(e){return e[e.length-1]}function dte(e){return e==null||e===""?null:+e}function pte(e){return function(t){return e*Math.exp(t)}}function vte(e){return function(t){return Math.log(e*t)}}function gte(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function mte(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function yte(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function bte(e,t,n,r){var i=n(e[0]),a=n(hte(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function _te(e,t){return bte(e,t,dte,ute)}function xte(e,t){var n=Math.sign(e[0]);return bte(e,t,vte(n),pte(n))}function wte(e,t,n){return bte(e,t,yte(n),yte(1/n))}function kte(e,t,n){return bte(e,t,gte(n),mte(n))}function Ate(e,t,n,r,i){var a=r(e[0]),o=r(hte(e)),u=t!=null?r(t):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function Ete(e,t,n){return Ate(e,t,n,dte,ute)}function Mte(e,t,n){var r=Math.sign(e[0]);return Ate(e,t,n,vte(r),pte(r))}function Ote(e,t,n,r){return Ate(e,t,n,yte(r),yte(1/r))}function Ste(e,t,n,r){return Ate(e,t,n,gte(r),mte(r))}function Dte(e){return 1+~~(new Date(e).getMonth()/3)}function Cte(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Fte(e){return e!=null?ete(e)?e:[e]:[]}function Tte(e,t,n){var r=e[0],i=e[1],a;if(i<r){a=i;i=r;r=a}a=i-r;return a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]}function Nte(e){return typeof e==="function"}function jte(e){return Nte(e)?e:function(){return e}}function Rte(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}function zte(e,t){var n=0,r,i,a,o;if(e&&(r=e.length)){if(t==null){for(i=e[n];i==null||i!==i;i=e[++n]);a=o=i;for(;n<r;++n){i=e[n];if(i!=null){if(i<a)a=i;if(i>o)o=i}}}else{for(i=t(e[n]);i==null||i!==i;i=t(e[++n]));a=o=i;for(;n<r;++n){i=t(e[n]);if(i!=null){if(i<a)a=i;if(i>o)o=i}}}}return[a,o]}var Pte=Object.prototype.hasOwnProperty;function Lte(e,t){return Pte.call(e,t)}function Ite(e,t,n,r,i,a){if(!n&&n!==0)return a;var o=e[0],u=hte(e),s=+n,l,f;if(u<o){l=o;o=u;u=l}l=Math.abs(t-o);f=Math.abs(u-t);return l<f&&l<=s?r:f<=s?i:a}function Bte(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function Ute(e,t,n,r){var i=t[0],a=t[t.length-1],o;if(i>a){o=i;i=a;a=o}n=n===undefined||n;r=r===undefined||r;return(n?i<=e:i<e)&&(r?e<=a:e<a)}function qte(e){return typeof e==="boolean"}function Wte(e){return Object.prototype.toString.call(e)==="[object Date]"}function Hte(e){return typeof e==="number"}function Gte(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function $te(e,t){var n=e[0],r=hte(e),i=+t;return!i?n:i===1?r:n+i*(r-n)}function Yte(e,t){var n="";while(--t>=0)n+=e;return n}function Vte(e,t,n,r){var i=n||" ",a=e+"",o=t-a.length;return o<=0?a:r==="left"?Yte(i,o)+a:r==="center"?Yte(i,~~(o/2))+a+Yte(i,Math.ceil(o/2)):a+Yte(i,o)}function Xte(e){return e&&hte(e)-e[0]||0}function Jte(e){return e==null||e===""?null:!e||e==="false"||e==="0"?false:!!e}function Zte(e){return Hte(e)?e:Wte(e)?e:Date.parse(e)}function Qte(e,t){t=t||Zte;return e==null||e===""?null:t(e)}function Kte(e){return e==null||e===""?null:e+""}function ene(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=true;return t}function tne(e,t,n,r){var i=r!=null?r:"…",a=e+"",o=a.length,u=Math.max(0,t-i.length);return o<=t?a:n==="left"?i+a.slice(o-u):n==="center"?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i}function nne(e,t,n){if(e){var r=0,i=e.length,a;if(t){for(;r<i;++r){if(a=t(e[r]))n(a,r,e)}}else{e.forEach(n)}}}function rne(e){function t(t,n,r,i){var a=e(n[0]);if(r){a=r+"("+a+")";if(r.lastIndexOf("new ",0)===0)a="("+a+")"}return a+"."+t+(i<0?"":i===0?"()":"("+n.slice(1).map(e).join(",")+")")}function n(e,n,r){return function(i){return t(e,i,n,r)}}var r="new Date",i="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){if(t.length<3)Qee("Missing arguments to clamp function.");if(t.length>3)Qee("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),join:n("join",null),indexof:n("indexOf",null),lastindexof:n("lastIndexOf",null),slice:n("slice",null),reverse:function(t){return"("+e(t[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),replace:n("replace",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(t){if(t.length<3)Qee("Missing arguments to if function.");if(t.length>3)Qee("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function ine(e){var t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function ane(e){e=e||{};var t=e.whitelist?ene(e.whitelist):{},n=e.blacklist?ene(e.blacklist):{},r=e.constants||Jee,i=(e.functions||rne)(c),a=e.globalvar,o=e.fieldvar,u={},s={},l=0;var f=Nte(a)?a:function(e){return a+'["'+e+'"]'};function c(e){if(nte(e))return e;var t=h[e.type];if(t==null)Qee("Unsupported type: "+e.type);return t(e)}var h={Literal:function(e){return e.raw},Identifier:function(e){var i=e.name;if(l>0){return i}else if(Lte(n,i)){return Qee("Illegal identifier: "+i)}else if(Lte(r,i)){return r[i]}else if(Lte(t,i)){return i}else{u[i]=1;return f(i)}},MemberExpression:function(e){var t=!e.computed;var n=c(e.object);if(t)l+=1;var r=c(e.property);if(n===o){s[ine(r)]=1}if(t)l-=1;return n+(t?"."+r:"["+r+"]")},CallExpression:function(e){if(e.callee.type!=="Identifier"){Qee("Illegal callee type: "+e.callee.type)}var t=e.callee.name;var n=e.arguments;var r=Lte(i,t)&&i[t];if(!r)Qee("Unrecognized function: "+t);return Nte(r)?r(n):r+"("+n.map(c).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(c).join(",")+"]"},BinaryExpression:function(e){return"("+c(e.left)+e.operator+c(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+c(e.argument)+")"},ConditionalExpression:function(e){return"("+c(e.test)+"?"+c(e.consequent)+":"+c(e.alternate)+")"},LogicalExpression:function(e){return"("+c(e.left)+e.operator+c(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(c).join(",")+"}"},Property:function(e){l+=1;var t=c(e.key);l-=1;return t+":"+c(e.value)}};function d(e){var t={code:c(e),globals:Object.keys(u),fields:Object.keys(s)};u={};s={};return t}d.functions=i;d.constants=r;return d}function one(e){var t=e||ute,n=[],r={};n.add=function(e){var i=t(e);if(!r[i]){r[i]=1;n.push(e)}return n};n.remove=function(e){var i=t(e),a;if(r[i]){r[i]=0;if((a=n.indexOf(e))>=0){n.splice(a,1)}}return n};return n}var une=Symbol("vega_id");function sne(e){return!!(e&&lne(e))}function lne(e){return e[une]}var fne="_:mod:_";function cne(){Object.defineProperty(this,fne,{writable:true,value:{}})}var hne=cne.prototype;hne.set=function(e,t,n,r){var i=this,a=i[e],o=i[fne];if(t!=null&&t>=0){if(a[t]!==n||r){a[t]=n;o[t+":"+e]=-1;o[e]=-1}}else if(a!==n||r){i[e]=n;o[e]=ete(n)?1+n.length:-1}return i};hne.modified=function(e,t){var n=this[fne],r;if(!arguments.length){for(r in n){if(n[r])return true}return false}else if(ete(e)){for(r=0;r<e.length;++r){if(n[e[r]])return true}return false}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]};hne.clear=function(){this[fne]={};return this};var dne=0;var pne="pulse";var vne=new cne;var gne=1,mne=2;function yne(e,t,n,r){this.id=++dne;this.value=e;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(t){this._update=t}if(n)this.parameters(n,r)}var bne=yne.prototype;bne.targets=function(){return this._targets||(this._targets=one(ote))};bne.set=function(e){if(this.value!==e){this.value=e;return 1}else{return 0}};function _ne(e){return function(t){var n=this.flags;if(arguments.length===0)return!!(n&e);this.flags=t?n|e:n&~e;return this}}bne.skip=_ne(gne);bne.modified=_ne(mne);bne.parameters=function(e,t,n){t=t!==false;var r=this,i=r._argval=r._argval||new cne,a=r._argops=r._argops||[],o=[],u,s,l,f;function c(e,n,u){if(u instanceof yne){if(u!==r){if(t)u.targets().add(r);o.push(u)}a.push({op:u,name:e,index:n})}else{i.set(e,n,u)}}for(u in e){s=e[u];if(u===pne){Fte(s).forEach((function(e){if(!(e instanceof yne)){Qee("Pulse parameters must be operator instances.")}else if(e!==r){e.targets().add(r);o.push(e)}}));r.source=s}else if(ete(s)){i.set(u,-1,Array(l=s.length));for(f=0;f<l;++f)c(u,f,s[f])}else{c(u,-1,s)}}this.marshall().clear();if(n)a.initonly=true;return o};bne.marshall=function(e){var t=this._argval||vne,n=this._argops,r,i,a,o,u;if(n){for(i=0,a=n.length;i<a;++i){r=n[i];o=r.op;u=o.modified()&&o.stamp===e;t.set(r.name,r.index,o.value,u)}if(n.initonly){for(i=0;i<a;++i){r=n[i];r.op.targets().remove(this)}this._argops=null;this._update=null}}return t};bne.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);n.clear();if(r!==this.value){this.value=r}else if(!this.modified()){return e.StopPropagation}}};bne.run=function(e){if(e.stamp<this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false);t=0}else{t=this.evaluate(e)}return this.pulse=t||e};var xne={};var wne=1<<0,kne=1<<1,Ane=1<<2,Ene=wne|kne,Mne=wne|Ane,One=wne|kne|Ane,Sne=1<<3,Dne=1<<4,Cne=1<<5,Fne=1<<6;function Tne(e,t,n){this.dataflow=e;this.stamp=t==null?-1:t;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}var Nne=Tne.prototype;Nne.StopPropagation=xne;Nne.ADD=wne;Nne.REM=kne;Nne.MOD=Ane;Nne.ADD_REM=Ene;Nne.ADD_MOD=Mne;Nne.ALL=One;Nne.REFLOW=Sne;Nne.SOURCE=Dne;Nne.NO_SOURCE=Cne;Nne.NO_FIELDS=Fne;Nne.fork=function(e){return new Tne(this.dataflow).init(this,e)};Nne.clone=function(){var e=this.fork(One);e.add=e.add.slice();e.rem=e.rem.slice();e.mod=e.mod.slice();if(e.source)e.source=e.source.slice();return e.materialize(One|Dne)};Nne.addAll=function(){var e=this;if(!this.source||this.source.length===this.add.length){return e}else{e=new Tne(this.dataflow).init(this);e.add=e.source;return e}};Nne.init=function(e,t){var n=this;n.stamp=e.stamp;n.encode=e.encode;if(e.fields&&!(t&Fne)){n.fields=e.fields}if(t&wne){n.addF=e.addF;n.add=e.add}else{n.addF=null;n.add=[]}if(t&kne){n.remF=e.remF;n.rem=e.rem}else{n.remF=null;n.rem=[]}if(t&Ane){n.modF=e.modF;n.mod=e.mod}else{n.modF=null;n.mod=[]}if(t&Cne){n.srcF=null;n.source=null}else{n.srcF=e.srcF;n.source=e.source}return n};Nne.runAfter=function(e){this.dataflow.runAfter(e)};Nne.changed=function(e){var t=e||One;return t&wne&&this.add.length||t&kne&&this.rem.length||t&Ane&&this.mod.length};Nne.reflow=function(e){if(e)return this.fork(One).reflow();var t=this.add.length,n=this.source&&this.source.length;if(n&&n!==t){this.mod=this.source;if(t)this.filter(Ane,zne(this,wne))}return this};Nne.modifies=function(e){var t=this.fields||(this.fields={});if(ete(e)){e.forEach((function(e){return t[e]=true}))}else{t[e]=true}return this};Nne.modified=function(e,t){var n=this.fields;return!((t||this.mod.length)&&n)?false:!arguments.length?!!n:ete(e)?e.some((function(e){return n[e]})):n[e]};Nne.filter=function(e,t){var n=this;if(e&wne)n.addF=jne(n.addF,t);if(e&kne)n.remF=jne(n.remF,t);if(e&Ane)n.modF=jne(n.modF,t);if(e&Dne)n.srcF=jne(n.srcF,t);return n};function jne(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}Nne.materialize=function(e){e=e||One;var t=this;if(e&wne&&t.addF){t.add=Rne(t.add,t.addF);t.addF=null}if(e&kne&&t.remF){t.rem=Rne(t.rem,t.remF);t.remF=null}if(e&Ane&&t.modF){t.mod=Rne(t.mod,t.modF);t.modF=null}if(e&Dne&&t.srcF){t.source=t.source.filter(t.srcF);t.srcF=null}return t};function Rne(e,t){var n=[];nne(e,t,(function(e){n.push(e)}));return n}function zne(e,t){var n={};e.visit(t,(function(e){n[lne(e)]=1}));return function(e){return n[lne(e)]?null:e}}Nne.visit=function(e,t){var n=this,r=t,i,a;if(e&Dne){nne(n.source,n.srcF,r);return n}if(e&wne)nne(n.add,n.addF,r);if(e&kne)nne(n.rem,n.remF,r);if(e&Ane)nne(n.mod,n.modF,r);if(e&Sne&&(i=n.source)){a=n.add.length+n.mod.length;if(a===i.length);else if(a){nne(i,zne(n,Mne),r)}else{nne(i,n.srcF,r)}}return n};function Pne(e,t,n,r){var i=this,a=0,o,u,s,l,f;this.dataflow=e;this.stamp=t;this.fields=null;this.encode=r||null;this.pulses=n;for(s=0,l=n.length;s<l;++s){o=n[s];if(o.stamp!==t)continue;if(o.fields){u=i.fields||(i.fields={});for(f in o.fields){u[f]=1}}if(o.changed(i.ADD))a|=i.ADD;if(o.changed(i.REM))a|=i.REM;if(o.changed(i.MOD))a|=i.MOD}this.changes=a}var Lne=Bte(Pne,Tne);Lne.fork=function(e){var t=new Tne(this.dataflow).init(this,e&this.NO_FIELDS);if(e!==undefined){if(e&t.ADD){this.visit(t.ADD,(function(e){return t.add.push(e)}))}if(e&t.REM){this.visit(t.REM,(function(e){return t.rem.push(e)}))}if(e&t.MOD){this.visit(t.MOD,(function(e){return t.mod.push(e)}))}}return t};Lne.changed=function(e){return this.changes&e};Lne.modified=function(e){var t=this,n=t.fields;return!(n&&t.changes&t.MOD)?0:ete(e)?e.some((function(e){return n[e]})):n[e]};Lne.filter=function(){Qee("MultiPulse does not support filtering.")};Lne.materialize=function(){Qee("MultiPulse does not support materialization.")};Lne.visit=function(e,t){var n=this,r=n.pulses,i=r.length,a=0;if(e&n.SOURCE){for(;a<i;++a){r[a].visit(e,t)}}else{for(;a<i;++a){if(r[a].stamp===n.stamp){r[a].visit(e,t)}}}return n};function Ine(e,t){yne.call(this,e,null,t)}var Bne=Bte(Ine,yne);Bne.run=function(e){var t=this;if(e.stamp<this.stamp)return e.StopPropagation;var n;if(this.skip()){this.skip(false)}else{n=this.evaluate(e)}n=n||e;if(n.then){n=n.then((function(e){return t.pulse=e}))}else if(n!==e.StopPropagation){this.pulse=n}return n};Bne.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);t.clear();return n};Bne.transform=function(){};var Une=Math.random;var qne=Math.sqrt(2*Math.PI);var Wne=Math.SQRT2;var Hne=NaN;function Gne(e,t){e=e||0;t=t==null?1:t;var n=0,r=0,i,a;if(Hne===Hne){n=Hne;Hne=NaN}else{do{n=Une()*2-1;r=Une()*2-1;i=n*n+r*r}while(i===0||i>1);a=Math.sqrt(-2*Math.log(i)/i);n*=a;Hne=r*a}return e+n*t}function $ne(e,t,n){n=n==null?1:n;var r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*qne)}function Yne(e,t,n){t=t||0;n=n==null?1:n;var r,i=(e-t)/n,a=Math.abs(i);if(a>37){r=0}else{var o,u=Math.exp(-a*a/2);if(a<7.07106781186547){o=.0352624965998911*a+.700383064443688;o=o*a+6.37396220353165;o=o*a+33.912866078383;o=o*a+112.079291497871;o=o*a+221.213596169931;o=o*a+220.206867912376;r=u*o;o=.0883883476483184*a+1.75566716318264;o=o*a+16.064177579207;o=o*a+86.7807322029461;o=o*a+296.564248779674;o=o*a+637.333633378831;o=o*a+793.826512519948;o=o*a+440.413735824752;r=r/o}else{o=a+.65;o=a+4/o;o=a+3/o;o=a+2/o;o=a+1/o;r=u/o/2.506628274631}}return i>0?1-r:r}function Vne(e,t,n){if(e<0||e>1)return NaN;return(t||0)+(n==null?1:n)*Wne*Xne(2*e-1)}function Xne(e){var t=-Math.log((1-e)*(1+e)),n;if(t<6.25){t-=3.125;n=-364441206401782e-35;n=-16850591381820166e-35+n*t;n=128584807152564e-32+n*t;n=11157877678025181e-33+n*t;n=-1333171662854621e-31+n*t;n=20972767875968562e-33+n*t;n=6637638134358324e-30+n*t;n=-4054566272975207e-29+n*t;n=-8151934197605472e-29+n*t;n=26335093153082323e-28+n*t;n=-12975133253453532e-27+n*t;n=-5415412054294628e-26+n*t;n=1.0512122733215323e-9+n*t;n=-4.112633980346984e-9+n*t;n=-2.9070369957882005e-8+n*t;n=4.2347877827932404e-7+n*t;n=-13654692000834679e-22+n*t;n=-13882523362786469e-21+n*t;n=.00018673420803405714+n*t;n=-.000740702534166267+n*t;n=-.006033670871430149+n*t;n=.24015818242558962+n*t;n=1.6536545626831027+n*t}else if(t<16){t=Math.sqrt(t)-3.25;n=2.2137376921775787e-9;n=9.075656193888539e-8+n*t;n=-2.7517406297064545e-7+n*t;n=1.8239629214389228e-8+n*t;n=15027403968909828e-22+n*t;n=-4013867526981546e-21+n*t;n=29234449089955446e-22+n*t;n=12475304481671779e-21+n*t;n=-47318229009055734e-21+n*t;n=6828485145957318e-20+n*t;n=24031110387097894e-21+n*t;n=-.0003550375203628475+n*t;n=.0009532893797373805+n*t;n=-.0016882755560235047+n*t;n=.002491442096107851+n*t;n=-.003751208507569241+n*t;n=.005370914553590064+n*t;n=1.0052589676941592+n*t;n=3.0838856104922208+n*t}else if(Number.isFinite(t)){t=Math.sqrt(t)-5;n=-27109920616438573e-27;n=-2.555641816996525e-10+n*t;n=1.5076572693500548e-9+n*t;n=-3.789465440126737e-9+n*t;n=7.61570120807834e-9+n*t;n=-1.496002662714924e-8+n*t;n=2.914795345090108e-8+n*t;n=-6.771199775845234e-8+n*t;n=2.2900482228026655e-7+n*t;n=-9.9298272942317e-7+n*t;n=4526062597223154e-21+n*t;n=-1968177810553167e-20+n*t;n=7599527703001776e-20+n*t;n=-.00021503011930044477+n*t;n=-.00013871931833623122+n*t;n=1.0103004648645344+n*t;n=4.849906401408584+n*t}else{n=Infinity}return n*e}function Jne(e,t){e=e||0;t=t==null?1:t;return Math.exp(e+Gne()*t)}function Zne(e,t,n){if(e<=0)return 0;t=t||0;n=n==null?1:n;var r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*qne*e)}function Qne(e,t,n){return Yne(Math.log(e),t,n)}function Kne(e,t,n){return Math.exp(Vne(e,t,n))}function ere(e,t){if(t==null){t=e==null?1:e;e=0}return e+(t-e)*Une()}function tre(e,t,n){if(n==null){n=t==null?1:t;t=0}return e>=t&&e<=n?1/(n-t):0}function nre(e,t,n){if(n==null){n=t==null?1:t;t=0}return e<t?0:e>n?1:(e-t)/(n-t)}function rre(e,t,n){if(n==null){n=t==null?1:t;t=0}return e>=0&&e<=1?t+e*(n-t):NaN}function ire(e){var t=e/255;if(t<=.03928){return t/12.92}return Math.pow((t+.055)/1.055,2.4)}function are(e){var t=pA(e),n=ire(t.r),r=ire(t.g),i=ire(t.b);return.2126*n+.7152*r+.0722*i}function ore(e,t){var n=are(e),r=are(t),i=Math.max(n,r),a=Math.min(n,r);return(i+.05)/(a+.05)}function ure(e){var t=this.context.data[e];return t?t.values.value:[]}function sre(e,t,n){var r=this.context.data[e]["index:"+t],i=r?r.value.get(n):undefined;return i?i.count:i}function lre(e,t){var n=this.context.dataflow,r=this.context.data[e],i=r.input;n.pulse(i,n.changeset().remove(fte).insert(t));return 1}function fre(e,t,n){if(e){var r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==undefined?n:e}var cre={};function hre(e,t,n){var r=e+":"+n,i=cre[r];if(!i||i[0]!==t){cre[r]=i=[t,t(n)]}return i[1]}function dre(e,t){return hre("format",LM,t)(e)}function pre(e,t){return hre("timeFormat",Od,t)(e)}function vre(e,t){return hre("utcFormat",Sd,t)(e)}function gre(e,t){return hre("timeParse",xo,t)(e)}function mre(e,t){return hre("utcParse",ko,t)(e)}var yre=new Date(2e3,0,1);function bre(e,t,n){if(!Number.isInteger(e)||!Number.isInteger(t))return"";yre.setYear(2e3);yre.setMonth(e);yre.setDate(t);return pre(yre,n)}function _re(e){return bre(e,1,"%B")}function xre(e){return bre(e,1,"%b")}function wre(e){return bre(0,2+e,"%A")}function kre(e){return bre(0,2+e,"%a")}function Are(e,t,n){var r=e-t+n*2;return e?r>0?r:1:0}var Ere="identity";var Mre="linear";var Ore="log";var Sre="pow";var Dre="sqrt";var Cre="symlog";var Fre="time";var Tre="utc";var Nre="sequential";var jre="diverging";var Rre="quantile";var zre="quantize";var Pre="threshold";var Lre="ordinal";var Ire="point";var Bre="band";var Ure="bin-ordinal";function qre(e){return function(t){var n=t[0],r=t[1],i;if(r<n){i=n;n=r;r=i}return[e.invert(n),e.invert(r)]}}function Wre(e){return function(t){var n=e.range(),r=t[0],i=t[1],a=-1,o,u,s,l;if(i<r){u=r;r=i;i=u}for(s=0,l=n.length;s<l;++s){if(n[s]>=r&&n[s]<=i){if(a<0)a=s;o=s}}if(a<0)return undefined;r=e.invertExtent(n[a]);i=e.invertExtent(n[o]);return[r[0]===undefined?r[1]:r[0],i[1]===undefined?i[0]:i[1]]}}function Hre(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Gre(e,t){switch(arguments.length){case 0:break;case 1:{if(typeof e==="function")this.interpolator(e);else this.range(e);break}default:{this.domain(e);if(typeof t==="function")this.interpolator(t);else this.range(t);break}}return this}var $re=Symbol("implicit");function Yre(){var e=new Map,t=[],n=[],r=$re;function i(i){var a=i+"",o=e.get(a);if(!o){if(r!==$re)return r;e.set(a,o=t.push(i))}return n[(o-1)%n.length]}i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;for(var r=0,a=n;r<a.length;r++){var o=a[r];var u=o+"";if(e.has(u))continue;e.set(u,t.push(o))}return i};i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()};i.unknown=function(e){return arguments.length?(r=e,i):r};i.copy=function(){return Yre(t,n).unknown(r)};Hre.apply(i,arguments);return i}function Vre(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}function Xre(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,u=r<t-1?e[r+2]:2*a-i;return Vre((n-r/t)*t,o,i,a,u)}}function Jre(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],u=e[(r+2)%t];return Vre((n-r/t)*t,i,a,o,u)}}function Zre(e){return function(){return e}}function Qre(e,t){return function(n){return e+n*t}}function Kre(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function eie(e,t){var n=t-e;return n?Qre(e,n>180||n<-180?n-360*Math.round(n/360):n):Zre(isNaN(e)?t:e)}function tie(e){return(e=+e)===1?nie:function(t,n){return n-t?Kre(t,n,e):Zre(isNaN(t)?n:t)}}function nie(e,t){var n=t-e;return n?Qre(e,n):Zre(isNaN(e)?t:e)}var rie=function e(t){var n=tie(t);function r(e,t){var r=n((e=pA(e)).r,(t=pA(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=nie(e.opacity,t.opacity);return function(t){e.r=r(t);e.g=i(t);e.b=a(t);e.opacity=o(t);return e+""}}r.gamma=e;return r}(1);function iie(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),a=new Array(n),o,u;for(o=0;o<n;++o){u=pA(t[o]);r[o]=u.r||0;i[o]=u.g||0;a[o]=u.b||0}r=e(r);i=e(i);a=e(a);u.opacity=1;return function(e){u.r=r(e);u.g=i(e);u.b=a(e);return u+""}}}var aie=iie(Xre);var oie=iie(Jre);function uie(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=gie(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(e){for(o=0;o<r;++o)a[o]=i[o](e);return a}}function sie(e,t){var n=new Date;return e=+e,t-=e,function(r){return n.setTime(e+t*r),n}}function lie(e,t){return e=+e,t-=e,function(n){return e+t*n}}function fie(e,t){var n={},r={},i;if(e===null||typeof e!=="object")e={};if(t===null||typeof t!=="object")t={};for(i in t){if(i in e){n[i]=gie(e[i],t[i])}else{r[i]=t[i]}}return function(e){for(i in n)r[i]=n[i](e);return r}}var cie=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hie=new RegExp(cie.source,"g");function die(e){return function(){return e}}function pie(e){return function(t){return e(t)+""}}function vie(e,t){var n=cie.lastIndex=hie.lastIndex=0,r,i,a,o=-1,u=[],s=[];e=e+"",t=t+"";while((r=cie.exec(e))&&(i=hie.exec(t))){if((a=i.index)>n){a=t.slice(n,a);if(u[o])u[o]+=a;else u[++o]=a}if((r=r[0])===(i=i[0])){if(u[o])u[o]+=i;else u[++o]=i}else{u[++o]=null;s.push({i:o,x:lie(r,i)})}n=hie.lastIndex}if(n<t.length){a=t.slice(n);if(u[o])u[o]+=a;else u[++o]=a}return u.length<2?s[0]?pie(s[0].x):die(t):(t=s.length,function(e){for(var n=0,r;n<t;++n)u[(r=s[n]).i]=r.x(e);return u.join("")})}function gie(e,t){var n=typeof t,r;return t==null||n==="boolean"?Zre(t):(n==="number"?lie:n==="string"?(r=fA(t))?(t=r,rie):vie:t instanceof fA?rie:t instanceof Date?sie:Array.isArray(t)?uie:typeof t.valueOf!=="function"&&typeof t.toString!=="function"||isNaN(t)?fie:lie)(e,t)}function mie(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function yie(e,t){var n=eie(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}function bie(e,t){return e=+e,t-=e,function(n){return Math.round(e+t*n)}}var _ie=180/Math.PI;var xie={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function wie(e,t,n,r,i,a){var o,u,s;if(o=Math.sqrt(e*e+t*t))e/=o,t/=o;if(s=e*n+t*r)n-=e*s,r-=t*s;if(u=Math.sqrt(n*n+r*r))n/=u,r/=u,s/=u;if(e*r<t*n)e=-e,t=-t,s=-s,o=-o;return{translateX:i,translateY:a,rotate:Math.atan2(t,e)*_ie,skewX:Math.atan(s)*_ie,scaleX:o,scaleY:u}}var kie,Aie,Eie,Mie;function Oie(e){if(e==="none")return xie;if(!kie)kie=document.createElement("DIV"),Aie=document.documentElement,Eie=document.defaultView;kie.style.transform=e;e=Eie.getComputedStyle(Aie.appendChild(kie),null).getPropertyValue("transform");Aie.removeChild(kie);e=e.slice(7,-1).split(",");return wie(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5])}function Sie(e){if(e==null)return xie;if(!Mie)Mie=document.createElementNS("http://www.w3.org/2000/svg","g");Mie.setAttribute("transform",e);if(!(e=Mie.transform.baseVal.consolidate()))return xie;e=e.matrix;return wie(e.a,e.b,e.c,e.d,e.e,e.f)}function Die(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}function a(e,r,i,a,o,u){if(e!==i||r!==a){var s=o.push("translate(",null,t,null,n);u.push({i:s-4,x:lie(e,i)},{i:s-2,x:lie(r,a)})}else if(i||a){o.push("translate("+i+t+a+n)}}function o(e,t,n,a){if(e!==t){if(e-t>180)t+=360;else if(t-e>180)e+=360;a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:lie(e,t)})}else if(t){n.push(i(n)+"rotate("+t+r)}}function u(e,t,n,a){if(e!==t){a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:lie(e,t)})}else if(t){n.push(i(n)+"skewX("+t+r)}}function s(e,t,n,r,a,o){if(e!==n||t!==r){var u=a.push(i(a)+"scale(",null,",",null,")");o.push({i:u-4,x:lie(e,n)},{i:u-2,x:lie(t,r)})}else if(n!==1||r!==1){a.push(i(a)+"scale("+n+","+r+")")}}return function(t,n){var r=[],i=[];t=e(t),n=e(n);a(t.translateX,t.translateY,n.translateX,n.translateY,r,i);o(t.rotate,n.rotate,r,i);u(t.skewX,n.skewX,r,i);s(t.scaleX,t.scaleY,n.scaleX,n.scaleY,r,i);t=n=null;return function(e){var t=-1,n=i.length,a;while(++t<n)r[(a=i[t]).i]=a.x(e);return r.join("")}}}var Cie=Die(Oie,"px, ","px)","deg)");var Fie=Die(Sie,", ",")",")");var Tie=Math.SQRT2,Nie=2,jie=4,Rie=1e-12;function zie(e){return((e=Math.exp(e))+1/e)/2}function Pie(e){return((e=Math.exp(e))-1/e)/2}function Lie(e){return((e=Math.exp(2*e))-1)/(e+1)}function Iie(e,t){var n=e[0],r=e[1],i=e[2],a=t[0],o=t[1],u=t[2],s=a-n,l=o-r,f=s*s+l*l,c,h;if(f<Rie){h=Math.log(u/i)/Tie;c=function(e){return[n+e*s,r+e*l,i*Math.exp(Tie*e*h)]}}else{var d=Math.sqrt(f),p=(u*u-i*i+jie*f)/(2*i*Nie*d),v=(u*u-i*i-jie*f)/(2*u*Nie*d),g=Math.log(Math.sqrt(p*p+1)-p),m=Math.log(Math.sqrt(v*v+1)-v);h=(m-g)/Tie;c=function(e){var t=e*h,a=zie(g),o=i/(Nie*d)*(a*Lie(Tie*t+g)-Pie(g));return[n+o*s,r+o*l,i*a/zie(Tie*t+g)]}}c.duration=h*1e3;return c}function Bie(e){return function(t,n){var r=e((t=xA(t)).h,(n=xA(n)).h),i=nie(t.s,n.s),a=nie(t.l,n.l),o=nie(t.opacity,n.opacity);return function(e){t.h=r(e);t.s=i(e);t.l=a(e);t.opacity=o(e);return t+""}}}var Uie=Bie(eie);var qie=Bie(nie);function Wie(e,t){var n=nie((e=RA(e)).l,(t=RA(t)).l),r=nie(e.a,t.a),i=nie(e.b,t.b),a=nie(e.opacity,t.opacity);return function(t){e.l=n(t);e.a=r(t);e.b=i(t);e.opacity=a(t);return e+""}}function Hie(e){return function(t,n){var r=e((t=qA(t)).h,(n=qA(n)).h),i=nie(t.c,n.c),a=nie(t.l,n.l),o=nie(t.opacity,n.opacity);return function(e){t.h=r(e);t.c=i(e);t.l=a(e);t.opacity=o(e);return t+""}}}var Gie=Hie(eie);var $ie=Hie(nie);function Yie(e){return function t(n){n=+n;function r(t,r){var i=e((t=eE(t)).h,(r=eE(r)).h),a=nie(t.s,r.s),o=nie(t.l,r.l),u=nie(t.opacity,r.opacity);return function(e){t.h=i(e);t.s=a(e);t.l=o(Math.pow(e,n));t.opacity=u(e);return t+""}}r.gamma=t;return r}(1)}var Vie=Yie(eie);var Xie=Yie(nie);function Jie(e,t){var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);while(n<r)a[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return a[t](e-t)}}function Zie(e,t){var n=new Array(t);for(var r=0;r<t;++r)n[r]=e(r/(t-1));return n}var Qie=Object.freeze({__proto__:null,interpolate:gie,interpolateArray:uie,interpolateBasis:Xre,interpolateBasisClosed:Jre,interpolateDate:sie,interpolateDiscrete:mie,interpolateHue:yie,interpolateNumber:lie,interpolateObject:fie,interpolateRound:bie,interpolateString:vie,interpolateTransformCss:Cie,interpolateTransformSvg:Fie,interpolateZoom:Iie,interpolateRgb:rie,interpolateRgbBasis:aie,interpolateRgbBasisClosed:oie,interpolateHsl:Uie,interpolateHslLong:qie,interpolateLab:Wie,interpolateHcl:Gie,interpolateHclLong:$ie,interpolateCubehelix:Vie,interpolateCubehelixLong:Xie,piecewise:Jie,quantize:Zie});function Kie(e){return function(){return e}}function eae(e){return+e}var tae=[0,1];function nae(e){return e}function rae(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Kie(isNaN(t)?NaN:.5)}function iae(e,t){var n;if(e>t)n=e,e=t,t=n;return function(n){return Math.max(e,Math.min(t,n))}}function aae(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];if(i<r)r=rae(i,r),a=n(o,a);else r=rae(r,i),a=n(a,o);return function(e){return a(r(e))}}function oae(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;if(e[r]<e[0]){e=e.slice().reverse();t=t.slice().reverse()}while(++o<r){i[o]=rae(e[o],e[o+1]);a[o]=n(t[o],t[o+1])}return function(t){var n=Ml(e,t,1,r)-1;return a[n](i[n](t))}}function uae(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function sae(){var e=tae,t=tae,n=gie,r,i,a,o=nae,u,s,l;function f(){var n=Math.min(e.length,t.length);if(o!==nae)o=iae(e[0],e[n-1]);u=n>2?oae:aae;s=l=null;return c}function c(i){return isNaN(i=+i)?a:(s||(s=u(e.map(r),t,n)))(r(o(i)))}c.invert=function(n){return o(i((l||(l=u(t,e.map(r),lie)))(n)))};c.domain=function(t){return arguments.length?(e=Array.from(t,eae),f()):e.slice()};c.range=function(e){return arguments.length?(t=Array.from(e),f()):t.slice()};c.rangeRound=function(e){return t=Array.from(e),n=bie,f()};c.clamp=function(e){return arguments.length?(o=e?true:nae,f()):o!==nae};c.interpolate=function(e){return arguments.length?(n=e,f()):n};c.unknown=function(e){return arguments.length?(a=e,c):a};return function(e,t){r=e,i=t;return f()}}function lae(){return sae()(nae,nae)}function fae(e,t,n,r){var i=zl(e,t,n),a;r=MM(r==null?",f":r);switch(r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));if(r.precision==null&&!isNaN(a=qM(i,o)))r.precision=a;return IM(r,o)}case"":case"e":case"g":case"p":case"r":{if(r.precision==null&&!isNaN(a=WM(i,Math.max(Math.abs(e),Math.abs(t)))))r.precision=a-(r.type==="e");break}case"f":case"%":{if(r.precision==null&&!isNaN(a=UM(i)))r.precision=a-(r.type==="%")*2;break}}return LM(r)}function cae(e){var t=e.domain;e.ticks=function(e){var n=t();return jl(n[0],n[n.length-1],e==null?10:e)};e.tickFormat=function(e,n){var r=t();return fae(r[0],r[r.length-1],e==null?10:e,n)};e.nice=function(n){if(n==null)n=10;var r=t(),i=0,a=r.length-1,o=r[i],u=r[a],s;if(u<o){s=o,o=u,u=s;s=i,i=a,a=s}s=Rl(o,u,n);if(s>0){o=Math.floor(o/s)*s;u=Math.ceil(u/s)*s;s=Rl(o,u,n)}else if(s<0){o=Math.ceil(o*s)/s;u=Math.floor(u*s)/s;s=Rl(o,u,n)}if(s>0){r[i]=Math.floor(o/s)*s;r[a]=Math.ceil(u/s)*s;t(r)}else if(s<0){r[i]=Math.ceil(o*s)/s;r[a]=Math.floor(u*s)/s;t(r)}return e};return e}function hae(){var e=lae();e.copy=function(){return uae(e,hae())};Hre.apply(e,arguments);return cae(e)}function dae(e){var t;function n(e){return isNaN(e=+e)?t:e}n.invert=n;n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,eae),n):e.slice()};n.unknown=function(e){return arguments.length?(t=e,n):t};n.copy=function(){return dae(e).unknown(t)};e=arguments.length?Array.from(e,eae):[0,1];return cae(n)}function pae(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],o;if(a<i){o=n,n=r,r=o;o=i,i=a,a=o}e[n]=t.floor(i);e[r]=t.ceil(a);return e}function vae(e){return Math.log(e)}function gae(e){return Math.exp(e)}function mae(e){return-Math.log(-e)}function yae(e){return-Math.exp(-e)}function bae(e){return isFinite(e)?+("1e"+e):e<0?0:e}function _ae(e){return e===10?bae:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function xae(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function wae(e){return function(t){return-e(-t)}}function kae(e){var t=e(vae,gae),n=t.domain,r=10,i,a;function o(){i=xae(r),a=_ae(r);if(n()[0]<0){i=wae(i),a=wae(a);e(mae,yae)}else{e(vae,gae)}return t}t.base=function(e){return arguments.length?(r=+e,o()):r};t.domain=function(e){return arguments.length?(n(e),o()):n()};t.ticks=function(e){var t=n(),o=t[0],u=t[t.length-1],s;if(s=u<o)l=o,o=u,u=l;var l=i(o),f=i(u),c,h,d,p=e==null?10:+e,v=[];if(!(r%1)&&f-l<p){l=Math.floor(l),f=Math.ceil(f);if(o>0)for(;l<=f;++l){for(h=1,c=a(l);h<r;++h){d=c*h;if(d<o)continue;if(d>u)break;v.push(d)}}else for(;l<=f;++l){for(h=r-1,c=a(l);h>=1;--h){d=c*h;if(d<o)continue;if(d>u)break;v.push(d)}}if(!v.length)v=jl(o,u,p)}else{v=jl(l,f,Math.min(f-l,p)).map(a)}return s?v.reverse():v};t.tickFormat=function(e,n){if(n==null)n=r===10?".0e":",";if(typeof n!=="function")n=LM(n);if(e===Infinity)return n;if(e==null)e=10;var o=Math.max(1,r*e/t.ticks().length);return function(e){var t=e/a(Math.round(i(e)));if(t*r<r-.5)t*=r;return t<=o?n(e):""}};t.nice=function(){return n(pae(n(),{floor:function(e){return a(Math.floor(i(e)))},ceil:function(e){return a(Math.ceil(i(e)))}}))};return t}function Aae(){var e=kae(sae()).domain([1,10]);e.copy=function(){return uae(e,Aae()).base(e.base())};Hre.apply(e,arguments);return e}function Eae(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Mae(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Oae(e){var t=1,n=e(Eae(t),Mae(t));n.constant=function(n){return arguments.length?e(Eae(t=+n),Mae(t)):t};return cae(n)}function Sae(){var e=Oae(sae());e.copy=function(){return uae(e,Sae()).constant(e.constant())};return Hre.apply(e,arguments)}function Dae(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Cae(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Fae(e){return e<0?-e*e:e*e}function Tae(e){var t=e(nae,nae),n=1;function r(){return n===1?e(nae,nae):n===.5?e(Cae,Fae):e(Dae(n),Dae(1/n))}t.exponent=function(e){return arguments.length?(n=+e,r()):n};return cae(t)}function Nae(){var e=Tae(sae());e.copy=function(){return uae(e,Nae()).exponent(e.exponent())};Hre.apply(e,arguments);return e}function jae(){return Nae.apply(null,arguments).exponent(.5)}function Rae(){var e=[],t=[],n=[],r;function i(){var r=0,i=Math.max(1,t.length);n=new Array(i-1);while(++r<i)n[r-1]=Wl(e,r/i);return a}function a(e){return isNaN(e=+e)?r:t[Ml(n,e)]}a.invertExtent=function(r){var i=t.indexOf(r);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]};a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n=0,r=t;n<r.length;n++){var a=r[n];if(a!=null&&!isNaN(a=+a))e.push(a)}e.sort(wl);return i()};a.range=function(e){return arguments.length?(t=Array.from(e),i()):t.slice()};a.unknown=function(e){return arguments.length?(r=e,a):r};a.quantiles=function(){return n.slice()};a.copy=function(){return Rae().domain(e).range(t).unknown(r)};return Hre.apply(a,arguments)}function zae(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function o(e){return e<=e?i[Ml(r,e,0,n)]:a}function u(){var i=-1;r=new Array(n);while(++i<n)r[i]=((i+1)*t-(i-n)*e)/(n+1);return o}o.domain=function(n){return arguments.length?(e=n[0],t=n[1],n,e=+e,t=+t,u()):[e,t]};o.range=function(e){return arguments.length?(n=(i=Array.from(e)).length-1,u()):i.slice()};o.invertExtent=function(a){var o=i.indexOf(a);return o<0?[NaN,NaN]:o<1?[e,r[0]]:o>=n?[r[n-1],t]:[r[o-1],r[o]]};o.unknown=function(e){return arguments.length?(a=e,o):o};o.thresholds=function(){return r.slice()};o.copy=function(){return zae().domain([e,t]).range(i).unknown(a)};return Hre.apply(cae(o),arguments)}function Pae(){var e=[.5],t=[0,1],n,r=1;function i(i){return i<=i?t[Ml(e,i,0,r)]:n}i.domain=function(n){return arguments.length?(e=Array.from(n),r=Math.min(e.length,t.length-1),i):e.slice()};i.range=function(n){return arguments.length?(t=Array.from(n),r=Math.min(e.length,t.length-1),i):t.slice()};i.invertExtent=function(n){var r=t.indexOf(n);return[e[r-1],e[r]]};i.unknown=function(e){return arguments.length?(n=e,i):n};i.copy=function(){return Pae().domain(e).range(t).unknown(n)};return Hre.apply(i,arguments)}var Lae=1e3,Iae=Lae*60,Bae=Iae*60,Uae=Bae*24,qae=Uae*7,Wae=Uae*30,Hae=Uae*365;function Gae(e){return new Date(e)}function $ae(e){return e instanceof Date?+e:+new Date(+e)}function Yae(e,t,n,r,i,a,o,u,s){var l=lae(),f=l.invert,c=l.domain;var h=s(".%L"),d=s(":%S"),p=s("%I:%M"),v=s("%I %p"),g=s("%a %d"),m=s("%b %d"),y=s("%B"),b=s("%Y");var _=[[o,1,Lae],[o,5,5*Lae],[o,15,15*Lae],[o,30,30*Lae],[a,1,Iae],[a,5,5*Iae],[a,15,15*Iae],[a,30,30*Iae],[i,1,Bae],[i,3,3*Bae],[i,6,6*Bae],[i,12,12*Bae],[r,1,Uae],[r,2,2*Uae],[n,1,qae],[t,1,Wae],[t,3,3*Wae],[e,1,Hae]];function x(u){return(o(u)<u?h:a(u)<u?d:i(u)<u?p:r(u)<u?v:t(u)<u?n(u)<u?g:m:e(u)<u?y:b)(u)}function w(t,n,r){if(t==null)t=10;if(typeof t==="number"){var i=Math.abs(r-n)/t,a=kl((function(e){return e[2]})).right(_,i),o;if(a===_.length){o=zl(n/Hae,r/Hae,t);t=e}else if(a){a=_[i/_[a-1][2]<_[a][2]/i?a-1:a];o=a[1];t=a[0]}else{o=Math.max(zl(n,r,t),1);t=u}return t.every(o)}return t}l.invert=function(e){return new Date(f(e))};l.domain=function(e){return arguments.length?c(Array.from(e,$ae)):c().map(Gae)};l.ticks=function(e){var t=c(),n=t[0],r=t[t.length-1],i=r<n,a;if(i)a=n,n=r,r=a;a=w(e,n,r);a=a?a.range(n,r+1):[];return i?a.reverse():a};l.tickFormat=function(e,t){return t==null?x:s(t)};l.nice=function(e){var t=c();return(e=w(e,t[0],t[t.length-1]))?c(pae(t,e)):l};l.copy=function(){return uae(l,Yae(e,t,n,r,i,a,o,u,s))};return l}function Vae(){return Hre.apply(Yae(Wi,qi,Ri,Ni,Ti,Fi,Ci,Ai,_o).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Xae(){return Hre.apply(Yae(na,ta,Vi,$i,Gi,Hi,Ci,Ai,wo).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Jae(){var e=0,t=1,n,r,i,a,o=nae,u=false,s;function l(e){return isNaN(e=+e)?s:o(i===0?.5:(e=(a(e)-n)*i,u?Math.max(0,Math.min(1,e)):e))}l.domain=function(o){return arguments.length?(e=o[0],t=o[1],o,n=a(e=+e),r=a(t=+t),i=n===r?0:1/(r-n),l):[e,t]};l.clamp=function(e){return arguments.length?(u=!!e,l):u};l.interpolator=function(e){return arguments.length?(o=e,l):o};function f(e){return function(t){var n,r;return arguments.length?(n=t[0],r=t[1],t,o=e(n,r),l):[o(0),o(1)]}}l.range=f(gie);l.rangeRound=f(bie);l.unknown=function(e){return arguments.length?(s=e,l):s};return function(o){a=o,n=o(e),r=o(t),i=n===r?0:1/(r-n);return l}}function Zae(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Qae(){var e=cae(Jae()(nae));e.copy=function(){return Zae(e,Qae())};return Gre.apply(e,arguments)}function Kae(){var e=kae(Jae()).domain([1,10]);e.copy=function(){return Zae(e,Kae()).base(e.base())};return Gre.apply(e,arguments)}function eoe(){var e=Oae(Jae());e.copy=function(){return Zae(e,eoe()).constant(e.constant())};return Gre.apply(e,arguments)}function toe(){var e=Tae(Jae());e.copy=function(){return Zae(e,toe()).exponent(e.exponent())};return Gre.apply(e,arguments)}function noe(){return toe.apply(null,arguments).exponent(.5)}function roe(){var e=0,t=.5,n=1,r=1,i,a,o,u,s,l=nae,f,c=false,h;function d(e){return isNaN(e=+e)?h:(e=.5+((e=+f(e))-a)*(r*e<r*a?u:s),l(c?Math.max(0,Math.min(1,e)):e))}d.domain=function(l){return arguments.length?(e=l[0],t=l[1],n=l[2],l,i=f(e=+e),a=f(t=+t),o=f(n=+n),u=i===a?0:.5/(a-i),s=a===o?0:.5/(o-a),r=a<i?-1:1,d):[e,t,n]};d.clamp=function(e){return arguments.length?(c=!!e,d):c};d.interpolator=function(e){return arguments.length?(l=e,d):l};function p(e){return function(t){var n,r,i;return arguments.length?(n=t[0],r=t[1],i=t[2],t,l=Jie(e,[n,r,i]),d):[l(0),l(.5),l(1)]}}d.range=p(gie);d.rangeRound=p(bie);d.unknown=function(e){return arguments.length?(h=e,d):h};return function(l){f=l,i=l(e),a=l(t),o=l(n),u=i===a?0:.5/(a-i),s=a===o?0:.5/(o-a),r=a<i?-1:1;return d}}function ioe(){var e=cae(roe()(nae));e.copy=function(){return Zae(e,ioe())};return Gre.apply(e,arguments)}function aoe(){var e=kae(roe()).domain([.1,1,10]);e.copy=function(){return Zae(e,aoe()).base(e.base())};return Gre.apply(e,arguments)}function ooe(){var e=Oae(roe());e.copy=function(){return Zae(e,ooe()).constant(e.constant())};return Gre.apply(e,arguments)}function uoe(){var e=Tae(roe());e.copy=function(){return Zae(e,uoe()).exponent(e.exponent())};return Gre.apply(e,arguments)}function soe(){return uoe.apply(null,arguments).exponent(.5)}function loe(){var e=Yre().unknown(undefined),t=e.domain,n=e.range,r=[0,1],i,a,o=false,u=0,s=0,l=.5;delete e.unknown;function f(){var e=t().length,f=r[1]<r[0],c=r[f-0],h=r[1-f],d=Are(e,u,s);i=(h-c)/(d||1);if(o){i=Math.floor(i)}c+=(h-c-i*(e-u))*l;a=i*(1-u);if(o){c=Math.round(c);a=Math.round(a)}var p=Cl(e).map((function(e){return c+i*e}));return n(f?p.reverse():p)}e.domain=function(e){if(arguments.length){t(e);return f()}else{return t()}};e.range=function(e){if(arguments.length){r=[+e[0],+e[1]];return f()}else{return r.slice()}};e.rangeRound=function(e){r=[+e[0],+e[1]];o=true;return f()};e.bandwidth=function(){return a};e.step=function(){return i};e.round=function(e){if(arguments.length){o=!!e;return f()}else{return o}};e.padding=function(e){if(arguments.length){s=Math.max(0,Math.min(1,e));u=s;return f()}else{return u}};e.paddingInner=function(e){if(arguments.length){u=Math.max(0,Math.min(1,e));return f()}else{return u}};e.paddingOuter=function(e){if(arguments.length){s=Math.max(0,Math.min(1,e));return f()}else{return s}};e.align=function(e){if(arguments.length){l=Math.max(0,Math.min(1,e));return f()}else{return l}};e.invertRange=function(e){if(e[0]==null||e[1]==null)return;var i=+e[0],o=+e[1],u=r[1]<r[0],s=u?n().reverse():n(),l=s.length-1,f,c,h;if(i!==i||o!==o)return;if(o<i){h=i;i=o;o=h}if(o<s[0]||i>r[1-u])return;f=Math.max(0,Ml(s,i)-1);c=i===o?f:Ml(s,o)-1;if(i-s[f]>a+1e-10)++f;if(u){h=f;f=l-c;c=l-h}return f>c?undefined:t().slice(f,c+1)};e.invert=function(t){var n=e.invertRange([t,t]);return n?n[0]:n};e.copy=function(){return loe().domain(t()).range(r).round(o).paddingInner(u).paddingOuter(s).align(l)};return f()}function foe(e){var t=e.copy;e.padding=e.paddingOuter;delete e.paddingInner;e.copy=function(){return foe(t())};return e}function coe(){return foe(loe().paddingInner(1))}var hoe=Array.prototype.map;function doe(e){return hoe.call(e,(function(e){return+e}))}var poe=Array.prototype.slice;function voe(){var e=[],t=[];function n(n){return n==null||n!==n?undefined:t[(Ml(e,n)-1)%t.length]}n.domain=function(t){if(arguments.length){e=doe(t);return n}else{return e.slice()}};n.range=function(e){if(arguments.length){t=poe.call(e);return n}else{return t.slice()}};n.tickFormat=function(t,n){return fae(e[0],hte(e),t==null?10:t,n)};n.copy=function(){return voe().domain(n.domain()).range(n.range())};return n}function goe(e,t){return function n(){var r=t();if(!r.invertRange){r.invertRange=r.invert?qre(r):r.invertExtent?Wre(r):undefined}r.type=e;return r}}function moe(e,t){if(arguments.length>1){yoe[e]=goe(e,t);return this}else{return Lte(yoe,e)?yoe[e]:undefined}}var yoe=(c={},c[Ere]=dae,c[Mre]=hae,c[Ore]=Aae,c[Sre]=Nae,c[Dre]=jae,c[Cre]=Sae,c[Fre]=Vae,c[Tre]=Xae,c[Nre]=Qae,c[Nre+"-"+Mre]=Qae,c[Nre+"-"+Ore]=Kae,c[Nre+"-"+Sre]=toe,c[Nre+"-"+Dre]=noe,c[Nre+"-"+Cre]=eoe,c[jre+"-"+Mre]=ioe,c[jre+"-"+Ore]=aoe,c[jre+"-"+Sre]=uoe,c[jre+"-"+Dre]=soe,c[jre+"-"+Cre]=ooe,c[Rre]=Rae,c[zre]=zae,c[Pre]=Pae,c[Ure]=voe,c[Lre]=Yre,c[Bre]=loe,c[Ire]=coe,c);for(var boe in yoe){moe(boe,yoe[boe])}var _oe=["clamp","base","constant","exponent"];function xoe(e,t,n){return Jie(koe(t||"rgb",n),e)}function woe(e,t,n){var r=n-t,i,a,o;if(!r||!Number.isFinite(r)){return jte(.5)}else{i=(a=e.type).indexOf("-");a=i<0?a:a.slice(i+1);o=moe(a)().domain([t,n]).range([0,1]);_oe.forEach((function(t){return e[t]?o[t](e[t]()):0}));return o}}function koe(e,t){var n=Qie[Aoe(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function Aoe(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}var Eoe={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"};var Moe={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function Ooe(e){var t=e.length/6|0,n=new Array(t),r=0;while(r<t)n[r]="#"+e.slice(r*6,++r*6);return n}function Soe(e,t){for(var n in e)Coe(n,t(e[n]))}var Doe={};Soe(Moe,Ooe);Soe(Eoe,(function(e){return xoe(Ooe(e))}));function Coe(e,t){e=e&&e.toLowerCase();if(arguments.length>1){Doe[e]=t;return this}else{return Doe[e]}}function Foe(e,t){var n;return Nte(e)?e:nte(e)?(n=t.scales[e])&&n.value:undefined}function Toe(e,t){var n=Foe(e,(t||this).context);return n&&n.range?n.range():[]}function Noe(e,t){var n=Foe(e,(t||this).context);return n?n.domain():[]}function joe(e,t){var n=Foe(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Roe(e,t,n){return Are(e||0,t||0,n||0)}function zoe(e,t){var n=Foe(e,(t||this).context);return n?n.copy():undefined}function Poe(e,t,n){var r=Foe(e,(n||this).context);return r&&t!==undefined?r(t):undefined}function Loe(e,t,n){var r=Foe(e,(n||this).context);return!r?undefined:ete(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t)}function Ioe(){return new Boe}function Boe(){this.reset()}Boe.prototype={constructor:Boe,reset:function(){this.s=this.t=0},add:function(e){qoe(Uoe,e,this.t);qoe(this,Uoe.s,this.s);if(this.s)this.t+=Uoe.t;else this.s=Uoe.t},valueOf:function(){return this.s}};var Uoe=new Boe;function qoe(e,t,n){var r=e.s=t+n,i=r-t,a=r-i;e.t=t-a+(n-i)}var Woe=1e-6;var Hoe=1e-12;var Goe=Math.PI;var $oe=Goe/2;var Yoe=Goe/4;var Voe=Goe*2;var Xoe=180/Goe;var Joe=Goe/180;var Zoe=Math.abs;var Qoe=Math.atan2;var Koe=Math.cos;var eue=Math.sin;var tue=Math.sqrt;function nue(e){return e>1?$oe:e<-1?-$oe:Math.asin(e)}function rue(){}function iue(e,t){if(e&&oue.hasOwnProperty(e.type)){oue[e.type](e,t)}}var aue={Feature:function(e,t){iue(e.geometry,t)},FeatureCollection:function(e,t){var n=e.features,r=-1,i=n.length;while(++r<i)iue(n[r].geometry,t)}};var oue={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates;t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){uue(e.coordinates,t,0)},MultiLineString:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)uue(n[r],t,0)},Polygon:function(e,t){sue(e.coordinates,t)},MultiPolygon:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)sue(n[r],t)},GeometryCollection:function(e,t){var n=e.geometries,r=-1,i=n.length;while(++r<i)iue(n[r],t)}};function uue(e,t,n){var r=-1,i=e.length-n,a;t.lineStart();while(++r<i)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function sue(e,t){var n=-1,r=e.length;t.polygonStart();while(++n<r)uue(e[n],t,1);t.polygonEnd()}function lue(e,t){if(e&&aue.hasOwnProperty(e.type)){aue[e.type](e,t)}else{iue(e,t)}}var fue=Ioe();var cue=Ioe(),hue,due,pue,vue,gue;var mue={point:rue,lineStart:rue,lineEnd:rue,polygonStart:function(){fue.reset();mue.lineStart=yue;mue.lineEnd=bue},polygonEnd:function(){var e=+fue;cue.add(e<0?Voe+e:e);this.lineStart=this.lineEnd=this.point=rue},sphere:function(){cue.add(Voe)}};function yue(){mue.point=_ue}function bue(){xue(hue,due)}function _ue(e,t){mue.point=xue;hue=e,due=t;e*=Joe,t*=Joe;pue=e,vue=Koe(t=t/2+Yoe),gue=eue(t)}function xue(e,t){e*=Joe,t*=Joe;t=t/2+Yoe;var n=e-pue,r=n>=0?1:-1,i=r*n,a=Koe(t),o=eue(t),u=gue*o,s=vue*a+u*Koe(i),l=u*r*eue(i);fue.add(Qoe(l,s));pue=e,vue=a,gue=o}function wue(e){cue.reset();lue(e,mue);return cue*2}function kue(e){return[Qoe(e[1],e[0]),nue(e[2])]}function Aue(e){var t=e[0],n=e[1],r=Koe(n);return[r*Koe(t),r*eue(t),eue(n)]}function Eue(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Mue(e){var t=tue(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Oue,Sue,Due,Cue,Fue,Tue,Nue,jue,Rue=Ioe(),zue,Pue;var Lue={point:Iue,lineStart:Uue,lineEnd:que,polygonStart:function(){Lue.point=Wue;Lue.lineStart=Hue;Lue.lineEnd=Gue;Rue.reset();mue.polygonStart()},polygonEnd:function(){mue.polygonEnd();Lue.point=Iue;Lue.lineStart=Uue;Lue.lineEnd=que;if(fue<0)Oue=-(Due=180),Sue=-(Cue=90);else if(Rue>Woe)Cue=90;else if(Rue<-Woe)Sue=-90;Pue[0]=Oue,Pue[1]=Due},sphere:function(){Oue=-(Due=180),Sue=-(Cue=90)}};function Iue(e,t){zue.push(Pue=[Oue=e,Due=e]);if(t<Sue)Sue=t;if(t>Cue)Cue=t}function Bue(e,t){var n=Aue([e*Joe,t*Joe]);if(jue){var r=Eue(jue,n),i=[r[1],-r[0],0],a=Eue(i,r);Mue(a);a=kue(a);var o=e-Fue,u=o>0?1:-1,s=a[0]*Xoe*u,l,f=Zoe(o)>180;if(f^(u*Fue<s&&s<u*e)){l=a[1]*Xoe;if(l>Cue)Cue=l}else if(s=(s+360)%360-180,f^(u*Fue<s&&s<u*e)){l=-a[1]*Xoe;if(l<Sue)Sue=l}else{if(t<Sue)Sue=t;if(t>Cue)Cue=t}if(f){if(e<Fue){if($ue(Oue,e)>$ue(Oue,Due))Due=e}else{if($ue(e,Due)>$ue(Oue,Due))Oue=e}}else{if(Due>=Oue){if(e<Oue)Oue=e;if(e>Due)Due=e}else{if(e>Fue){if($ue(Oue,e)>$ue(Oue,Due))Due=e}else{if($ue(e,Due)>$ue(Oue,Due))Oue=e}}}}else{zue.push(Pue=[Oue=e,Due=e])}if(t<Sue)Sue=t;if(t>Cue)Cue=t;jue=n,Fue=e}function Uue(){Lue.point=Bue}function que(){Pue[0]=Oue,Pue[1]=Due;Lue.point=Iue;jue=null}function Wue(e,t){if(jue){var n=e-Fue;Rue.add(Zoe(n)>180?n+(n>0?360:-360):n)}else{Tue=e,Nue=t}mue.point(e,t);Bue(e,t)}function Hue(){mue.lineStart()}function Gue(){Wue(Tue,Nue);mue.lineEnd();if(Zoe(Rue)>Woe)Oue=-(Due=180);Pue[0]=Oue,Pue[1]=Due;jue=null}function $ue(e,t){return(t-=e)<0?t+360:t}function Yue(e,t){return e[0]-t[0]}function Vue(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Xue(e){var t,n,r,i,a,o,u;Cue=Due=-(Oue=Sue=Infinity);zue=[];lue(e,Lue);if(n=zue.length){zue.sort(Yue);for(t=1,r=zue[0],a=[r];t<n;++t){i=zue[t];if(Vue(r,i[0])||Vue(r,i[1])){if($ue(r[0],i[1])>$ue(r[0],r[1]))r[1]=i[1];if($ue(i[0],r[1])>$ue(r[0],r[1]))r[0]=i[0]}else{a.push(r=i)}}for(o=-Infinity,n=a.length-1,t=0,r=a[n];t<=n;r=i,++t){i=a[t];if((u=$ue(r[1],i[0]))>o)o=u,Oue=i[0],Due=r[1]}}zue=Pue=null;return Oue===Infinity||Sue===Infinity?[[NaN,NaN],[NaN,NaN]]:[[Oue,Sue],[Due,Cue]]}var Jue,Zue,Que,Kue,ese,tse,nse,rse,ise,ase,ose,use,sse,lse,fse,cse;var hse={sphere:rue,point:dse,lineStart:vse,lineEnd:yse,polygonStart:function(){hse.lineStart=bse;hse.lineEnd=_se},polygonEnd:function(){hse.lineStart=vse;hse.lineEnd=yse}};function dse(e,t){e*=Joe,t*=Joe;var n=Koe(t);pse(n*Koe(e),n*eue(e),eue(t))}function pse(e,t,n){++Jue;Que+=(e-Que)/Jue;Kue+=(t-Kue)/Jue;ese+=(n-ese)/Jue}function vse(){hse.point=gse}function gse(e,t){e*=Joe,t*=Joe;var n=Koe(t);lse=n*Koe(e);fse=n*eue(e);cse=eue(t);hse.point=mse;pse(lse,fse,cse)}function mse(e,t){e*=Joe,t*=Joe;var n=Koe(t),r=n*Koe(e),i=n*eue(e),a=eue(t),o=Qoe(tue((o=fse*a-cse*i)*o+(o=cse*r-lse*a)*o+(o=lse*i-fse*r)*o),lse*r+fse*i+cse*a);Zue+=o;tse+=o*(lse+(lse=r));nse+=o*(fse+(fse=i));rse+=o*(cse+(cse=a));pse(lse,fse,cse)}function yse(){hse.point=dse}function bse(){hse.point=xse}function _se(){wse(use,sse);hse.point=dse}function xse(e,t){use=e,sse=t;e*=Joe,t*=Joe;hse.point=wse;var n=Koe(t);lse=n*Koe(e);fse=n*eue(e);cse=eue(t);pse(lse,fse,cse)}function wse(e,t){e*=Joe,t*=Joe;var n=Koe(t),r=n*Koe(e),i=n*eue(e),a=eue(t),o=fse*a-cse*i,u=cse*r-lse*a,s=lse*i-fse*r,l=tue(o*o+u*u+s*s),f=nue(l),c=l&&-f/l;ise+=c*o;ase+=c*u;ose+=c*s;Zue+=f;tse+=f*(lse+(lse=r));nse+=f*(fse+(fse=i));rse+=f*(cse+(cse=a));pse(lse,fse,cse)}function kse(e){Jue=Zue=Que=Kue=ese=tse=nse=rse=ise=ase=ose=0;lue(e,hse);var t=ise,n=ase,r=ose,i=t*t+n*n+r*r;if(i<Hoe){t=tse,n=nse,r=rse;if(Zue<Woe)t=Que,n=Kue,r=ese;i=t*t+n*n+r*r;if(i<Hoe)return[NaN,NaN]}return[Qoe(n,t)*Xoe,nue(r/tue(i))*Xoe]}function Ase(e,t){return function(n,r,i){if(n){var a=Foe(n,(i||this).context);return a&&a.path[e](r)}else{return t(r)}}}var Ese=Ase("area",wue);var Mse=Ase("bounds",Xue);var Ose=Ase("centroid",kse);function Sse(e){var t=this.context.group,n=false;if(t)while(e){if(e===t){n=true;break}e=e.mark.group}return n}function Dse(e){this.clear();if(e)this.union(e)}var Cse=Dse.prototype;Cse.clone=function(){return new Dse(this)};Cse.clear=function(){this.x1=+Number.MAX_VALUE;this.y1=+Number.MAX_VALUE;this.x2=-Number.MAX_VALUE;this.y2=-Number.MAX_VALUE;return this};Cse.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE};Cse.equals=function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2};Cse.set=function(e,t,n,r){if(n<e){this.x2=e;this.x1=n}else{this.x1=e;this.x2=n}if(r<t){this.y2=t;this.y1=r}else{this.y1=t;this.y2=r}return this};Cse.add=function(e,t){if(e<this.x1)this.x1=e;if(t<this.y1)this.y1=t;if(e>this.x2)this.x2=e;if(t>this.y2)this.y2=t;return this};Cse.expand=function(e){this.x1-=e;this.y1-=e;this.x2+=e;this.y2+=e;return this};Cse.round=function(){this.x1=Math.floor(this.x1);this.y1=Math.floor(this.y1);this.x2=Math.ceil(this.x2);this.y2=Math.ceil(this.y2);return this};Cse.translate=function(e,t){this.x1+=e;this.x2+=e;this.y1+=t;this.y2+=t;return this};Cse.rotate=function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])};Cse.rotatedPoints=function(e,t,n){var r=this,i=r.x1,a=r.y1,o=r.x2,u=r.y2,s=Math.cos(e),l=Math.sin(e),f=t-t*s+n*l,c=n-t*l-n*s;return[s*i-l*a+f,l*i+s*a+c,s*i-l*u+f,l*i+s*u+c,s*o-l*a+f,l*o+s*a+c,s*o-l*u+f,l*o+s*u+c]};Cse.union=function(e){if(e.x1<this.x1)this.x1=e.x1;if(e.y1<this.y1)this.y1=e.y1;if(e.x2>this.x2)this.x2=e.x2;if(e.y2>this.y2)this.y2=e.y2;return this};Cse.intersect=function(e){if(e.x1>this.x1)this.x1=e.x1;if(e.y1>this.y1)this.y1=e.y1;if(e.x2<this.x2)this.x2=e.x2;if(e.y2<this.y2)this.y2=e.y2;return this};Cse.encloses=function(e){return e&&(this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2)};Cse.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)};Cse.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)};Cse.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)};Cse.width=function(){return this.x2-this.x1};Cse.height=function(){return this.y2-this.y1};var Fse=0;var Tse="p_";function Nse(e){return e&&e.gradient}function jse(e,t,n){var r=e.id,i=e.gradient,a=i==="radial"?Tse:"";if(!r){r=e.id="gradient_"+Fse++;if(i==="radial"){e.x1=Rse(e.x1,.5);e.y1=Rse(e.y1,.5);e.r1=Rse(e.r1,0);e.x2=Rse(e.x2,.5);e.y2=Rse(e.y2,.5);e.r2=Rse(e.r2,.5);a=Tse}else{e.x1=Rse(e.x1,0);e.y1=Rse(e.y1,0);e.x2=Rse(e.x2,1);e.y2=Rse(e.y2,0)}}t[r]=e;return"url("+(n||"")+"#"+a+r+")"}function Rse(e,t){return e!=null?e:t}function zse(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(e,t){n.push({offset:e,color:t});return r}}}function Pse(e){this.mark=e;this.bounds=this.bounds||new Dse}function Lse(e,t,n){e.fields=t||[];e.fname=n;return e}function Ise(e){throw Error(e)}function Bse(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);o=++u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)Ise("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)Ise("Access path missing closing bracket: "+e);if(n)Ise("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var Use=Array.isArray;function qse(e){return e===Object(e)}function Wse(e){return typeof e==="string"}function Hse(e){return Use(e)?"["+e.map(Hse)+"]":qse(e)||Wse(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Gse(e,t){var n=Bse(e),r="return _["+n.map(Hse).join("][")+"];";return Lse(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var $se=[];var Yse=Gse("id");var Vse=Lse((function(e){return e}),$se,"identity");var Xse=Lse((function(){return 0}),$se,"zero");var Jse=Lse((function(){return 1}),$se,"one");var Zse=Lse((function(){return true}),$se,"true");var Qse=Lse((function(){return false}),$se,"false");function Kse(e){return typeof e==="function"}var ele=Object.prototype.hasOwnProperty;function tle(e,t){return ele.call(e,t)}function nle(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function rle(e){Pse.call(this,e);this.items=this.items||[]}nle(rle,Pse);function ile(e){this._pending=0;this._loader=e||Oo()}var ale=ile.prototype;ale.pending=function(){return this._pending};function ole(e){e._pending+=1}function ule(e){e._pending-=1}ale.sanitizeURL=function(e){var t=this;ole(t);return t._loader.sanitize(e,{context:"href"}).then((function(e){ule(t);return e})).catch((function(){ule(t);return null}))};ale.loadImage=function(e){var t=this,n=Vv();ole(t);return t._loader.sanitize(e,{context:"image"}).then((function(e){var r=e.href;if(!r||!n)throw{url:r};var i=new n;i.onload=function(){ule(t)};i.onerror=function(){ule(t)};i.src=r;return i})).catch((function(e){ule(t);return{complete:false,width:0,height:0,src:e&&e.url||""}}))};ale.ready=function(){var e=this;return new Promise((function(t){function n(r){if(!e.pending())t(r);else setTimeout((function(){n(true)}),10)}n(false)}))};function sle(e){return function t(){return e}}var lle=Math.abs;var fle=Math.atan2;var cle=Math.cos;var hle=Math.max;var dle=Math.min;var ple=Math.sin;var vle=Math.sqrt;var gle=1e-12;var mle=Math.PI;var yle=mle/2;var ble=2*mle;function _le(e){return e>1?0:e<-1?mle:Math.acos(e)}function xle(e){return e>=1?yle:e<=-1?-yle:Math.asin(e)}function wle(e){return e.innerRadius}function kle(e){return e.outerRadius}function Ale(e){return e.startAngle}function Ele(e){return e.endAngle}function Mle(e){return e&&e.padAngle}function Ole(e,t,n,r,i,a,o,u){var s=n-e,l=r-t,f=o-i,c=u-a,h=c*s-f*l;if(h*h<gle)return;h=(f*(t-a)-c*(e-i))/h;return[e+h*s,t+h*l]}function Sle(e,t,n,r,i,a,o){var u=e-n,s=t-r,l=(o?a:-a)/vle(u*u+s*s),f=l*s,c=-l*u,h=e+f,d=t+c,p=n+f,v=r+c,g=(h+p)/2,m=(d+v)/2,y=p-h,b=v-d,_=y*y+b*b,x=i-a,w=h*v-p*d,k=(b<0?-1:1)*vle(hle(0,x*x*_-w*w)),A=(w*b-y*k)/_,E=(-w*y-b*k)/_,M=(w*b+y*k)/_,O=(-w*y+b*k)/_,S=A-g,D=E-m,C=M-g,F=O-m;if(S*S+D*D>C*C+F*F)A=M,E=O;return{cx:A,cy:E,x01:-f,y01:-c,x11:A*(i/x-1),y11:E*(i/x-1)}}function Dle(){var e=wle,t=kle,n=sle(0),r=null,i=Ale,a=Ele,o=Mle,u=null;function s(){var s,l,f=+e.apply(this,arguments),c=+t.apply(this,arguments),h=i.apply(this,arguments)-yle,d=a.apply(this,arguments)-yle,p=lle(d-h),v=d>h;if(!u)u=s=ig();if(c<f)l=c,c=f,f=l;if(!(c>gle))u.moveTo(0,0);else if(p>ble-gle){u.moveTo(c*cle(h),c*ple(h));u.arc(0,0,c,h,d,!v);if(f>gle){u.moveTo(f*cle(d),f*ple(d));u.arc(0,0,f,d,h,v)}}else{var g=h,m=d,y=h,b=d,_=p,x=p,w=o.apply(this,arguments)/2,k=w>gle&&(r?+r.apply(this,arguments):vle(f*f+c*c)),A=dle(lle(c-f)/2,+n.apply(this,arguments)),E=A,M=A,O,S;if(k>gle){var D=xle(k/f*ple(w)),C=xle(k/c*ple(w));if((_-=D*2)>gle)D*=v?1:-1,y+=D,b-=D;else _=0,y=b=(h+d)/2;if((x-=C*2)>gle)C*=v?1:-1,g+=C,m-=C;else x=0,g=m=(h+d)/2}var F=c*cle(g),T=c*ple(g),N=f*cle(b),j=f*ple(b);if(A>gle){var R=c*cle(m),z=c*ple(m),P=f*cle(y),L=f*ple(y),I;if(p<mle&&(I=Ole(F,T,P,L,R,z,N,j))){var B=F-I[0],U=T-I[1],q=R-I[0],W=z-I[1],H=1/ple(_le((B*q+U*W)/(vle(B*B+U*U)*vle(q*q+W*W)))/2),G=vle(I[0]*I[0]+I[1]*I[1]);E=dle(A,(f-G)/(H-1));M=dle(A,(c-G)/(H+1))}}if(!(x>gle))u.moveTo(F,T);else if(M>gle){O=Sle(P,L,F,T,c,M,v);S=Sle(R,z,N,j,c,M,v);u.moveTo(O.cx+O.x01,O.cy+O.y01);if(M<A)u.arc(O.cx,O.cy,M,fle(O.y01,O.x01),fle(S.y01,S.x01),!v);else{u.arc(O.cx,O.cy,M,fle(O.y01,O.x01),fle(O.y11,O.x11),!v);u.arc(0,0,c,fle(O.cy+O.y11,O.cx+O.x11),fle(S.cy+S.y11,S.cx+S.x11),!v);u.arc(S.cx,S.cy,M,fle(S.y11,S.x11),fle(S.y01,S.x01),!v)}}else u.moveTo(F,T),u.arc(0,0,c,g,m,!v);if(!(f>gle)||!(_>gle))u.lineTo(N,j);else if(E>gle){O=Sle(N,j,R,z,f,-E,v);S=Sle(F,T,P,L,f,-E,v);u.lineTo(O.cx+O.x01,O.cy+O.y01);if(E<A)u.arc(O.cx,O.cy,E,fle(O.y01,O.x01),fle(S.y01,S.x01),!v);else{u.arc(O.cx,O.cy,E,fle(O.y01,O.x01),fle(O.y11,O.x11),!v);u.arc(0,0,f,fle(O.cy+O.y11,O.cx+O.x11),fle(S.cy+S.y11,S.cx+S.x11),v);u.arc(S.cx,S.cy,E,fle(S.y11,S.x11),fle(S.y01,S.x01),!v)}}else u.arc(0,0,f,b,y,v)}u.closePath();if(s)return u=null,s+""||null}s.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-mle/2;return[cle(r)*n,ple(r)*n]};s.innerRadius=function(t){return arguments.length?(e=typeof t==="function"?t:sle(+t),s):e};s.outerRadius=function(e){return arguments.length?(t=typeof e==="function"?e:sle(+e),s):t};s.cornerRadius=function(e){return arguments.length?(n=typeof e==="function"?e:sle(+e),s):n};s.padRadius=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:sle(+e),s):r};s.startAngle=function(e){return arguments.length?(i=typeof e==="function"?e:sle(+e),s):i};s.endAngle=function(e){return arguments.length?(a=typeof e==="function"?e:sle(+e),s):a};s.padAngle=function(e){return arguments.length?(o=typeof e==="function"?e:sle(+e),s):o};s.context=function(e){return arguments.length?(u=e==null?null:e,s):u};return s}function Cle(e){this._context=e}Cle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Fle(e){return new Cle(e)}function Tle(e){return e[0]}function Nle(e){return e[1]}function jle(){var e=Tle,t=Nle,n=sle(true),r=null,i=Fle,a=null;function o(o){var u,s=o.length,l,f=false,c;if(r==null)a=i(c=ig());for(u=0;u<=s;++u){if(!(u<s&&n(l=o[u],u,o))===f){if(f=!f)a.lineStart();else a.lineEnd()}if(f)a.point(+e(l,u,o),+t(l,u,o))}if(c)return a=null,c+""||null}o.x=function(t){return arguments.length?(e=typeof t==="function"?t:sle(+t),o):e};o.y=function(e){return arguments.length?(t=typeof e==="function"?e:sle(+e),o):t};o.defined=function(e){return arguments.length?(n=typeof e==="function"?e:sle(!!e),o):n};o.curve=function(e){return arguments.length?(i=e,r!=null&&(a=i(r)),o):i};o.context=function(e){return arguments.length?(e==null?r=a=null:a=i(r=e),o):r};return o}function Rle(){var e=Tle,t=null,n=sle(0),r=Nle,i=sle(true),a=null,o=Fle,u=null;function s(s){var l,f,c,h=s.length,d,p=false,v,g=new Array(h),m=new Array(h);if(a==null)u=o(v=ig());for(l=0;l<=h;++l){if(!(l<h&&i(d=s[l],l,s))===p){if(p=!p){f=l;u.areaStart();u.lineStart()}else{u.lineEnd();u.lineStart();for(c=l-1;c>=f;--c){u.point(g[c],m[c])}u.lineEnd();u.areaEnd()}}if(p){g[l]=+e(d,l,s),m[l]=+n(d,l,s);u.point(t?+t(d,l,s):g[l],r?+r(d,l,s):m[l])}}if(v)return u=null,v+""||null}function l(){return jle().defined(i).curve(o).context(a)}s.x=function(n){return arguments.length?(e=typeof n==="function"?n:sle(+n),t=null,s):e};s.x0=function(t){return arguments.length?(e=typeof t==="function"?t:sle(+t),s):e};s.x1=function(e){return arguments.length?(t=e==null?null:typeof e==="function"?e:sle(+e),s):t};s.y=function(e){return arguments.length?(n=typeof e==="function"?e:sle(+e),r=null,s):n};s.y0=function(e){return arguments.length?(n=typeof e==="function"?e:sle(+e),s):n};s.y1=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:sle(+e),s):r};s.lineX0=s.lineY0=function(){return l().x(e).y(n)};s.lineY1=function(){return l().x(e).y(r)};s.lineX1=function(){return l().x(t).y(n)};s.defined=function(e){return arguments.length?(i=typeof e==="function"?e:sle(!!e),s):i};s.curve=function(e){return arguments.length?(o=e,a!=null&&(u=o(a)),s):o};s.context=function(e){return arguments.length?(e==null?a=u=null:u=o(a=e),s):a};return s}var zle={draw:function(e,t){var n=Math.sqrt(t/mle);e.moveTo(n,0);e.arc(0,0,n,0,ble)}};function Ple(){var e=sle(zle),t=sle(64),n=null;function r(){var r;if(!n)n=r=ig();e.apply(this,arguments).draw(n,+t.apply(this,arguments));if(r)return n=null,r+""||null}r.type=function(t){return arguments.length?(e=typeof t==="function"?t:sle(t),r):e};r.size=function(e){return arguments.length?(t=typeof e==="function"?e:sle(+e),r):t};r.context=function(e){return arguments.length?(n=e==null?null:e,r):n};return r}function Lle(){}function Ile(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Ble(e){this._context=e}Ble.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){switch(this._point){case 3:Ile(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ile(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function Ule(e){return new Ble(e)}function qle(e){this._context=e}qle.prototype={areaStart:Lle,areaEnd:Lle,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2);this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3);this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3);this._context.closePath();break}case 3:{this.point(this._x2,this._y2);this.point(this._x3,this._y3);this.point(this._x4,this._y4);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x2=e,this._y2=t;break;case 1:this._point=2;this._x3=e,this._y3=t;break;case 2:this._point=3;this._x4=e,this._y4=t;this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ile(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function Wle(e){return new qle(e)}function Hle(e){this._context=e}Hle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Ile(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function Gle(e){return new Hle(e)}function $le(e,t){this._basis=new Ble(e);this._beta=t}$le.prototype={lineStart:function(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0){var r=e[0],i=t[0],a=e[n]-r,o=t[n]-i,u=-1,s;while(++u<=n){s=u/n;this._basis.point(this._beta*e[u]+(1-this._beta)*(r+s*a),this._beta*t[u]+(1-this._beta)*(i+s*o))}}this._x=this._y=null;this._basis.lineEnd()},point:function(e,t){this._x.push(+e);this._y.push(+t)}};var Yle=function e(t){function n(e){return t===1?new Ble(e):new $le(e,t)}n.beta=function(t){return e(+t)};return n}(.85);function Vle(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Xle(e,t){this._context=e;this._k=(1-t)/6}Xle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Vle(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;this._x1=e,this._y1=t;break;case 2:this._point=3;default:Vle(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Jle=function e(t){function n(e){return new Xle(e,t)}n.tension=function(t){return e(+t)};return n}(0);function Zle(e,t){this._context=e;this._k=(1-t)/6}Zle.prototype={areaStart:Lle,areaEnd:Lle,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:Vle(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Qle=function e(t){function n(e){return new Zle(e,t)}n.tension=function(t){return e(+t)};return n}(0);function Kle(e,t){this._context=e;this._k=(1-t)/6}Kle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Vle(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var efe=function e(t){function n(e){return new Kle(e,t)}n.tension=function(t){return e(+t)};return n}(0);function tfe(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>gle){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,s=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/s;i=(i*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/s}if(e._l23_a>gle){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/f;o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/f}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function nfe(e,t){this._context=e;this._alpha=t}nfe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:tfe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var rfe=function e(t){function n(e){return t?new nfe(e,t):new Xle(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function ife(e,t){this._context=e;this._alpha=t}ife.prototype={areaStart:Lle,areaEnd:Lle,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:tfe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var afe=function e(t){function n(e){return t?new ife(e,t):new Zle(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function ofe(e,t){this._context=e;this._alpha=t}ofe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:tfe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ufe=function e(t){function n(e){return t?new ofe(e,t):new Kle(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function sfe(e){this._context=e}sfe.prototype={areaStart:Lle,areaEnd:Lle,lineStart:function(){this._point=0},lineEnd:function(){if(this._point)this._context.closePath()},point:function(e,t){e=+e,t=+t;if(this._point)this._context.lineTo(e,t);else this._point=1,this._context.moveTo(e,t)}};function lfe(e){return new sfe(e)}function ffe(e){return e<0?-1:1}function cfe(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),u=(a*i+o*r)/(r+i);return(ffe(a)+ffe(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function hfe(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function dfe(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,u=(a-r)/3;e._context.bezierCurveTo(r+u,i+u*t,a-u,o-u*n,a,o)}function pfe(e){this._context=e}pfe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:dfe(this,this._t0,hfe(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){var n=NaN;e=+e,t=+t;if(e===this._x1&&t===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;dfe(this,hfe(this,n=cfe(this,e,t)),n);break;default:dfe(this,this._t0,n=cfe(this,e,t));break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t;this._t0=n}};function vfe(e){this._context=new gfe(e)}(vfe.prototype=Object.create(pfe.prototype)).point=function(e,t){pfe.prototype.point.call(this,t,e)};function gfe(e){this._context=e}gfe.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function mfe(e){return new pfe(e)}function yfe(e){return new vfe(e)}function bfe(e){this._context=e}bfe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[];this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n){this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]);if(n===2){this._context.lineTo(e[1],t[1])}else{var r=_fe(e),i=_fe(t);for(var a=0,o=1;o<n;++a,++o){this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o])}}}if(this._line||this._line!==0&&n===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function(e,t){this._x.push(+e);this._y.push(+t)}};function _fe(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);i[0]=0,a[0]=2,o[0]=e[0]+2*e[1];for(t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n];for(t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];i[n-1]=o[n-1]/a[n-1];for(t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];a[n-1]=(e[n]+i[n-1])/2;for(t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function xfe(e){return new bfe(e)}function wfe(e,t){this._context=e;this._t=t}wfe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN;this._point=0},lineEnd:function(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,t);this._context.lineTo(e,t)}else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y);this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function kfe(e){return new wfe(e,.5)}function Afe(e){return new wfe(e,0)}function Efe(e){return new wfe(e,1)}var Mfe={basis:{curve:Ule},"basis-closed":{curve:Wle},"basis-open":{curve:Gle},bundle:{curve:Yle,tension:"beta",value:.85},cardinal:{curve:Jle,tension:"tension",value:0},"cardinal-open":{curve:efe,tension:"tension",value:0},"cardinal-closed":{curve:Qle,tension:"tension",value:0},"catmull-rom":{curve:rfe,tension:"alpha",value:.5},"catmull-rom-closed":{curve:afe,tension:"alpha",value:.5},"catmull-rom-open":{curve:ufe,tension:"alpha",value:.5},linear:{curve:Fle},"linear-closed":{curve:lfe},monotone:{horizontal:yfe,vertical:mfe},natural:{curve:xfe},step:{curve:kfe},"step-after":{curve:Efe},"step-before":{curve:Afe}};function Ofe(e,t,n){var r=tle(Mfe,e)&&Mfe[e],i=null;if(r){i=r.curve||r[t||"vertical"];if(r.tension&&n!=null){i=i[r.tension](n)}}return i}var Sfe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Dfe=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];function Cfe(e){var t=[],n,r,i,a,o,u,s,l,f,c,h;n=e.slice().replace(Dfe[0],"###$1").split(Dfe[1]).slice(1);for(l=0,c=n.length;l<c;++l){r=n[l];i=r.slice(1).trim().replace(Dfe[2],"$1###$2").split(Dfe[3]);u=r.charAt(0);a=[u];for(f=0,h=i.length;f<h;++f){if((o=+i[f])===o){a.push(o)}}s=Sfe[u.toLowerCase()];if(a.length-1>s){for(f=1,h=a.length;f<h;f+=s){t.push([u].concat(a.slice(f,f+s)))}}else{t.push(a)}}return t}var Ffe=Math.PI/180;var Tfe=Math.PI/2;var Nfe=Math.PI*2;var jfe=Math.sqrt(3)/2;var Rfe={};var zfe={};var Pfe=[].join;function Lfe(e,t,n,r,i,a,o,u,s){var l=Pfe.call(arguments);if(Rfe[l]){return Rfe[l]}var f=o*Ffe;var c=Math.sin(f);var h=Math.cos(f);n=Math.abs(n);r=Math.abs(r);var d=h*(u-e)*.5+c*(s-t)*.5;var p=h*(s-t)*.5-c*(u-e)*.5;var v=d*d/(n*n)+p*p/(r*r);if(v>1){v=Math.sqrt(v);n*=v;r*=v}var g=h/n;var m=c/n;var y=-c/r;var b=h/r;var _=g*u+m*s;var x=y*u+b*s;var w=g*e+m*t;var k=y*e+b*t;var A=(w-_)*(w-_)+(k-x)*(k-x);var E=1/A-.25;if(E<0)E=0;var M=Math.sqrt(E);if(a==i)M=-M;var O=.5*(_+w)-M*(k-x);var S=.5*(x+k)+M*(w-_);var D=Math.atan2(x-S,_-O);var C=Math.atan2(k-S,w-O);var F=C-D;if(F<0&&a===1){F+=Nfe}else if(F>0&&a===0){F-=Nfe}var T=Math.ceil(Math.abs(F/(Tfe+.001)));var N=[];for(var j=0;j<T;++j){var R=D+j*F/T;var z=D+(j+1)*F/T;N[j]=[O,S,R,z,n,r,c,h]}return Rfe[l]=N}function Ife(e){var t=Pfe.call(e);if(zfe[t]){return zfe[t]}var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7];var f=l*o;var c=-s*u;var h=s*o;var d=l*u;var p=Math.cos(i);var v=Math.sin(i);var g=Math.cos(a);var m=Math.sin(a);var y=.5*(a-i);var b=Math.sin(y*.5);var _=8/3*b*b/Math.sin(y);var x=n+p-_*v;var w=r+v+_*p;var k=n+g;var A=r+m;var E=k+_*m;var M=A-_*g;return zfe[t]=[f*x+c*w,h*x+d*w,f*E+c*M,h*E+d*M,f*k+c*A,h*k+d*A]}var Bfe=["l",0,0,0,0,0,0,0];function Ufe(e,t,n){var r=Bfe[0]=e[0];if(r==="a"||r==="A"){Bfe[1]=t*e[1];Bfe[2]=n*e[2];Bfe[3]=e[3];Bfe[4]=e[4];Bfe[5]=e[5];Bfe[6]=t*e[6];Bfe[7]=n*e[7]}else if(r==="h"||r==="H"){Bfe[1]=t*e[1]}else if(r==="v"||r==="V"){Bfe[1]=n*e[1]}else{for(var i=1,a=e.length;i<a;++i){Bfe[i]=(i%2==1?t:n)*e[i]}}return Bfe}function qfe(e,t,n,r,i,a){var o,u=null,s=0,l=0,f=0,c=0,h,d,p,v;if(n==null)n=0;if(r==null)r=0;if(i==null)i=1;if(a==null)a=i;if(e.beginPath)e.beginPath();for(var g=0,m=t.length;g<m;++g){o=t[g];if(i!==1||a!==1){o=Ufe(o,i,a)}switch(o[0]){case"l":s+=o[1];l+=o[2];e.lineTo(s+n,l+r);break;case"L":s=o[1];l=o[2];e.lineTo(s+n,l+r);break;case"h":s+=o[1];e.lineTo(s+n,l+r);break;case"H":s=o[1];e.lineTo(s+n,l+r);break;case"v":l+=o[1];e.lineTo(s+n,l+r);break;case"V":l=o[1];e.lineTo(s+n,l+r);break;case"m":s+=o[1];l+=o[2];e.moveTo(s+n,l+r);break;case"M":s=o[1];l=o[2];e.moveTo(s+n,l+r);break;case"c":h=s+o[5];d=l+o[6];f=s+o[3];c=l+o[4];e.bezierCurveTo(s+o[1]+n,l+o[2]+r,f+n,c+r,h+n,d+r);s=h;l=d;break;case"C":s=o[5];l=o[6];f=o[3];c=o[4];e.bezierCurveTo(o[1]+n,o[2]+r,f+n,c+r,s+n,l+r);break;case"s":h=s+o[3];d=l+o[4];f=2*s-f;c=2*l-c;e.bezierCurveTo(f+n,c+r,s+o[1]+n,l+o[2]+r,h+n,d+r);f=s+o[1];c=l+o[2];s=h;l=d;break;case"S":h=o[3];d=o[4];f=2*s-f;c=2*l-c;e.bezierCurveTo(f+n,c+r,o[1]+n,o[2]+r,h+n,d+r);s=h;l=d;f=o[1];c=o[2];break;case"q":h=s+o[3];d=l+o[4];f=s+o[1];c=l+o[2];e.quadraticCurveTo(f+n,c+r,h+n,d+r);s=h;l=d;break;case"Q":h=o[3];d=o[4];e.quadraticCurveTo(o[1]+n,o[2]+r,h+n,d+r);s=h;l=d;f=o[1];c=o[2];break;case"t":h=s+o[1];d=l+o[2];if(u[0].match(/[QqTt]/)===null){f=s;c=l}else if(u[0]==="t"){f=2*s-p;c=2*l-v}else if(u[0]==="q"){f=2*s-f;c=2*l-c}p=f;v=c;e.quadraticCurveTo(f+n,c+r,h+n,d+r);s=h;l=d;f=s+o[1];c=l+o[2];break;case"T":h=o[1];d=o[2];f=2*s-f;c=2*l-c;e.quadraticCurveTo(f+n,c+r,h+n,d+r);s=h;l=d;break;case"a":Wfe(e,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+s+n,o[7]+l+r]);s+=o[6];l+=o[7];break;case"A":Wfe(e,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]);s=o[6];l=o[7];break;case"z":case"Z":e.closePath();break}u=o}}function Wfe(e,t,n,r){var i=Lfe(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(var a=0;a<i.length;++a){var o=Ife(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var Hfe=.5773502691896257;var Gfe={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0);e.arc(0,0,n,0,Nfe)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r);e.lineTo(-n,r);e.lineTo(-r,r);e.lineTo(-r,n);e.lineTo(r,n);e.lineTo(r,r);e.lineTo(n,r);e.lineTo(n,-r);e.lineTo(r,-r);e.lineTo(r,-n);e.lineTo(-r,-n);e.lineTo(-r,-r);e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0);e.lineTo(0,-n);e.lineTo(n,0);e.lineTo(0,n);e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,a=n/8;e.moveTo(-r,n);e.lineTo(r,n);e.lineTo(r,-a);e.lineTo(i,-a);e.lineTo(0,-n);e.lineTo(-i,-a);e.lineTo(-r,-a);e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=jfe*n,i=r-n*Hfe,a=n/4;e.moveTo(0,-r-i);e.lineTo(-a,r-i);e.lineTo(a,r-i);e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=jfe*n,i=r-n*Hfe;e.moveTo(0,-r-i);e.lineTo(-n,r-i);e.lineTo(n,r-i);e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=jfe*n;e.moveTo(0,-r);e.lineTo(-n,r);e.lineTo(n,r);e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=jfe*n;e.moveTo(0,r);e.lineTo(-n,-r);e.lineTo(n,-r);e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=jfe*n;e.moveTo(r,0);e.lineTo(-r,-n);e.lineTo(-r,n);e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=jfe*n;e.moveTo(-r,0);e.lineTo(r,-n);e.lineTo(r,n);e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0);e.lineTo(n,0)}}};function $fe(e){return tle(Gfe,e)?Gfe[e]:Vfe(e)}var Yfe={};function Vfe(e){if(!tle(Yfe,e)){var t=Cfe(e);Yfe[e]={draw:function(e,n){qfe(e,t,0,0,Math.sqrt(n)/2)}}}return Yfe[e]}var Xfe=.448084975506;function Jfe(e){return e.x}function Zfe(e){return e.y}function Qfe(e){return e.width}function Kfe(e){return e.height}function ece(e){return typeof e==="function"?e:function(){return+e}}function tce(e,t,n){return Math.max(t,Math.min(e,n))}function nce(){var e=Jfe,t=Zfe,n=Qfe,r=Kfe,i=ece(0),a=i,o=i,u=i,s=null;function l(l,f,c){var h,d=f!=null?f:+e.call(this,l),p=c!=null?c:+t.call(this,l),v=+n.call(this,l),g=+r.call(this,l),m=Math.min(v,g)/2,y=tce(+i.call(this,l),0,m),b=tce(+a.call(this,l),0,m),_=tce(+o.call(this,l),0,m),x=tce(+u.call(this,l),0,m);if(!s)s=h=ig();if(y<=0&&b<=0&&_<=0&&x<=0){s.rect(d,p,v,g)}else{var w=d+v,k=p+g;s.moveTo(d+y,p);s.lineTo(w-b,p);s.bezierCurveTo(w-Xfe*b,p,w,p+Xfe*b,w,p+b);s.lineTo(w,k-x);s.bezierCurveTo(w,k-Xfe*x,w-Xfe*x,k,w-x,k);s.lineTo(d+_,k);s.bezierCurveTo(d+Xfe*_,k,d,k-Xfe*_,d,k-_);s.lineTo(d,p+y);s.bezierCurveTo(d,p+Xfe*y,d+Xfe*y,p,d+y,p);s.closePath()}if(h){s=null;return h+""||null}}l.x=function(t){if(arguments.length){e=ece(t);return l}else{return e}};l.y=function(e){if(arguments.length){t=ece(e);return l}else{return t}};l.width=function(e){if(arguments.length){n=ece(e);return l}else{return n}};l.height=function(e){if(arguments.length){r=ece(e);return l}else{return r}};l.cornerRadius=function(e,t,n,r){if(arguments.length){i=ece(e);a=t!=null?ece(t):i;u=n!=null?ece(n):i;o=r!=null?ece(r):a;return l}else{return i}};l.context=function(e){if(arguments.length){s=e==null?null:e;return l}else{return s}};return l}function rce(){var e,t,n,r,i=null,a,o,u,s;function l(e,t,n){var r=n/2;if(a){var l=u-t,f=e-o;if(l||f){var c=Math.sqrt(l*l+f*f),h=(l/=c)*s,d=(f/=c)*s,p=Math.atan2(f,l);i.moveTo(o-h,u-d);i.lineTo(e-l*r,t-f*r);i.arc(e,t,r,p-Math.PI,p);i.lineTo(o+h,u+d);i.arc(o,u,s,p,p+Math.PI)}else{i.arc(e,t,r,0,Nfe)}i.closePath()}else{a=1}o=e;u=t;s=r}function f(o){var u,s=o.length,f,c=false,h;if(i==null)i=h=ig();for(u=0;u<=s;++u){if(!(u<s&&r(f=o[u],u,o))===c){if(c=!c)a=0}if(c)l(+e(f,u,o),+t(f,u,o),+n(f,u,o))}if(h){i=null;return h+""||null}}f.x=function(t){if(arguments.length){e=t;return f}else{return e}};f.y=function(e){if(arguments.length){t=e;return f}else{return t}};f.size=function(e){if(arguments.length){n=e;return f}else{return n}};f.defined=function(e){if(arguments.length){r=e;return f}else{return r}};f.context=function(e){if(arguments.length){if(e==null){i=null}else{i=e}return f}else{return i}};return f}function ice(e,t){return e!=null?e:t}var ace=function(e){return e.x||0},oce=function(e){return e.y||0},uce=function(e){return e.width||0},sce=function(e){return e.height||0},lce=function(e){return(e.x||0)+(e.width||0)},fce=function(e){return(e.y||0)+(e.height||0)},cce=function(e){return e.startAngle||0},hce=function(e){return e.endAngle||0},dce=function(e){return e.padAngle||0},pce=function(e){return e.innerRadius||0},vce=function(e){return e.outerRadius||0},gce=function(e){return e.cornerRadius||0},mce=function(e){return ice(e.cornerRadiusTopLeft,e.cornerRadius)||0},yce=function(e){return ice(e.cornerRadiusTopRight,e.cornerRadius)||0},bce=function(e){return ice(e.cornerRadiusBottomRight,e.cornerRadius)||0},_ce=function(e){return ice(e.cornerRadiusBottomLeft,e.cornerRadius)||0},xce=function(e){return ice(e.size,64)},wce=function(e){return e.size||1},kce=function(e){return!(e.defined===false)},Ace=function(e){return $fe(e.shape||"circle")};var Ece=Dle().startAngle(cce).endAngle(hce).padAngle(dce).innerRadius(pce).outerRadius(vce).cornerRadius(gce),Mce=Rle().x(ace).y1(oce).y0(fce).defined(kce),Oce=Rle().y(oce).x1(ace).x0(lce).defined(kce),Sce=jle().x(ace).y(oce).defined(kce),Dce=nce().x(ace).y(oce).width(uce).height(sce).cornerRadius(mce,yce,bce,_ce),Cce=Ple().type(Ace).size(xce),Fce=rce().x(ace).y(oce).defined(kce).size(wce);function Tce(e,t){return Ece.context(e)(t)}function Nce(e,t){var n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?Oce:Mce).curve(Ofe(r,n.orient,n.tension)).context(e)(t)}function jce(e,t){var n=t[0],r=n.interpolate||"linear";return Sce.curve(Ofe(r,n.orient,n.tension)).context(e)(t)}function Rce(e,t,n,r){return Dce.context(e)(t,n,r)}function zce(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Pce(e,t){return Cce.context(e)(t)}function Lce(e,t){return Fce.context(e)(t)}function Ice(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){var r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Bce(t,r):0))}return e}function Bce(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}var Uce,qce=Nfe-1e-8;function Wce(e){Uce=e;return Wce}function Hce(){}function Gce(e,t){Uce.add(e,t)}Wce.beginPath=Hce;Wce.closePath=Hce;Wce.moveTo=Gce;Wce.lineTo=Gce;Wce.rect=function(e,t,n,r){Gce(e,t);Gce(e+n,t+r)};Wce.quadraticCurveTo=function(e,t,n,r){Gce(e,t);Gce(n,r)};Wce.bezierCurveTo=function(e,t,n,r,i,a){Gce(e,t);Gce(n,r);Gce(i,a)};Wce.arc=function(e,t,n,r,i,a){if(Math.abs(i-r)>qce){Gce(e-n,t-n);Gce(e+n,t+n);return}var o=Infinity,u=-Infinity,s=Infinity,l=-Infinity,f,c,h,d;function p(e){h=n*Math.cos(e);d=n*Math.sin(e);if(h<o)o=h;if(h>u)u=h;if(d<s)s=d;if(d>l)l=d}p(r);p(i);if(i!==r){r=r%Nfe;if(r<0)r+=Nfe;i=i%Nfe;if(i<0)i+=Nfe;if(i<r){a=!a;f=r;r=i;i=f}if(a){i-=Nfe;f=r-r%Tfe;for(c=0;c<4&&f>i;++c,f-=Tfe)p(f)}else{f=r-r%Tfe+Tfe;for(c=0;c<4&&f<i;++c,f=f+Tfe)p(f)}}Gce(e+o,t+s);Gce(e+u,t+l)};var $ce=($ce=Yv(1,1))?$ce.getContext("2d"):null;var Yce=new Dse;function Vce(e){return function(t,n){if(!$ce)return true;e($ce,t);Yce.clear().union(t.bounds).intersect(n).round();var r=Yce.x1,i=Yce.y1,a=Yce.x2,o=Yce.y2;for(var u=i;u<=o;++u){for(var s=r;s<=a;++s){if($ce.isPointInPath(s,u)){return true}}}return false}}function Xce(e,t){return t.contains(e.x||0,e.y||0)}function Jce(e,t){var n=e.x||0,r=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(Yce.set(n,r,n+i,r+a))}function Zce(e,t){var n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,a=e.y2!=null?e.y2:r;return Qce(t,n,r,i,a)}function Qce(e,t,n,r,i){var a=e.x1,o=e.y1,u=e.x2,s=e.y2,l=r-t,f=i-n;var c=0,h=1,d,p,v,g;for(g=0;g<4;++g){if(g===0){d=-l;p=-(a-t)}if(g===1){d=l;p=u-t}if(g===2){d=-f;p=-(o-n)}if(g===3){d=f;p=s-n}if(Math.abs(d)<1e-10&&p<0)return false;v=p/d;if(d<0){if(v>h)return false;else if(v>c)c=v}else if(d>0){if(v<c)return false;else if(v<h)h=v}}return true}function Kce(e,t,n){var r=n.width(),i=n.height(),a=t.stops,o=a.length;var u=t.gradient==="radial"?e.createRadialGradient(n.x1+ehe(t.x1,.5)*r,n.y1+ehe(t.y1,.5)*i,Math.max(r,i)*ehe(t.r1,0),n.x1+ehe(t.x2,.5)*r,n.y1+ehe(t.y2,.5)*i,Math.max(r,i)*ehe(t.r2,.5)):e.createLinearGradient(n.x1+ehe(t.x1,0)*r,n.y1+ehe(t.y1,0)*i,n.x1+ehe(t.x2,1)*r,n.y1+ehe(t.y2,0)*i);for(var s=0;s<o;++s){u.addColorStop(a[s].offset,a[s].color)}return u}function ehe(e,t){return e==null?t:e}function the(e,t,n){return Nse(n)?Kce(e,n,t.bounds):n}function nhe(e,t,n){n*=t.fillOpacity==null?1:t.fillOpacity;if(n>0){e.globalAlpha=n;e.fillStyle=the(e,t,t.fill);return true}else{return false}}var rhe=[];function ihe(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;if(r<=0)return false;n*=t.strokeOpacity==null?1:t.strokeOpacity;if(n>0){e.globalAlpha=n;e.strokeStyle=the(e,t,t.stroke);e.lineWidth=r;e.lineCap=t.strokeCap||"butt";e.lineJoin=t.strokeJoin||"miter";e.miterLimit=t.strokeMiterLimit||10;if(e.setLineDash){e.setLineDash(t.strokeDash||rhe);e.lineDashOffset=t.strokeDashOffset||0}return true}else{return false}}function ahe(e,t){return e.zindex-t.zindex||e.index-t.index}function ohe(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,a;for(i=0,a=t.length;i<a;++i){r=t[i];r.index=i;if(r.zindex)n.push(r)}e.zdirty=false;return e.zitems=n.sort(ahe)}function uhe(e,t){var n=e.items,r,i;if(!n||!n.length)return;var a=ohe(e);if(a&&a.length){for(r=0,i=n.length;r<i;++r){if(!n[r].zindex)t(n[r])}n=a}for(r=0,i=n.length;r<i;++r){t(n[r])}}function she(e,t){var n=e.items,r,i;if(!n||!n.length)return null;var a=ohe(e);if(a&&a.length)n=a;for(i=n.length;--i>=0;){if(r=t(n[i]))return r}if(n===a){for(n=e.items,i=n.length;--i>=0;){if(!n[i].zindex){if(r=t(n[i]))return r}}}return null}function lhe(e){return function(t,n,r){uhe(n,(function(n){if(!r||r.intersects(n.bounds)){che(e,t,n,n)}}))}}function fhe(e){return function(t,n,r){if(n.items.length&&(!r||r.intersects(n.bounds))){che(e,t,n.items[0],n.items)}}}function che(e,t,n,r){var i=n.opacity==null?1:n.opacity;if(i===0)return;if(e(t,r))return;if(n.fill&&nhe(t,n,i)){t.fill()}if(n.stroke&&ihe(t,n,i)){t.stroke()}}function hhe(e){e=e||Zse;return function(t,n,r,i,a,o){r*=t.pixelRatio;i*=t.pixelRatio;return she(n,(function(n){var u=n.bounds;if(u&&!u.contains(a,o)||!u)return;if(e(t,n,r,i,a,o))return n}))}}function dhe(e,t){return function(n,r,i,a){var o=Array.isArray(r)?r[0]:r,u=t==null?o.fill:t,s=o.stroke&&n.isPointInStroke,l,f;if(s){l=o.strokeWidth;f=o.strokeCap;n.lineWidth=l!=null?l:1;n.lineCap=f!=null?f:"butt"}return e(n,r)?false:u&&n.isPointInPath(i,a)||s&&n.isPointInStroke(i,a)}}function phe(e){return hhe(dhe(e))}function vhe(e,t){return"translate("+e+","+t+")"}function ghe(e){return"rotate("+e+")"}function mhe(e,t){return"scale("+e+","+t+")"}function yhe(e){return vhe(e.x||0,e.y||0)}function bhe(e){return vhe(e.x||0,e.y||0)+(e.angle?" "+ghe(e.angle):"")+(e.scaleX||e.scaleY?" "+mhe(e.scaleX||1,e.scaleY||1):"")}function _he(e,t,n){function r(e,n){e("transform",bhe(n));e("d",t(null,n))}function i(e,n){var r=n.x||0,i=n.y||0;t(Wce(e),n);Ice(e,n).translate(r,i);if(n.angle){e.rotate(n.angle*Ffe,r,i)}return e}function a(e,n){var r=n.x||0,i=n.y||0,a=n.angle||0;e.translate(r,i);if(a)e.rotate(a*=Ffe);e.beginPath();t(e,n);if(a)e.rotate(-a);e.translate(-r,-i)}return{type:e,tag:"path",nested:false,attr:r,bound:i,draw:lhe(a),pick:phe(a),isect:n||Vce(a)}}var xhe=_he("arc",Tce);function whe(e,t){var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,a=+Infinity,o,u;while(--i>=0){if(e[i].defined===false)continue;u=Math.abs(e[i][r]-n);if(u<a){a=u;o=e[i]}}return o}function khe(e,t){var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,a,o;while(--r>=0){if(e[r].defined===false)continue;i=e[r].x-t[0];a=e[r].y-t[1];o=i*i+a*a;if(o<n)return e[r]}return null}function Ahe(e,t){var n=e.length,r,i,a;while(--n>=0){if(e[n].defined===false)continue;r=e[n].x-t[0];i=e[n].y-t[1];a=r*r+i*i;r=e[n].size||1;if(a<r*r)return e[n]}return null}function Ehe(e,t,n){function r(e,n){var r=n.mark.items;if(r.length)e("d",t(null,r))}function i(e,n){var r=n.items;if(r.length===0){return e}else{t(Wce(e),r);return Ice(e,r[0])}}function a(e,n){e.beginPath();t(e,n)}var o=dhe(a);function u(e,t,n,r,i,a){var u=t.items,s=t.bounds;if(!u||!u.length||s&&!s.contains(i,a)){return null}n*=e.pixelRatio;r*=e.pixelRatio;return o(e,u,n,r)?u[0]:null}return{type:e,tag:"path",nested:true,attr:r,bound:i,draw:fhe(a),pick:u,isect:Xce,tip:n}}var Mhe=Ehe("area",Nce,whe);var Ohe=1;function She(e,t,n){var r=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+Ohe++),o=i.clipping[a]||(i.clipping[a]={id:a});if(Kse(r)){o.path=r(null)}else{o.width=n.width||0;o.height=n.height||0}return"url(#"+a+")"}var Dhe=.5;function Che(e,t){e("transform",yhe(t))}function Fhe(e,t){var n=t.stroke?Dhe:0;e("class","background");e("d",Rce(null,t,n,n))}function The(e,t,n){var r=t.clip?She(n,t,t):null;e("clip-path",r)}function Nhe(e,t){if(!t.clip&&t.items){var n=t.items;for(var r=0,i=n.length;r<i;++r){e.union(n[r].bounds)}}if((t.clip||t.width||t.height)&&!t.noBound){e.add(0,0).add(t.width||0,t.height||0)}Ice(e,t);return e.translate(t.x||0,t.y||0)}function jhe(e,t){var n=t.stroke?Dhe:0;e.beginPath();Rce(e,t,n,n)}var Rhe=dhe(jhe);function zhe(e,t,n){var r=this;uhe(t,(function(t){var i=t.x||0,a=t.y||0,o=t.width||0,u=t.height||0,s;e.save();e.translate(i,a);if(t.stroke||t.fill){s=t.opacity==null?1:t.opacity;if(s>0){jhe(e,t);if(t.fill&&nhe(e,t,s)){e.fill()}if(t.stroke&&ihe(e,t,s)){e.stroke()}}}if(t.clip){e.beginPath();e.rect(0,0,o,u);e.clip()}if(n)n.translate(-i,-a);uhe(t,(function(t){r.draw(e,t,n)}));if(n)n.translate(i,a);e.restore()}))}function Phe(e,t,n,r,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items){return null}var o=this,u=n*e.pixelRatio,s=r*e.pixelRatio;return she(t,(function(l){var f,c,h,d;d=l.bounds;if(d&&!d.contains(i,a))return;c=l.x||0;h=l.y||0;e.save();e.translate(c,h);c=i-c;h=a-h;f=she(l,(function(e){return Lhe(e,c,h)?o.pick(e,n,r,c,h):null}));if(!f&&t.interactive!==false&&(l.fill||l.stroke)&&Rhe(e,l,u,s)){f=l}e.restore();return f||null}))}function Lhe(e,t,n){return(e.interactive!==false||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Ihe={type:"group",tag:"g",nested:false,attr:Che,bound:Nhe,draw:zhe,pick:Phe,isect:Jce,background:Fhe,foreground:The};function Bhe(e,t){var n=e.image;if(!n||e.url&&e.url!==n.url){n={complete:false,width:0,height:0};t.loadImage(e.url).then((function(t){e.image=t;e.image.url=e.url}))}return n}function Uhe(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==false&&e.height?e.height*t.width/t.height:t.width}function qhe(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==false&&e.width?e.width*t.height/t.width:t.height}function Whe(e,t){return e==="center"?t/2:e==="right"?t:0}function Hhe(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function Ghe(e,t,n){var r=Bhe(t,n),i=t.x||0,a=t.y||0,o=Uhe(t,r),u=qhe(t,r),s=t.aspect===false?"none":"xMidYMid";i-=Whe(t.align,o);a-=Hhe(t.baseline,u);if(!r.src&&r.toDataURL){e("href",r.toDataURL(),"http://www.w3.org/1999/xlink","xlink:href")}else{e("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href")}e("transform",vhe(i,a));e("width",o);e("height",u);e("preserveAspectRatio",s)}function $he(e,t){var n=t.image,r=t.x||0,i=t.y||0,a=Uhe(t,n),o=qhe(t,n);r-=Whe(t.align,a);i-=Hhe(t.baseline,o);return e.set(r,i,r+a,i+o)}function Yhe(e,t,n){var r=this;uhe(t,(function(t){if(n&&!n.intersects(t.bounds))return;var i=Bhe(t,r),a=t.x||0,o=t.y||0,u=Uhe(t,i),s=qhe(t,i),l,f,c,h;a-=Whe(t.align,u);o-=Hhe(t.baseline,s);if(t.aspect!==false){f=i.width/i.height;c=t.width/t.height;if(f===f&&c===c&&f!==c){if(c<f){h=u/f;o+=(s-h)/2;s=h}else{h=s*f;a+=(u-h)/2;u=h}}}if(i.complete||i.toDataURL){e.globalAlpha=(l=t.opacity)!=null?l:1;e.imageSmoothingEnabled=t.smooth!==false;e.drawImage(i,a,o,u,s)}}))}var Vhe={type:"image",tag:"image",nested:false,attr:Ghe,bound:$he,draw:Yhe,pick:hhe(),isect:Zse,get:Bhe,xOffset:Whe,yOffset:Hhe};var Xhe=Ehe("line",jce,khe);function Jhe(e,t){var n=t.scaleX||1,r=t.scaleY||1;if(n!==1||r!==1){e("vector-effect","non-scaling-stroke")}e("transform",bhe(t));e("d",t.path)}function Zhe(e,t){var n=t.path;if(n==null)return true;var r=t.x||0,i=t.y||0,a=t.scaleX||1,o=t.scaleY||1,u=(t.angle||0)*Ffe,s=t.pathCache;if(!s||s.path!==n){(t.pathCache=s=Cfe(n)).path=n}if(u&&e.rotate&&e.translate){e.translate(r,i);e.rotate(u);qfe(e,s,0,0,a,o);e.rotate(-u);e.translate(-r,-i)}else{qfe(e,s,r,i,a,o)}}function Qhe(e,t){Zhe(Wce(e),t)?e.set(0,0,0,0):Ice(e,t,true);if(t.angle){e.rotate(t.angle*Ffe,t.x||0,t.y||0)}return e}var Khe={type:"path",tag:"path",nested:false,attr:Jhe,bound:Qhe,draw:lhe(Zhe),pick:phe(Zhe),isect:Vce(Zhe)};function ede(e,t){e("d",Rce(null,t))}function tde(e,t){var n,r;return Ice(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function nde(e,t){e.beginPath();Rce(e,t)}var rde={type:"rect",tag:"path",nested:false,attr:ede,bound:tde,draw:lhe(nde),pick:phe(nde),isect:Jce};function ide(e,t){e("transform",yhe(t));e("x2",t.x2!=null?t.x2-(t.x||0):0);e("y2",t.y2!=null?t.y2-(t.y||0):0)}function ade(e,t){var n,r;return Ice(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function ode(e,t,n){var r,i,a,o;if(t.stroke&&ihe(e,t,n)){r=t.x||0;i=t.y||0;a=t.x2!=null?t.x2:r;o=t.y2!=null?t.y2:i;e.beginPath();e.moveTo(r,i);e.lineTo(a,o);return true}return false}function ude(e,t,n){uhe(t,(function(t){if(n&&!n.intersects(t.bounds))return;var r=t.opacity==null?1:t.opacity;if(r&&ode(e,t,r)){e.stroke()}}))}function sde(e,t,n,r){if(!e.isPointInStroke)return false;return ode(e,t,1)&&e.isPointInStroke(n,r)}var lde={type:"rule",tag:"line",nested:false,attr:ide,bound:ade,draw:ude,pick:hhe(sde),isect:Zce};var fde=_he("shape",zce);var cde=_he("symbol",Pce,Xce);var hde;var dde={height:yde,measureWidth:gde,estimateWidth:pde,width:pde,canvas:bde};bde(true);function pde(e,t){hde=yde(e);return vde(kde(e,t))}function vde(e){return~~(.8*e.length*hde)}function gde(e,t){return yde(e)<=0?0:($ce.font=Mde(e),mde(kde(e,t)))}function mde(e){return $ce.measureText(e).width}function yde(e){return e.fontSize!=null?e.fontSize:11}function bde(e){dde.width=e&&$ce?gde:pde}function _de(e){return e.lineHeight!=null?e.lineHeight:yde(e)+2}function xde(e){return Use(e)?e.length>1?e:e[0]:e}function wde(e){return xde(e.lineBreak&&e.text&&!Use(e.text)?e.text.split(e.lineBreak):e.text)}function kde(e,t){return t==null?"":e.limit>0?Ade(e,t):t+""}function Ade(e,t){var n=+e.limit,r=t+"",i;if(dde.width===gde){$ce.font=Mde(e);i=mde}else{hde=yde(e);i=vde}if(i(r)<n)return r;var a=e.ellipsis||"…",o=e.dir==="rtl",u=0,s=r.length,l;n-=i(a);if(o){while(u<s){l=u+s>>>1;if(i(r.slice(l))>n)u=l+1;else s=l}return a+r.slice(u)}else{while(u<s){l=1+(u+s>>>1);if(i(r.slice(0,l))<n)u=l;else s=l-1}return r.slice(0,u)+a}}function Ede(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Mde(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+yde(e)+"px "+Ede(e,t)}function Ode(e){var t=e.baseline,n=yde(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:0)}var Sde={left:"start",center:"middle",right:"end"};var Dde=new Dse;function Cde(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;if(r){i=(e.theta||0)-Tfe;t+=r*Math.cos(i);n+=r*Math.sin(i)}Dde.x1=t;Dde.y1=n;return Dde}function Fde(e,t){var n=t.dx||0,r=(t.dy||0)+Ode(t),i=Cde(t),a=i.x1,o=i.y1,u=t.angle||0,s;e("text-anchor",Sde[t.align]||"start");if(u){s=vhe(a,o)+" "+ghe(u);if(n||r)s+=" "+vhe(n,r)}else{s=vhe(a+n,o+r)}e("transform",s)}function Tde(e,t,n){var r=dde.height(t),i=t.align,a=Cde(t),o=a.x1,u=a.y1,s=t.dx||0,l=(t.dy||0)+Ode(t)-Math.round(.8*r),f=wde(t),c;if(Use(f)){r+=_de(t)*(f.length-1);c=f.reduce((function(e,n){return Math.max(e,dde.width(t,n))}),0)}else{c=dde.width(t,f)}if(i==="center"){s-=c/2}else if(i==="right"){s-=c}e.set(s+=o,l+=u,s+c,l+r);if(t.angle&&!n){e.rotate(t.angle*Ffe,o,u)}else if(n===2){return e.rotatedPoints(t.angle*Ffe,o,u)}return e}function Nde(e,t,n){uhe(t,(function(t){var r=t.opacity==null?1:t.opacity,i,a,o,u,s,l,f;if(n&&!n.intersects(t.bounds)||r===0||t.fontSize<=0||t.text==null||t.text.length===0)return;e.font=Mde(t);e.textAlign=t.align||"left";i=Cde(t);a=i.x1,o=i.y1;if(t.angle){e.save();e.translate(a,o);e.rotate(t.angle*Ffe);a=o=0}a+=t.dx||0;o+=(t.dy||0)+Ode(t);l=wde(t);if(Use(l)){s=_de(t);for(u=0;u<l.length;++u){f=kde(t,l[u]);if(t.fill&&nhe(e,t,r)){e.fillText(f,a,o)}if(t.stroke&&ihe(e,t,r)){e.strokeText(f,a,o)}o+=s}}else{f=kde(t,l);if(t.fill&&nhe(e,t,r)){e.fillText(f,a,o)}if(t.stroke&&ihe(e,t,r)){e.strokeText(f,a,o)}}if(t.angle)e.restore()}))}function jde(e,t,n,r,i,a){if(t.fontSize<=0)return false;if(!t.angle)return true;var o=Cde(t),u=o.x1,s=o.y1,l=Tde(Dde,t,1),f=-t.angle*Ffe,c=Math.cos(f),h=Math.sin(f),d=c*i-h*a+(u-c*u+h*s),p=h*i+c*a+(s-h*u-c*s);return l.contains(d,p)}function Rde(e,t){var n=Tde(Dde,e,2);return Qce(t,n[0],n[1],n[2],n[3])||Qce(t,n[0],n[1],n[4],n[5])||Qce(t,n[4],n[5],n[6],n[7])||Qce(t,n[2],n[3],n[6],n[7])}var zde={type:"text",tag:"text",nested:false,attr:Fde,bound:Tde,draw:Nde,pick:hhe(jde),isect:Rde};var Pde=Ehe("trail",Lce,Ahe);var Lde={arc:xhe,area:Mhe,group:Ihe,image:Vhe,line:Xhe,path:Khe,rect:rde,rule:lde,shape:fde,symbol:cde,text:zde,trail:Pde};function Ide(e,t,n){if(!e&&typeof document!=="undefined"&&document.createElement){e=document}return e?n?e.createElementNS(n,t):e.createElement(t):null}function Bde(e,t){t=t.toLowerCase();var n=e.childNodes,r=0,i=n.length;for(;r<i;++r)if(n[r].tagName.toLowerCase()===t){return n[r]}}function Ude(e,t,n,r){var i=e.childNodes[t],a;if(!i||i.tagName.toLowerCase()!==n.toLowerCase()){a=i||null;i=Ide(e.ownerDocument,n,r);e.insertBefore(i,a)}return i}function qde(e,t){var n=e.childNodes,r=n.length;while(r>t)e.removeChild(n[--r]);return e}function Wde(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Hde(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Gde(e,t,n,r){var i=e&&e.mark,a,o;if(i&&(a=Lde[i.marktype]).tip){o=Hde(t,n);o[0]-=r[0];o[1]-=r[1];while(e=e.mark.group){o[0]-=e.x||0;o[1]-=e.y||0}e=a.tip(i.items,o)}return e}function $de(e,t){this._active=null;this._handlers={};this._loader=e||Oo();this._tooltip=t||Yde}function Yde(e,t,n,r){e.element().setAttribute("title",r||"")}var Vde=$de.prototype;Vde.initialize=function(e,t,n){this._el=e;this._obj=n||null;return this.origin(t)};Vde.element=function(){return this._el};Vde.canvas=function(){return this._el&&this._el.firstChild};Vde.origin=function(e){if(arguments.length){this._origin=e||[0,0];return this}else{return this._origin.slice()}};Vde.scene=function(e){if(!arguments.length)return this._scene;this._scene=e;return this};Vde.on=function(){};Vde.off=function(){};Vde._handlerIndex=function(e,t,n){for(var r=e?e.length:0;--r>=0;){if(e[r].type===t&&(!n||e[r].handler===n)){return r}}return-1};Vde.handlers=function(e){var t=this._handlers,n=[],r;if(e){n.push.apply(n,t[this.eventName(e)])}else{for(r in t){n.push.apply(n,t[r])}}return n};Vde.eventName=function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)};Vde.handleHref=function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((function(t){var n=new MouseEvent(e.type,e),r=Ide(null,"a");for(var i in t)r.setAttribute(i,t[i]);r.dispatchEvent(n)})).catch((function(){}))};Vde.handleTooltip=function(e,t,n){if(t&&t.tooltip!=null){t=Gde(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}};Vde.getItemBoundingClientRect=function(e){if(!(t=this.canvas()))return;var t,n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.x1+r[0]+n.left,o=i.y1+r[1]+n.top,u=i.width(),s=i.height();while(e.mark&&(e=e.mark.group)){a+=e.x||0;o+=e.y||0}return{x:a,y:o,width:u,height:s,left:a,top:o,right:a+u,bottom:o+s}};function Xde(e){this._el=null;this._bgcolor=null;this._loader=new ile(e)}var Jde=Xde.prototype;Jde.initialize=function(e,t,n,r,i){this._el=e;return this.resize(t,n,r,i)};Jde.element=function(){return this._el};Jde.canvas=function(){return this._el&&this._el.firstChild};Jde.background=function(e){if(arguments.length===0)return this._bgcolor;this._bgcolor=e;return this};Jde.resize=function(e,t,n,r){this._width=e;this._height=t;this._origin=n||[0,0];this._scale=r||1;return this};Jde.dirty=function(){};Jde.render=function(e){var t=this;t._call=function(){t._render(e)};t._call();t._call=null;return t};Jde._render=function(){};Jde.renderAsync=function(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)};Jde._load=function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then((function(e){if(e)i();n._ready=null}))}return r};Jde.sanitizeURL=function(e){return this._load("sanitizeURL",e)};Jde.loadImage=function(e){return this._load("loadImage",e)};var Zde=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"];var Qde="mousemove";var Kde="mouseout";var epe="click";function tpe(e,t){$de.call(this,e,t);this._down=null;this._touch=null;this._first=true}var npe=nle(tpe,$de);npe.initialize=function(e,t,n){var r=this._canvas=e&&Bde(e,"canvas");if(r){var i=this;this.events.forEach((function(e){r.addEventListener(e,(function(t){if(npe[e]){npe[e].call(i,t)}else{i.fire(e,t)}}))}))}return $de.prototype.initialize.call(this,e,t,n)};npe.canvas=function(){return this._canvas};npe.context=function(){return this._canvas.getContext("2d")};npe.events=Zde;npe.DOMMouseScroll=function(e){this.fire("mousewheel",e)};function rpe(e,t,n){return function(r){var i=this._active,a=this.pickEvent(r);if(a===i){this.fire(e,r)}else{if(!i||!i.exit){this.fire(n,r)}this._active=a;this.fire(t,r);this.fire(e,r)}}}function ipe(e){return function(t){this.fire(e,t);this._active=null}}npe.mousemove=rpe("mousemove","mouseover","mouseout");npe.dragover=rpe("dragover","dragenter","dragleave");npe.mouseout=ipe("mouseout");npe.dragleave=ipe("dragleave");npe.mousedown=function(e){this._down=this._active;this.fire("mousedown",e)};npe.click=function(e){if(this._down===this._active){this.fire("click",e);this._down=null}};npe.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]);if(this._first){this._active=this._touch;this._first=false}this.fire("touchstart",e,true)};npe.touchmove=function(e){this.fire("touchmove",e,true)};npe.touchend=function(e){this.fire("touchend",e,true);this._touch=null};npe.fire=function(e,t,n){var r=n?this._touch:this._active,i=this._handlers[e],a,o;t.vegaType=e;if(e===epe&&r&&r.href){this.handleHref(t,r,r.href)}else if(e===Qde||e===Kde){this.handleTooltip(t,r,e!==Kde)}if(i){for(a=0,o=i.length;a<o;++a){i[a].handler.call(this._obj,t,r)}}};npe.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){(r[n]||(r[n]=[])).push({type:e,handler:t})}return this};npe.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){r.splice(i,1)}return this};npe.pickEvent=function(e){var t=Hde(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])};npe.pick=function(e,t,n,r,i){var a=this.context(),o=Lde[e.marktype];return o.pick.call(this,a,e,t,n,r,i)};function ape(e,t){var n=t.clip;e.save();e.beginPath();if(Kse(n)){n(e)}else{var r=t.group;e.rect(0,0,r.width||0,r.height||0)}e.clip()}function ope(){return typeof window!=="undefined"?window.devicePixelRatio||1:1}var upe=ope();function spe(e,t,n,r,i,a){var o=typeof HTMLElement!=="undefined"&&e instanceof HTMLElement&&e.parentNode!=null;var u=e.getContext("2d"),s=o?upe:i,l;e.width=t*s;e.height=n*s;for(l in a){u[l]=a[l]}if(o&&s!==1){e.style.width=t+"px";e.style.height=n+"px"}u.pixelRatio=s;u.setTransform(s,0,0,s,s*r[0],s*r[1]);return e}function lpe(e){Xde.call(this,e);this._redraw=false;this._dirty=new Dse}var fpe=nle(lpe,Xde),cpe=Xde.prototype,hpe=new Dse;fpe.initialize=function(e,t,n,r,i,a){this._options=a;this._canvas=Yv(1,1);if(e){qde(e,0).appendChild(this._canvas);this._canvas.setAttribute("class","marks")}return cpe.initialize.call(this,e,t,n,r,i)};fpe.resize=function(e,t,n,r){cpe.resize.call(this,e,t,n,r);spe(this._canvas,this._width,this._height,this._origin,this._scale,this._options&&this._options.context);this._redraw=true;return this};fpe.canvas=function(){return this._canvas};fpe.context=function(){return this._canvas?this._canvas.getContext("2d"):null};fpe.dirty=function(e){var t=vpe(e.bounds,e.mark.group);this._dirty.union(t)};function dpe(e,t,n){t.expand(1).round();t.translate(-(n[0]%1),-(n[1]%1));e.beginPath();e.rect(t.x1,t.y1,t.width(),t.height());e.clip();return t}function ppe(e,t,n){return hpe.set(0,0,t,n).translate(-e[0],-e[1])}function vpe(e,t){if(t==null)return e;var n=hpe.clear().union(e);for(;t!=null;t=t.mark.group){n.translate(t.x||0,t.y||0)}return n}fpe._render=function(e){var t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty;t.save();if(this._redraw||a.empty()){this._redraw=false;a=ppe(n,r,i).expand(1)}else{a=dpe(t,a.intersect(ppe(n,r,i)),n)}this.clear(-n[0],-n[1],r,i);this.draw(t,e,a);t.restore();this._dirty.clear();return this};fpe.draw=function(e,t,n){var r=Lde[t.marktype];if(t.clip)ape(e,t);r.draw.call(this,e,t,n);if(t.clip)e.restore()};fpe.clear=function(e,t,n,r){var i=this.context();i.clearRect(e,t,n,r);if(this._bgcolor!=null){i.fillStyle=this._bgcolor;i.fillRect(e,t,n,r)}};function gpe(e,t){$de.call(this,e,t);var n=this;n._hrefHandler=ype(n,(function(e,t){if(t&&t.href)n.handleHref(e,t,t.href)}));n._tooltipHandler=ype(n,(function(e,t){n.handleTooltip(e,t,e.type!==Kde)}))}var mpe=nle(gpe,$de);mpe.initialize=function(e,t,n){var r=this._svg;if(r){r.removeEventListener(epe,this._hrefHandler);r.removeEventListener(Qde,this._tooltipHandler);r.removeEventListener(Kde,this._tooltipHandler)}this._svg=r=e&&Bde(e,"svg");if(r){r.addEventListener(epe,this._hrefHandler);r.addEventListener(Qde,this._tooltipHandler);r.addEventListener(Kde,this._tooltipHandler)}return $de.prototype.initialize.call(this,e,t,n)};mpe.canvas=function(){return this._svg};function ype(e,t){return function(n){var r=n.target,i=r.__data__;n.vegaType=n.type;i=Array.isArray(i)?i[0]:i;t.call(e._obj,n,i)}}mpe.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){var a={type:e,handler:t,listener:ype(this,t)};(r[n]||(r[n]=[])).push(a);if(this._svg){this._svg.addEventListener(n,a.listener)}}return this};mpe.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){if(this._svg){this._svg.removeEventListener(n,r[i].listener)}r.splice(i,1)}return this};function bpe(e,t,n){var r="<"+e,i,a;if(t){for(i in t){a=t[i];if(a!=null){r+=" "+i+'="'+a+'"'}}}if(n)r+=" "+n;return r+">"}function _pe(e){return"</"+e+">"}var xpe={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};var wpe={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"};var kpe=Object.keys(wpe);var Ape=xpe.xmlns;function Epe(e){Xde.call(this,e);this._dirtyID=0;this._dirty=[];this._svg=null;this._root=null;this._defs=null}var Mpe=nle(Epe,Xde);var Ope=Xde.prototype;Mpe.initialize=function(e,t,n,r){if(e){this._svg=Ude(e,0,"svg",Ape);this._svg.setAttribute("class","marks");qde(e,1);this._root=Ude(this._svg,0,"g",Ape);qde(this._svg,1)}this._defs={gradient:{},clipping:{}};this.background(this._bgcolor);return Ope.initialize.call(this,e,t,n,r)};Mpe.background=function(e){if(arguments.length&&this._svg){this._svg.style.setProperty("background-color",e)}return Ope.background.apply(this,arguments)};Mpe.resize=function(e,t,n,r){Ope.resize.call(this,e,t,n,r);if(this._svg){this._svg.setAttribute("width",this._width*this._scale);this._svg.setAttribute("height",this._height*this._scale);this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height);this._root.setAttribute("transform","translate("+this._origin+")")}this._dirty=[];return this};Mpe.canvas=function(){return this._svg};Mpe.svg=function(){if(!this._svg)return null;var e={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var t in xpe){e[t]=xpe[t]}var n=!this._bgcolor?"":bpe("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+_pe("rect");return bpe("svg",e)+n+this._svg.innerHTML+_pe("svg")};Mpe._render=function(e){if(this._dirtyCheck()){if(this._dirtyAll)this._resetDefs();this.draw(this._root,e);qde(this._root,1)}this.updateDefs();this._dirty=[];++this._dirtyID;return this};Mpe.updateDefs=function(){var e=this._svg,t=this._defs,n=t.el,r=0,i;for(i in t.gradient){if(!n)t.el=n=Ude(e,0,"defs",Ape);r=Spe(n,t.gradient[i],r)}for(i in t.clipping){if(!n)t.el=n=Ude(e,0,"defs",Ape);r=Dpe(n,t.clipping[i],r)}if(n){if(r===0){e.removeChild(n);t.el=null}else{qde(n,r)}}};function Spe(e,t,n){var r,i,a;if(t.gradient==="radial"){var o=Ude(e,n++,"pattern",Ape);o.setAttribute("id",Tse+t.id);o.setAttribute("viewBox","0,0,1,1");o.setAttribute("width","100%");o.setAttribute("height","100%");o.setAttribute("preserveAspectRatio","xMidYMid slice");o=Ude(o,0,"rect",Ape);o.setAttribute("width","1");o.setAttribute("height","1");o.setAttribute("fill","url("+Ipe()+"#"+t.id+")");e=Ude(e,n++,"radialGradient",Ape);e.setAttribute("id",t.id);e.setAttribute("fx",t.x1);e.setAttribute("fy",t.y1);e.setAttribute("fr",t.r1);e.setAttribute("cx",t.x2);e.setAttribute("cy",t.y2);e.setAttribute("r",t.r2)}else{e=Ude(e,n++,"linearGradient",Ape);e.setAttribute("id",t.id);e.setAttribute("x1",t.x1);e.setAttribute("x2",t.x2);e.setAttribute("y1",t.y1);e.setAttribute("y2",t.y2)}for(r=0,i=t.stops.length;r<i;++r){a=Ude(e,r,"stop",Ape);a.setAttribute("offset",t.stops[r].offset);a.setAttribute("stop-color",t.stops[r].color)}qde(e,r);return n}function Dpe(e,t,n){var r;e=Ude(e,n,"clipPath",Ape);e.setAttribute("id",t.id);if(t.path){r=Ude(e,0,"path",Ape);r.setAttribute("d",t.path)}else{r=Ude(e,0,"rect",Ape);r.setAttribute("x",0);r.setAttribute("y",0);r.setAttribute("width",t.width);r.setAttribute("height",t.height)}return n+1}Mpe._resetDefs=function(){var e=this._defs;e.gradient={};e.clipping={}};Mpe.dirty=function(e){if(e.dirty!==this._dirtyID){e.dirty=this._dirtyID;this._dirty.push(e)}};Mpe.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID};Mpe._dirtyCheck=function(){this._dirtyAll=true;var e=this._dirty;if(!e.length||!this._dirtyID)return true;var t=++this._dirtyID,n,r,i,a,o,u,s;for(o=0,u=e.length;o<u;++o){n=e[o];r=n.mark;if(r.marktype!==i){i=r.marktype;a=Lde[i]}if(r.zdirty&&r.dirty!==t){this._dirtyAll=false;Cpe(n,t);r.items.forEach((function(e){e.dirty=t}))}if(r.zdirty)continue;if(n.exit){if(a.nested&&r.items.length){s=r.items[0];if(s._svg)this._update(a,s._svg,s)}else if(n._svg){s=n._svg.parentNode;if(s)s.removeChild(n._svg)}n._svg=null;continue}n=a.nested?r.items[0]:n;if(n._update===t)continue;if(!n._svg||!n._svg.ownerSVGElement){this._dirtyAll=false;Cpe(n,t)}else{this._update(a,n._svg,n)}n._update=t}return!this._dirtyAll};function Cpe(e,t){for(;e&&e.dirty!==t;e=e.mark.group){e.dirty=t;if(e.mark&&e.mark.dirty!==t){e.mark.dirty=t}else return}}Mpe.draw=function(e,t,n){if(!this.isDirty(t))return t._svg;var r=this,i=this._svg,a=Lde[t.marktype],o=t.interactive===false?"none":null,u=a.tag==="g",s=null,l=0,f;f=Tpe(t,e,n,"g",i);f.setAttribute("class",Wde(t));if(!u){f.style.setProperty("pointer-events",o)}if(t.clip){f.setAttribute("clip-path",She(r,t,t.group))}else{f.removeAttribute("clip-path")}function c(e){var t=r.isDirty(e),n=Tpe(e,f,s,a.tag,i);if(t){r._update(a,n,e);if(u)Fpe(r,n,e)}s=n;++l}if(a.nested){if(t.items.length)c(t.items[0])}else{uhe(t,c)}qde(f,l);return f};function Fpe(e,t,n){t=t.lastChild;var r,i=0;uhe(n,(function(n){r=e.draw(t,n,r);++i}));qde(t,1+i)}function Tpe(e,t,n,r,i){var a=e._svg,o;if(!a){o=t.ownerDocument;a=Ide(o,r,Ape);e._svg=a;if(e.mark){a.__data__=e;a.__values__={fill:"default"};if(r==="g"){var u=Ide(o,"path",Ape);u.setAttribute("class","background");a.appendChild(u);u.__data__=e;var s=Ide(o,"g",Ape);a.appendChild(s);s.__data__=e}}}if(a.ownerSVGElement!==i||Npe(a,n)){t.insertBefore(a,n?n.nextSibling:t.firstChild)}return a}function Npe(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}var jpe=null,Rpe=null;var zpe={group:function(e,t,n){Rpe=t.__values__;jpe=t.childNodes[1];e.foreground(Lpe,n,this);jpe=t.childNodes[0];e.background(Lpe,n,this);var r=n.mark.interactive===false?"none":null;if(r!==Rpe.events){jpe.style.setProperty("pointer-events",r);Rpe.events=r}},image:function(e,t,n){if(n.smooth===false){Ppe(t,"image-rendering","optimizeSpeed");Ppe(t,"image-rendering","pixelated")}else{Ppe(t,"image-rendering",null)}},text:function(e,t,n){var r=wde(n),i,a,o,u;if(Use(r)){a=r.map((function(e){return kde(n,e)}));i=a.join("\n");if(i!==Rpe.text){qde(t,0);o=t.ownerDocument;u=_de(n);a.forEach((function(e,r){var i=Ide(o,"tspan",Ape);i.__data__=n;i.textContent=e;if(r){i.setAttribute("x",0);i.setAttribute("dy",u)}t.appendChild(i)}));Rpe.text=i}}else{a=kde(n,r);if(a!==Rpe.text){t.textContent=a;Rpe.text=a}}Ppe(t,"font-family",Ede(n));Ppe(t,"font-size",yde(n)+"px");Ppe(t,"font-style",n.fontStyle);Ppe(t,"font-variant",n.fontVariant);Ppe(t,"font-weight",n.fontWeight)}};function Ppe(e,t,n){if(n!==Rpe[t]){if(n==null){e.style.removeProperty(t)}else{e.style.setProperty(t,n+"")}Rpe[t]=n}}Mpe._update=function(e,t,n){jpe=t;Rpe=t.__values__;e.attr(Lpe,n,this);var r=zpe[e.type];if(r)r.call(this,e,t,n);this.style(jpe,n)};function Lpe(e,t,n){if(t===Rpe[e])return;if(t!=null){if(n){jpe.setAttributeNS(n,e,t)}else{jpe.setAttribute(e,t)}}else{if(n){jpe.removeAttributeNS(n,e)}else{jpe.removeAttribute(e)}}Rpe[e]=t}Mpe.style=function(e,t){if(t==null)return;var n,r,i,a,o;for(n=0,r=kpe.length;n<r;++n){i=kpe[n];o=t[i];if(i==="font"){o=Ede(t)}if(o===Rpe[i])continue;a=wpe[i];if(o==null){if(a==="fill"){e.style.setProperty(a,"none")}else{e.style.removeProperty(a)}}else{if(Nse(o)){o=jse(o,this._defs.gradient,Ipe())}e.style.setProperty(a,o+"")}Rpe[i]=o}};function Ipe(){var e;return typeof window==="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Bpe(e){Xde.call(this,e);this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""};this._defs={gradient:{},clipping:{}}}var Upe=nle(Bpe,Xde);var qpe=Xde.prototype;Upe.resize=function(e,t,n,r){qpe.resize.call(this,e,t,n,r);var i=this._origin,a=this._text;var o={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var u in xpe){o[u]=xpe[u]}a.head=bpe("svg",o);var s=this._bgcolor;if(s==="transparent"||s==="none")s=null;if(s){a.bg=bpe("rect",{width:this._width,height:this._height,style:"fill: "+s+";"})+_pe("rect")}else{a.bg=""}a.root=bpe("g",{transform:"translate("+i+")"});a.foot=_pe("g")+_pe("svg");return this};Upe.background=function(){var e=qpe.background.apply(this,arguments);if(arguments.length&&this._text.head){this.resize(this._width,this._height,this._origin,this._scale)}return e};Upe.svg=function(){var e=this._text;return e.head+e.bg+e.defs+e.root+e.body+e.foot};Upe._render=function(e){this._text.body=this.mark(e);this._text.defs=this.buildDefs();return this};Upe.buildDefs=function(){var e=this._defs,t="",n,r,i,a,o;for(r in e.gradient){i=e.gradient[r];o=i.stops;if(i.gradient==="radial"){t+=bpe(a="pattern",{id:Tse+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"});t+=bpe("rect",{width:"1",height:"1",fill:"url(#"+r+")"})+_pe("rect");t+=_pe(a);t+=bpe(a="radialGradient",{id:r,fx:i.x1,fy:i.y1,fr:i.r1,cx:i.x2,cy:i.y2,r:i.r2})}else{t+=bpe(a="linearGradient",{id:r,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2})}for(n=0;n<o.length;++n){t+=bpe("stop",{offset:o[n].offset,"stop-color":o[n].color})+_pe("stop")}t+=_pe(a)}for(r in e.clipping){i=e.clipping[r];t+=bpe("clipPath",{id:r});if(i.path){t+=bpe("path",{d:i.path})+_pe("path")}else{t+=bpe("rect",{x:0,y:0,width:i.width,height:i.height})+_pe("rect")}t+=_pe("clipPath")}return t.length>0?bpe("defs")+t+_pe("defs"):""};var Wpe;function Hpe(e,t,n,r){Wpe[r||e]=t}Upe.attributes=function(e,t){Wpe={};e(Hpe,t,this);return Wpe};Upe.href=function(e){var t=this,n=e.href,r;if(n){if(r=t._hrefs&&t._hrefs[n]){return r}else{t.sanitizeURL(n).then((function(e){e["xlink:href"]=e.href;e.href=null;(t._hrefs||(t._hrefs={}))[n]=e}))}}return null};Upe.mark=function(e){var t=this,n=Lde[e.marktype],r=n.tag,i=this._defs,a="",o;if(r!=="g"&&e.interactive===false){o='style="pointer-events: none;"'}a+=bpe("g",{class:Wde(e),"clip-path":e.clip?She(t,e,e.group):null},o);function u(u){var s=t.href(u);if(s)a+=bpe("a",s);o=r!=="g"?Gpe(u,e,r,i):null;a+=bpe(r,t.attributes(n.attr,u),o);if(r==="text"){var l=wde(u);if(Use(l)){var f={x:0,dy:_de(u)};for(var c=0;c<l.length;++c){a+=bpe("tspan",c?f:null)+$pe(kde(u,l[c]))+_pe("tspan")}}else{a+=$pe(kde(u,l))}}else if(r==="g"){a+=bpe("path",t.attributes(n.background,u),Gpe(u,e,"bgrect",i))+_pe("path");a+=bpe("g",t.attributes(n.foreground,u))+t.markGroup(u)+_pe("g")}a+=_pe(r);if(s)a+=_pe("a")}if(n.nested){if(e.items&&e.items.length)u(e.items[0])}else{uhe(e,u)}return a+_pe("g")};Upe.markGroup=function(e){var t=this,n="";uhe(e,(function(e){n+=t.mark(e)}));return n};function Gpe(e,t,n,r){if(e==null)return"";var i,a,o,u,s,l="";if(n==="bgrect"&&t.interactive===false){l+="pointer-events: none; "}if(n==="image"){if(e.smooth===false){l+="image-rendering: optimizeSpeed; image-rendering: pixelated; "}}if(n==="text"){l+="font-family: "+Ede(e)+"; ";l+="font-size: "+yde(e)+"px; ";if(e.fontStyle)l+="font-style: "+e.fontStyle+"; ";if(e.fontVariant)l+="font-variant: "+e.fontVariant+"; ";if(e.fontWeight)l+="font-weight: "+e.fontWeight+"; "}for(i=0,a=kpe.length;i<a;++i){o=kpe[i];u=wpe[o];s=e[o];if(s==null){if(u==="fill"){l+="fill: none; "}}else if(s==="transparent"&&(u==="fill"||u==="stroke")){l+=u+": none; "}else{if(Nse(s)){s=jse(s,r.gradient,"")}l+=u+": "+s+"; "}}return l?'style="'+l.trim()+'"':null}function $pe(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ype(e,t,n){var r=[],i=(new Dse).union(t),a=e.marktype;return a?Vpe(e,i,n,r):a==="group"?Jpe(e,i,n,r):Ise("Intersect scene must be mark node or group item.")}function Vpe(e,t,n,r){if(Xpe(e,t,n)){var i=e.items,a=e.marktype,o=i.length;var u=0;if(a==="group"){for(;u<o;++u){Jpe(i[u],t,n,r)}}else{for(var s=Lde[a].isect;u<o;++u){var l=i[u];if(Zpe(l,t,s))r.push(l)}}}return r}function Xpe(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==false&&(!n||n(e)))}function Jpe(e,t,n,r){if(n&&n(e.mark)&&Zpe(e,t,Lde.group.isect)){r.push(e)}var i=e.items,a=i&&i.length;if(a){var o=e.x||0,u=e.y||0;t.translate(-o,-u);for(var s=0;s<a;++s){Vpe(i[s],t,n,r)}t.translate(o,u)}return r}function Zpe(e,t,n){var r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}var Qpe=new Dse;function Kpe(e,t,n){if(!e)return[];var r=e[0],i=e[1],a=(new Dse).set(r[0],r[1],i[0],i[1]),o=n||this.context.dataflow.scenegraph().root;return Ype(o,a,eve(t))}function eve(e){var t=null;if(e){var n=Fte(e.marktype),r=Fte(e.markname);t=function(e){return(!n.length||n.some((function(t){return e.marktype===t})))&&(!r.length||r.some((function(t){return e.name===t})))}}return t}function tve(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function nve(){return tve(this.context.dataflow,"warn",arguments)}function rve(){return tve(this.context.dataflow,"info",arguments)}function ive(){return tve(this.context.dataflow,"debug",arguments)}function ave(){var e=[].slice.call(arguments);e.unshift({});return Rte.apply(null,e)}function ove(e,t){return e===t||e!==e&&t!==t?true:ete(e)?ete(t)&&e.length===t.length?uve(e,t):false:tte(e)&&tte(t)?sve(e,t):false}function uve(e,t){for(var n=0,r=e.length;n<r;++n){if(!ove(e[n],t[n]))return false}return true}function sve(e,t){for(var n in e){if(!ove(e[n],t[n]))return false}return true}function lve(e){return function(t){return sve(e,t)}}function fve(e,t,n,r,i,a){var o=this.context.dataflow,u=this.context.data[e],s=u.input,l=u.changes,f=o.stamp(),c,h;if(o._trigger===false||!(s.value.length||t||r)){return 0}if(!l||l.stamp<f){u.changes=l=o.changeset();l.stamp=f;o.runAfter((function(){u.modified=true;o.pulse(s,l).run()}),true,1)}if(n){c=n===true?fte:ete(n)||sne(n)?n:lve(n);l.remove(c)}if(t){l.insert(t)}if(r){c=lve(r);if(s.value.some(c)){l.remove(c)}else{l.insert(r)}}if(i){for(h in a){l.modify(i,h,a[h])}}return 1}function cve(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function hve(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}function dve(e,t,n,r,i){e=Foe(e,(i||this).context);var a=zse(t,n);var o=e.domain(),u=o[0],s=hte(o),l=ute;if(!(s-u)){e=(e.interpolator?moe("sequential")().interpolator(e.interpolator()):moe("linear")().interpolate(e.interpolate()).range(e.range())).domain([u=0,s=1])}else{l=woe(e,u,s)}if(e.ticks){o=e.ticks(+r||15);if(u!==o[0])o.unshift(u);if(s!==hte(o))o.push(s)}o.forEach((function(t){return a.stop(l(t),e(t))}));return a}function pve(e,t,n){var r=Foe(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}function vve(e){var t=null;return function(n){return n?qfe(n,t=t||Cfe(e)):e}}var gve={};function mve(e){return e.data}function yve(e,t){var n=ure.call(t,e);return n.root&&n.root.lookup||gve}function bve(e,t,n){var r=yve(e,this),i=r[t],a=r[n];return i&&a?i.path(a).map(mve):undefined}function _ve(e,t){var n=yve(e,this)[t];return n?n.ancestors().map(mve):undefined}var xve=typeof window!=="undefined"&&window||null;function wve(){return xve?xve.screen:{}}function kve(){return xve?[xve.innerWidth,xve.innerHeight]:[undefined,undefined]}function Ave(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[undefined,undefined]}var Eve=":";var Mve="@";var Ove="%";var Sve="$";function Dve(e,t,n,r){if(t[0].type!==Lee){Qee("First argument to data functions must be a string literal.")}var i=t[0].value,a=Eve+i;if(!Lte(a,r)){try{r[a]=n.getData(i).tuplesRef()}catch(o){}}}function Cve(e,t,n,r){if(t[0].type!==Lee)Qee("First argument to indata must be a string literal.");if(t[1].type!==Lee)Qee("Second argument to indata must be a string literal.");var i=t[0].value,a=t[1].value,o=Mve+a;if(!Lte(o,r)){r[o]=n.getData(i).indataRef(n,a)}}function Fve(e,t,n,r){if(t[0].type===Lee){Tve(n,r,t[0].value)}else if(t[0].type===Iee){for(e in n.scales){Tve(n,r,e)}}}function Tve(e,t,n){var r=Ove+n;if(!Lte(t,r)){try{t[r]=e.scaleRef(n)}catch(i){}}}var Nve={random:function(){return Une()},cumulativeNormal:Yne,cumulativeLogNormal:Qne,cumulativeUniform:nre,densityNormal:$ne,densityLogNormal:Zne,densityUniform:tre,quantileNormal:Vne,quantileLogNormal:Kne,quantileUniform:rre,sampleNormal:Gne,sampleLogNormal:Jne,sampleUniform:ere,isArray:ete,isBoolean:qte,isDate:Wte,isDefined:function(e){return e!==undefined},isNumber:Hte,isObject:tte,isRegExp:Gte,isString:nte,isTuple:sne,isValid:function(e){return e!=null&&e===e},toBoolean:Jte,toDate:Qte,toNumber:dte,toString:Kte,flush:Ite,lerp:$te,merge:ave,pad:Vte,peek:hte,span:Xte,inrange:Ute,truncate:tne,rgb:pA,lab:RA,hcl:qA,hsl:xA,luminance:are,contrast:ore,sequence:Cl,format:dre,utcFormat:vre,utcParse:mre,utcOffset:xd,utcSequence:Ad,timeFormat:pre,timeParse:gre,timeOffset:_d,timeSequence:kd,timeUnitSpecifier:Md,monthFormat:_re,monthAbbrevFormat:xre,dayFormat:wre,dayAbbrevFormat:kre,quarter:Dte,utcquarter:Cte,warn:nve,info:rve,debug:ive,extent:zte,inScope:Sse,intersect:Kpe,clampRange:Tte,pinchDistance:cve,pinchAngle:hve,screen:wve,containerSize:Ave,windowSize:kve,bandspace:Roe,setdata:lre,pathShape:vve,panLinear:_te,panLog:xte,panPow:wte,panSymlog:kte,zoomLinear:Ete,zoomLog:Mte,zoomPow:Ote,zoomSymlog:Ste,encode:fre,modify:fve};var jve=["view","item","group","xy","x","y"],Rve="event.vega.",zve="this.",Pve={};function Lve(e){var t=rne(e);jve.forEach((function(e){return t[e]=Rve+e}));for(var n in Nve){t[n]=zve+n}return t}function Ive(e,t,n){if(arguments.length===1){return Nve[e]}Nve[e]=t;if(n)Pve[e]=n;if(Uve)Uve.functions[e]=zve+e;return this}Ive("bandwidth",joe,Fve);Ive("copy",zoe,Fve);Ive("domain",Noe,Fve);Ive("range",Toe,Fve);Ive("invert",Loe,Fve);Ive("scale",Poe,Fve);Ive("gradient",dve,Fve);Ive("geoArea",Ese,Fve);Ive("geoBounds",Mse,Fve);Ive("geoCentroid",Ose,Fve);Ive("geoShape",pve,Fve);Ive("indata",sre,Cve);Ive("data",ure,Dve);Ive("treePath",bve,Dve);Ive("treeAncestors",_ve,Dve);Ive("vlSelectionTest",f5,M5);Ive("vlSelectionResolve",c5,M5);var Bve={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_["+rte(Sve+e)+"]"},functions:Lve,constants:Jee,visitors:Pve};var Uve=ane(Bve);function qve(e,t,n){var r={},i,a;try{e=cee(e)?e:hee(e)+"";i=V2(e)}catch(o){uee("Expression parse error: "+e)}i.visit((function e(n){if(n.type!==V0)return;var i=n.callee.name,a=Bve.visitors[i];if(a)a(i,n.arguments,t,r)}));a=Uve(i);a.globals.forEach((function(e){var n=Sve+e;if(!See(r,n)&&t.getSignal(e)){r[n]=t.signalRef(e)}}));return{$expr:n?n+"return("+a.code+");":a.code,$fields:a.fields,$params:r}}function Wve(e,t,n,r){this.id=-1;this.type=e;this.value=t;this.params=n;if(r)this.parent=r}function Hve(e,t,n,r){return new Wve(e,t,n,r)}function Gve(e,t){return Hve("operator",e,t)}function $ve(e){var t={$ref:e.id};if(e.id<0)(e.refs=e.refs||[]).push(t);return t}function Yve(e,t){return t?{$field:e,$name:t}:{$field:e}}var Vve=Yve("key");function Xve(e,t){return{$compare:e,$order:t}}function Jve(e,t){var n={$key:e};if(t)n.$flat=true;return n}var Zve="ascending";var Qve="descending";function Kve(e){return!fee(e)?"":(e.order===Qve?"-":"+")+ege(e.op,e.field)}function ege(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var tge="scope";var nge="view";function rge(e){return e&&e.signal}function ige(e){return e&&e.expr}function age(e){if(rge(e))return true;if(fee(e))for(var t in e){if(age(e[t]))return true}return false}function oge(e,t){return e!=null?e:t}function uge(e){return e&&e.signal||e}var sge="timer";function lge(e,t){var n=e.merge?cge:e.stream?hge:e.type?dge:uee("Invalid stream specification: "+hee(e));return n(e,t)}function fge(e){return e===tge?nge:e||nge}function cge(e,t){var n=e.merge.map((function(e){return lge(e,t)})),r=pge({merge:n},e,t);return t.addStream(r).id}function hge(e,t){var n=lge(e.stream,t),r=pge({stream:n},e,t);return t.addStream(r).id}function dge(e,t){var n,r;if(e.type===sge){n=t.event(sge,e.throttle);e={between:e.between,filter:e.filter}}else{n=t.event(fge(e.source),e.type)}r=pge({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function pge(e,t,n){var r=t.between;if(r){if(r.length!==2){uee('Stream "between" parameter must have 2 entries: '+hee(t))}e.between=[lge(r[0],n),lge(r[1],n)]}r=t.filter?[].concat(t.filter):[];if(t.marktype||t.markname||t.markrole){r.push(vge(t.marktype,t.markname,t.markrole))}if(t.source===tge){r.push("inScope(event.item)")}if(r.length){e.filter=qve("("+r.join(")&&(")+")").$expr}if((r=t.throttle)!=null){e.throttle=+r}if((r=t.debounce)!=null){e.debounce=+r}if(t.consume){e.consume=true}return e}function vge(e,t,n){var r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}function gge(e,t,n){Oge=t||mge;Sge=n||Dge;return Tge(e.trim()).map(Nge)}var mge="view",yge="[",bge="]",_ge="{",xge="}",wge=":",kge=",",Age="@",Ege=">",Mge=/[[\]{}]/,Oge,Sge,Dge={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function Cge(e){return Sge[e]}function Fge(e,t,n,r,i){var a=0,o=e.length,u;for(;t<o;++t){u=e[t];if(!a&&u===n)return t;else if(i&&i.indexOf(u)>=0)--a;else if(r&&r.indexOf(u)>=0)++a}return t}function Tge(e){var t=[],n=0,r=e.length,i=0;while(i<r){i=Fge(e,i,kge,yge+_ge,bge+xge);t.push(e.substring(n,i).trim());n=++i}if(t.length===0){throw"Empty event selector: "+e}return t}function Nge(e){return e[0]==="["?jge(e):Rge(e)}function jge(e){var t=e.length,n=1,r,i;n=Fge(e,n,bge,yge,bge);if(n===t){throw"Empty between selector: "+e}r=Tge(e.substring(1,n));if(r.length!==2){throw"Between selector must have two elements: "+e}e=e.slice(n+1).trim();if(e[0]!==Ege){throw"Expected '>' after between selector: "+e}r=r.map(Nge);i=Nge(e.slice(1).trim());if(i.between){return{between:r,stream:i}}else{i.between=r}return i}function Rge(e){var t={source:Oge},n=[],r=[0,0],i=0,a=0,o=e.length,u=0,s,l;if(e[o-1]===xge){u=e.lastIndexOf(_ge);if(u>=0){try{r=zge(e.substring(u+1,o-1))}catch(f){throw"Invalid throttle specification: "+e}e=e.slice(0,u).trim();o=e.length}else throw"Unmatched right brace: "+e;u=0}if(!o)throw e;if(e[0]===Age)i=++u;s=Fge(e,u,wge);if(s<o){n.push(e.substring(a,s).trim());a=u=++s}u=Fge(e,u,yge);if(u===o){n.push(e.substring(a,o).trim())}else{n.push(e.substring(a,u).trim());l=[];a=++u;if(a===o)throw"Unmatched left bracket: "+e}while(u<o){u=Fge(e,u,bge);if(u===o)throw"Unmatched left bracket: "+e;l.push(e.substring(a,u).trim());if(u<o-1&&e[++u]!==yge)throw"Expected left bracket: "+e;a=++u}if(!(o=n.length)||Mge.test(n[o-1])){throw"Invalid event selector: "+e}if(o>1){t.type=n[1];if(i){t.markname=n[0].slice(1)}else if(Cge(n[0])){t.marktype=n[0]}else{t.source=n[0]}}else{t.type=n[0]}if(t.type.slice(-1)==="!"){t.consume=true;t.type=t.type.slice(0,-1)}if(l!=null)t.filter=l;if(r[0])t.throttle=r[0];if(r[1])t.debounce=r[1];return t}function zge(e){var t=e.split(kge);if(!e.length||t.length>2)throw e;return t.map((function(t){var n=+t;if(n!==n)throw e;return n}))}var Pge="var datum=event.item&&event.item.datum;";function Lge(e,t,n){var r=e.events,i=e.update,a=e.encode,o=[],u={target:n};if(!r){uee("Signal update missing events specification.")}if(cee(r)){r=gge(r,t.isSubscope()?tge:nge)}r=Eee(r).filter((function(e){return e.signal||e.scale?(o.push(e),0):1}));if(o.length>1){o=[Bge(o)]}if(r.length){o.push(r.length>1?{merge:r}:r[0])}if(a!=null){if(i)uee("Signal encode and update are mutually exclusive.");i="encode(item(),"+hee(a)+")"}u.update=cee(i)?qve(i,t,Pge):i.expr!=null?qve(i.expr,t,Pge):i.value!=null?i.value:i.signal!=null?{$expr:"_.value",$params:{value:t.signalRef(i.signal)}}:uee("Invalid signal update specification.");if(e.force){u.options={force:true}}o.forEach((function(e){t.addUpdate(Mee(Ige(e,t),u))}))}function Ige(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):lge(e,t)}}function Bge(e){return{signal:"["+e.map((function(e){return e.scale?'scale("'+e.scale+'")':e.signal}))+"]"}}function Uge(e,t){var n=t.getSignal(e.name),r=e.update;if(e.init){if(r){uee("Signals can not include both init and update expressions.")}else{r=e.init;n.initonly=true}}if(r){r=qve(r,t);n.update=r.$expr;n.params=r.$params}if(e.on){e.on.forEach((function(e){Lge(e,t,n.id)}))}}function qge(e){return function(t,n,r){return Hve(e,n,t||undefined,r)}}var Wge=qge("aggregate");var Hge=qge("axisticks");var Gge=qge("bound");var $ge=qge("collect");var Yge=qge("compare");var Vge=qge("datajoin");var Xge=qge("encode");var Jge=qge("expression");var Zge=qge("facet");var Qge=qge("field");var Kge=qge("key");var eme=qge("legendentries");var tme=qge("load");var nme=qge("mark");var rme=qge("multiextent");var ime=qge("multivalues");var ame=qge("overlap");var ome=qge("params");var ume=qge("prefacet");var sme=qge("projection");var lme=qge("proxy");var fme=qge("relay");var cme=qge("render");var hme=qge("scale");var dme=qge("sieve");var pme=qge("sortitems");var vme=qge("viewlayout");var gme=qge("values");var mme=0;var yme={min:"min",max:"max",count:"sum"};function bme(e,t){var n=e.type||"linear";if(!KO(n)){uee("Unrecognized scale type: "+hee(n))}t.addScale(e.name,{type:n,domain:undefined})}function _me(e,t){var n=t.getScale(e.name).params,r;n.domain=Ame(e.domain,e,t);if(e.range!=null){n.range=zme(e,t,n)}if(e.interpolate!=null){Rme(e.interpolate,n)}if(e.nice!=null){n.nice=jme(e.nice)}if(e.bins!=null){n.bins=Nme(e.bins,t)}for(r in e){if(See(n,r)||r==="name")continue;n[r]=xme(e[r],t)}}function xme(e,t){return!fee(e)?e:e.signal?t.signalRef(e.signal):uee("Unsupported object: "+hee(e))}function wme(e,t){return e.signal?t.signalRef(e.signal):e.map((function(e){return xme(e,t)}))}function kme(e){uee("Can not find data set: "+hee(e))}function Ame(e,t,n){if(!e){if(t.domainMin!=null||t.domainMax!=null){uee("No scale domain defined for domainMin/domainMax to override.")}return}return e.signal?n.signalRef(e.signal):(lee(e)?Eme:e.fields?Ome:Mme)(e,t,n)}function Eme(e,t,n){return e.map((function(e){return xme(e,n)}))}function Mme(e,t,n){var r=n.getData(e.data);if(!r)kme(e.data);return nS(t.type)?r.valuesRef(n,e.field,Cme(e.sort,false)):oS(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Ome(e,t,n){var r=e.data,i=e.fields.reduce((function(e,t){t=cee(t)?{data:r,field:t}:lee(t)||t.signal?Sme(t,n):t;e.push(t);return e}),[]);return(nS(t.type)?Dme:oS(t.type)?Fme:Tme)(e,n,i)}function Sme(e,t){var n="_:vega:_"+mme++,r=$ge({});if(lee(e)){r.value={$ingest:e}}else if(e.signal){var i="setdata("+hee(n)+","+e.signal+")";r.params.input=t.signalRef(i)}t.addDataPipeline(n,[r,dme({})]);return{data:n,field:"data"}}function Dme(e,t,n){var r=Cme(e.sort,true),i,a,o,u,s;i=n.map((function(e){var n=t.getData(e.data);if(!n)kme(e.data);return n.countsRef(t,e.field,r)}));a={groupby:Vve,pulse:i};if(r){o=r.op||"count";s=r.field?ege(o,r.field):"count";a.ops=[yme[o]];a.fields=[t.fieldRef(s)];a.as=[s]}o=t.add(Wge(a));u=t.add($ge({pulse:$ve(o)}));s=t.add(gme({field:Vve,sort:t.sortRef(r),pulse:$ve(u)}));return $ve(s)}function Cme(e,t){if(e){if(!e.field&&!e.op){if(fee(e))e.field="key";else e={field:"key"}}else if(!e.field&&e.op!=="count"){uee("No field provided for sort aggregate op: "+e.op)}else if(t&&e.field){if(e.op&&!yme[e.op]){uee("Multiple domain scales can not be sorted using "+e.op)}}}return e}function Fme(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);if(!n)kme(e.data);return n.domainRef(t,e.field)}));return $ve(t.add(ime({values:r})))}function Tme(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);if(!n)kme(e.data);return n.extentRef(t,e.field)}));return $ve(t.add(rme({extents:r})))}function Nme(e,t){return e.signal||lee(e)?wme(e,t):t.objectProperty(e)}function jme(e){return fee(e)?{interval:xme(e.interval),step:xme(e.step)}:xme(e)}function Rme(e,t){t.interpolate=xme(e.type||e);if(e.gamma!=null){t.interpolateGamma=xme(e.gamma)}}function zme(e,t,n){var r=e.range,i=t.config.range;if(r.signal){return t.signalRef(r.signal)}else if(cee(r)){if(i&&See(i,r)){e=Mee({},e,{range:i[r]});return zme(e,t,n)}else if(r==="width"){r=[0,{signal:"width"}]}else if(r==="height"){r=nS(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]}else{uee("Unrecognized scale range value: "+hee(r))}}else if(r.scheme){n.scheme=lee(r.scheme)?wme(r.scheme,t):xme(r.scheme,t);if(r.extent)n.schemeExtent=wme(r.extent,t);if(r.count)n.schemeCount=xme(r.count,t);return}else if(r.step){n.rangeStep=xme(r.step,t);return}else if(nS(e.type)&&!lee(r)){return Ame(r,e,t)}else if(!lee(r)){uee("Unsupported range type: "+hee(r))}return r.map((function(e){return(lee(e)?wme:xme)(e,t)}))}function Pme(e,t){var n=t.config.projection||{},r={};for(var i in e){if(i==="name")continue;r[i]=Lme(e[i],i,t)}for(i in n){if(r[i]==null){r[i]=Lme(n[i],i,t)}}t.addProjection(e.name,r)}function Lme(e,t,n){return lee(e)?e.map((function(e){return Lme(e,t,n)})):!fee(e)?e:e.signal?n.signalRef(e.signal):t==="fit"?e:uee("Unsupported parameter object: "+hee(e))}var Ime="top";var Bme="left";var Ume="right";var qme="bottom";var Wme="center";var Hme="vertical";var Gme="start";var $me="middle";var Yme="end";var Vme="index";var Xme="label";var Jme="offset";var Zme="perc";var Qme="perc2";var Kme="size";var eye="value";var tye="guide-label";var nye="guide-title";var rye="group-title";var iye="group-subtitle";var aye="symbol";var oye="gradient";var uye="discrete";var sye=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"];var lye={name:1,style:1,interactive:1};var fye={value:0};var cye={value:1};var hye=Dee(["rule"]),dye=Dee(["group","image","rect"]);function pye(e,t){var n="";if(hye[t])return n;if(e.x2){if(e.x){if(dye[t]){n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"}n+="o.width=o.x2-o.x;"}else{n+="o.x=o.x2-(o.width||0);"}}if(e.xc){n+="o.x=o.xc-(o.width||0)/2;"}if(e.y2){if(e.y){if(dye[t]){n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"}n+="o.height=o.y2-o.y;"}else{n+="o.y=o.y2-(o.height||0);"}}if(e.yc){n+="o.y=o.yc-(o.height||0)/2;"}return n}function vye(e,t,n,r){function i(e,i,a,o){var u=Aye(null,i,t,n,r),s=Aye(null,a,t,n,r),l=Aye(null,o,t,n,r);return"this."+e+"("+[u,s,l].join(",")+").toString()"}return e.c?i("hcl",e.h,e.c,e.l):e.h||e.s?i("hsl",e.h,e.s,e.l):e.l||e.a?i("lab",e.l,e.a,e.b):e.r||e.g||e.b?i("rgb",e.r,e.g,e.b):null}function gye(e,t,n,r){var i=qve(e,t);i.$fields.forEach((function(e){r[e]=1}));Mee(n,i.$params);return i.$expr}function mye(e,t,n,r){return yye(fee(e)?e:{datum:e},t,n,r)}function yye(e,t,n,r){var i,a,o;if(e.signal){i="datum";o=gye(e.signal,t,n,r)}else if(e.group||e.parent){a=Math.max(1,e.level||1);i="item";while(a-- >0){i+=".mark.group"}if(e.parent){o=e.parent;i+=".datum"}else{o=e.group}}else if(e.datum){i="datum";o=e.datum}else{uee("Invalid field reference: "+hee(e))}if(!e.signal){if(cee(o)){r[o]=1;o=see(o).map(hee).join("][")}else{o=yye(o,t,n,r)}}return i+"["+o+"]"}function bye(e,t,n,r){return fee(e)?"("+Aye(null,e,t,n,r)+")":e}function _ye(e,t,n,r,i){var a=wye(e.scale,n,r,i),o,u,s;if(e.range!=null){o=+e.range;u=a+".range()";t=o===0?u+"[0]":"($="+u+","+(o===1?"$[$.length-1]":"$[0]+"+o+"*($[$.length-1]-$[0])")+")"}else{if(t!==undefined)t=a+"("+t+")";if(e.band&&(s=xye(e.scale,n))){u=a+".bandwidth";if(e.band.signal){o=u+"()*"+bye(e.band,n,r,i)}else{o=+e.band;o=u+"()"+(o===1?"":"*"+o)}if(s<0)o="("+u+"?"+o+":0)";t=(t?t+"+":"")+o;if(e.extra){t="(datum.extra?"+a+"(datum.extra.value):"+t+")"}}if(t==null)t="0"}return t}function xye(e,t){if(!cee(e))return-1;var n=t.scaleType(e);return n==="band"||n==="point"?1:0}function wye(e,t,n,r){var i;if(cee(e)){i=Ove+e;if(!See(n,i)){n[i]=t.scaleRef(e)}i=hee(i)}else{for(i in t.scales){n[Ove+i]=t.scaleRef(i)}i=hee(Ove)+"+"+(e.signal?"("+gye(e.signal,t,n,r)+")":mye(e,t,n,r))}return"_["+i+"]"}function kye(e,t,n,r){return"this.gradient("+wye(e.gradient,t,n,r)+","+hee(e.start)+","+hee(e.stop)+","+hee(e.count)+")"}function Aye(e,t,n,r,i){if(t.gradient!=null){return kye(t,n,r,i)}var a=t.signal?gye(t.signal,n,r,i):t.color?vye(t.color,n,r,i):t.field!=null?mye(t.field,n,r,i):t.value!==undefined?hee(t.value):undefined;if(t.scale!=null){a=_ye(t,a,n,r,i)}if(a===undefined){a=null}if(t.exponent!=null){a="Math.pow("+a+","+bye(t.exponent,n,r,i)+")"}if(t.mult!=null){a+="*"+bye(t.mult,n,r,i)}if(t.offset!=null){a+="+"+bye(t.offset,n,r,i)}if(t.round){a="Math.round("+a+")"}return a}function Eye(e,t,n){var r=e+"["+hee(t)+"]";return"$="+n+";if("+r+"!==$)"+r+"=$,m=1;"}function Mye(e,t,n,r,i){var a="";t.forEach((function(t){var o=Aye(e,t,n,r,i);a+=t.test?gye(t.test,n,r,i)+"?"+o+":":o}));if(Aee(a)===":"){a+="null"}return Eye("o",e,a)}function Oye(e,t,n,r){var i={},a="var o=item,datum=o.datum,m=0,$;",o,u,s;for(o in e){u=e[o];if(lee(u)){a+=Mye(o,u,r,n,i)}else{s=Aye(o,u,r,n,i);a+=Eye("o",o,s)}}a+=pye(e,t);a+="return m;";return{$expr:a,$fields:Object.keys(i),$output:Object.keys(e)}}var Sye="mark";var Dye="frame";var Cye="scope";var Fye="axis";var Tye="axis-domain";var Nye="axis-grid";var jye="axis-label";var Rye="axis-tick";var zye="axis-title";var Pye="legend";var Lye="legend-band";var Iye="legend-entry";var Bye="legend-gradient";var Uye="legend-label";var qye="legend-symbol";var Wye="legend-title";var Hye="title";var Gye="title-text";var $ye="title-subtitle";function Yye(e){return fee(e)&&!lee(e)?Mee({},e):{value:e}}function Vye(e,t,n,r){if(n!=null){if(fee(n)&&!lee(n)){e.update[t]=n}else{e[r||"enter"][t]={value:n}}return 1}else{return 0}}function Xye(e,t,n){for(var r in t){Vye(e,r,t[r])}for(var i in n){Vye(e,i,n[i],"update")}}function Jye(e,t,n){for(var r in t){if(n&&See(n,r))continue;e[r]=Mee(e[r]||{},t[r])}return e}function Zye(e,t,n,r,i,a){var o,u;a=a||{};a.encoders={$encode:o={}};e=Qye(e,t,n,r,i.config);for(u in e){o[u]=Oye(e[u],t,a,i)}return a}function Qye(e,t,n,r,i){var a={},o={},u,s,l,f;if(n=="legend"||String(n).indexOf("axis")===0){n=null}f=n===Dye?i.group:n===Sye?Mee({},i.mark,i[t]):null;for(s in f){l=ebe(s,e)||(s==="fill"||s==="stroke")&&(ebe("fill",e)||ebe("stroke",e));if(!l)Kye(a,s,f[s])}Eee(r).forEach((function(t){var n=i.style&&i.style[t];for(var r in n){if(!ebe(r,e)){Kye(a,r,n[r])}}}));e=Mee({},e);for(s in a){f=a[s];if(f.signal){(u=u||{})[s]=f}else{o[s]=f}}e.enter=Mee(o,e.enter);if(u)e.update=Mee(u,e.update);return e}function Kye(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}function ebe(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}function tbe(e,t,n,r,i,a,o){return{type:e,name:o?o.name:undefined,role:t,style:o&&o.style||n,key:r,from:i,interactive:!!(o&&o.interactive),encode:Jye(a,o,lye)}}function nbe(e,t){var n=function(n,r){return oge(e[n],oge(t[n],r))};n.isVertical=function(n){return Hme===oge(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection))};n.gradientLength=function(){return oge(e.gradientLength,t.gradientLength||t.gradientWidth)};n.gradientThickness=function(){return oge(e.gradientThickness,t.gradientThickness||t.gradientHeight)};n.entryColumns=function(){return oge(e.columns,oge(t.columns,+n.isVertical(true)))};return n}function rbe(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function ibe(e,t,n){var r=t.config.style[n];return r&&r[e]}function abe(e,t,n){return'item.anchor === "'+Gme+'" ? '+e+' : item.anchor === "'+Yme+'" ? '+t+" : "+n}var obe=abe(hee(Bme),hee(Ume),hee(Wme));function ube(e){var t=e("tickBand"),n=e("tickOffset"),r,i;if(!t){r=e("bandPosition");i=e("tickExtra")}else if(t.signal){r={signal:"("+t.signal+")==='extent'?1:0.5"};i={signal:"("+t.signal+")==='extent'?true:false"};if(!fee(n)){n={signal:"("+t.signal+")==='extent'?0:"+n}}}else if(t==="extent"){r=1;i=true;n=0}else{r=.5;i=false}return{extra:i,band:r,offset:n}}var sbe="group";var lbe="rect";var fbe="rule";var cbe="symbol";var hbe="text";function dbe(e,t,n,r){var i=nbe(e,n),a=i.isVertical(),o=i.gradientThickness(),u=i.gradientLength(),s,l,f,c,h,d;if(a){f=[0,1];c=[0,0];h=o;d=u}else{f=[0,0];c=[1,0];h=u;d=o}s={enter:l={opacity:fye,x:fye,y:fye,width:Yye(h),height:Yye(d)},update:Mee({},l,{opacity:cye,fill:{gradient:t,start:f,stop:c}}),exit:{opacity:fye}};Xye(s,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")});return tbe(lbe,Bye,null,undefined,undefined,s,r)}function pbe(e,t,n,r,i){var a=nbe(e,n),o=a.isVertical(),u=a.gradientThickness(),s=a.gradientLength(),l,f,c,h,d,p,v="";o?(c="y",d="y2",h="x",p="width",v="1-"):(c="x",d="x2",h="y",p="height");f={opacity:fye,fill:{scale:t,field:eye}};f[c]={signal:v+"datum."+Zme,mult:s};f[h]=fye;f[d]={signal:v+"datum."+Qme,mult:s};f[p]=Yye(u);l={enter:f,update:Mee({},f,{opacity:cye}),exit:{opacity:fye}};Xye(l,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")});return tbe(lbe,Lye,null,eye,i,l,r)}var vbe="datum."+Zme+'<=0?"'+Bme+'":datum.'+Zme+'>=1?"'+Ume+'":"'+Wme+'"',gbe="datum."+Zme+'<=0?"'+qme+'":datum.'+Zme+'>=1?"'+Ime+'":"'+$me+'"';function mbe(e,t,n,r){var i=nbe(e,t),a=i.isVertical(),o=Yye(i.gradientThickness()),u=i.gradientLength(),s=i("labelOverlap"),l=i("labelSeparation"),f,c,h,d,p,v="";f={enter:c={opacity:fye},update:h={opacity:cye,text:{field:Xme}},exit:{opacity:fye}};Xye(f,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:oge(e.labelLimit,t.gradientLabelLimit)});if(a){c.align={value:"left"};c.baseline=h.baseline={signal:gbe};d="y";p="x";v="1-"}else{c.align=h.align={signal:vbe};c.baseline={value:"top"};d="x";p="y"}c[d]=h[d]={signal:v+"datum."+Zme,mult:u};c[p]=h[p]=o;o.offset=oge(e.labelOffset,t.gradientLabelOffset)||0;e=tbe(hbe,Uye,tye,eye,r,f,n);if(s){e.overlap={separation:l,method:s,order:"datum."+Vme}}return e}function ybe(e,t,n,r,i,a,o,u){return{type:sbe,name:n,role:e,style:t,from:r,interactive:i||false,encode:a,marks:o,layout:u}}function bbe(e,t,n,r,i){var a=nbe(e,t),o=n.entries,u=!!(o&&o.interactive),s=o?o.name:undefined,l=a("clipHeight"),f=a("symbolOffset"),c={data:"value"},h={},d=i+" ? datum."+Jme+" : datum."+Kme,p=l?Yye(l):{field:Kme},v="datum."+Vme,g="max(1, "+i+")",m,y,b,_,x,w,k;p.mult=.5;h={enter:m={opacity:fye,x:{signal:d,mult:.5,offset:f},y:p},update:y={opacity:cye,x:m.x,y:m.y},exit:{opacity:fye}};var A=null,E=null;if(!e.fill){A=t.symbolBaseFillColor;E=t.symbolBaseStrokeColor}Xye(h,{fill:a("symbolFillColor",A),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",E),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")});sye.forEach((function(t){if(e[t]){y[t]=m[t]={scale:e[t],field:eye}}}));_=tbe(cbe,qye,null,eye,c,h,n.symbols);if(l)_.clip=true;b=Yye(f);b.offset=a("labelOffset");h={enter:m={opacity:fye,x:{signal:d,offset:b},y:p},update:y={opacity:cye,text:{field:Xme},x:m.x,y:m.y},exit:{opacity:fye}};Xye(h,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});x=tbe(hbe,Uye,tye,eye,c,h,n.labels);h={enter:{noBound:{value:!l},width:fye,height:l?Yye(l):fye,opacity:fye},exit:{opacity:fye},update:y={opacity:cye,row:{signal:null},column:{signal:null}}};if(a.isVertical(true)){w="ceil(item.mark.items.length / "+g+")";y.row.signal=v+"%"+w;y.column.signal="floor("+v+" / "+w+")";k={field:["row",v]}}else{y.row.signal="floor("+v+" / "+g+")";y.column.signal=v+" % "+g;k={field:v}}y.column.signal=i+"?"+y.column.signal+":"+v;r={facet:{data:r,name:"value",groupby:Vme}};e=ybe(Cye,null,s,r,u,Jye(h,o,lye),[_,x]);e.sort=k;return e}function _be(e,t){var n=nbe(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:true,column:false},padding:{row:n("rowPadding"),column:n("columnPadding")}}}var xbe='item.orient === "left"',wbe='item.orient === "right"',kbe="("+xbe+" || "+wbe+")",Abe="datum.vgrad && "+kbe,Ebe=abe('"top"','"bottom"','"middle"'),Mbe=abe('"right"','"left"','"center"'),Obe="datum.vgrad && "+wbe+" ? ("+Mbe+") : ("+kbe+" && !(datum.vgrad && "+xbe+')) ? "left" : '+obe,Sbe="item._anchor || ("+kbe+' ? "middle" : "start")',Dbe=Abe+" ? ("+xbe+" ? -90 : 90) : 0",Cbe=kbe+" ? (datum.vgrad ? ("+wbe+' ? "bottom" : "top") : '+Ebe+') : "top"';function Fbe(e,t,n,r){var i=nbe(e,t),a;a={enter:{opacity:fye},update:{opacity:cye,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:fye}};Xye(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:Sbe},angle:{signal:Dbe},align:{signal:Obe},baseline:{signal:Cbe},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")});return tbe(hbe,Wye,nye,null,r,a,n)}function Tbe(e,t){var n;if(fee(e)){if(e.signal){n=e.signal}else if(e.path){n="pathShape("+Nbe(e.path)+")"}else if(e.sphere){n="geoShape("+Nbe(e.sphere)+', {type: "Sphere"})'}}return n?t.signalRef(n):!!e}function Nbe(e){return fee(e)&&e.signal?e.signal:hee(e)}function jbe(e){var t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===sbe?Cye:t||Sye}function Rbe(e){return{marktype:e.type,name:e.name||undefined,role:e.role||jbe(e),zindex:+e.zindex||undefined}}function zbe(e,t){return e&&e.signal?t.signalRef(e.signal):e===false?false:true}function Pbe(e,t,n){e.fields=t||[];e.fname=n;return e}function Lbe(e){throw Error(e)}function Ibe(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);o=++u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)Lbe("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)Lbe("Access path missing closing bracket: "+e);if(n)Lbe("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var Bbe=Array.isArray;function Ube(e){return e===Object(e)}function qbe(e){return typeof e==="string"}function Wbe(e){return Bbe(e)?"["+e.map(Wbe)+"]":Ube(e)||qbe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Hbe(e,t){var n=Ibe(e),r="return _["+n.map(Wbe).join("][")+"];";return Pbe(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var Gbe=[];var $be=Hbe("id");var Ybe=Pbe((function(e){return e}),Gbe,"identity");var Vbe=Pbe((function(){return 0}),Gbe,"zero");var Xbe=Pbe((function(){return 1}),Gbe,"one");var Jbe=Pbe((function(){return true}),Gbe,"true");var Zbe=Pbe((function(){return false}),Gbe,"false");function Qbe(e){return e!=null?Bbe(e)?e:[e]:[]}var Kbe=Object.prototype.hasOwnProperty;function e_e(e,t){return Kbe.call(e,t)}function t_e(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function n_e(e,t,n){if(e){var r=0,i=e.length,a;if(t){for(;r<i;++r){if(a=t(e[r]))n(a,r,e)}}else{e.forEach(n)}}}function r_e(e){var t=e||Ybe,n=[],r={};n.add=function(e){var i=t(e);if(!r[i]){r[i]=1;n.push(e)}return n};n.remove=function(e){var i=t(e),a;if(r[i]){r[i]=0;if((a=n.indexOf(e))>=0){n.splice(a,1)}}return n};return n}var i_e=Symbol("vega_id");function a_e(e){return e[i_e]}var o_e="_:mod:_";function u_e(){Object.defineProperty(this,o_e,{writable:true,value:{}})}var s_e=u_e.prototype;s_e.set=function(e,t,n,r){var i=this,a=i[e],o=i[o_e];if(t!=null&&t>=0){if(a[t]!==n||r){a[t]=n;o[t+":"+e]=-1;o[e]=-1}}else if(a!==n||r){i[e]=n;o[e]=Bbe(n)?1+n.length:-1}return i};s_e.modified=function(e,t){var n=this[o_e],r;if(!arguments.length){for(r in n){if(n[r])return true}return false}else if(Bbe(e)){for(r=0;r<e.length;++r){if(n[e[r]])return true}return false}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]};s_e.clear=function(){this[o_e]={};return this};var l_e=0;var f_e="pulse";var c_e=new u_e;var h_e=1,d_e=2;function p_e(e,t,n,r){this.id=++l_e;this.value=e;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(t){this._update=t}if(n)this.parameters(n,r)}var v_e=p_e.prototype;v_e.targets=function(){return this._targets||(this._targets=r_e($be))};v_e.set=function(e){if(this.value!==e){this.value=e;return 1}else{return 0}};function g_e(e){return function(t){var n=this.flags;if(arguments.length===0)return!!(n&e);this.flags=t?n|e:n&~e;return this}}v_e.skip=g_e(h_e);v_e.modified=g_e(d_e);v_e.parameters=function(e,t,n){t=t!==false;var r=this,i=r._argval=r._argval||new u_e,a=r._argops=r._argops||[],o=[],u,s,l,f;function c(e,n,u){if(u instanceof p_e){if(u!==r){if(t)u.targets().add(r);o.push(u)}a.push({op:u,name:e,index:n})}else{i.set(e,n,u)}}for(u in e){s=e[u];if(u===f_e){Qbe(s).forEach((function(e){if(!(e instanceof p_e)){Lbe("Pulse parameters must be operator instances.")}else if(e!==r){e.targets().add(r);o.push(e)}}));r.source=s}else if(Bbe(s)){i.set(u,-1,Array(l=s.length));for(f=0;f<l;++f)c(u,f,s[f])}else{c(u,-1,s)}}this.marshall().clear();if(n)a.initonly=true;return o};v_e.marshall=function(e){var t=this._argval||c_e,n=this._argops,r,i,a,o,u;if(n){for(i=0,a=n.length;i<a;++i){r=n[i];o=r.op;u=o.modified()&&o.stamp===e;t.set(r.name,r.index,o.value,u)}if(n.initonly){for(i=0;i<a;++i){r=n[i];r.op.targets().remove(this)}this._argops=null;this._update=null}}return t};v_e.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);n.clear();if(r!==this.value){this.value=r}else if(!this.modified()){return e.StopPropagation}}};v_e.run=function(e){if(e.stamp<this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false);t=0}else{t=this.evaluate(e)}return this.pulse=t||e};var m_e={};var y_e=1<<0,b_e=1<<1,__e=1<<2,x_e=y_e|b_e,w_e=y_e|__e,k_e=y_e|b_e|__e,A_e=1<<3,E_e=1<<4,M_e=1<<5,O_e=1<<6;function S_e(e,t,n){this.dataflow=e;this.stamp=t==null?-1:t;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}var D_e=S_e.prototype;D_e.StopPropagation=m_e;D_e.ADD=y_e;D_e.REM=b_e;D_e.MOD=__e;D_e.ADD_REM=x_e;D_e.ADD_MOD=w_e;D_e.ALL=k_e;D_e.REFLOW=A_e;D_e.SOURCE=E_e;D_e.NO_SOURCE=M_e;D_e.NO_FIELDS=O_e;D_e.fork=function(e){return new S_e(this.dataflow).init(this,e)};D_e.clone=function(){var e=this.fork(k_e);e.add=e.add.slice();e.rem=e.rem.slice();e.mod=e.mod.slice();if(e.source)e.source=e.source.slice();return e.materialize(k_e|E_e)};D_e.addAll=function(){var e=this;if(!this.source||this.source.length===this.add.length){return e}else{e=new S_e(this.dataflow).init(this);e.add=e.source;return e}};D_e.init=function(e,t){var n=this;n.stamp=e.stamp;n.encode=e.encode;if(e.fields&&!(t&O_e)){n.fields=e.fields}if(t&y_e){n.addF=e.addF;n.add=e.add}else{n.addF=null;n.add=[]}if(t&b_e){n.remF=e.remF;n.rem=e.rem}else{n.remF=null;n.rem=[]}if(t&__e){n.modF=e.modF;n.mod=e.mod}else{n.modF=null;n.mod=[]}if(t&M_e){n.srcF=null;n.source=null}else{n.srcF=e.srcF;n.source=e.source}return n};D_e.runAfter=function(e){this.dataflow.runAfter(e)};D_e.changed=function(e){var t=e||k_e;return t&y_e&&this.add.length||t&b_e&&this.rem.length||t&__e&&this.mod.length};D_e.reflow=function(e){if(e)return this.fork(k_e).reflow();var t=this.add.length,n=this.source&&this.source.length;if(n&&n!==t){this.mod=this.source;if(t)this.filter(__e,T_e(this,y_e))}return this};D_e.modifies=function(e){var t=this.fields||(this.fields={});if(Bbe(e)){e.forEach((function(e){return t[e]=true}))}else{t[e]=true}return this};D_e.modified=function(e,t){var n=this.fields;return!((t||this.mod.length)&&n)?false:!arguments.length?!!n:Bbe(e)?e.some((function(e){return n[e]})):n[e]};D_e.filter=function(e,t){var n=this;if(e&y_e)n.addF=C_e(n.addF,t);if(e&b_e)n.remF=C_e(n.remF,t);if(e&__e)n.modF=C_e(n.modF,t);if(e&E_e)n.srcF=C_e(n.srcF,t);return n};function C_e(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}D_e.materialize=function(e){e=e||k_e;var t=this;if(e&y_e&&t.addF){t.add=F_e(t.add,t.addF);t.addF=null}if(e&b_e&&t.remF){t.rem=F_e(t.rem,t.remF);t.remF=null}if(e&__e&&t.modF){t.mod=F_e(t.mod,t.modF);t.modF=null}if(e&E_e&&t.srcF){t.source=t.source.filter(t.srcF);t.srcF=null}return t};function F_e(e,t){var n=[];n_e(e,t,(function(e){n.push(e)}));return n}function T_e(e,t){var n={};e.visit(t,(function(e){n[a_e(e)]=1}));return function(e){return n[a_e(e)]?null:e}}D_e.visit=function(e,t){var n=this,r=t,i,a;if(e&E_e){n_e(n.source,n.srcF,r);return n}if(e&y_e)n_e(n.add,n.addF,r);if(e&b_e)n_e(n.rem,n.remF,r);if(e&__e)n_e(n.mod,n.modF,r);if(e&A_e&&(i=n.source)){a=n.add.length+n.mod.length;if(a===i.length);else if(a){n_e(i,T_e(n,w_e),r)}else{n_e(i,n.srcF,r)}}return n};function N_e(e,t,n,r){var i=this,a=0,o,u,s,l,f;this.dataflow=e;this.stamp=t;this.fields=null;this.encode=r||null;this.pulses=n;for(s=0,l=n.length;s<l;++s){o=n[s];if(o.stamp!==t)continue;if(o.fields){u=i.fields||(i.fields={});for(f in o.fields){u[f]=1}}if(o.changed(i.ADD))a|=i.ADD;if(o.changed(i.REM))a|=i.REM;if(o.changed(i.MOD))a|=i.MOD}this.changes=a}var j_e=t_e(N_e,S_e);j_e.fork=function(e){var t=new S_e(this.dataflow).init(this,e&this.NO_FIELDS);if(e!==undefined){if(e&t.ADD){this.visit(t.ADD,(function(e){return t.add.push(e)}))}if(e&t.REM){this.visit(t.REM,(function(e){return t.rem.push(e)}))}if(e&t.MOD){this.visit(t.MOD,(function(e){return t.mod.push(e)}))}}return t};j_e.changed=function(e){return this.changes&e};j_e.modified=function(e){var t=this,n=t.fields;return!(n&&t.changes&t.MOD)?0:Bbe(e)?e.some((function(e){return n[e]})):n[e]};j_e.filter=function(){Lbe("MultiPulse does not support filtering.")};j_e.materialize=function(){Lbe("MultiPulse does not support materialization.")};j_e.visit=function(e,t){var n=this,r=n.pulses,i=r.length,a=0;if(e&n.SOURCE){for(;a<i;++a){r[a].visit(e,t)}}else{for(;a<i;++a){if(r[a].stamp===n.stamp){r[a].visit(e,t)}}}return n};function R_e(e,t){p_e.call(this,e,null,t)}var z_e=t_e(R_e,p_e);z_e.run=function(e){var t=this;if(e.stamp<this.stamp)return e.StopPropagation;var n;if(this.skip()){this.skip(false)}else{n=this.evaluate(e)}n=n||e;if(n.then){n=n.then((function(e){return t.pulse=e}))}else if(n!==e.StopPropagation){this.pulse=n}return n};z_e.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);t.clear();return n};z_e.transform=function(){};var P_e={};function L_e(e){var t=I_e(e);return t&&t.Definition||null}function I_e(e){e=e&&e.toLowerCase();return e_e(P_e,e)?P_e[e]:null}function B_e(e,t){var n=L_e(e.type);if(!n)uee("Unrecognized transform type: "+hee(e.type));var r=Hve(n.type.toLowerCase(),null,U_e(n,e,t));if(e.signal)t.addSignal(e.signal,t.proxy(r));r.metadata=n.metadata||{};return r}function U_e(e,t,n){var r={},i,a,o;for(a=0,o=e.params.length;a<o;++a){i=e.params[a];r[i.name]=q_e(i,t,n)}return r}function q_e(e,t,n){var r=e.type,i=t[e.name];if(r==="index"){return H_e(e,t,n)}else if(i===undefined){if(e.required){uee("Missing required "+hee(t.type)+" parameter: "+hee(e.name))}return}else if(r==="param"){return G_e(e,t,n)}else if(r==="projection"){return n.projectionRef(t[e.name])}return e.array&&!rge(i)?i.map((function(t){return W_e(e,t,n)})):W_e(e,i,n)}function W_e(e,t,n){var r=e.type;if(rge(t)){return J_e(r)?uee("Expression references can not be signals."):Z_e(r)?n.fieldRef(t):Q_e(r)?n.compareRef(t):n.signalRef(t.signal)}else{var i=e.expr||Z_e(r);return i&&Y_e(t)?n.exprRef(t.expr,t.as):i&&V_e(t)?Yve(t.field,t.as):J_e(r)?qve(t,n):X_e(r)?$ve(n.getData(t).values):Z_e(r)?Yve(t):Q_e(r)?n.compareRef(t):t}}function H_e(e,t,n){if(!cee(t.from)){uee('Lookup "from" parameter must be a string literal.')}return n.getData(t.from).lookupRef(n,t.key)}function G_e(e,t,n){var r=t[e.name];if(e.array){if(!lee(r)){uee("Expected an array of sub-parameters. Instead: "+hee(r))}return r.map((function(t){return $_e(e,t,n)}))}else{return $_e(e,r,n)}}function $_e(e,t,n){var r,i,a,o,u;for(o=0,u=e.params.length;o<u;++o){i=e.params[o];for(a in i.key){if(i.key[a]!==t[a]){i=null;break}}if(i)break}if(!i)uee("Unsupported parameter: "+hee(t));r=Mee(U_e(i,t,n),i.key);return $ve(n.add(ome(r)))}function Y_e(e){return e&&e.expr}function V_e(e){return e&&e.field}function X_e(e){return e==="data"}function J_e(e){return e==="expr"}function Z_e(e){return e==="field"}function Q_e(e){return e==="compare"}function K_e(e,t,n){var r,i,a,o,u;if(!e){o=$ve(n.add($ge(null,[{}])))}else if(r=e.facet){if(!t)uee("Only group marks can be faceted.");if(r.field!=null){o=u=exe(r,n)}else{if(!e.data){a=B_e(Mee({type:"aggregate",groupby:Eee(r.groupby)},r.aggregate),n);a.params.key=n.keyRef(r.groupby);a.params.pulse=exe(r,n);o=u=$ve(n.add(a))}else{u=$ve(n.getData(e.data).aggregate)}i=n.keyRef(r.groupby,true)}}if(!o){o=exe(e,n)}return{key:i,pulse:o,parent:u}}function exe(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:$ve(t.getData(e.data).output)}function txe(e,t,n,r,i){this.scope=e;this.input=t;this.output=n;this.values=r;this.aggregate=i;this.index={}}txe.fromEntries=function(e,t){var n=t.length,r=1,i=t[0],a=t[n-1],o=t[n-2],u=null;if(i&&i.type==="load"){i=t[1]}e.add(t[0]);for(;r<n;++r){t[r].params.pulse=$ve(t[r-1]);e.add(t[r]);if(t[r].type==="aggregate")u=t[r]}return new txe(e,i,o,a,u)};var nxe=txe.prototype;nxe.countsRef=function(e,t,n){var r=this,i=r.counts||(r.counts={}),a=rxe(t),o,u,s;if(a!=null){e=r.scope;o=i[a]}if(!o){s={groupby:e.fieldRef(t,"key"),pulse:$ve(r.output)};if(n&&n.field)ixe(e,s,n);u=e.add(Wge(s));o=e.add($ge({pulse:$ve(u)}));o={agg:u,ref:$ve(o)};if(a!=null)i[a]=o}else if(n&&n.field){ixe(e,o.agg.params,n)}return o.ref};function rxe(e){return cee(e)?e:null}function ixe(e,t,n){var r=ege(n.op,n.field),i;if(t.ops){for(var a=0,o=t.as.length;a<o;++a){if(t.as[a]===r)return}}else{t.ops=["count"];t.fields=[null];t.as=["count"]}if(n.op){t.ops.push((i=n.op.signal)?e.signalRef(i):n.op);t.fields.push(e.fieldRef(n.field));t.as.push(r)}}function axe(e,t,n,r,i,a,o){var u=t[n]||(t[n]={}),s=Kve(a),l=rxe(i),f,c;if(l!=null){e=t.scope;l=l+(s?"|"+s:"");f=u[l]}if(!f){var h=a?{field:Vve,pulse:t.countsRef(e,i,a)}:{field:e.fieldRef(i),pulse:$ve(t.output)};if(s)h.sort=e.sortRef(a);c=e.add(Hve(r,undefined,h));if(o)t.index[i]=c;f=$ve(c);if(l!=null)u[l]=f}return f}nxe.tuplesRef=function(){return $ve(this.values)};nxe.extentRef=function(e,t){return axe(e,this,"extent","extent",t,false)};nxe.domainRef=function(e,t){return axe(e,this,"domain","values",t,false)};nxe.valuesRef=function(e,t,n){return axe(e,this,"vals","values",t,n||true)};nxe.lookupRef=function(e,t){return axe(e,this,"lookup","tupleindex",t,false)};nxe.indataRef=function(e,t){return axe(e,this,"indata","tupleindex",t,true,true)};function oxe(e,t,n){var r=e.from.facet,i=r.name,a=exe(r,t),o,u,s,l;if(!r.name){uee("Facet must have a name: "+hee(r))}if(!r.data){uee("Facet must reference a data set: "+hee(r))}if(r.field){l=t.add(ume({field:t.fieldRef(r.field),pulse:a}))}else if(r.groupby){l=t.add(Zge({key:t.keyRef(r.groupby),group:$ve(t.proxy(n.parent)),pulse:a}))}else{uee("Facet must specify groupby or field: "+hee(r))}o=t.fork();u=o.add($ge());s=o.add(dme({pulse:$ve(u)}));o.addData(i,new txe(o,u,u,s));o.addSignal("parent",null);l.params.subflow={$subflow:Lxe(e,o).toRuntime()}}function uxe(e,t,n){var r=t.add(ume({pulse:n.pulse})),i=t.fork();i.add(dme());i.addSignal("parent",null);r.params.subflow={$subflow:Lxe(e,i).toRuntime()}}function sxe(e,t,n){var r=e.remove,i=e.insert,a=e.toggle,o=e.modify,u=e.values,s=t.add(Gve()),l,f;l="if("+e.trigger+',modify("'+n+'",'+[i,r,a,o,u].map((function(e){return e==null?"null":e})).join(",")+"),0)";f=qve(l,t);s.update=f.$expr;s.params=f.$params}function lxe(e,t){var n=jbe(e),r=e.type===sbe,i=e.from&&e.from.facet,a=e.layout||n===Cye||n===Dye,o=n===Sye||a||i,u=e.overlap,s,l,f,c,h,d,p,v,g,m,y,b,_,x;f=K_e(e.from,r,t);l=t.add(Vge({key:f.key||(e.key?Yve(e.key):undefined),pulse:f.pulse,clean:!r}));m=$ve(l);l=c=t.add($ge({pulse:m}));l=t.add(nme({markdef:Rbe(e),interactive:zbe(e.interactive,t),clip:Tbe(e.clip,t),context:{$context:true},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:$ve(l)}));y=$ve(l);l=h=t.add(Xge(Zye(e.encode,e.type,n,e.style,t,{mod:false,pulse:y})));l.params.parent=t.encode();if(e.transform){e.transform.forEach((function(e){var n=B_e(e,t),r=n.metadata;if(r.generates||r.changes){uee("Mark transforms should not generate new data.")}if(!r.nomod)h.params.mod=true;n.params.pulse=$ve(l);t.add(l=n)}))}if(e.sort){l=t.add(pme({sort:t.compareRef(e.sort),pulse:$ve(l)}))}b=$ve(l);if(i||a){a=t.add(vme({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:b}));_=$ve(a)}d=t.add(Gge({mark:y,pulse:_||b}));x=$ve(d);if(r){if(o){s=t.operators;s.pop();if(a)s.pop()}t.pushState(b,_||x,m);i?oxe(e,t,f):o?uxe(e,t,f):Lxe(e,t);t.popState();if(o){if(a)s.push(a);s.push(d)}}if(u){x=fxe(u,x,t)}p=t.add(cme({pulse:x}));v=t.add(dme({pulse:$ve(p)},undefined,t.parent()));if(e.name!=null){g=e.name;t.addData(g,new txe(t,c,p,v));if(e.on)e.on.forEach((function(e){if(e.insert||e.remove||e.toggle){uee("Marks only support modify triggers.")}sxe(e,t,g)}))}}function fxe(e,t,n){var r=e.method,i=e.bound,a=e.separation,o;var u={separation:rge(a)?n.signalRef(a.signal):a,method:rge(r)?n.signalRef(r.signal):r,pulse:t};if(e.order){u.sort=n.compareRef({field:e.order})}if(i){o=i.tolerance;u.boundTolerance=rge(o)?n.signalRef(o.signal):+o;u.boundScale=n.scaleRef(i.scale);u.boundOrient=i.orient}return $ve(n.add(ame(u)))}function cxe(e,t){var n=t.config.legend,r=e.encode||{},i=r.legend||{},a=i.name||undefined,o=i.interactive,u=i.style,s=nbe(e,n),l,f,c,h,d,p,v,g,m;var y=sye.reduce((function(t,n){return t||e[n]}),0);if(!y)uee("Missing valid scale for legend.");d=hxe(e,t.scaleType(y));p={title:e.title!=null,type:d,vgrad:d!=="symbol"&&s.isVertical()};v=$ve(t.add($ge(null,[p])));i=Jye(pxe(s,n),i,lye);l={enter:{x:{value:0},y:{value:0}}};g=$ve(t.add(eme(c={type:d,scale:t.scaleRef(y),count:t.objectProperty(s("tickCount")),limit:t.property(s("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));if(d===oye){h=[dbe(e,y,n,r.gradient),mbe(e,n,r.labels,g)];c.count=c.count||t.signalRef("max(2,2*floor(("+uge(s.gradientLength())+")/100))")}else if(d===uye){h=[pbe(e,y,n,r.gradient,g),mbe(e,n,r.labels,g)]}else{f=_be(e,n);h=[bbe(e,n,r,g,uge(f.columns))];c.size=vxe(e,t,h[0].marks)}h=[ybe(Iye,null,null,v,o,l,h,f)];if(p.title){h.push(Fbe(e,n,r.title,v))}m=ybe(Pye,u,a,v,o,i,h);if(e.zindex)m.zindex=e.zindex;return lxe(m,t)}function hxe(e,t){var n=e.type||aye;if(!e.type&&dxe(e)===1&&(e.fill||e.stroke)){n=tS(t)?oye:rS(t)?uye:aye}return n!==oye?n:rS(t)?uye:oye}function dxe(e){return sye.reduce((function(t,n){return t+(e[n]?1:0)}),0)}function pxe(e,t){var n={enter:{},update:{}};Xye(n,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:t.strokeWidth,strokeDash:t.strokeDash,x:e("legendX"),y:e("legendY")});return n}function vxe(e,t,n){var r=uge(gxe("size",e,n)),i=uge(gxe("strokeWidth",e,n)),a=uge(mxe(n[1].encode,t,tye));return qve("max(ceil(sqrt("+r+")+"+i+"),"+a+")",t)}function gxe(e,t,n){return t[e]?'scale("'+t[e]+'",datum)':rbe(e,n[0].encode)}function mxe(e,t,n){return rbe("fontSize",e)||ibe("fontSize",t,n)}var yxe='item.orient==="'+Bme+'"?-90:item.orient==="'+Ume+'"?90:0';function bxe(e,t){e=cee(e)?{text:e}:e;var n=nbe(e,t.config.title),r=e.encode||{},i=r.group||{},a=i.name||undefined,o=i.interactive,u=i.style,s=[],l,f;l=$ve(t.add($ge(null,[{}])));s.push(wxe(e,n,_xe(e),l));if(e.subtitle){s.push(kxe(e,n,r.subtitle,l))}f=ybe(Hye,u,a,l,o,xxe(n,i),s);if(e.zindex)f.zindex=e.zindex;return lxe(f,t)}function _xe(e){var t=e.encode;return t&&t.title||Mee({name:e.name,interactive:e.interactive,style:e.style},t)}function xxe(e,t){var n={enter:{},update:{}};Xye(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:obe},angle:{signal:yxe},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")});return Jye(n,t,lye)}function wxe(e,t,n,r){var i={value:0},a=e.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};Xye(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")});return tbe(hbe,Gye,rye,null,r,o,n)}function kxe(e,t,n,r){var i={value:0},a=e.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};Xye(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")});return tbe(hbe,$ye,iye,null,r,o,n)}function Axe(e,t){var n=[];if(e.transform){e.transform.forEach((function(e){n.push(B_e(e,t))}))}if(e.on){e.on.forEach((function(n){sxe(n,t,e.name)}))}t.addDataPipeline(e.name,Exe(e,t,n))}function Exe(e,t,n){var r=[],i=null,a=false,o=false,u,s,l,f,c;if(e.values){if(age(e.values)||age(e.format)){r.push(Oxe(t,e));r.push(i=Mxe())}else{r.push(i=Mxe({$ingest:e.values,$format:e.format}))}}else if(e.url){if(age(e.url)||age(e.format)){r.push(Oxe(t,e));r.push(i=Mxe())}else{r.push(i=Mxe({$request:e.url,$format:e.format}))}}else if(e.source){i=u=Eee(e.source).map((function(e){return $ve(t.getData(e).output)}));r.push(null)}for(s=0,l=n.length;s<l;++s){f=n[s];c=f.metadata;if(!i&&!c.source){r.push(i=Mxe())}r.push(f);if(c.generates)o=true;if(c.modifies&&!o)a=true;if(c.source)i=f;else if(c.changes)i=null}if(u){l=u.length-1;r[0]=fme({derive:a,pulse:l?u:u[0]});if(a||l){r.splice(1,0,Mxe())}}if(!i)r.push(Mxe());r.push(dme({}));return r}function Mxe(e){var t=$ge({},e);t.metadata={source:true};return t}function Oxe(e,t){return tme({url:t.url?e.property(t.url):undefined,async:t.async?e.property(t.async):undefined,values:t.values?e.property(t.values):undefined,format:e.objectProperty(t.format)})}function Sxe(e,t){var n=t.config,r=e.orient,i=r===Ime||r===qme?n.axisX:n.axisY,a=n["axis"+r[0].toUpperCase()+r.slice(1)],o=t.scaleType(e.scale)==="band"&&n.axisBand;return i||a||o?Mee({},n.axis,i,a,o):n.axis}function Dxe(e,t,n,r){var i=nbe(e,t),a=e.orient,o,u,s,l,f,c;o={enter:u={opacity:fye},update:s={opacity:cye},exit:{opacity:fye}};Xye(o,{stroke:i("domainColor"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});if(a===Ime||a===qme){l="x";c="y"}else{l="y";c="x"}f=l+"2";u[c]=fye;s[l]=u[l]=Cxe(e,0);s[f]=u[f]=Cxe(e,1);return tbe(fbe,Tye,null,null,r,o,n)}function Cxe(e,t){return{scale:e.scale,range:t}}function Fxe(e,t,n,r,i){var a=nbe(e,t),o=e.orient,u=e.gridScale,s=o===Bme||o===Ime?1:-1,l=Txe(e.offset,s),f,c,h,d,p,v,g,m,y;f={enter:c={opacity:fye},update:d={opacity:cye},exit:h={opacity:fye}};Xye(f,{stroke:a("gridColor"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});p={scale:e.scale,field:eye,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")};if(o===Ime||o===qme){v="x";g="y";y="height"}else{v="y";g="x";y="width"}m=g+"2";d[v]=c[v]=h[v]=p;if(u){d[g]=c[g]={scale:u,range:0,mult:s,offset:l};d[m]=c[m]={scale:u,range:1,mult:s,offset:l}}else{d[g]=c[g]={value:0,offset:l};d[m]=c[m]={signal:y,mult:s,offset:l}}return tbe(fbe,Nye,null,eye,r,f,n)}function Txe(e,t){if(t===1);else if(!fee(e)){e=t*(e||0)}else{var n=e=Mee({},e);while(n.mult!=null){if(!fee(n.mult)){n.mult*=t;return e}else{n=n.mult=Mee({},n.mult)}}n.mult=t}return e}function Nxe(e,t,n,r,i,a){var o=nbe(e,t),u=e.orient,s=u===Bme||u===Ime?-1:1,l,f,c,h,d,p;l={enter:f={opacity:fye},update:h={opacity:cye},exit:c={opacity:fye}};Xye(l,{stroke:o("tickColor"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});d=Yye(i);d.mult=s;p={scale:e.scale,field:eye,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};if(u===Ime||u===qme){h.y=f.y=fye;h.y2=f.y2=d;h.x=f.x=c.x=p}else{h.x=f.x=fye;h.x2=f.x2=d;h.y=f.y=c.y=p}return tbe(fbe,Rye,null,eye,r,l,n)}function jxe(e,t,n,r,i){return{signal:'flush(range("'+e+'"), '+'scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function Rxe(e,t,n,r,i,a){var o;var u=nbe(e,t),s=e.orient,l=s===Bme||s===Ime?-1:1,f=s===Ime||s===qme,c=e.scale,h=uge(u("labelFlush")),d=uge(u("labelFlushOffset")),p=h===0||!!h,v=u("labelAlign"),g=u("labelBaseline"),m,y,b,_,x,w,k,A,E,M;b=Yye(i);b.mult=l;b.offset=Yye(u("labelPadding")||0);b.offset.mult=l;_={scale:c,field:eye,band:.5,offset:a.offset};if(f){x=v||(p?jxe(c,h,'"left"','"right"','"center"'):"center");w=g||(s===Ime?"bottom":"top");k=!v}else{x=v||(s===Ume?"left":"right");w=g||(p?jxe(c,h,'"top"','"bottom"','"middle"'):"middle");k=!g}k=k&&p&&d?jxe(c,h,"-("+d+")",d,0):null;m={enter:y={opacity:fye,x:f?_:b,y:f?b:_},update:{opacity:cye,text:{field:Xme},x:y.x,y:y.y},exit:{opacity:fye,x:y.x,y:y.y}};Xye(m,(o={},o[f?"dx":"dy"]=k,o.align=x,o.baseline=w,o.angle=u("labelAngle"),o.fill=u("labelColor"),o.fillOpacity=u("labelOpacity"),o.font=u("labelFont"),o.fontSize=u("labelFontSize"),o.fontWeight=u("labelFontWeight"),o.fontStyle=u("labelFontStyle"),o.limit=u("labelLimit"),o));A=u("labelBound");E=u("labelOverlap");M=u("labelSeparation");e=tbe(hbe,jye,tye,eye,r,m,n);if(E||A){e.overlap={separation:M,method:E,order:"datum.index",bound:A?{scale:c,orient:s,tolerance:A}:null}}return e}function zxe(e,t,n,r){var i=nbe(e,t),a=e.orient,o=a===Bme||a===Ime?-1:1,u=a===Ime||a===qme,s,l,f,c;s={enter:l={opacity:fye,anchor:Yye(i("titleAnchor")),align:{signal:obe}},update:f=Mee({},l,{opacity:cye,text:Yye(e.title)}),exit:{opacity:fye}};c={signal:'lerp(range("'+e.scale+'"), '+abe(0,1,.5)+")"};if(u){f.x=c;l.angle={value:0};l.baseline={value:a===Ime?"bottom":"top"}}else{f.y=c;l.angle={value:o*90};l.baseline={value:"bottom"}}Xye(s,{angle:i("titleAngle"),baseline:i("titleBaseline"),fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign")});!Vye(s,"x",i("titleX"),"update")&&!u&&!ebe("x",n)&&(s.enter.auto={value:true});!Vye(s,"y",i("titleY"),"update")&&u&&!ebe("y",n)&&(s.enter.auto={value:true});return tbe(hbe,zye,nye,null,r,s,n)}function Pxe(e,t){var n=Sxe(e,t),r=e.encode||{},i=r.axis||{},a=i.name||undefined,o=i.interactive,u=i.style,s=nbe(e,n),l=ube(s),f,c,h,d,p,v;f={orient:e.orient,ticks:!!s("ticks"),labels:!!s("labels"),grid:!!s("grid"),domain:!!s("domain"),title:e.title!=null,translate:s("translate")};c=$ve(t.add($ge({},[f])));i=Jye({update:{offset:Yye(s("offset")||0),position:Yye(oge(e.position,0)),titlePadding:Yye(s("titlePadding")),minExtent:Yye(s("minExtent")),maxExtent:Yye(s("maxExtent")),range:{signal:'abs(span(range("'+e.scale+'")))'}}},r.axis,lye);h=$ve(t.add(Hge({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));v=[];if(f.grid){v.push(Fxe(e,n,r.grid,h,l))}if(f.ticks){d=s("tickSize");v.push(Nxe(e,n,r.ticks,h,d,l))}if(f.labels){d=f.ticks?d:0;v.push(Rxe(e,n,r.labels,h,d,l))}if(f.domain){v.push(Dxe(e,n,r.domain,c))}if(f.title){v.push(zxe(e,n,r.title,c))}p=ybe(Fye,u,a,c,o,i,v);if(e.zindex)p.zindex=e.zindex;return lxe(p,t)}function Lxe(e,t,n){var r=Eee(e.signals),i=Eee(e.scales);if(!n)r.forEach((function(e){return Pee(e,t)}));Eee(e.projections).forEach((function(e){return Pme(e,t)}));i.forEach((function(e){return bme(e,t)}));Eee(e.data).forEach((function(e){return Axe(e,t)}));i.forEach((function(e){return _me(e,t)}));(n||r).forEach((function(e){return Uge(e,t)}));Eee(e.axes).forEach((function(e){return Pxe(e,t)}));Eee(e.marks).forEach((function(e){return lxe(e,t)}));Eee(e.legends).forEach((function(e){return cxe(e,t)}));if(e.title)bxe(e.title,t);t.parseLambdas();return t}var Ixe=Dee(["width","height","padding","autosize"]);function Bxe(e,t){var n=t.config,r,i,a,o,u,s;t.background=e.background||n.background;t.eventConfig=n.events;u=$ve(t.root=t.add(Gve()));t.addSignal("width",e.width||0);t.addSignal("height",e.height||0);t.addSignal("padding",Fee(e.padding,n));t.addSignal("autosize",Cee(e.autosize,n));t.legends=t.objectProperty(n.legend&&n.legend.layout);s=Uxe(t,e.signals,n.signals);i=t.add($ge());a=Jye({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e.encode);a=t.add(Xge(Zye(a,sbe,Dye,e.style,t,{pulse:$ve(i)})));o=t.add(vme({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:u,pulse:$ve(a)}));t.operators.pop();t.pushState($ve(a),$ve(o),null);Lxe(e,t,s);t.operators.push(o);r=t.add(Gge({mark:u,pulse:$ve(o)}));r=t.add(cme({pulse:$ve(r)}));r=t.add(dme({pulse:$ve(r)}));t.addData("root",new txe(t,i,i,r));return t}function Uxe(e,t,n){Eee(t).forEach((function(t){if(!Ixe[t.name])Pee(t,e)}));if(!n)return t;var r=Eee(t).slice();Eee(n).forEach((function(t){if(!e.hasOwnSignal(t.name)){Pee(t,e);r.push(t)}}));return r}function qxe(e){this.config=e;this.bindings=[];this.field={};this.signals={};this.lambdas={};this.scales={};this.events={};this.data={};this.streams=[];this.updates=[];this.operators=[];this.background=null;this.eventConfig=null;this._id=0;this._subid=0;this._nextsub=[0];this._parent=[];this._encode=[];this._lookup=[];this._markpath=[]}function Wxe(e){this.config=e.config;this.legends=e.legends;this.field=Object.create(e.field);this.signals=Object.create(e.signals);this.lambdas=Object.create(e.lambdas);this.scales=Object.create(e.scales);this.events=Object.create(e.events);this.data=Object.create(e.data);this.streams=[];this.updates=[];this.operators=[];this._id=0;this._subid=++e._nextsub[0];this._nextsub=e._nextsub;this._parent=e._parent.slice();this._encode=e._encode.slice();this._lookup=e._lookup.slice();this._markpath=e._markpath}var Hxe=qxe.prototype=Wxe.prototype;Hxe.fork=function(){return new Wxe(this)};Hxe.isSubscope=function(){return this._subid>0};Hxe.toRuntime=function(){this.finish();return{background:this.background,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig}};Hxe.id=function(){return(this._subid?this._subid+":":0)+this._id++};Hxe.add=function(e){this.operators.push(e);e.id=this.id();if(e.refs){e.refs.forEach((function(t){t.$ref=e.id}));e.refs=null}return e};Hxe.proxy=function(e){var t=e instanceof Wve?$ve(e):e;return this.add(lme({value:t}))};Hxe.addStream=function(e){this.streams.push(e);e.id=this.id();return e};Hxe.addUpdate=function(e){this.updates.push(e);return e};Hxe.finish=function(){var e,t;if(this.root)this.root.root=true;for(e in this.signals){this.signals[e].signal=e}for(e in this.scales){this.scales[e].scale=e}function n(e,t,n){var r,i;if(e){r=e.data||(e.data={});i=r[t]||(r[t]=[]);i.push(n)}}for(e in this.data){t=this.data[e];n(t.input,e,"input");n(t.output,e,"output");n(t.values,e,"values");for(var r in t.index){n(t.index[r],e,"index:"+r)}}return this};Hxe.pushState=function(e,t,n){this._encode.push($ve(this.add(dme({pulse:e}))));this._parent.push(t);this._lookup.push(n?$ve(this.proxy(n)):null);this._markpath.push(-1)};Hxe.popState=function(){this._encode.pop();this._parent.pop();this._lookup.pop();this._markpath.pop()};Hxe.parent=function(){return Aee(this._parent)};Hxe.encode=function(){return Aee(this._encode)};Hxe.lookup=function(){return Aee(this._lookup)};Hxe.markpath=function(){var e=this._markpath;return++e[e.length-1]};Hxe.fieldRef=function(e,t){if(cee(e))return Yve(e,t);if(!e.signal){uee("Unsupported field reference: "+hee(e))}var n=e.signal,r=this.field[n],i;if(!r){i={name:this.signalRef(n)};if(t)i.as=t;this.field[n]=r=$ve(this.add(Qge(i)))}return r};Hxe.compareRef=function(e){function t(e){if(rge(e)){r=true;return n.signalRef(e.signal)}else if(ige(e)){r=true;return n.exprRef(e.expr)}else{return e}}var n=this,r=false,i=Eee(e.field).map(t),a=Eee(e.order).map(t);return r?$ve(this.add(Yge({fields:i,orders:a}))):Xve(i,a)};Hxe.keyRef=function(e,t){function n(e){if(rge(e)){i=true;return $ve(r[e.signal])}else{return e}}var r=this.signals,i=false;e=Eee(e).map(n);return i?$ve(this.add(Kge({fields:e,flat:t}))):Jve(e,t)};Hxe.sortRef=function(e){if(!e)return e;var t=ege(e.op,e.field),n=e.order||Zve;return n.signal?$ve(this.add(Yge({fields:t,orders:this.signalRef(n.signal)}))):Xve(t,n)};Hxe.event=function(e,t){var n=e+":"+t;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:e,type:t});this.events[n]=r}return this.events[n]};Hxe.hasOwnSignal=function(e){return See(this.signals,e)};Hxe.addSignal=function(e,t){if(this.hasOwnSignal(e)){uee("Duplicate signal name: "+hee(e))}var n=t instanceof Wve?t:this.add(Gve(t));return this.signals[e]=n};Hxe.getSignal=function(e){if(!this.signals[e]){uee("Unrecognized signal name: "+hee(e))}return this.signals[e]};Hxe.signalRef=function(e){if(this.signals[e]){return $ve(this.signals[e])}else if(!See(this.lambdas,e)){this.lambdas[e]=this.add(Gve(null))}return $ve(this.lambdas[e])};Hxe.parseLambdas=function(){var e=Object.keys(this.lambdas);for(var t=0,n=e.length;t<n;++t){var r=e[t],i=qve(r,this),a=this.lambdas[r];a.params=i.$params;a.update=i.$expr}};Hxe.property=function(e){return e&&e.signal?this.signalRef(e.signal):e};Hxe.objectProperty=function(e){return!e||!fee(e)?e:this.signalRef(e.signal||Gxe(e))};function Gxe(e){return(lee(e)?$xe:Yxe)(e)}function $xe(e){var t="[",n=0,r=e.length,i;for(;n<r;++n){i=e[n];t+=(n>0?",":"")+(fee(i)?i.signal||Gxe(i):hee(i))}return t+"]"}function Yxe(e){var t="{",n=0,r,i;for(r in e){i=e[r];t+=(++n>1?",":"")+hee(r)+":"+(fee(i)?i.signal||Gxe(i):hee(i))}return t+"}"}Hxe.exprRef=function(e,t){var n={expr:qve(e,this)};if(t)n.expr.$name=t;return $ve(this.add(Jge(n)))};Hxe.addBinding=function(e,t){if(!this.bindings){uee("Nested signals do not support binding: "+hee(e))}this.bindings.push(Mee({signal:e},t))};Hxe.addScaleProj=function(e,t){if(See(this.scales,e)){uee("Duplicate scale or projection name: "+hee(e))}this.scales[e]=this.add(t)};Hxe.addScale=function(e,t){this.addScaleProj(e,hme(t))};Hxe.addProjection=function(e,t){this.addScaleProj(e,sme(t))};Hxe.getScale=function(e){if(!this.scales[e]){uee("Unrecognized scale name: "+hee(e))}return this.scales[e]};Hxe.projectionRef=Hxe.scaleRef=function(e){return $ve(this.getScale(e))};Hxe.projectionType=Hxe.scaleType=function(e){return this.getScale(e).params.type};Hxe.addData=function(e,t){if(See(this.data,e)){uee("Duplicate data set name: "+hee(e))}return this.data[e]=t};Hxe.getData=function(e){if(!this.data[e]){uee("Undefined data set name: "+hee(e))}return this.data[e]};Hxe.addDataPipeline=function(e,t){if(See(this.data,e)){uee("Duplicate data set name: "+hee(e))}return this.addData(e,txe.fromEntries(this,t))};var Vxe="sans-serif",Xxe=30,Jxe=2,Zxe="#4c78a8",Qxe="#000",Kxe="#888",ewe="#ddd";function twe(){return{padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:Zxe},area:{fill:Zxe},image:null,line:{stroke:Zxe,strokeWidth:Jxe},path:{stroke:Zxe},rect:{fill:Zxe},rule:{stroke:Qxe},shape:{stroke:Zxe},symbol:{fill:Zxe,size:64},text:{fill:Qxe,font:Vxe,fontSize:11},style:{"guide-label":{fill:Qxe,font:Vxe,fontSize:10},"guide-title":{fill:Qxe,font:Vxe,fontSize:11,fontWeight:"bold"},"group-title":{fill:Qxe,font:Vxe,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:Qxe,font:Vxe,fontSize:12},point:{size:Xxe,strokeWidth:Jxe,shape:"circle"},circle:{size:Xxe,strokeWidth:Jxe},square:{size:Xxe,strokeWidth:Jxe,shape:"square"},cell:{fill:"transparent",stroke:ewe}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:true,domainWidth:1,domainColor:Kxe,grid:false,gridWidth:1,gridColor:ewe,labels:true,labelAngle:0,labelLimit:180,labelPadding:2,ticks:true,tickColor:Kxe,tickOffset:0,tickRound:true,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:ewe,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:true,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:Kxe,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function nwe(e,t){if(!fee(e)){uee("Input Vega specification must be an object.")}t=xee(twe(),t,e.config);return Bxe(e,new qxe(t)).toRuntime()}Ke(Au,dp,Yw,rT,NL,iB,rq,Fq,sW,GW,oH);var rwe=Object.freeze({__proto__:null,version:uH,Dataflow:bu,EventStream:Sn,Parameters:vn,Pulse:Zo,MultiPulse:nu,Operator:wn,Transform:wu,changeset:dn,ingest:cn,isTuple:sn,definition:Eu,transform:Mu,transforms:Au,tupleid:ln,scale:QO,scheme:bS,interpolate:hS,interpolateColors:lS,interpolateRange:sS,quantizeInterpolator:fS,projection:oL,View:eee,expressionFunction:T9,formatLocale:e6,timeFormatLocale:b8,parse:nwe,runtime:o7,runtimeContext:f7,bandwidthNRD:Zl,bin:Ql,bootstrapCI:tf,dotbin:nf,quantiles:Xl,quartiles:Jl,get random(){return Kl},setRandom:ef,randomLCG:af,randomInteger:of,randomKDE:gf,randomLogNormal:xf,sampleLogNormal:mf,densityLogNormal:yf,cumulativeLogNormal:bf,quantileLogNormal:_f,randomMixture:wf,randomNormal:vf,sampleNormal:ff,densityNormal:cf,cumulativeNormal:hf,quantileNormal:df,randomUniform:Of,sampleUniform:kf,densityUniform:Af,cumulativeUniform:Ef,quantileUniform:Mf,regressionLinear:Tf,regressionLog:Nf,regressionExp:jf,regressionPow:Rf,regressionQuad:zf,regressionPoly:Pf,regressionLoess:qf,sampleCurve:Yf,timeUnits:Kh,timeFloor:ld,utcFloor:pd,timeUnitSpecifier:Md,timeFormat:Od,utcFormat:Sd,timeInterval:md,timeOffset:_d,timeSequence:kd,utcInterval:yd,utcOffset:xd,utcSequence:Ad,timeBin:Yd,accessor:te,accessorName:ne,accessorFields:re,id:he,identity:de,zero:pe,one:ve,truthy:ge,falsy:me,logger:Ae,None:be,Error:_e,Warn:xe,Info:we,Debug:ke,mergeConfig:Ee,writeConfig:Me,panLinear:ze,panLog:Pe,panPow:Le,panSymlog:Ie,zoomLinear:Ue,zoomLog:qe,zoomPow:We,zoomSymlog:He,quarter:Ge,utcquarter:$e,array:Ye,clampRange:Ve,compare:Je,constant:Ze,debounce:Qe,error:ie,extend:Ke,extent:et,extentIndex:tt,fastmap:at,field:fe,flush:ot,hasOwnProperty:rt,inherits:ut,inrange:st,isArray:oe,isBoolean:lt,isDate:ft,isFunction:Xe,isNumber:ct,isObject:ue,isRegExp:ht,isString:se,key:dt,lerp:pt,merge:vt,pad:mt,peek:Se,repeat:gt,span:yt,splitAccessPath:ae,stringValue:le,toBoolean:bt,toDate:xt,toNumber:De,toString:wt,toSet:kt,truncate:At,visitArray:Et,loader:Oo,read:Eo,inferType:Nr,inferTypes:jr,typeParsers:Cr,format:yi,formats:bi,responseType:_i,Bounds:sH,Gradient:vH,GroupItem:PH,ResourceLoader:LH,Item:gH,Scenegraph:XX,Handler:aJ,Renderer:sJ,CanvasHandler:pJ,CanvasRenderer:xJ,SVGHandler:SJ,SVGRenderer:PJ,SVGStringRenderer:QJ,RenderType:lZ,renderModule:cZ,intersect:hZ,Marks:UX,boundClip:yZ,boundContext:NY,boundStroke:OY,boundItem:qX,boundMark:HX,pathCurves:u$,pathSymbols:O$,pathRectangle:W$,pathTrail:H$,pathParse:f$,pathRender:k$,point:rJ,domCreate:QX,domFind:KX,domChild:eJ,domClear:tJ,openTag:FJ,closeTag:TJ,font:DX,fontFamily:SX,fontSize:_X,lineHeight:wX,multiLineOffset:EX,textMetrics:vX,resetSVGClipId:MV,sceneEqual:_Z,pathEqual:xZ,sceneToJSON:$X,sceneFromJSON:YX,intersectPath:HY,intersectPoint:GY,intersectRule:YY,intersectBoxLine:VY,sceneZOrder:nV,sceneVisit:rV,scenePickVisit:iV});var iwe="vega-lite";var awe='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer';var owe="4.1.1";var uwe=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"];var swe="https://vega.github.io/vega-lite/";var lwe="Vega-Lite is a concise high-level language for interactive visualization.";var fwe="build/vega-lite.js";var cwe="build/vega-lite.min.js";var hwe="build/vega-lite.min.js";var dwe="build/src/index";var pwe="build/src/index.d.ts";var vwe={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"};var gwe={test:"test"};var mwe={changelog:"conventional-changelog -p angular",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -c -f tsconfig.json -p src/index.ts -t TopLevelSpec -k deprecated > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint --ext .ts .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"};var ywe={type:"git",url:"https://github.com/vega/vega-lite.git"};var bwe="BSD-3-Clause";var _we={url:"https://github.com/vega/vega-lite/issues"};var xwe={"@commitlint/cli":"^8.3.5","@commitlint/config-conventional":"^8.3.4","@rollup/plugin-commonjs":"11.0.1","@rollup/plugin-json":"^4.0.1","@rollup/plugin-node-resolve":"^7.0.0","@types/chai":"^4.2.7","@types/d3":"^5.7.2","@types/highlight.js":"^9.12.3","@types/jest":"^24.9.1","@types/jest-environment-puppeteer":"^4.3.1","@types/mkdirp":"^0.5.2","@types/puppeteer":"^2.0.0","@typescript-eslint/eslint-plugin":"^2.17.0","@typescript-eslint/parser":"^2.17.0",ajv:"^6.11.0",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.6.2",concurrently:"^5.0.2","conventional-changelog":"^3.1.18",d3:"^5.15.0",eslint:"^6.8.0","eslint-config-prettier":"^6.9.0","eslint-plugin-prettier":"^3.1.2","gh-pages":"^2.2.0","highlight.js":"^9.18.0","http-server":"^0.12.1",husky:"^4.2.1",jest:"^25.1.0","jest-puppeteer":"^4.4.0","lint-staged":"^10.0.2",mkdirp:"^1.0.3",prettier:"^1.19.1",puppeteer:"^2.0.0",rollup:"^1.29.1","rollup-plugin-sourcemaps":"^0.5.0","rollup-plugin-terser":"^5.2.0","svg2png-many":"^0.0.7",terser:"^4.6.3","ts-jest":"^25.0.0","ts-json-schema-generator":"0.58.1",typescript:"~3.7.5","vega-cli":"^5.9.1","vega-datasets":"^1.29.0","vega-embed":"^6.2.2","vega-tooltip":"^0.20.0","yaml-front-matter":"^4.1.0"};var wwe={"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~1.10.0","vega-event-selector":"~2.0.2","vega-expression":"~2.6.3","vega-typings":"~0.12.0","vega-util":"~1.12.2",yargs:"~15.1.0"};var kwe={vega:"^5.9.0"};var Awe={hooks:{"pre-commit":"lint-staged","commit-msg":"commitlint -E HUSKY_GIT_PARAMS"}};var Ewe={preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:false};var Mwe={name:iwe,author:awe,version:owe,collaborators:uwe,homepage:swe,description:lwe,main:fwe,unpkg:cwe,jsdelivr:hwe,module:dwe,types:pwe,bin:vwe,directories:gwe,scripts:mwe,repository:ywe,license:bwe,bugs:_we,devDependencies:xwe,dependencies:wwe,peerDependencies:kwe,husky:Awe,"lint-staged":{"*.ts":["eslint --fix","git add"],"*.{md,css,yml}":["prettier --write","git add"]},jest:Ewe};function Owe(e,t,n){e.fields=t||[];e.fname=n;return e}function Swe(e){throw Error(e)}function Dwe(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)Swe("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)Swe("Access path missing closing bracket: "+e);if(n)Swe("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var Cwe=Array.isArray;function Fwe(e){return e===Object(e)}function Twe(e){return typeof e==="string"}function Nwe(e){return Cwe(e)?"["+e.map(Nwe)+"]":Fwe(e)||Twe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function jwe(e,t){var n=Dwe(e),r="return _["+n.map(Nwe).join("][")+"];";return Owe(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var Rwe=[];var zwe=jwe("id");var Pwe=Owe((function(e){return e}),Rwe,"identity");var Lwe=Owe((function(){return 0}),Rwe,"zero");var Iwe=Owe((function(){return 1}),Rwe,"one");var Bwe=Owe((function(){return true}),Rwe,"true");var Uwe=Owe((function(){return false}),Rwe,"false");function qwe(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var Wwe=0;var Hwe=1;var Gwe=2;var $we=3;var Ywe=4;function Vwe(e,t){var n=e||Wwe;return{level:function(e){if(arguments.length){n=+e;return this}else{return n}},error:function(){if(n>=Hwe)qwe(t||"error","ERROR",arguments);return this},warn:function(){if(n>=Gwe)qwe(t||"warn","WARN",arguments);return this},info:function(){if(n>=$we)qwe(t||"log","INFO",arguments);return this},debug:function(){if(n>=Ywe)qwe(t||"log","DEBUG",arguments);return this}}}function Xwe(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}return e.reduce((function(e,t){for(var n in t){if(n==="signals"){e.signals=Zwe(e.signals,t.signals)}else{var r=n==="legend"?{layout:1}:n==="style"?true:null;Jwe(e,n,t[n],r)}}return e}),{})}function Jwe(e,t,n,r){var i,a;if(Fwe(n)&&!Cwe(n)){a=Fwe(e[t])?e[t]:e[t]={};for(i in n){if(r&&(r===true||r[i])){Jwe(a,i,n[i])}else{a[i]=n[i]}}}else{e[t]=n}}function Zwe(e,t){if(e==null)return t;var n={},r=[];function i(e){if(!n[e.name]){n[e.name]=1;r.push(e)}}t.forEach(i);e.forEach(i);return r}function Qwe(e){return e!=null?Cwe(e)?e:[e]:[]}function Kwe(e){return typeof e==="function"}var eke=Object.prototype.hasOwnProperty;function tke(e,t){return eke.call(e,t)}function nke(e){return typeof e==="boolean"}function rke(e){return typeof e==="number"}function ike(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=true;return t}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var ake=Q((function(e){var t=function(){function e(e,t){return t!=null&&e instanceof t}var t;try{t=Map}catch(f){t=function(){}}var n;try{n=Set}catch(f){n=function(){}}var r;try{r=Promise}catch(f){r=function(){}}function i(a,o,u,s,f){if(typeof o==="object"){u=o.depth;s=o.prototype;f=o.includeNonEnumerable;o=o.circular}var c=[];var h=[];var d=typeof Buffer!="undefined";if(typeof o=="undefined")o=true;if(typeof u=="undefined")u=Infinity;function p(a,u){if(a===null)return null;if(u===0)return a;var v;var g;if(typeof a!="object"){return a}if(e(a,t)){v=new t}else if(e(a,n)){v=new n}else if(e(a,r)){v=new r((function(e,t){a.then((function(t){e(p(t,u-1))}),(function(e){t(p(e,u-1))}))}))}else if(i.__isArray(a)){v=[]}else if(i.__isRegExp(a)){v=new RegExp(a.source,l(a));if(a.lastIndex)v.lastIndex=a.lastIndex}else if(i.__isDate(a)){v=new Date(a.getTime())}else if(d&&Buffer.isBuffer(a)){if(Buffer.allocUnsafe){v=Buffer.allocUnsafe(a.length)}else{v=new Buffer(a.length)}a.copy(v);return v}else if(e(a,Error)){v=Object.create(a)}else{if(typeof s=="undefined"){g=Object.getPrototypeOf(a);v=Object.create(g)}else{v=Object.create(s);g=s}}if(o){var m=c.indexOf(a);if(m!=-1){return h[m]}c.push(a);h.push(v)}if(e(a,t)){a.forEach((function(e,t){var n=p(t,u-1);var r=p(e,u-1);v.set(n,r)}))}if(e(a,n)){a.forEach((function(e){var t=p(e,u-1);v.add(t)}))}for(var y in a){var b;if(g){b=Object.getOwnPropertyDescriptor(g,y)}if(b&&b.set==null){continue}v[y]=p(a[y],u-1)}if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(a);for(var y=0;y<_.length;y++){var x=_[y];var w=Object.getOwnPropertyDescriptor(a,x);if(w&&!w.enumerable&&!f){continue}v[x]=p(a[x],u-1);if(!w.enumerable){Object.defineProperty(v,x,{enumerable:false})}}}if(f){var k=Object.getOwnPropertyNames(a);for(var y=0;y<k.length;y++){var A=k[y];var w=Object.getOwnPropertyDescriptor(a,A);if(w&&w.enumerable){continue}v[A]=p(a[A],u-1);Object.defineProperty(v,A,{enumerable:false})}}return v}return p(a,u)}i.clonePrototype=function e(t){if(t===null)return null;var n=function(){};n.prototype=t;return new n};function a(e){return Object.prototype.toString.call(e)}i.__objToStr=a;function o(e){return typeof e==="object"&&a(e)==="[object Date]"}i.__isDate=o;function u(e){return typeof e==="object"&&a(e)==="[object Array]"}i.__isArray=u;function s(e){return typeof e==="object"&&a(e)==="[object RegExp]"}i.__isRegExp=s;function l(e){var t="";if(e.global)t+="g";if(e.ignoreCase)t+="i";if(e.multiline)t+="m";return t}i.__getRegExpFlags=l;return i}();if(e.exports){e.exports=t}}));var oke=function e(t,n){if(t===n)return true;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return false;var r,i,a;if(Array.isArray(t)){r=t.length;if(r!=n.length)return false;for(i=r;i--!==0;)if(!e(t[i],n[i]))return false;return true}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();a=Object.keys(t);r=a.length;if(r!==Object.keys(n).length)return false;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return false;for(i=r;i--!==0;){var o=a[i];if(!e(t[o],n[o]))return false}return true}return t!==t&&n!==n};var uke=function(e,t){if(!t)t={};if(typeof t==="function")t={cmp:t};var n=typeof t.cycles==="boolean"?t.cycles:false;var r=t.cmp&&function(e){return function(t){return function(n,r){var i={key:n,value:t[n]};var a={key:r,value:t[r]};return e(i,a)}}}(t.cmp);var i=[];return function e(t){if(t&&t.toJSON&&typeof t.toJSON==="function"){t=t.toJSON()}if(t===undefined)return;if(typeof t=="number")return isFinite(t)?""+t:"null";if(typeof t!=="object")return JSON.stringify(t);var a,o;if(Array.isArray(t)){o="[";for(a=0;a<t.length;a++){if(a)o+=",";o+=e(t[a])||"null"}return o+"]"}if(t===null)return"null";if(i.indexOf(t)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(t)-1;var s=Object.keys(t).sort(r&&r(t));o="";for(a=0;a<s.length;a++){var l=s[a];var f=e(t[l]);if(!f)continue;if(o)o+=",";o+=JSON.stringify(l)+":"+f}i.splice(u,1);return"{"+o+"}"}(e)};function ske(e){return!!e.or}function lke(e){return!!e.and}function fke(e){return!!e.not}function cke(e,t){if(fke(e)){cke(e.not,t)}else if(lke(e)){for(var n=0,r=e.and;n<r.length;n++){var i=r[n];cke(i,t)}}else if(ske(e)){for(var a=0,o=e.or;a<o.length;a++){var i=o[a];cke(i,t)}}else{t(e)}}function hke(e,t){if(fke(e)){return{not:hke(e.not,t)}}else if(lke(e)){return{and:e.and.map((function(e){return hke(e,t)}))}}else if(ske(e)){return{or:e.or.map((function(e){return hke(e,t)}))}}else{return t(e)}}var dke=oke;var pke=ake;function vke(e,t){var n={};for(var r=0,i=t;r<i.length;r++){var a=i[r];if(tke(e,a)){n[a]=e[a]}}return n}function gke(e,t){var n=Object.assign({},e);for(var r=0,i=t;r<i.length;r++){var a=i[r];delete n[a]}return n}Set.prototype["toJSON"]=function(){return"Set("+__spreadArrays(this).map((function(e){return uke(e)})).join(",")+")"};var mke=uke;function yke(e){if(rke(e)){return e}var t=Twe(e)?e:uke(e);if(t.length<250){return t}var n=0;for(var r=0;r<t.length;r++){var i=t.charCodeAt(r);n=(n<<5)-n+i;n=n&n}return n}function bke(e){return e===false||e===null}function _ke(e,t){return e.indexOf(t)>-1}function xke(e,t){var n=0;for(var r=0,i=e.entries();r<i.length;r++){var a=i[r],o=a[0],u=a[1];if(t(u,o,n++)){return true}}return false}function wke(e,t){var n=0;for(var r=0,i=e.entries();r<i.length;r++){var a=i[r],o=a[0],u=a[1];if(!t(u,o,n++)){return false}}return true}function kke(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}for(var r=0,i=t;r<i.length;r++){var a=i[r];Ake(e,a!==null&&a!==void 0?a:{})}return e}function Ake(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Jwe(e,i,t[i],true)}}function Eke(e,t){var n=[];var r={};var i;for(var a=0,o=e;a<o.length;a++){var u=o[a];i=t(u);if(i in r){continue}r[i]=1;n.push(u)}return n}function Mke(e,t){if(e.size!==t.size){return false}for(var n=0,r=e;n<r.length;n++){var i=r[n];if(!t.has(i)){return false}}return true}function Oke(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(t.has(i)){return true}}return false}function Ske(e){var t=new Set;var n=function(e){var n=Dwe(e);var r=n.map((function(e,t){return t===0?e:"["+e+"]"}));var i=r.map((function(e,t){return r.slice(0,t+1).join("")}));i.forEach((function(e){return t.add(e)}))};for(var r=0,i=e;r<i.length;r++){var a=i[r];n(a)}return t}function Dke(e,t){if(e===undefined||t===undefined){return true}return Oke(Ske(e),Ske(t))}var Cke=Object.keys;function Fke(e){var t=[];for(var n in e){if(tke(e,n)){t.push(e[n])}}return t}function Tke(e){return e===true||e===false}function Nke(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function jke(e,t){if(fke(e)){return"!("+jke(e.not,t)+")"}else if(lke(e)){return"("+e.and.map((function(e){return jke(e,t)})).join(") && (")+")"}else if(ske(e)){return"("+e.or.map((function(e){return jke(e,t)})).join(") || (")+")"}else{return t(e)}}function Rke(e,t){if(t.length===0){return true}var n=t.shift();if(Rke(e[n],t)){delete e[n]}return Cke(e).length===0}function zke(e){return e.charAt(0).toUpperCase()+e.substr(1)}function Pke(e){return e.replace(/(\[|\]|\.)/g,"\\$1")}function Lke(e,t){if(t===void 0){t="datum"}var n=Dwe(e);var r=[];for(var i=1;i<=n.length;i++){var a="["+n.slice(0,i).map(Nwe).join("][")+"]";r.push(""+t+a)}return r.join(" && ")}function Ike(e,t){if(t===void 0){t="datum"}return t+"["+Nwe(Dwe(e).join("."))+"]"}function Bke(e){return""+Dwe(e).map(Pke).join("\\.")}function Uke(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function qke(e){return""+Dwe(e).join(".")}function Wke(e){if(!e){return 0}return Dwe(e).length}function Hke(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i!==undefined){return i}}return undefined}var Gke=42;function $ke(e){var t=++Gke;return e?String(e)+t:t}function Yke(e){return Vke(e)?e:"__"+e}function Vke(e){return e.indexOf("__")===0}function Xke(e){return(e%360+360)%360}function Jke(e){if(rke(e)){return true}return!isNaN(e)&&!isNaN(parseFloat(e))}var Zke={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Qke(e){return e&&e["condition"]}var Kke=["domain","grid","labels","ticks","title"];var eAe={grid:"grid",gridColor:"grid",gridDash:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",domain:"main",domainColor:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontWeight:"main",labelLimit:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickColor:"main",tickExtra:"main",tickOffset:"both",tickOpacity:"main",tickRound:"main",ticks:"main",tickSize:"main",title:"main",titleAlign:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",tickWidth:"both",tickCount:"both",values:"both",scale:"both",zindex:"both"};var tAe={orient:1,bandPosition:1,domain:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,values:1,translate:1,zindex:1};var nAe=Object.assign(Object.assign({},tAe),{labelExpr:1,encoding:1});function rAe(e){return!!nAe[e]}var iAe="area";var aAe="bar";var oAe="image";var uAe="line";var sAe="point";var lAe="rect";var fAe="rule";var cAe="text";var hAe="tick";var dAe="trail";var pAe="circle";var vAe="square";var gAe="geoshape";var mAe={area:1,bar:1,image:1,line:1,point:1,text:1,tick:1,trail:1,rect:1,geoshape:1,rule:1,circle:1,square:1};function yAe(e){return _ke(["line","area","trail"],e)}function bAe(e){return _ke(["rect","bar","image"],e)}var _Ae=Cke(mAe);function xAe(e){return e["type"]}var wAe=ike(_Ae);var kAe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"];var AAe=["fill","fillOpacity"];var EAe=__spreadArrays(kAe,AAe);var MAe=["filled","color","tooltip","invalid","timeUnitBandPosition","timeUnitBand"];var OAe={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]};var SAe={color:"#4c78a8",invalid:"filter",timeUnitBand:1};var DAe={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]};var CAe=5;var FAe={binSpacing:1,continuousBandSize:CAe,timeUnitBandPosition:.5};var TAe={binSpacing:0,continuousBandSize:CAe,timeUnitBandPosition:.5};var NAe={thickness:1};function jAe(e){return xAe(e)?e.type:e}function RAe(e){return!!e["mark"]}var zAe=function(){function e(e,t){this.name=e;this.run=t}e.prototype.hasMatchingType=function(e){if(RAe(e)){return jAe(e.mark)===this.name}return false};return e}();var PAe={argmax:1,argmin:1,average:1,count:1,distinct:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1};var LAe={count:1,min:1,max:1};function IAe(e){return!!e&&!!e["argmin"]}function BAe(e){return!!e&&!!e["argmax"]}function UAe(e){return Twe(e)&&!!PAe[e]}var qAe=["count","valid","missing","distinct"];function WAe(e){return Twe(e)&&_ke(qAe,e)}function HAe(e){return Twe(e)&&_ke(["min","max"],e)}var GAe=["count","sum","distinct","valid","missing"];var $Ae=["mean","average","median","q1","q3","min","max"];var YAe=ike($Ae);var VAe="row";var XAe="column";var JAe="facet";var ZAe="x";var QAe="y";var KAe="x2";var eEe="y2";var tEe="latitude";var nEe="longitude";var rEe="latitude2";var iEe="longitude2";var aEe="color";var oEe="fill";var uEe="stroke";var sEe="shape";var lEe="size";var fEe="opacity";var cEe="fillOpacity";var hEe="strokeOpacity";var dEe="strokeWidth";var pEe="text";var vEe="order";var gEe="detail";var mEe="key";var yEe="tooltip";var bEe="href";var _Ee="url";var xEe={x:1,y:1,x2:1,y2:1};function wEe(e){switch(e){case tEe:return"y";case rEe:return"y2";case nEe:return"x";case iEe:return"x2"}}var kEe={longitude:1,longitude2:1,latitude:1,latitude2:1};function AEe(e){return e in kEe}var EEe=Cke(kEe);var MEe=Object.assign(Object.assign(Object.assign({},xEe),kEe),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,size:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1});function OEe(e){return e==="color"||e==="fill"||e==="stroke"}var SEe={row:1,column:1,facet:1};var DEe=Cke(SEe);var CEe=Object.assign(Object.assign({},MEe),SEe);var FEe=Cke(CEe);var TEe=h(CEe,["order","detail","tooltip"]);var NEe=h(TEe,["row","column","facet"]);function jEe(e){return!!NEe[e]}function REe(e){return!!CEe[e]}var zEe=["x2","y2","latitude2","longitude2"];function PEe(e){var t=LEe(e);return t!==e}function LEe(e){switch(e){case"x2":return"x";case"y2":return"y";case"latitude2":return"latitude";case"longitude2":return"longitude"}return e}function IEe(e){switch(e){case"x":return"x2";case"y":return"y2";case"latitude":return"latitude2";case"longitude":return"longitude2"}return undefined}var BEe=h(MEe,["x","y","x2","y2","latitude","longitude","latitude2","longitude2"]);var UEe=Cke(BEe);var qEe={x:1,y:1};var WEe=Cke(qEe);function HEe(e){return e==="x"?"width":"height"}function GEe(e){return e==="width"?"x":"y"}var $Ee=h(BEe,["text","tooltip","href","url","detail","key","order"]);var YEe=Cke($Ee);function VEe(e){return!!BEe[e]}function XEe(e){switch(e){case aEe:case oEe:case uEe:case lEe:case sEe:case fEe:case dEe:return true;case cEe:case hEe:return false}}var JEe=Object.assign(Object.assign({},qEe),$Ee);var ZEe=Cke(JEe);function QEe(e){return!!JEe[e]}function KEe(e,t){return nMe(e)[t]}var eMe={area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"};var tMe=h(eMe,["geoshape"]);function nMe(e){switch(e){case aEe:case oEe:case uEe:case gEe:case mEe:case yEe:case bEe:case vEe:case fEe:case cEe:case hEe:case dEe:case JAe:case VAe:case XAe:return eMe;case ZAe:case QAe:case tEe:case nEe:return tMe;case KAe:case eEe:case rEe:case iEe:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case lEe:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case sEe:return{point:"always",geoshape:"always"};case pEe:return{text:"always"};case _Ee:return{image:"always"}}}function rMe(e){switch(e){case ZAe:case QAe:case lEe:case dEe:case fEe:case cEe:case hEe:case KAe:case eEe:return undefined;case JAe:case VAe:case XAe:case sEe:case pEe:case yEe:case bEe:case _Ee:return"discrete";case aEe:case oEe:case uEe:return"flexible";case tEe:case nEe:case rEe:case iEe:case gEe:case mEe:case vEe:return undefined}}function iMe(e){return"Invalid specification "+JSON.stringify(e)+'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".'}var aMe='Autosize "fit" only works for single views and layered views.';function oMe(e){var t=e=="width"?"Width":"Height";return t+' "container" only works for single views and layered views.'}function uMe(e){var t=e=="width"?"Width":"Height";return t+' "container" only works well with autosize "fit" or "fit-x".'}function sMe(e){return e?'Dropping "fit-'+e+'" because spec has discrete '+HEe(e)+".":'Dropping "fit" because spec has discrete size.'}function lMe(e){return'Cannot project a selection on encoding channel "'+e+'", which has no field.'}function fMe(e,t){return'Cannot project a selection on encoding channel "'+e+'" as it uses an aggregate function ("'+t+'").'}function cMe(e){return'The "nearest" transform is not supported for '+e+" marks."}function hMe(e){return"Selection not supported for "+e+" yet."}function dMe(e){return'Cannot find a selection named "'+e+'".'}var pMe="Scale bindings are currently only supported for scales with unbinned, continuous domains.";var vMe="Legend bindings are only supported for selections over an individual field or encoding channel.";function gMe(e){return'Cannot define and lookup the "'+e+'" selection in the same view. '+"Try moving the lookup into a second, layered view?"}function mMe(e){return'Unknown repeated value "'+e+'".'}function yMe(e){return'The "columns" property cannot be used when "'+e+'" has nested row/column.'}var bMe="Axes cannot be shared in concatenated views yet (https://github.com/vega/vega-lite/issues/2415).";var _Me="Axes cannot be shared in repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function xMe(e){return'Unrecognized parse "'+e+'".'}function wMe(e,t,n){return'An ancestor parsed field "'+e+'" as '+n+" but a child wants to parse the field as "+t+"."}function kMe(e){return"Ignoring an invalid transform: "+mke(e)+"."}var AMe='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function EMe(e){return"Layer's shared "+e.join(",")+" channel "+(e.length===1?"is":"are")+" overriden."}function MMe(e){var t=e.parentProjection,n=e.projection;return"Layer's shared projection "+mke(t)+" is overridden by a child projection "+mke(n)+"."}function OMe(e,t,n){return"Channel "+e+" is a "+t+". Converted to {value: "+mke(n)+"}."}function SMe(e){return'Invalid field type "'+e+'".'}function DMe(e,t,n){var r=n.scaleType?n.scaleType+" scale":n.zeroFalse?"scale with zero=false":"scale with custom domain that excludes zero";return"A "+r+" is used to encode "+e+"'s "+t+". This can be misleading as the "+(t==="x"?"width":"height")+" of the "+e+" can be arbitrary based on the scale domain. You may want to use point mark instead."}function CMe(e,t){return'Invalid field type "'+e+'" for aggregate: "'+t+'", using "quantitative" instead.'}function FMe(e){return'Invalid aggregation operator "'+e+'".'}function TMe(e,t){return'Missing type for channel "'+e+'", using "'+t+'" instead.'}function NMe(e,t){var n=t.fill,r=t.stroke;return"Dropping color "+e+" as the plot also has "+(n&&r?"fill and stroke":n?"fill":"stroke")+"."}function jMe(e,t){return"Dropping "+mke(e)+' from channel "'+t+'" since it does not contain data field or value.'}function RMe(e,t,n){return e+"-encoding with type "+t+" is deprecated. Replacing with "+n+"-encoding."}var zMe="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function PMe(e,t,n){return e+' dropped as it is incompatible with "'+t+'"'+(n?" when "+n:"")+"."}function LMe(e){return e+"-encoding is dropped as "+e+" is not a valid encoding channel."}function IMe(e){return e+" encoding should be discrete (ordinal / nominal / binned)."}function BMe(e){return"Facet encoding dropped as "+e.join(" and ")+" "+(e.length>1?"are":"is")+" also specified."}function UMe(e,t){return'Using discrete channel "'+e+'" to encode "'+t+'" field can be misleading as it does not encode '+(t==="ordinal"?"order":"magnitude")+"."}function qMe(e,t){var n=e&&t?"x2 and y2":e?"x2":"y2";return"Line mark is for continuous lines and thus cannot be used with "+n+". We will use the rule mark (line segments) instead."}function WMe(e,t){return'Specified orient "'+e+'" overridden with "'+t+'".'}var HMe="Custom domain scale cannot be unioned with default field-based domain.";var GMe='Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.';function $Me(e){return'Cannot use the scale property "'+e+'" with non-color channel.'}function YMe(e){return"Using unaggregated domain with raw field has no effect ("+mke(e)+")."}function VMe(e){return'Unaggregated domain not applicable for "'+e+'" since it produces values outside the origin domain of the source data.'}function XMe(e){return"Unaggregated domain is currently unsupported for log scale ("+mke(e)+")."}function JMe(e){return'Cannot apply size to non-oriented mark "'+e+'".'}function ZMe(e,t,n){return'Channel "'+e+'" does not work with "'+t+'" scale. We are using "'+n+'" scale instead.'}function QMe(e,t){return'FieldDef does not work with "'+e+'" scale. We are using "'+t+'" scale instead.'}function KMe(e,t,n){return n+"-scale's \""+t+'" is dropped as it does not work with '+e+" scale."}function eOe(e,t){return'Scale type "'+t+'" does not work with mark "'+e+'".'}function tOe(e){return'The step for "'+e+'" is dropped because the '+(e==="width"?"x":"y")+" is continuous."}function nOe(e,t,n,r){return"Conflicting "+t.toString()+' property "'+e.toString()+'" ('+mke(n)+" and "+mke(r)+"). Using "+mke(n)+"."}function rOe(e,t,n,r){return"Conflicting "+t.toString()+' property "'+e.toString()+'" ('+mke(n)+" and "+mke(r)+"). Using the union of the two domains."}function iOe(e){return'Setting the scale to be independent for "'+e+'" means we also have to set the guide (axis or legend) to be independent.'}function aOe(e){return"Dropping sort property "+mke(e)+' as unioned domains only support boolean or op "count", "min", and "max".'}var oOe="Unable to merge domains.";var uOe="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";var sOe="Invalid channel for axis.";function lOe(e){return'Cannot stack "'+e+'" if there is already "'+e+'2".'}function fOe(e){return"Cannot stack non-linear scale ("+e+")."}function cOe(e){return'Stacking is applied even though the aggregate function is non-summative ("'+e+'").'}function hOe(e,t){return"Invalid "+e+": "+mke(t)+"."}function dOe(e){return'Time unit "'+e+'" is not supported. We are replacing it with '+Uke(e,"day","date")+"."}function pOe(e){return"Dropping day from datetime "+mke(e)+" as day cannot be combined with other units."}function vOe(e,t){return""+(t?"extent ":"")+(t&&e?"and ":"")+(e?"center ":"")+(t&&e?"are ":"is ")+"not needed when data are aggregated."}function gOe(e,t,n){return e+" is not usually used with "+t+" for "+n+"."}function mOe(e,t){return"Continuous axis should not have customized aggregation function "+e+"; "+t+" already agregates the axis."}function yOe(e,t){return"Center is not needed to be specified in "+t+" when extent is "+e+"."}function bOe(e){return"1D error band does not support "+e+"."}function _Oe(e){return"Channel "+e+' is required for "binned" bin.'}function xOe(e){return"Domain for "+e+" is required for threshold scale."}var wOe=Object.freeze({__proto__:null,invalidSpec:iMe,FIT_NON_SINGLE:aMe,containerSizeNonSingle:oMe,containerSizeNotCompatibleWithAutosize:uMe,droppingFit:sMe,cannotProjectOnChannelWithoutField:lMe,cannotProjectAggregate:fMe,nearestNotSupportForContinuous:cMe,selectionNotSupported:hMe,selectionNotFound:dMe,SCALE_BINDINGS_CONTINUOUS:pMe,LEGEND_BINDINGS_PROJECT_LENGTH:vMe,noSameUnitLookup:gMe,noSuchRepeatedValue:mMe,columnsNotSupportByRowCol:yMe,CONCAT_CANNOT_SHARE_AXIS:bMe,REPEAT_CANNOT_SHARE_AXIS:_Me,unrecognizedParse:xMe,differentParse:wMe,invalidTransformIgnored:kMe,NO_FIELDS_NEEDS_AS:AMe,encodingOverridden:EMe,projectionOverridden:MMe,primitiveChannelDef:OMe,invalidFieldType:SMe,nonZeroScaleUsedWithLengthMark:DMe,invalidFieldTypeForCountAggregate:CMe,invalidAggregate:FMe,missingFieldType:TMe,droppingColor:NMe,emptyFieldDef:jMe,latLongDeprecated:RMe,LINE_WITH_VARYING_SIZE:zMe,incompatibleChannel:PMe,invalidEncodingChannel:LMe,facetChannelShouldBeDiscrete:IMe,facetChannelDropped:BMe,discreteChannelCannotEncode:UMe,lineWithRange:qMe,orientOverridden:WMe,CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN:HMe,RANGE_STEP_DEPRECATED:GMe,cannotUseScalePropertyWithNonColor:$Me,unaggregateDomainHasNoEffectForRawField:YMe,unaggregateDomainWithNonSharedDomainOp:VMe,unaggregatedDomainWithLogScale:XMe,cannotApplySizeToNonOrientedMark:JMe,scaleTypeNotWorkWithChannel:ZMe,scaleTypeNotWorkWithFieldDef:QMe,scalePropertyNotWorkWithScaleType:KMe,scaleTypeNotWorkWithMark:eOe,stepDropped:tOe,mergeConflictingProperty:nOe,mergeConflictingDomainProperty:rOe,independentScaleMeansIndependentGuide:iOe,domainSortDropped:aOe,UNABLE_TO_MERGE_DOMAINS:oOe,MORE_THAN_ONE_SORT:uOe,INVALID_CHANNEL_FOR_AXIS:sOe,cannotStackRangedMark:lOe,cannotStackNonLinearScale:fOe,stackNonSummativeAggregate:cOe,invalidTimeUnit:hOe,dayReplacedWithDate:dOe,droppedDay:pOe,errorBarCenterAndExtentAreNotNeeded:vOe,errorBarCenterIsUsedWithWrongExtent:gOe,errorBarContinuousAxisHasCustomizedAggregate:mOe,errorBarCenterIsNotNeeded:yOe,errorBand1DNotSupport:bOe,channelRequiredForBinned:_Oe,domainRequiredForThresholdScale:xOe});var kOe=wOe;var AOe=Vwe(Gwe);var EOe=AOe;function MOe(e){EOe=e;return EOe}function OOe(){EOe=AOe;return EOe}function SOe(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}EOe.warn.apply(EOe,e)}function DOe(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}EOe.debug.apply(EOe,e)}var COe=2006;function FOe(e){return!!e&&(!!e.year||!!e.quarter||!!e.month||!!e.date||!!e.day||!!e.hours||!!e.minutes||!!e.seconds||!!e.milliseconds)}var TOe=["january","february","march","april","may","june","july","august","september","october","november","december"];var NOe=TOe.map((function(e){return e.substr(0,3)}));var jOe=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];var ROe=jOe.map((function(e){return e.substr(0,3)}));function zOe(e){if(Jke(e)){e=+e}if(rke(e)){if(e>4){SOe(kOe.invalidTimeUnit("quarter",e))}return e-1}else{throw new Error(kOe.invalidTimeUnit("quarter",e))}}function POe(e){if(Jke(e)){e=+e}if(rke(e)){return e-1}else{var t=e.toLowerCase();var n=TOe.indexOf(t);if(n!==-1){return n}var r=t.substr(0,3);var i=NOe.indexOf(r);if(i!==-1){return i}throw new Error(kOe.invalidTimeUnit("month",e))}}function LOe(e){if(Jke(e)){e=+e}if(rke(e)){return e%7}else{var t=e.toLowerCase();var n=jOe.indexOf(t);if(n!==-1){return n}var r=t.substr(0,3);var i=ROe.indexOf(r);if(i!==-1){return i}throw new Error(kOe.invalidTimeUnit("day",e))}}function IOe(e,t){var n=[];if(t&&e.day!==undefined){if(Cke(e).length>1){SOe(kOe.droppedDay(e));e=pke(e);delete e.day}}if(e.year!==undefined){n.push(e.year)}else if(e.day!==undefined){n.push(COe)}else{n.push(0)}if(e.month!==undefined){var r=t?POe(e.month):e.month;n.push(r)}else if(e.quarter!==undefined){var i=t?zOe(e.quarter):e.quarter;n.push(rke(i)?i*3:i+"*3")}else{n.push(0)}if(e.date!==undefined){n.push(e.date)}else if(e.day!==undefined){var a=t?LOe(e.day):e.day;n.push(rke(a)?a+1:a+"+1")}else{n.push(1)}for(var o=0,u=["hours","minutes","seconds","milliseconds"];o<u.length;o++){var s=u[o];var l=e[s];n.push(typeof l==="undefined"?0:l)}return n}function BOe(e){var t=IOe(e,true);var n=t.join(", ");if(e.utc){return"utc("+n+")"}else{return"datetime("+n+")"}}function UOe(e){var t=IOe(e,false);var n=t.join(", ");if(e.utc){return"utc("+n+")"}else{return"datetime("+n+")"}}function qOe(e){var t=IOe(e,true);if(e.utc){return+new Date(Date.UTC.apply(Date,t))}else{return+new(Date.bind.apply(Date,__spreadArrays([void 0],t)))}}var WOe;(function(e){e.YEAR="year";e.MONTH="month";e.DAY="day";e.DATE="date";e.HOURS="hours";e.MINUTES="minutes";e.SECONDS="seconds";e.MILLISECONDS="milliseconds";e.YEARMONTH="yearmonth";e.YEARMONTHDATE="yearmonthdate";e.YEARMONTHDATEHOURS="yearmonthdatehours";e.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes";e.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds";e.MONTHDATE="monthdate";e.MONTHDATEHOURS="monthdatehours";e.HOURSMINUTES="hoursminutes";e.HOURSMINUTESSECONDS="hoursminutesseconds";e.MINUTESSECONDS="minutesseconds";e.SECONDSMILLISECONDS="secondsmilliseconds";e.QUARTER="quarter";e.YEARQUARTER="yearquarter";e.QUARTERMONTH="quartermonth";e.YEARQUARTERMONTH="yearquartermonth";e.UTCYEAR="utcyear";e.UTCMONTH="utcmonth";e.UTCDAY="utcday";e.UTCDATE="utcdate";e.UTCHOURS="utchours";e.UTCMINUTES="utcminutes";e.UTCSECONDS="utcseconds";e.UTCMILLISECONDS="utcmilliseconds";e.UTCYEARMONTH="utcyearmonth";e.UTCYEARMONTHDATE="utcyearmonthdate";e.UTCYEARMONTHDATEHOURS="utcyearmonthdatehours";e.UTCYEARMONTHDATEHOURSMINUTES="utcyearmonthdatehoursminutes";e.UTCYEARMONTHDATEHOURSMINUTESSECONDS="utcyearmonthdatehoursminutesseconds";e.UTCMONTHDATE="utcmonthdate";e.UTCMONTHDATEHOURS="utcmonthdatehours";e.UTCHOURSMINUTES="utchoursminutes";e.UTCHOURSMINUTESSECONDS="utchoursminutesseconds";e.UTCMINUTESSECONDS="utcminutesseconds";e.UTCSECONDSMILLISECONDS="utcsecondsmilliseconds";e.UTCQUARTER="utcquarter";e.UTCYEARQUARTER="utcyearquarter";e.UTCQUARTERMONTH="utcquartermonth";e.UTCYEARQUARTERMONTH="utcyearquartermonth"})(WOe||(WOe={}));var HOe={year:1,quarter:1,month:1,day:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};var GOe=Cke(HOe);function $Oe(e){return!!HOe[e]}var YOe={utcyear:1,utcquarter:1,utcmonth:1,utcday:1,utcdate:1,utchours:1,utcminutes:1,utcseconds:1,utcmilliseconds:1};var VOe={yearquarter:1,yearquartermonth:1,yearmonth:1,yearmonthdate:1,yearmonthdatehours:1,yearmonthdatehoursminutes:1,yearmonthdatehoursminutesseconds:1,quartermonth:1,monthdate:1,monthdatehours:1,hoursminutes:1,hoursminutesseconds:1,minutesseconds:1,secondsmilliseconds:1};var XOe={utcyearquarter:1,utcyearquartermonth:1,utcyearmonth:1,utcyearmonthdate:1,utcyearmonthdatehours:1,utcyearmonthdatehoursminutes:1,utcyearmonthdatehoursminutesseconds:1,utcquartermonth:1,utcmonthdate:1,utcmonthdatehours:1,utchoursminutes:1,utchoursminutesseconds:1,utcminutesseconds:1,utcsecondsmilliseconds:1};var JOe=Object.assign(Object.assign({},YOe),XOe);function ZOe(e){return!!JOe[e]}function QOe(e){return e.substr(3)}var KOe=Object.assign(Object.assign(Object.assign(Object.assign({},HOe),YOe),VOe),XOe);var eSe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function tSe(e){return GOe.reduce((function(t,n){if(nSe(e,n)){return __spreadArrays(t,[n])}return t}),[])}function nSe(e,t){var n=e.indexOf(t);return n>-1&&(t!==WOe.SECONDS||n===0||e.charAt(n-1)!=="i")}function rSe(e,t,n){var r=(n===void 0?{end:false}:n).end;var i=Lke(t);var a=ZOe(e)?"utc":"";function o(e){if(e===WOe.QUARTER){return"("+a+"quarter("+i+")-1)"}else{return""+a+e+"("+i+")"}}var u;var s=GOe.reduce((function(t,n){if(nSe(e,n)){t[n]=o(n);u=n}return t}),{});if(r){s[u]+="+1"}return UOe(s)}function iSe(e){if(!e){return undefined}var t=tSe(e);return"timeUnitSpecifier("+uke(t)+", "+uke(eSe)+")"}function aSe(e,t,n){if(!e){return undefined}var r=iSe(e);if(n||ZOe(e)){return"utcFormat("+t+", "+r+")"}else{return"timeFormat("+t+", "+r+")"}}function oSe(e){if(!e){return undefined}var t;if(Twe(e)){t={unit:uSe(e)}}else if(Fwe(e)){t=Object.assign(Object.assign({},e),e.unit?{unit:uSe(e.unit)}:{})}if(ZOe(t.unit)){t.utc=true;t.unit=QOe(t.unit)}return t}function uSe(e){if(e!=="day"&&e.indexOf("day")>=0){SOe(kOe.dayReplacedWithDate(e));return Uke(e,"day","date")}return e}function sSe(e){var t=oSe(e),n=t.utc,r=h(t,["utc"]);if(r.unit){return(n?"utc":"")+Cke(r).map((function(e){return Nke(""+(e==="unit"?"":"_"+e+"_")+r[e])})).join("")}else{return(n?"utc":"")+"timeunit"+Cke(r).map((function(e){return Nke("_"+e+"_"+r[e])})).join("")}}function lSe(e){var t;return(t=e)===null||t===void 0?void 0:t["selection"]}function fSe(e){return e&&!!e.field&&e.equal!==undefined}function cSe(e){return e&&!!e.field&&e.lt!==undefined}function hSe(e){return e&&!!e.field&&e.lte!==undefined}function dSe(e){return e&&!!e.field&&e.gt!==undefined}function pSe(e){return e&&!!e.field&&e.gte!==undefined}function vSe(e){if(e&&e.field){if(Cwe(e.range)&&e.range.length===2){return true}}return false}function gSe(e){return e&&!!e.field&&(Cwe(e.oneOf)||Cwe(e.in))}function mSe(e){return e&&!!e.field&&e.valid!==undefined}function ySe(e){return gSe(e)||fSe(e)||vSe(e)||cSe(e)||dSe(e)||hSe(e)||pSe(e)}function bSe(e,t){return kCe(e,{timeUnit:t,time:true})}function _Se(e,t){return e.map((function(e){return bSe(e,t)}))}function xSe(e,t){if(t===void 0){t=true}var n;var r=e.field;var i=(n=oSe(e.timeUnit))===null||n===void 0?void 0:n.unit;var a=i?"time("+rSe(i,r)+")":KDe(e,{expr:"datum"});if(fSe(e)){return a+"==="+bSe(e.equal,i)}else if(cSe(e)){var o=e.lt;return a+"<"+bSe(o,i)}else if(dSe(e)){var u=e.gt;return a+">"+bSe(u,i)}else if(hSe(e)){var o=e.lte;return a+"<="+bSe(o,i)}else if(pSe(e)){var u=e.gte;return a+">="+bSe(u,i)}else if(gSe(e)){return"indexof(["+_Se(e.oneOf,i).join(",")+"], "+a+") !== -1"}else if(mSe(e)){return wSe(a,e.valid)}else if(vSe(e)){var u=e.range[0];var o=e.range[1];if(u!==null&&o!==null&&t){return"inrange("+a+", ["+bSe(u,i)+", "+bSe(o,i)+"])"}var s=[];if(u!==null){s.push(a+" >= "+bSe(u,i))}if(o!==null){s.push(a+" <= "+bSe(o,i))}return s.length>0?s.join(" && "):"true"}throw new Error("Invalid field predicate: "+JSON.stringify(e))}function wSe(e,t){if(t===void 0){t=true}if(t){return"isValid("+e+") && isFinite(+"+e+")"}else{return"!isValid("+e+") || !isFinite(+"+e+")"}}function kSe(e){var t;if(ySe(e)&&e.timeUnit){return Object.assign(Object.assign({},e),{timeUnit:(t=oSe(e.timeUnit))===null||t===void 0?void 0:t.unit})}return e}var ASe={quantitative:1,ordinal:1,temporal:1,nominal:1,geojson:1};var ESe="quantitative";var MSe="ordinal";var OSe="temporal";var SSe="nominal";var DSe="geojson";function CSe(e){if(e){e=e.toLowerCase();switch(e){case"q":case ESe:return"quantitative";case"t":case OSe:return"temporal";case"o":case MSe:return"ordinal";case"n":case SSe:return"nominal";case DSe:return"geojson"}}return undefined}var FSe;(function(e){e.LINEAR="linear";e.LOG="log";e.POW="pow";e.SQRT="sqrt";e.SYMLOG="symlog";e.TIME="time";e.UTC="utc";e.QUANTILE="quantile";e.QUANTIZE="quantize";e.THRESHOLD="threshold";e.BIN_ORDINAL="bin-ordinal";e.ORDINAL="ordinal";e.POINT="point";e.BAND="band"})(FSe||(FSe={}));var TSe={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};var NSe=Cke(TSe);function jSe(e,t){var n=TSe[e];var r=TSe[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}var RSe={linear:0,log:1,pow:1,sqrt:1,symlog:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function zSe(e){return RSe[e]}var PSe=["linear","log","pow","sqrt","symlog","time","utc"];var LSe=ike(PSe);var ISe=["quantile","quantize","threshold"];var BSe=ike(ISe);var USe=PSe.concat(["quantile","quantize","threshold"]);var qSe=ike(USe);var WSe=["ordinal","bin-ordinal","point","band"];var HSe=ike(WSe);function GSe(e){return e in HSe}function $Se(e){return e in qSe}function YSe(e){return e in LSe}function VSe(e){return e in BSe}var XSe={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function JSe(e){return!Twe(e)&&!!e["name"]}function ZSe(e){var t;return(t=e)===null||t===void 0?void 0:t["selection"]}var QSe={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1};var KSe=h(QSe,["type","domain","range","scheme"]);var eDe=Cke(KSe);var tDe=oDe();function nDe(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return true;case"scheme":case"interpolate":return!_ke(["point","band","identity"],e);case"bins":return!_ke(["point","band","identity","ordinal"],e);case"round":return YSe(e)||e==="band"||e==="point";case"padding":return YSe(e)||_ke(["point","band"],e);case"paddingOuter":case"align":return _ke(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return YSe(e);case"nice":return YSe(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return $Se(e)&&!_ke(["log","time","utc","threshold","quantile"],e)}}function rDe(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":if(!OEe(e)){return kOe.cannotUseScalePropertyWithNonColor(e)}return undefined;case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return undefined}}function iDe(e,t){if(_ke([MSe,SSe],t)){return e===undefined||GSe(e)}else if(t===OSe){return _ke([FSe.TIME,FSe.UTC,undefined],e)}else if(t===ESe){return _ke([FSe.LOG,FSe.POW,FSe.SQRT,FSe.SYMLOG,FSe.QUANTILE,FSe.QUANTIZE,FSe.THRESHOLD,FSe.LINEAR,undefined],e)}return true}function aDe(e,t){switch(e){case ZAe:case QAe:return YSe(t)||_ke(["band","point"],t);case lEe:case dEe:case fEe:case cEe:case hEe:return YSe(t)||VSe(t)||_ke(["band","point"],t);case aEe:case oEe:case uEe:return t!=="band";case sEe:return t==="ordinal"}return false}function oDe(){var e;var t={};for(var n=0,r=FEe;n<r.length;n++){var i=r[n];for(var a=0,o=Cke(ASe);a<o.length;a++){var u=o[a];for(var s=0,l=NSe;s<l.length;s++){var f=l[s];var c=uDe(i,u);if(aDe(i,f)&&iDe(f,u)){t[c]=(e=t[c],e!==null&&e!==void 0?e:[]);t[c].push(f)}}}}return t}function uDe(e,t){return e+"_"+t}function sDe(e){var t=e.anchor,n=e.frame,r=e.offset,i=e.orient,a=e.color,o=e.subtitleColor,u=e.subtitleFont,s=e.subtitleFontSize,l=e.subtitleFontStyle,f=e.subtitleFontWeight,c=e.subtitleLineHeight,d=e.subtitlePadding,p=h(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]);var v=Object.assign(Object.assign({},p),a?{fill:a}:{});var g=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{});var m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),u?{subtitleFont:u}:{}),s?{subtitleFontSize:s}:{}),l?{subtitleFontStyle:l}:{}),f?{subtitleFontWeight:f}:{}),c?{subtitleLineHeight:c}:{}),d?{subtitlePadding:d}:{});return{mark:v,nonMark:g,subtitle:m}}function lDe(e){return Twe(e)||Cwe(e)&&Twe(e[0])}var fDe=" – ";function cDe(e,t,n){for(var r=0,i=n;r<i.length;r++){var a=i[r];var o=pDe(a,t.markDef,t.config);if(o!==undefined){e[a]={value:o}}}return e}function hDe(e){var t;return[].concat(e.type,(t=e.style,t!==null&&t!==void 0?t:[]))}function dDe(e,t,n){return Hke(t[e],pDe(e,t,n))}function pDe(e,t,n,r){var i=(r===void 0?{}:r).vgChannel;return Hke(i?vDe(e,t,n.style):undefined,vDe(e,t,n.style),i?n[t.type][i]:undefined,n[t.type][e],i?n.mark[i]:n.mark[e])}function vDe(e,t,n){var r=hDe(t);var i;for(var a=0,o=r;a<o.length;a++){var u=o[a];var s=n[u];var l=e;if(s&&s[l]!==undefined){i=s[l]}}return i}function gDe(e,t,n,r){var i;if(xCe(e)){var a=VDe(e)&&e["scale"]&&e["scale"].type===FSe.UTC;return{signal:xDe(KDe(e,{expr:n}),(i=oSe(e.timeUnit))===null||i===void 0?void 0:i.unit,t,r.timeFormat,a,true)}}else{var o=mDe(e,t,r);if(OCe(e.bin)){var u=KDe(e,{expr:n});var s=KDe(e,{expr:n,binSuffix:"end"});return{signal:_De(u,s,o,r)}}else if(e.type==="quantitative"||o){return{signal:""+yDe(KDe(e,{expr:n,binSuffix:"range"}),o)}}else{return{signal:"''+"+KDe(e,{expr:n})}}}}function mDe(e,t,n){if(t){return t}if(e.type===ESe){return n.numberFormat}return undefined}function yDe(e,t){return"format("+e+', "'+(t||"")+'")'}function bDe(e,t,n){return yDe(e,t!==null&&t!==void 0?t:n.numberFormat)}function _De(e,t,n,r){return wSe(e,false)+' ? "null" : '+bDe(e,n,r)+' + "'+fDe+'" + '+bDe(t,n,r)}function xDe(e,t,n,r,i,a){if(a===void 0){a=false}if(!t||n){n=n!==null&&n!==void 0?n:r;if(n||a){return(i?"utc":"time")+"Format("+e+", '"+n+"')"}else{return undefined}}else{return aSe(t,e,i)}}function wDe(e,t){return Qwe(e).reduce((function(e,n){var r;e.field.push(KDe(n,t));e.order.push((r=n.sort,r!==null&&r!==void 0?r:"ascending"));return e}),{field:[],order:[]})}function kDe(e,t){var n=__spreadArrays(e);t.forEach((function(e){for(var t=0,r=n;t<r.length;t++){var i=r[t];if(dke(i,e)){return}}n.push(e)}));return n}function ADe(e,t){if(dke(e,t)||!t){return e}else if(!e){return t}else{return __spreadArrays(Qwe(e),Qwe(t)).join(", ")}}function EDe(e,t){var n=e.value;var r=t.value;if(n==null||r===null){return{explicit:e.explicit,value:null}}else if(lDe(n)&&lDe(r)){return{explicit:e.explicit,value:ADe(n,r)}}else if(!lDe(n)&&!lDe(r)){return{explicit:e.explicit,value:kDe(n,r)}}throw new Error("It should never reach here")}var MDe="mean";var ODe={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function SDe(e){return!!ODe[e]}function DDe(e){return!!e&&!!e["encoding"]}function CDe(e){return!!e&&(e["op"]==="count"||!!e["field"])}function FDe(e){return!!e&&Cwe(e)}function TDe(e){return!!e["row"]||!!e["column"]}function NDe(e){return!!e&&!!e["header"]}function jDe(e){return e["facet"]!==undefined}function RDe(e){return e["selection"]}function zDe(e){return e&&!Twe(e)&&"repeat"in e}function PDe(e){var t=e.field,n=e.timeUnit,r=e.bin,i=e.aggregate;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function LDe(e){return GDe(e)&&!!e["sort"]}function IDe(e,t,n,r,i,a){var o=(a===void 0?{}:a).isMidPoint;var u=t.timeUnit,s=t.bin;if(_ke(["x","y"],e)){if(XDe(t)&&t.band!==undefined){return t.band}else if(u&&!n){if(o){return pDe("timeUnitBandPosition",r,i)}else{return bAe(r.type)?pDe("timeUnitBand",r,i):0}}else if(OCe(s)){return bAe(r.type)&&!o?1:.5}}return undefined}function BDe(e,t,n,r,i){if(OCe(t.bin)||t.timeUnit&&GDe(t)&&t.type==="temporal"){return!!IDe(e,t,n,r,i)}return false}function UDe(e){return!!e&&!!e.condition}function qDe(e){return!!e&&!!e.condition&&!Cwe(e.condition)&&HDe(e.condition)}function WDe(e){return!!e&&!!e.condition&&(Cwe(e.condition)||YDe(e.condition))}function HDe(e){return!!e&&(!!e["field"]||e["aggregate"]==="count")}function GDe(e){return!!e&&(!!e["field"]&&!!e["type"]||e["aggregate"]==="count")}function $De(e){return HDe(e)&&Twe(e.field)}function YDe(e){return e&&"value"in e&&e["value"]!==undefined}function VDe(e){return!!e&&(!!e["scale"]||!!e["sort"])}function XDe(e){return!!e&&(!!e["axis"]||!!e["stack"]||!!e["impute"]||e["band"]!==undefined)}function JDe(e){return!!e&&!!e["legend"]}function ZDe(e){return!!e&&!!e["format"]}function QDe(e){return!!e["op"]}function KDe(e,t){if(t===void 0){t={}}var n,r,i;var a=e.field;var o=t.prefix;var u=t.suffix;var s="";if(nCe(e)){a=Yke("count")}else{var l=void 0;if(!t.nofn){if(QDe(e)){l=e.op}else{var f=e.bin,c=e.aggregate,h=e.timeUnit;if(OCe(f)){l=MCe(f);u=(n=t.binSuffix,n!==null&&n!==void 0?n:"")+(r=t.suffix,r!==null&&r!==void 0?r:"")}else if(c){if(BAe(c)){s="."+a;a="argmax_"+c.argmax}else if(IAe(c)){s="."+a;a="argmin_"+c.argmin}else{l=String(c)}}else if(h){l=sSe(h);u=(!_ke(["range","mid"],t.binSuffix)&&t.binSuffix||"")+(i=t.suffix,i!==null&&i!==void 0?i:"")}}}if(l){a=a?l+"_"+a:l}}if(u){a=a+"_"+u}if(o){a=o+"_"+a}if(t.forAs){return a}else if(t.expr){return Ike(a,t.expr)+s}else{return Bke(a)+s}}function eCe(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return true;case"quantitative":return!!e.bin;case"temporal":return false}throw new Error(kOe.invalidFieldType(e.type))}function tCe(e){return!eCe(e)}function nCe(e){return e.aggregate==="count"}function rCe(e,t){var n;var r=e.field,i=e.bin,a=e.timeUnit,o=e.aggregate;if(o==="count"){return t.countTitle}else if(OCe(i)){return r+" (binned)"}else if(a){var u=(n=oSe(a))===null||n===void 0?void 0:n.unit;if(u){return r+" ("+tSe(u).join("-")+")"}}else if(o){if(BAe(o)){return r+" for max "+o.argmax}else if(IAe(o)){return r+" for min "+o.argmin}else{return zke(o)+" of "+r}}return r}function iCe(e){var t,n;var r=e.aggregate,i=e.bin,a=e.timeUnit,o=e.field;if(BAe(r)){return o+" for argmax("+r.argmax+")"}else if(IAe(r)){return o+" for argmin("+r.argmin+")"}var u=oSe(a);var s=r||((t=u)===null||t===void 0?void 0:t.unit)||((n=u)===null||n===void 0?void 0:n.maxbins)&&"timeunit"||OCe(i)&&"bin";if(s){return s.toUpperCase()+"("+o+")"}else{return o}}var aCe=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return iCe(e);default:return rCe(e,t)}};var oCe=aCe;function uCe(e){oCe=e}function sCe(){uCe(aCe)}function lCe(e,t,n){var r=n.allowDisabling,i=n.includeDefault,a=i===void 0?true:i;var o,u;var s=(o=fCe(e),o!==null&&o!==void 0?o:{});var l=s.title;var f=a?cCe(e,t):undefined;if(r){return Hke(l,e.title,f)}else{return u=l!==null&&l!==void 0?l:e.title,u!==null&&u!==void 0?u:f}}function fCe(e){if(XDe(e)&&e.axis){return e.axis}else if(JDe(e)&&e.legend){return e.legend}else if(NDe(e)&&e.header){return e.header}return undefined}function cCe(e,t){return oCe(e,t)}function hCe(e){var t;if(ZDe(e)&&e.format){return e.format}else{var n=(t=fCe(e),t!==null&&t!==void 0?t:{});return n.format}}function dCe(e,t){if(e.timeUnit){return"temporal"}if(OCe(e.bin)){return"quantitative"}switch(rMe(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function pCe(e){if(HDe(e)){return e}else if(qDe(e)){return e.condition}return undefined}function vCe(e){if(HDe(e)){return e}else if(qDe(e)){return e.condition}return undefined}function gCe(e,t){if(Twe(e)||rke(e)||nke(e)){var n=Twe(e)?"string":rke(e)?"number":"boolean";SOe(kOe.primitiveChannelDef(t,n,e));return{value:e}}if(HDe(e)){return mCe(e,t)}else if(qDe(e)){return Object.assign(Object.assign({},e),{condition:mCe(e.condition,t)})}return e}function mCe(e,t){var n=e.aggregate,r=e.timeUnit,i=e.bin,a=e.field;var o=Object.assign({},e);if(n&&!UAe(n)&&!BAe(n)&&!IAe(n)){SOe(kOe.invalidAggregate(n));delete o.aggregate}if(r){o.timeUnit=oSe(r)}if(a){o.field=""+a}if(OCe(i)){o.bin=yCe(i,t)}if(SCe(i)&&!_ke(WEe,t)){SOe("Channel "+t+' should not be used with "binned" bin')}if(GDe(o)){var u=o.type;var s=CSe(u);if(u!==s){o.type=s}if(u!=="quantitative"){if(WAe(n)){SOe(kOe.invalidFieldTypeForCountAggregate(u,n));o.type="quantitative"}}}else if(!PEe(t)){var l=dCe(o,t);SOe(kOe.missingFieldType(t,l));o["type"]=l}if(GDe(o)){var f=_Ce(o,t),c=f.compatible,h=f.warning;if(!c){SOe(h)}}if(LDe(o)&&Twe(o.sort)){var d=o.sort;if(SDe(d)){return Object.assign(Object.assign({},o),{sort:{encoding:d}})}var p=d.substr(1);if(d.charAt(0)==="-"&&SDe(p)){return Object.assign(Object.assign({},o),{sort:{encoding:p,order:"descending"}})}}return o}function yCe(e,t){if(nke(e)){return{maxbins:FCe(t)}}else if(e==="binned"){return{binned:true}}else if(!e.maxbins&&!e.step){return Object.assign(Object.assign({},e),{maxbins:FCe(t)})}else{return e}}var bCe={compatible:true};function _Ce(e,t){var n=e.type;if(n==="geojson"&&t!=="shape"){return{compatible:false,warning:"Channel "+t+" should not be used with a geojson data."}}switch(t){case"row":case"column":case"facet":if(tCe(e)){return{compatible:false,warning:kOe.facetChannelShouldBeDiscrete(t)}}return bCe;case"x":case"y":case"color":case"fill":case"stroke":case"text":case"detail":case"key":case"tooltip":case"href":case"url":return bCe;case"longitude":case"longitude2":case"latitude":case"latitude2":if(n!==ESe){return{compatible:false,warning:"Channel "+t+" should be used with a quantitative field only, not "+e.type+" field."}}return bCe;case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case"size":case"x2":case"y2":if(n==="nominal"&&!e["sort"]){return{compatible:false,warning:"Channel "+t+" should not be used with an unsorted discrete field."}}return bCe;case"shape":if(!_ke(["ordinal","nominal","geojson"],e.type)){return{compatible:false,warning:"Shape channel should be used with only either discrete or geojson data."}}return bCe;case"order":if(e.type==="nominal"&&!("sort"in e)){return{compatible:false,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}return bCe}throw new Error("channelCompatability not implemented for channel "+t)}function xCe(e){var t=fCe(e);var n=t&&t.formatType||ZDe(e)&&e.formatType;return n==="time"||!n&&wCe(e)}function wCe(e){return e.type==="temporal"||!!e.timeUnit}function kCe(e,t){var n;var r=t.timeUnit,i=t.type,a=t.time,o=t.undefinedIfExprNotRequired;var u;var s=(u=oSe(r))===null||u===void 0?void 0:u.unit;var l;if(FOe(e)){l=BOe(e)}else if(Twe(e)||rke(e)){if(s||i==="temporal"){if($Oe(s)){l=BOe((n={},n[s]=e,n))}else{l="datetime("+JSON.stringify(e)+")"}}}if(l){return a?"time("+l+")":l}return o?undefined:JSON.stringify(e)}function ACe(e,t){var n;var r=e.type;var i=(n=oSe(e.timeUnit))===null||n===void 0?void 0:n.unit;return t.map((function(e){var t=kCe(e,{timeUnit:i,type:r,undefinedIfExprNotRequired:true});if(t!==undefined){return{signal:t}}return e}))}function ECe(e,t){if(!OCe(e.bin)){console.warn("Only call this method for binned field defs.");return false}return QEe(t)&&_ke(["ordinal","nominal"],e.type)}function MCe(e){if(nke(e)){e=yCe(e,undefined)}return"bin"+Cke(e).map((function(t){return CCe(e[t])?Nke("_"+t+"_"+Object.entries(e[t])):Nke("_"+t+"_"+e[t])})).join("")}function OCe(e){return e===true||DCe(e)&&!e.binned}function SCe(e){return e==="binned"||DCe(e)&&e.binned===true}function DCe(e){return Fwe(e)}function CCe(e){var t;return(t=e)===null||t===void 0?void 0:t["selection"]}function FCe(e){switch(e){case VAe:case XAe:case lEe:case aEe:case oEe:case uEe:case dEe:case fEe:case cEe:case hEe:case sEe:return 6;default:return 10}}function TCe(e,t){var n=e&&e[t];if(n){if(Cwe(n)){return xke(n,(function(e){return!!e.field}))}else{return HDe(n)||qDe(n)}}return false}function NCe(e){return xke(FEe,(function(t){if(TCe(e,t)){var n=e[t];if(Cwe(n)){return xke(n,(function(e){return!!e.aggregate}))}else{var r=pCe(n);return r&&!!r.aggregate}}return false}))}function jCe(e,t){var n=[];var r=[];var i=[];var a=[];var o={};LCe(e,(function(u,s){if(HDe(u)){var l=u.field,f=u.aggregate,c=u.bin,d=u.timeUnit,p=h(u,["field","aggregate","bin","timeUnit"]);if(f||d||c){var v=fCe(u);var g=v&&v.title;var m=KDe(u,{forAs:true});var y=Object.assign(Object.assign(Object.assign({},g?[]:{title:lCe(u,t,{allowDisabling:true})}),p),{field:m});var b=s==="x"||s==="y";if(f){var _=void 0;if(BAe(f)){_="argmax";m=KDe({op:"argmax",field:f.argmax},{forAs:true});y.field=m+"."+l}else if(IAe(f)){_="argmin";m=KDe({op:"argmin",field:f.argmin},{forAs:true});y.field=m+"."+l}else if(f!=="boxplot"&&f!=="errorbar"&&f!=="errorband"){_=f}if(_){var x={op:_,as:m};if(l){x.field=l}a.push(x)}}else{n.push(m);if(GDe(u)&&OCe(c)){r.push({bin:c,field:l,as:m});n.push(KDe(u,{binSuffix:"end"}));if(ECe(u,s)){n.push(KDe(u,{binSuffix:"range"}))}if(b){var w={field:m+"_end"};o[s+"2"]=w}y.bin="binned";if(!PEe(s)){y["type"]="quantitative"}}else if(d){i.push({timeUnit:d,field:l,as:m});var k=GDe(u)&&u.type!==OSe&&"time";if(k){if(s==="text"||s==="tooltip"){y["formatType"]=k}else if(VEe(s)){y["legend"]=Object.assign({formatType:k},y["legend"])}else if(b){y["axis"]=Object.assign({formatType:k},y["axis"])}}}}o[s]=y}else{n.push(l);o[s]=e[s]}}else{o[s]=e[s]}}));return{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function RCe(e,t,n){var r=KEe(t,n);if(!r){return false}else if(r==="binned"){var i=e[t==="x2"?"x":"y"];if(HDe(i)&&HDe(e[t])&&SCe(i.bin)){return true}else{return false}}return true}function zCe(e,t){var n=t.type;return Cke(e).reduce((function(r,i){var a;if(!REe(i)){SOe(kOe.invalidEncodingChannel(i));return r}if(!RCe(e,i,n)){SOe(kOe.incompatibleChannel(i,n));return r}if(i==="size"&&n==="line"){var o=vCe(e[i]);if((a=o)===null||a===void 0?void 0:a.aggregate){SOe(kOe.LINE_WITH_VARYING_SIZE);return r}}if(i==="color"&&(t.filled?"fill"in e:"stroke"in e)){SOe(kOe.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e}));return r}var u=e[i];if(i==="detail"||i==="order"&&!Cwe(u)&&!YDe(u)||i==="tooltip"&&Cwe(u)){if(u){r[i]=Qwe(u).reduce((function(e,t){if(!HDe(t)){SOe(kOe.emptyFieldDef(t,i))}else{e.push(mCe(t,i))}return e}),[])}}else{if(i==="tooltip"&&u===null){r[i]=null}else if(!HDe(u)&&!YDe(u)&&!UDe(u)){SOe(kOe.emptyFieldDef(u,i));return r}r[i]=gCe(u,i)}return r}),{})}function PCe(e){var t=[];for(var n=0,r=Cke(e);n<r.length;n++){var i=r[n];if(TCe(e,i)){var a=e[i];var o=Qwe(a);for(var u=0,s=o;u<s.length;u++){var l=s[u];if(HDe(l)){t.push(l)}else if(qDe(l)){t.push(l.condition)}}}}return t}function LCe(e,t,n){if(!e){return}var r=function(r){var i=e[r];if(Cwe(i)){i.forEach((function(e){t.call(n,e,r)}))}else{t.call(n,i,r)}};for(var i=0,a=Cke(e);i<a.length;i++){var o=a[i];r(o)}}function ICe(e,t,n,r){if(!e){return n}return Cke(e).reduce((function(n,i){var a=e[i];if(Cwe(a)){return a.reduce((function(e,n){return t.call(r,e,n,i)}),n)}else{return t.call(r,n,a,i)}}),n)}function BCe(e,t){return Cke(t).reduce((function(n,r){switch(r){case"x":case"y":case"href":case"url":case"x2":case"y2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case"shape":case"tooltip":return n;case"order":if(e==="line"||e==="trail"){return n}case"detail":case"key":{var i=t[r];if(Cwe(i)||HDe(i)){Qwe(i).forEach((function(e){if(!e.aggregate){n.push(KDe(e,{}))}}))}return n}case"size":if(e==="trail"){return n}case"color":case"fill":case"stroke":case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":{var a=vCe(t[r]);if(a&&!a.aggregate){n.push(KDe(a,{}))}return n}}}),[])}function UCe(e){var t=e.tooltip,n=h(e,["tooltip"]);if(!t){return{filteredEncoding:e}}var r;var i;if(Cwe(t)){t.forEach((function(e){if(e.aggregate){if(!r){r=[]}r.push(e)}else{if(!i){i=[]}i.push(e)}}));if(r){n.tooltip=r}}else{if(t["aggregate"]){n.tooltip=t}else{i=t}}if(Cwe(i)&&i.length===1){i=i[0]}return{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function qCe(e,t,n,r){if(r===void 0){r=true}if("tooltip"in n){return{tooltip:n.tooltip}}var i=e.map((function(e){var n=e.fieldPrefix,i=e.titlePrefix;return{field:n+t.field,type:t.type,title:i+(r?" of "+t.field:"")}}));return{tooltip:__spreadArrays(i,PCe(n))}}function WCe(e){var t=e.axis,n=e.title,r=e.field;return t&&t.title!==undefined?undefined:Hke(n,r)}function HCe(e,t,n,r,i){var a=n.scale,o=n.axis;return function(u){var s,l;var f=u.partName,c=u.mark,h=u.positionPrefix,d=u.endPositionPrefix,p=d===void 0?undefined:d,v=u.extraEncoding,g=v===void 0?{}:v;var m=WCe(n);return GCe(e,f,i,{mark:c,encoding:Object.assign(Object.assign(Object.assign((s={},s[t]=Object.assign(Object.assign(Object.assign({field:h+"_"+n.field,type:n.type},m!==undefined?{title:m}:{}),a!==undefined?{scale:a}:{}),o!==undefined?{axis:o}:{}),s),Twe(p)?(l={},l[t+"2"]={field:p+"_"+n.field},l):{}),r),g)})}}function GCe(e,t,n,r){var i=e.clip,a=e.color,o=e.opacity;var u=e.type;if(e[t]||e[t]===undefined&&n[t]){return[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),i?{clip:i}:{}),a?{color:a}:{}),o?{opacity:o}:{}),xAe(r.mark)?r.mark:{type:r.mark}),{style:u+"-"+t}),nke(e[t])?{}:e[t])})]}return[]}function $Ce(e,t,n){var r=e.encoding;var i=t==="vertical"?"y":"x";var a=r[i];var o=r[i+"2"];var u=r[i+"Error"];var s=r[i+"Error2"];return{continuousAxisChannelDef:YCe(a,n),continuousAxisChannelDef2:YCe(o,n),continuousAxisChannelDefError:YCe(u,n),continuousAxisChannelDefError2:YCe(s,n),continuousAxis:i}}function YCe(e,t){if(e&&e.aggregate){var n=e.aggregate,r=h(e,["aggregate"]);if(n!==t){SOe(kOe.errorBarContinuousAxisHasCustomizedAggregate(n,t))}return r}else{return e}}function VCe(e,t){var n=e.mark,r=e.encoding;if(HDe(r.x)&&tCe(r.x)){if(HDe(r.y)&&tCe(r.y)){if(r.x.aggregate===undefined&&r.y.aggregate===t){return"vertical"}else if(r.y.aggregate===undefined&&r.x.aggregate===t){return"horizontal"}else if(r.x.aggregate===t&&r.y.aggregate===t){throw new Error("Both x and y cannot have aggregate")}else{if(xAe(n)&&n.orient){return n.orient}return"vertical"}}return"horizontal"}else if(HDe(r.y)&&tCe(r.y)){return"vertical"}else{throw new Error("Need a valid continuous axis for "+t+"s")}}var XCe="boxplot";var JCe={box:1,median:1,outliers:1,rule:1,ticks:1};var ZCe=Cke(JCe);var QCe=new zAe(XCe,eFe);function KCe(e){if(rke(e)){return"tukey"}return e}function eFe(e,t){var n;var r=t.config;var i,a;var o=e.mark,u=e.encoding,s=e.selection,l=e.projection,f=h(e,["mark","encoding","selection","projection"]);var c=xAe(o)?o:{type:o};if(s){SOe(kOe.selectionNotSupported("boxplot"))}var d=(i=c.extent,i!==null&&i!==void 0?i:r.boxplot.extent);var p=Hke(c.size,r.boxplot.size);var v=KCe(d);var g=nFe(e,d,r),m=g.transform,y=g.continuousAxisChannelDef,b=g.continuousAxis,_=g.groupby,x=g.aggregate,w=g.encodingWithoutContinuousAxis,k=g.ticksOrient,A=g.boxOrient,E=g.customTooltipWithoutAggregatedField;var M=w.color,O=w.size,S=h(w,["color","size"]);var D=function(e){return HCe(c,b,y,e,r.boxplot)};var C=D(S);var F=D(w);var T=D(Object.assign(Object.assign({},S),O?{size:O}:{}));var N=qCe([{fieldPrefix:v==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:v==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],y,w);var j={type:"tick",color:"black",opacity:1,orient:k,invalid:null};var R=v==="min-max"?N:qCe([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],y,w);var z=__spreadArrays(C({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:R}),C({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:R}),C({partName:"ticks",mark:j,positionPrefix:"lower_whisker",extraEncoding:R}),C({partName:"ticks",mark:j,positionPrefix:"upper_whisker",extraEncoding:R}));var P=__spreadArrays(v!=="tukey"?z:[],F({partName:"box",mark:Object.assign(Object.assign({type:"bar"},p?{size:p}:{}),{orient:A,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:N}),T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Fwe(r.boxplot.median)&&r.boxplot.median.color?{color:r.boxplot.median.color}:{}),p?{size:p}:{}),{orient:k}),positionPrefix:"mid_box",extraEncoding:N}));var L;if(v!=="min-max"){var I='datum["lower_box_'+y.field+'"]';var B='datum["upper_box_'+y.field+'"]';var U="("+B+" - "+I+")";var q=I+" - "+d+" * "+U;var W=B+" + "+d+" * "+U;var H='datum["'+y.field+'"]';var G={joinaggregate:tFe(y.field),groupby:_};var $=undefined;if(v==="tukey"){$={transform:[{filter:"("+q+" <= "+H+") && ("+H+" <= "+W+")"},{aggregate:__spreadArrays([{op:"min",field:y.field,as:"lower_whisker_"+y.field},{op:"max",field:y.field,as:"upper_whisker_"+y.field},{op:"min",field:"lower_box_"+y.field,as:"lower_box_"+y.field},{op:"max",field:"upper_box_"+y.field,as:"upper_box_"+y.field}],x),groupby:_}],layer:z}}var Y=h(S,["tooltip"]);var V=y.scale,X=y.axis;var J=WCe(y);var Z=GCe(c,"outliers",r.boxplot,{transform:[{filter:"("+H+" < "+q+") || ("+H+" > "+W+")"}],mark:"point",encoding:Object.assign(Object.assign((n={},n[b]=Object.assign(Object.assign(Object.assign({field:y.field,type:y.type},J!==undefined?{title:J}:{}),V!==undefined?{scale:V}:{}),X!==undefined?{axis:X}:{}),n),Y),E?{tooltip:E}:{})})[0];if(Z&&$){L={transform:[G],layer:[Z,$]}}else if(Z){L=Z;L.transform.unshift(G)}else if($){L=$;L.transform.unshift(G)}}if(L){return Object.assign(Object.assign({},f),{layer:[L,{transform:m,layer:P}]})}return Object.assign(Object.assign({},f),{transform:(a=f.transform,a!==null&&a!==void 0?a:[]).concat(m),layer:P})}function tFe(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function nFe(e,t,n){var r=VCe(e,XCe);var i=$Ce(e,r,XCe),a=i.continuousAxisChannelDef,o=i.continuousAxis;var u=a.field;var s=KCe(t);var l=__spreadArrays(tFe(u),[{op:"median",field:u,as:"mid_box_"+u},{op:"min",field:u,as:(s==="min-max"?"lower_whisker_":"min_")+u},{op:"max",field:u,as:(s==="min-max"?"upper_whisker_":"max_")+u}]);var f=s==="min-max"||s==="tukey"?[]:[{calculate:'datum["upper_box_'+u+'"] - datum["lower_box_'+u+'"]',as:"iqr_"+u},{calculate:'min(datum["upper_box_'+u+'"] + datum["iqr_'+u+'"] * '+t+', datum["max_'+u+'"])',as:"upper_whisker_"+u},{calculate:'max(datum["lower_box_'+u+'"] - datum["iqr_'+u+'"] * '+t+', datum["min_'+u+'"])',as:"lower_whisker_"+u}];var c=e.encoding,d=o,p=h(c,[typeof d==="symbol"?d:d+""]);var v=UCe(p),g=v.customTooltipWithoutAggregatedField,m=v.filteredEncoding;var y=jCe(m,n),b=y.bins,_=y.timeUnits,x=y.aggregate,w=y.groupby,k=y.encoding;var A=r==="vertical"?"horizontal":"vertical";var E=r;var M=__spreadArrays(b,_,[{aggregate:__spreadArrays(x,l),groupby:w}],f);return{transform:M,groupby:w,aggregate:x,continuousAxisChannelDef:a,continuousAxis:o,encodingWithoutContinuousAxis:k,ticksOrient:A,boxOrient:E,customTooltipWithoutAggregatedField:g}}var rFe="errorbar";var iFe={ticks:1,rule:1};var aFe=Cke(iFe);var oFe=new zAe(rFe,uFe);function uFe(e,t){var n=t.config;var r=hFe(e,rFe,n),i=r.transform,a=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.ticksOrient,l=r.markDef,f=r.outerSpec,c=r.tooltipEncoding;var h=HCe(l,o,a,u,n.errorbar);var d={type:"tick",orient:s};return Object.assign(Object.assign({},f),{transform:i,layer:__spreadArrays(h({partName:"ticks",mark:d,positionPrefix:"lower",extraEncoding:c}),h({partName:"ticks",mark:d,positionPrefix:"upper",extraEncoding:c}),h({partName:"rule",mark:"rule",positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c}))})}function sFe(e,t){var n=e.encoding;if(lFe(n)){return{orient:VCe(e,t),inputType:"raw"}}var r=fFe(n);var i=cFe(n);var a=n.x;var o=n.y;if(r){if(i){throw new Error(t+" cannot be both type aggregated-upper-lower and aggregated-error")}var u=n.x2;var s=n.y2;if(HDe(u)&&HDe(s)){throw new Error(t+" cannot have both x2 and y2")}else if(HDe(u)){if(HDe(a)&&tCe(a)){return{orient:"horizontal",inputType:"aggregated-upper-lower"}}else{throw new Error("Both x and x2 have to be quantitative in "+t)}}else if(HDe(s)){if(HDe(o)&&tCe(o)){return{orient:"vertical",inputType:"aggregated-upper-lower"}}else{throw new Error("Both y and y2 have to be quantitative in "+t)}}throw new Error("No ranged axis")}else{var l=n.xError;var f=n.xError2;var c=n.yError;var h=n.yError2;if(HDe(f)&&!HDe(l)){throw new Error(t+" cannot have xError2 without xError")}if(HDe(h)&&!HDe(c)){throw new Error(t+" cannot have yError2 without yError")}if(HDe(l)&&HDe(c)){throw new Error(t+" cannot have both xError and yError with both are quantiative")}else if(HDe(l)){if(HDe(a)&&tCe(a)){return{orient:"horizontal",inputType:"aggregated-error"}}else{throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}}else if(HDe(c)){if(HDe(o)&&tCe(o)){return{orient:"vertical",inputType:"aggregated-error"}}else{throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}}throw new Error("No ranged axis")}}function lFe(e){return(HDe(e.x)||HDe(e.y))&&!HDe(e.x2)&&!HDe(e.y2)&&!HDe(e.xError)&&!HDe(e.xError2)&&!HDe(e.yError)&&!HDe(e.yError2)}function fFe(e){return HDe(e.x2)||HDe(e.y2)}function cFe(e){return HDe(e.xError)||HDe(e.xError2)||HDe(e.yError)||HDe(e.yError2)}function hFe(e,t,n){var r;var i=e.mark,a=e.encoding,o=e.selection,u=e.projection,s=h(e,["mark","encoding","selection","projection"]);var l=xAe(i)?i:{type:i};if(o){SOe(kOe.selectionNotSupported(t))}var f=sFe(e,t),c=f.orient,d=f.inputType;var p=$Ce(e,c,t),v=p.continuousAxisChannelDef,g=p.continuousAxisChannelDef2,m=p.continuousAxisChannelDefError,y=p.continuousAxisChannelDefError2,b=p.continuousAxis;var _=dFe(l,v,g,m,y,d,t,n),x=_.errorBarSpecificAggregate,w=_.postAggregateCalculates,k=_.tooltipSummary,A=_.tooltipTitleWithFieldName;var E=b,M=b==="x"?"x2":"y2",O=b==="x"?"xError":"yError",S=b==="x"?"xError2":"yError2",D=h(a,[typeof E==="symbol"?E:E+"",typeof M==="symbol"?M:M+"",typeof O==="symbol"?O:O+"",typeof S==="symbol"?S:S+""]);var C=jCe(D,n),F=C.bins,T=C.timeUnits,N=C.aggregate,j=C.groupby,R=C.encoding;var z=__spreadArrays(N,x);var P=d!=="raw"?[]:j;var L=qCe(k,v,R,A);return{transform:__spreadArrays((r=s.transform,r!==null&&r!==void 0?r:[]),F,T,z.length===0?[]:[{aggregate:z,groupby:P}],w),groupby:P,continuousAxisChannelDef:v,continuousAxis:b,encodingWithoutContinuousAxis:R,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:s,tooltipEncoding:L}}function dFe(e,t,n,r,i,a,o,u){var s=[];var l=[];var f=t.field;var c;var h=false;if(a==="raw"){var d=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":u.errorbar.center;var p=e.extent?e.extent:d==="mean"?"stderr":"iqr";if(d==="median"!==(p==="iqr")){SOe(kOe.errorBarCenterIsUsedWithWrongExtent(d,p,o))}if(p==="stderr"||p==="stdev"){s=[{op:p,field:f,as:"extent_"+f},{op:d,field:f,as:"center_"+f}];l=[{calculate:'datum["center_'+f+'"] + datum["extent_'+f+'"]',as:"upper_"+f},{calculate:'datum["center_'+f+'"] - datum["extent_'+f+'"]',as:"lower_"+f}];c=[{fieldPrefix:"center_",titlePrefix:zke(d)},{fieldPrefix:"upper_",titlePrefix:pFe(d,p,"+")},{fieldPrefix:"lower_",titlePrefix:pFe(d,p,"-")}];h=true}else{if(e.center&&e.extent){SOe(kOe.errorBarCenterIsNotNeeded(e.extent,o))}var v=void 0;var g=void 0;var m=void 0;if(p==="ci"){v="mean";g="ci0";m="ci1"}else{v="median";g="q1";m="q3"}s=[{op:g,field:f,as:"lower_"+f},{op:m,field:f,as:"upper_"+f},{op:v,field:f,as:"center_"+f}];c=[{fieldPrefix:"upper_",titlePrefix:lCe({field:f,aggregate:m,type:"quantitative"},u,{allowDisabling:false})},{fieldPrefix:"lower_",titlePrefix:lCe({field:f,aggregate:g,type:"quantitative"},u,{allowDisabling:false})},{fieldPrefix:"center_",titlePrefix:lCe({field:f,aggregate:v,type:"quantitative"},u,{allowDisabling:false})}]}}else{if(e.center||e.extent){SOe(kOe.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent))}if(a==="aggregated-upper-lower"){c=[];l=[{calculate:'datum["'+n.field+'"]',as:"upper_"+f},{calculate:'datum["'+f+'"]',as:"lower_"+f}]}else if(a==="aggregated-error"){c=[{fieldPrefix:"",titlePrefix:f}];l=[{calculate:'datum["'+f+'"] + datum["'+r.field+'"]',as:"upper_"+f}];if(i){l.push({calculate:'datum["'+f+'"] + datum["'+i.field+'"]',as:"lower_"+f})}else{l.push({calculate:'datum["'+f+'"] - datum["'+r.field+'"]',as:"lower_"+f})}}for(var y=0,b=l;y<b.length;y++){var _=b[y];c.push({fieldPrefix:_.as.substring(0,6),titlePrefix:Uke(Uke(_.calculate,'datum["',""),'"]',"")})}}return{postAggregateCalculates:l,errorBarSpecificAggregate:s,tooltipSummary:c,tooltipTitleWithFieldName:h}}function pFe(e,t,n){return zke(e)+" "+n+" "+t}var vFe="errorband";var gFe={band:1,borders:1};var mFe=Cke(gFe);var yFe=new zAe(vFe,bFe);function bFe(e,t){var n=t.config;var r=hFe(e,vFe,n),i=r.transform,a=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.markDef,l=r.outerSpec,f=r.tooltipEncoding;var c=s;var h=HCe(c,o,a,u,n.errorband);var d=e.encoding.x!==undefined&&e.encoding.y!==undefined;var p={type:d?"area":"rect"};var v={type:d?"line":"rule"};var g=Object.assign(Object.assign({},c.interpolate?{interpolate:c.interpolate}:{}),c.tension&&c.interpolate?{interpolate:c.tension}:{});if(d){p=Object.assign(Object.assign({},p),g);v=Object.assign(Object.assign({},v),g)}else if(c.interpolate){SOe(kOe.errorBand1DNotSupport("interpolate"))}else if(c.tension){SOe(kOe.errorBand1DNotSupport("tension"))}return Object.assign(Object.assign({},l),{transform:i,layer:__spreadArrays(h({partName:"band",mark:p,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:f}),h({partName:"borders",mark:v,positionPrefix:"lower",extraEncoding:f}),h({partName:"borders",mark:v,positionPrefix:"upper",extraEncoding:f}))})}var _Fe={};function xFe(e,t,n){var r=new zAe(e,t);_Fe[e]={normalizer:r,parts:n}}function wFe(){return Cke(_Fe)}xFe(XCe,eFe,ZCe);xFe(rFe,uFe,aFe);xFe(vFe,bFe,mFe);var kFe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"];var AFe={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35};var EFe={clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1};var MFe="_vgsid_";var OFe={single:{on:"click",fields:[MFe],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[MFe],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function SFe(e){return!!e&&(e==="legend"||!!e.legend)}function DFe(e){return SFe(e)&&Fwe(e)}function CFe(e){return TFe(e)||NFe(e)||FFe(e)}function FFe(e){return e["concat"]!==undefined}function TFe(e){return e["vconcat"]!==undefined}function NFe(e){return e["hconcat"]!==undefined}function jFe(e){return e["repeat"]!==undefined}function RFe(e){return Fwe(e)&&e["step"]!==undefined}function zFe(e){return e["view"]||e["width"]||e["height"]}var PFe=20;var LFe={align:1,bounds:1,center:1,columns:1,spacing:1};var IFe=Cke(LFe);function BFe(e,t,n){var r,i;var a=n[t];var o={};var u=a.spacing,s=a.columns;if(u!==undefined){o.spacing=u}if(s!==undefined){if(jDe(e)&&!TDe(e.facet)||jFe(e)&&Cwe(e.repeat)||FFe(e)){o.columns=s}}for(var l=0,f=IFe;l<f.length;l++){var c=f[l];if(e[c]!==undefined){if(c==="spacing"){var h=e[c];o[c]=rke(h)?h:{row:(r=h.row,r!==null&&r!==void 0?r:u),column:(i=h.column,i!==null&&i!==void 0?i:u)}}else{o[c]=e[c]}}}return o}function UFe(e,t){var n;return n=e[t],n!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function qFe(e,t){var n=WFe(e,t);return RFe(n)?n.step:HFe}function WFe(e,t){var n;var r=(n=e[t],n!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"]);return Hke(r,{step:e.step})}var HFe=20;var GFe={continuousWidth:200,continuousHeight:200,step:HFe};var $Fe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:GFe,mark:SAe,area:{},bar:FAe,circle:{},geoshape:{},image:{},line:{},point:{},rect:TAe,rule:{color:"black"},square:{},text:{color:"black"},tick:NAe,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:true,ticks:false},errorband:{band:{opacity:.3},borders:false},scale:XSe,projection:{},axis:{},axisX:{},axisY:{},axisLeft:{},axisRight:{},axisTop:{},axisBottom:{},axisBand:{},legend:AFe,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:OFe,style:{},title:{},facet:{spacing:PFe},repeat:{spacing:PFe},concat:{spacing:PFe}};function YFe(e){return Xwe({},$Fe,e)}var VFe=__spreadArrays(["view"],_Ae);var XFe=["background","padding","facet","concat","repeat","numberFormat","timeFormat","countTitle","header","scale","selection","overlay"];var JFe=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},OAe);function ZFe(e){e=pke(e);for(var t=0,n=XFe;t<n.length;t++){var r=n[t];delete e[r]}if(e.axis){for(var r in e.axis){if(Qke(e.axis[r])){delete e.axis[r]}}}if(e.legend){for(var i=0,a=kFe;i<a.length;i++){var r=a[i];delete e.legend[r]}}if(e.mark){for(var o=0,u=MAe;o<u.length;o++){var r=u[o];delete e.mark[r]}}for(var s=0,l=VFe;s<l.length;s++){var f=l[s];for(var c=0,h=MAe;c<h.length;c++){var r=h[c];delete e[f][r]}var d=JFe[f];if(d){for(var p=0,v=d;p<v.length;p++){var r=v[p];delete e[f][r]}}KFe(e,f)}for(var g=0,m=wFe();g<m.length;g++){var y=m[g];delete e[y]}QFe(e);for(var r in e){if(Fwe(e[r])&&Cke(e[r]).length===0){delete e[r]}}return Cke(e).length>0?e:undefined}function QFe(e){var t=sDe(e.title),n=t.mark,r=t.subtitle;var i=Object.assign(Object.assign({},n),e.style["group-title"]);if(Cke(i).length>0){e.style["group-title"]=i}if(Cke(r).length>0){e.title=r}else{delete e.title}}function KFe(e,t,n,r){var i=r?e[t][r]:e[t];if(t==="view"){n="cell"}var a=Object.assign(Object.assign({},i),e.style[n!==null&&n!==void 0?n:t]);if(Cke(a).length>0){e.style[n!==null&&n!==void 0?n:t]=a}if(!r){delete e[t]}}function eTe(e){return e["layer"]!==undefined}var tTe=function(){function e(){}e.prototype.map=function(e,t){if(jDe(e)){return this.mapFacet(e,t)}else if(jFe(e)){return this.mapRepeat(e,t)}else if(NFe(e)){return this.mapHConcat(e,t)}else if(TFe(e)){return this.mapVConcat(e,t)}else if(FFe(e)){return this.mapConcat(e,t)}else{return this.mapLayerOrUnit(e,t)}};e.prototype.mapLayerOrUnit=function(e,t){if(eTe(e)){return this.mapLayer(e,t)}else if(RAe(e)){return this.mapUnit(e,t)}throw new Error(kOe.invalidSpec(e))};e.prototype.mapLayer=function(e,t){var n=this;return Object.assign(Object.assign({},e),{layer:e.layer.map((function(e){return n.mapLayerOrUnit(e,t)}))})};e.prototype.mapHConcat=function(e,t){var n=this;return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map((function(e){return n.map(e,t)}))})};e.prototype.mapVConcat=function(e,t){var n=this;return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map((function(e){return n.map(e,t)}))})};e.prototype.mapConcat=function(e,t){var n=this;var r=e.concat,i=h(e,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map((function(e){return n.map(e,t)}))})};e.prototype.mapFacet=function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})};e.prototype.mapRepeat=function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})};return e}();var nTe={zero:1,center:1,normalize:1};function rTe(e){return!!nTe[e]}var iTe=[aAe,iAe,fAe,sAe,pAe,vAe,uAe,cAe,hAe];var aTe=[aAe,iAe];function oTe(e){var t=e.x;var n=e.y;if(HDe(t)&&HDe(n)){if(t.type==="quantitative"&&n.type==="quantitative"){if(t.stack){return"x"}else if(n.stack){return"y"}if(!!t.aggregate!==!!n.aggregate){return t.aggregate?"x":"y"}}else if(t.type==="quantitative"){return"x"}else if(n.type==="quantitative"){return"y"}}else if(HDe(t)&&t.type==="quantitative"){return"x"}else if(HDe(n)&&n.type==="quantitative"){return"y"}return undefined}function uTe(e,t,n){if(n===void 0){n={}}var r=xAe(e)?e.type:e;if(!_ke(iTe,r)){return null}var i=oTe(t);if(!i){return null}var a=t[i];var o=$De(a)?KDe(a,{}):undefined;var u=i==="x"?"y":"x";var s=t[u];var l=$De(s)?KDe(s,{}):undefined;var f=UEe.reduce((function(e,n){if(n!=="tooltip"&&TCe(t,n)){var r=t[n];Qwe(r).forEach((function(t){var r=vCe(t);if(r.aggregate){return}var i=$De(r)?KDe(r,{}):undefined;if(!i||i!==l&&i!==o){e.push({channel:n,fieldDef:r})}}))}return e}),[]);var c;if(a.stack!==undefined){if(nke(a.stack)){c=a.stack?"zero":null}else{c=a.stack}}else if(f.length>0&&_ke(aTe,r)){c="zero"}if(!c||!rTe(c)){return null}if(NCe(t)&&f.length===0){return null}if(a.scale&&a.scale.type&&a.scale.type!==FSe.LINEAR){if(n.disallowNonLinearStack){return null}else{SOe(kOe.cannotStackNonLinearScale(a.scale.type))}}if(TCe(t,i===ZAe?KAe:eEe)){if(a.stack!==undefined){SOe(kOe.cannotStackRangedMark(i))}return null}if(a.aggregate&&!_ke(GAe,a.aggregate)){SOe(kOe.stackNonSummativeAggregate(a.aggregate))}return{groupbyChannel:s?u:undefined,fieldChannel:i,impute:a.impute===null?false:yAe(r),stackBy:f,offset:c}}function sTe(e){var t=h(e,["point","line"]);return Cke(t).length>1?t:t.type}function lTe(e){var t;for(var n=0,r=["line","area","rule","trail"];n<r.length;n++){var i=r[n];if(e[i]){e=Object.assign(Object.assign({},e),(t={},t[i]=gke(e[i],["point","line"]),t))}}return e}function fTe(e,t,n){if(t===void 0){t={}}if(e.point==="transparent"){return{opacity:0}}else if(e.point){return Fwe(e.point)?e.point:{}}else if(e.point!==undefined){return null}else{if(t.point||n.shape){return Fwe(t.point)?t.point:{}}return undefined}}function cTe(e,t){if(t===void 0){t={}}if(e.line){return e.line===true?{}:e.line}else if(e.line!==undefined){return null}else{if(t.line){return t.line===true?{}:t.line}return undefined}}var hTe=function(){function e(){this.name="path-overlay"}e.prototype.hasMatchingType=function(e,t){if(RAe(e)){var n=e.mark,r=e.encoding;var i=xAe(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!fTe(i,t[i.type],r);case"area":return!!fTe(i,t[i.type],r)||!!cTe(i,t[i.type])}}return false};e.prototype.run=function(e,t,n){var r;var i=t.config;var a=e.selection,o=e.projection,u=e.encoding,s=e.mark,l=h(e,["selection","projection","encoding","mark"]);var f=xAe(s)?s:{type:s};var c=fTe(f,i[f.type],u);var d=f.type==="area"&&cTe(f,i[f.type]);var p=[Object.assign(Object.assign({},a?{selection:a}:{}),{mark:sTe(Object.assign(Object.assign({},f),f.type==="area"?{opacity:.7}:{})),encoding:gke(u,["shape"])})];var v=uTe(f,u);var g=u;if(v){var m=v.fieldChannel,y=v.offset;g=Object.assign(Object.assign({},u),(r={},r[m]=Object.assign(Object.assign({},u[m]),y?{stack:y}:{}),r))}if(d){p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},vke(f,["clip","interpolate","tension","tooltip"])),d),encoding:g}))}if(c){p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:true},vke(f,["clip","tooltip"])),c),encoding:g}))}return n(Object.assign(Object.assign({},l),{layer:p}),Object.assign(Object.assign({},t),{config:lTe(i)}))};return e}();var dTe=function(){function e(){this.name="RangeStep"}e.prototype.hasMatchingType=function(e){var t,n;if(RAe(e)&&e.encoding){for(var r=0,i=WEe;r<i.length;r++){var a=i[r];var o=e.encoding[a];if(o&&HDe(o)){if((n=(t=o)===null||t===void 0?void 0:t.scale)===null||n===void 0?void 0:n["rangeStep"]){return true}}}}return false};e.prototype.run=function(e){var t;var n,r;var i={};var a=Object.assign({},e.encoding);for(var o=0,u=WEe;o<u.length;o++){var s=u[o];var l=HEe(s);var f=a[s];if(f&&HDe(f)){if((r=(n=f)===null||n===void 0?void 0:n.scale)===null||r===void 0?void 0:r["rangeStep"]){var c=f.scale,d=h(f,["scale"]);var p=c,v=h(p,["rangeStep"]);i[l]={step:c["rangeStep"]};SOe(kOe.RANGE_STEP_DEPRECATED);a=Object.assign(Object.assign({},a),(t={},t[s]=Object.assign(Object.assign({},d),Cke(v).length>0?{scale:v}:{}),t))}}}return Object.assign(Object.assign(Object.assign({},i),e),{encoding:a})};return e}();var pTe=function(){function e(){this.name="RuleForRangedLine"}e.prototype.hasMatchingType=function(e){if(RAe(e)){var t=e.encoding,n=e.mark;if(n==="line"){for(var r=0,i=zEe;r<i.length;r++){var a=i[r];var o=LEe(a);var u=t[o];if(!!t[a]&&HDe(u)&&!SCe(u.bin)){return true}}}}return false};e.prototype.run=function(e,t,n){var r=e.encoding;SOe(kOe.lineWithRange(!!r.x2,!!r.y2));return n(Object.assign(Object.assign({},e),{mark:"rule"}),t)};return e}();var vTe=function(e){p(t,e);function t(){var t=e.apply(this,arguments)||this;t.nonFacetUnitNormalizers=[QCe,oFe,yFe,new hTe,new pTe,new dTe];return t}t.prototype.map=function(t,n){if(RAe(t)){var r=TCe(t.encoding,VAe);var i=TCe(t.encoding,XAe);var a=TCe(t.encoding,JAe);if(r||i||a){return this.mapFacetedUnit(t,n)}}return e.prototype.map.call(this,t,n)};t.prototype.mapUnit=function(e,t){var n=t.parentEncoding,r=t.parentProjection;if(n||r){return this.mapUnitWithParentEncodingOrProjection(e,t)}var i=this.mapLayerOrUnit.bind(this);for(var a=0,o=this.nonFacetUnitNormalizers;a<o.length;a++){var u=o[a];if(u.hasMatchingType(e,t.config)){return u.run(e,t,i)}}return e};t.prototype.mapRepeat=function(e,t){var n=e.repeat;if(!Cwe(n)&&e.columns){e=gke(e,["columns"]);SOe(kOe.columnsNotSupportByRowCol("repeat"))}return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})};t.prototype.mapFacet=function(t,n){var r=t.facet;if(TDe(r)&&t.columns){t=gke(t,["columns"]);SOe(kOe.columnsNotSupportByRowCol("facet"))}return e.prototype.mapFacet.call(this,t,n)};t.prototype.mapUnitWithParentEncodingOrProjection=function(e,t){var n=e.encoding,r=e.projection;var i=t.parentEncoding,a=t.parentProjection,o=t.config;var u=mTe({parentProjection:a,projection:r});var s=gTe({parentEncoding:i,encoding:n});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),u?{projection:u}:{}),s?{encoding:s}:{}),{config:o})};t.prototype.mapFacetedUnit=function(e,t){var n=e.encoding,r=n.row,i=n.column,a=n.facet,o=h(n,["row","column","facet"]);var u=e.mark,s=e.width,l=e.projection,f=e.height,c=e.selection,d=e.encoding,p=h(e,["mark","width","projection","height","selection","encoding"]);var v=this.getFacetMappingAndLayout({row:r,column:i,facet:a}),g=v.facetMapping,m=v.layout;return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),m),{facet:g,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{projection:l}:{}),{mark:u}),s?{width:s}:{}),f?{height:f}:{}),{encoding:o}),c?{selection:c}:{})}),t)};t.prototype.getFacetMappingAndLayout=function(e){var t;var n=e.row,r=e.column,i=e.facet;if(n||r){if(i){SOe(kOe.facetChannelDropped(__spreadArrays(n?[VAe]:[],r?[XAe]:[])))}var a={};var o={};for(var u=0,s=[VAe,XAe];u<s.length;u++){var l=s[u];var f=e[l];if(f){var c=h(f,["align","center","spacing","columns"]);a[l]=c;for(var d=0,p=["align","center","spacing"];d<p.length;d++){var v=p[d];if(f[v]!==undefined){o[v]=(t=o[v],t!==null&&t!==void 0?t:{});o[v][l]=f[v]}}}}return{facetMapping:a,layout:o}}else{var g=i.align,m=i.center,y=i.spacing,b=i.columns,a=h(i,["align","center","spacing","columns"]);return{facetMapping:a,layout:Object.assign(Object.assign(Object.assign(Object.assign({},g?{align:g}:{}),m?{center:m}:{}),y?{spacing:y}:{}),b?{columns:b}:{})}}};t.prototype.mapLayer=function(t,n){var r=n.parentEncoding,i=n.parentProjection,a=h(n,["parentEncoding","parentProjection"]);var o=t.encoding,u=t.projection,s=h(t,["encoding","projection"]);var l=Object.assign(Object.assign({},a),{parentEncoding:gTe({parentEncoding:r,encoding:o}),parentProjection:mTe({parentProjection:i,projection:u})});return e.prototype.mapLayer.call(this,s,l)};return t}(tTe);function gTe(e){var t=e.parentEncoding,n=e.encoding;if(t&&n){var r=Cke(t).reduce((function(e,t){if(n[t]){e.push(t)}return e}),[]);if(r.length>0){SOe(kOe.encodingOverridden(r))}}var i=Object.assign(Object.assign({},t!==null&&t!==void 0?t:{}),n!==null&&n!==void 0?n:{});return Cke(i).length>0?i:undefined}function mTe(e){var t=e.parentProjection,n=e.projection;if(t&&n){SOe(kOe.projectionOverridden({parentProjection:t,projection:n}))}return n!==null&&n!==void 0?n:t}function yTe(e,t){if(t===undefined){t=YFe(e.config)}var n=_Te(e,t);var r=e.width,i=e.height;var a=wTe(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),a?{autosize:a}:{})}var bTe=new vTe;function _Te(e,t){if(t===void 0){t={}}return bTe.map(e,{config:t})}function xTe(e){return Twe(e)?{type:e}:e!==null&&e!==void 0?e:{}}function wTe(e,t,n){var r=t.width,i=t.height;var a=RAe(e)||eTe(e);var o={};if(!a){if(r=="container"){SOe(kOe.containerSizeNonSingle("width"));r=undefined}if(i=="container"){SOe(kOe.containerSizeNonSingle("height"));i=undefined}}else{if(r=="container"&&i=="container"){o.type="fit";o.contains="padding"}else if(r=="container"){o.type="fit-x";o.contains="padding"}else if(i=="container"){o.type="fit-y";o.contains="padding"}}var u=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?xTe(n.autosize):{}),xTe(e.autosize));if(u.type==="fit"&&!a){SOe(kOe.FIT_NON_SINGLE);u.type="pad"}if(r=="container"&&!(u.type=="fit"||u.type=="fit-x")){SOe(kOe.containerSizeNotCompatibleWithAutosize("width"))}if(i=="container"&&!(u.type=="fit"||u.type=="fit-y")){SOe(kOe.containerSizeNotCompatibleWithAutosize("height"))}if(dke(u,{type:"pad"})){return undefined}return u}function kTe(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function ATe(e){return e?"fit-"+GEe(e):"fit"}var ETe=["background","padding"];function MTe(e){return ETe.reduce((function(t,n){if(e&&e[n]!==undefined){t[n]=e[n]}return t}),{})}function OTe(e){return!!e["url"]}function STe(e){return!!e["values"]}function DTe(e){return!!e["name"]&&!OTe(e)&&!STe(e)&&!CTe(e)}function CTe(e){return e&&(FTe(e)||TTe(e)||NTe(e))}function FTe(e){return!!e["sequence"]}function TTe(e){return!!e["sphere"]}function NTe(e){return!!e["graticule"]}var jTe="main";var RTe="raw";function zTe(e){return e["filter"]!==undefined}function PTe(e){var t;return((t=e)===null||t===void 0?void 0:t["stop"])!==undefined}function LTe(e){return e["lookup"]!==undefined}function ITe(e){return e["data"]!==undefined}function BTe(e){return e["selection"]!==undefined}function UTe(e){return e["pivot"]!==undefined}function qTe(e){return e["density"]!==undefined}function WTe(e){return e["quantile"]!==undefined}function HTe(e){return e["regression"]!==undefined}function GTe(e){return e["loess"]!==undefined}function $Te(e){return e["sample"]!==undefined}function YTe(e){return e["window"]!==undefined}function VTe(e){return e["joinaggregate"]!==undefined}function XTe(e){return e["flatten"]!==undefined}function JTe(e){return e["calculate"]!==undefined}function ZTe(e){return!!e["bin"]}function QTe(e){return e["impute"]!==undefined}function KTe(e){return e["timeUnit"]!==undefined}function eNe(e){return e["aggregate"]!==undefined}function tNe(e){return e["stack"]!==undefined}function nNe(e){return e["fold"]!==undefined}function rNe(e){return e.map((function(e){if(zTe(e)){return{filter:hke(e.filter,kSe)}}return e}))}function iNe(e){return!!e["signal"]}function aNe(e){return!!e["step"]}function oNe(e){if(!Cwe(e)){return"fields"in e&&!("data"in e)}return false}function uNe(e){if(!Cwe(e)){return"fields"in e&&"data"in e}return false}function sNe(e){if(!Cwe(e)){return"field"in e&&"data"in e}return false}var lNe={opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeMiterLimit:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,x:1,y:1,x2:1,y2:1,width:1,height:1,aspect:1};var fNe=Cke(lNe);var cNe=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function hNe(e,t,n,r){var i,a;var o=t&&t.condition;var u=r(t);if(o){var s=Qwe(o);var l=s.map((function(t){var n=r(t);var i=RDe(t)?rRe(e,t.selection):oRe(e,t.test);return Object.assign({test:i},n)}));return i={},i[n]=__spreadArrays(l,u!==undefined?[u]:[]),i}else{return u!==undefined?(a={},a[n]=u,a):{}}}function dNe(e){var t=e.channel,n=e.channelDef,r=e.markDef,i=e.scale;var a=bNe(e);if(HDe(n)&&!WAe(n.aggregate)&&i&&YSe(i.get("type"))&&i.get("zero")===false){return pNe({fieldDef:n,channel:t,markDef:r,ref:a})}return a}function pNe(e){var t=e.fieldDef,n=e.channel,r=e.markDef,i=e.ref;if(!yAe(r.type)){return[vNe(t,n),i]}return i}function vNe(e,t){var n=gNe(e,true);var r=LEe(t);var i=r==="x"?{value:0}:{field:{group:"height"}};return Object.assign({test:n},i)}function gNe(e,t){if(t===void 0){t=true}return wSe(Twe(e)?e:KDe(e,{expr:"datum"}),!t)}function mNe(e,t,n,r){var i=Object.assign(Object.assign({},t?{scale:t}:{}),{field:KDe(e,n)});if(r){var a=r.offset,o=r.band;return Object.assign(Object.assign(Object.assign({},i),a?{offset:a}:{}),o?{band:o}:{})}return i}function yNe(e){var t=e.scaleName,n=e.fieldDef,r=e.fieldDef2,i=e.offset,a=e.startSuffix,o=e.band,u=o===void 0?.5:o;var s=0<u&&u<1?"datum":undefined;var l=KDe(n,{expr:s,suffix:a});var f=r!==undefined?KDe(r,{expr:s}):KDe(n,{suffix:"end",expr:s});if(u===0){return Object.assign({scale:t,field:l},i?{offset:i}:{})}else if(u===1){return Object.assign({scale:t,field:f},i?{offset:i}:{})}else{var c=u+" * "+l+" + "+(1-u)+" * "+f;return Object.assign({signal:'scale("'+t+'", '+c+")"},i?{offset:i}:{})}}function bNe(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,i=e.markDef,a=e.config,o=e.scaleName,u=e.scale,s=e.stack,l=e.offset,f=e.defaultRef;if(n){if(HDe(n)){if(GDe(n)){var c=IDe(t,n,r,i,a,{isMidPoint:true});if(OCe(n.bin)||c&&n.timeUnit){if(_ke([ZAe,QAe],t)&&_ke([ESe,OSe],n.type)){if(s&&s.impute){return mNe(n,o,{binSuffix:"mid"},{offset:l})}return yNe({scaleName:o,fieldDef:n,band:c,offset:l})}return mNe(n,o,ECe(n,t)?{binSuffix:"range"}:{},{offset:l})}else if(SCe(n.bin)){if(HDe(r)){return yNe({scaleName:o,fieldDef:n,fieldDef2:r,band:c,offset:l})}else{var h=t===ZAe?KAe:eEe;SOe(kOe.channelRequiredForBinned(h))}}}if(u){var d=u.get("type");if(GSe(d)){if(d==="band"){var p=Hke(XDe(n)?n.band:undefined,.5);return mNe(n,o,{binSuffix:"range"},{band:p,offset:l})}return mNe(n,o,{binSuffix:"range"},{offset:l})}}return mNe(n,o,{},{offset:l})}else if(YDe(n)){var v=n.value;var g=l?{offset:l}:{};return Object.assign(Object.assign({},_Ne(t,v)),g)}}var m=Kwe(f)?Object.assign(Object.assign({},f()),l?{offset:l}:{}):f;if(m){return Object.assign(Object.assign({},m),l?{offset:l}:{})}return m}function _Ne(e,t){if(_ke(["x","x2"],e)&&t==="width"){return{field:{group:"width"}}}else if(_ke(["y","y2"],e)&&t==="height"){return{field:{group:"height"}}}return{value:t}}function xNe(e,t,n){if(n===void 0){n={}}var r=t.markDef,i=t.encoding,a=t.config;var o=n.vgChannel,u=o===void 0?e:o;var s=n.defaultRef,l=n.defaultValue;if(s===undefined){l=l!==null&&l!==void 0?l:u===e?r[e]:Hke(r[e],r[u],pDe(e,r,a,{vgChannel:u}));s=l?{value:l}:undefined}var f=i[e];return hNe(t,f,u,(function(n){return bNe({channel:e,channelDef:n,markDef:r,config:a,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s})}))}function wNe(e){var t=e.markDef,n=e.encoding,r=e.config;var i=t.filled,a=t.type;var o={fill:pDe("fill",t,r),stroke:pDe("stroke",t,r),color:pDe("color",t,r)};var u=_ke(["bar","point","circle","square","geoshape"],a)?"transparent":undefined;var s=Hke(t.fill,i===true?t.color:undefined,o.fill,i===true?o.color:undefined,u);var l=Hke(t.stroke,i===false?t.color:undefined,o.stroke,i===false?o.color:undefined);var f=i?"fill":"stroke";var c=Object.assign(Object.assign({},s?{fill:{value:s}}:{}),l?{stroke:{value:l}}:{});if(t.color&&(i?t.fill:t.stroke)){SOe(kOe.droppingColor("property",{fill:"fill"in t,stroke:"stroke"in t}))}return Object.assign(Object.assign(Object.assign(Object.assign({},c),xNe("color",e,{vgChannel:f,defaultValue:i?s:l})),xNe("fill",e,{defaultValue:n.fill?s:undefined})),xNe("stroke",e,{defaultValue:n.stroke?l:undefined}))}function kNe(e,t){if(t===void 0){t="text"}var n=e.encoding[t];return hNe(e,n,t,(function(t){return ANe(t,e.config)}))}function ANe(e,t,n){if(n===void 0){n="datum"}if(e){if(YDe(e)){return{value:e.value}}if(GDe(e)){return gDe(e,hCe(e),n,t)}}return undefined}function ENe(e,t){if(t===void 0){t={}}var n=e.encoding,r=e.markDef,i=e.config;var a=n.tooltip;if(Cwe(a)){return{tooltip:MNe({tooltip:a},i,t)}}else{return hNe(e,a,"tooltip",(function(a){var o=ANe(a,e.config,t.reactiveGeom?"datum.datum":"datum");if(o){return o}if(a===null){return undefined}var u=Hke(r.tooltip,pDe("tooltip",r,i));if(u===true){u={content:"encoding"}}if(Twe(u)){return{value:u}}else if(Fwe(u)){if(u.content==="encoding"){return MNe(n,i,t)}else{return{signal:"datum"}}}return undefined}))}}function MNe(e,t,n){var r=(n===void 0?{}:n).reactiveGeom;var i=[];var a={};var o={};var u=r?"datum.datum":"datum";var s=[];function l(n,r){var i=LEe(r);var a=GDe(n)?n:Object.assign(Object.assign({},n),{type:e[i].type});var l=Qwe(lCe(a,t,{allowDisabling:false})).join(", ");var f=ANe(a,t,u).signal;if(r==="x"||r==="y"){var c=r==="x"?"x2":"y2";var h=pCe(e[c]);if(SCe(a.bin)&&h){var d=KDe(a,{expr:u});var p=KDe(h,{expr:u});f=_De(d,p,hCe(a),t);o[c]=true}}s.push({channel:r,key:l,value:f})}LCe(e,(function(e,t){if(HDe(e)){l(e,t)}else if(qDe(e)){l(e.condition,t)}}));for(var f=0,c=s;f<c.length;f++){var h=c[f],d=h.channel,p=h.key,v=h.value;if(!o[d]&&!a[p]){i.push(Nwe(p)+": "+v);a[p]=true}}return i.length>0?{signal:"{"+i.join(", ")+"}"}:undefined}function ONe(e,t){var n=e+"Offset";var r=t[n];if(r){return r}return undefined}function SNe(e,t,n){var r;var i=n.defaultPos,a=n.vgChannel;var o=t.encoding,u=t.markDef,s=t.config,l=t.stack;var f=o[e];var c=o[e===ZAe?KAe:eEe];var h=t.scaleName(e);var d=t.getScaleComponent(e);var p=ONe(e,u);var v=CNe({model:t,defaultPos:i,channel:e,scaleName:h,scale:d,checkBarAreaWithoutZero:!c});var g=!f&&(o.latitude||o.longitude)?{field:t.getName(e)}:DNe({channel:e,channelDef:f,channel2Def:c,markDef:u,config:s,scaleName:h,scale:d,stack:l,offset:p,defaultRef:v});return r={},r[a!==null&&a!==void 0?a:e]=g,r}function DNe(e){var t=e.channel,n=e.channelDef,r=e.scaleName,i=e.stack,a=e.offset;if(HDe(n)&&i&&t===i.fieldChannel){if(XDe(n)&&n.band!==undefined){return yNe({scaleName:r,fieldDef:n,startSuffix:"start",band:n.band,offset:0})}return mNe(n,r,{suffix:"end"},{offset:a})}return dNe(e)}function CNe(e){var t=e.model,n=e.defaultPos,r=e.channel,i=e.scaleName,a=e.scale,o=e.checkBarAreaWithoutZero;var u=t.mark,s=t.markDef,l=t.config;return function(){var e=LEe(r);var f=Hke(s[r],pDe(r,s,l));if(f!==undefined){return _Ne(r,f)}if(n==="zeroOrMin"||n==="zeroOrMax"){if(i){var c=a.get("type");if(_ke([FSe.LOG,FSe.TIME,FSe.UTC],c)){if(o&&(u==="bar"||u==="area")){SOe(kOe.nonZeroScaleUsedWithLengthMark(u,e,{scaleType:c}))}}else{if(a.domainDefinitelyIncludesZero()){return{scale:i,value:0}}if(o&&(u==="bar"||u==="area")){SOe(kOe.nonZeroScaleUsedWithLengthMark(u,e,{zeroFalse:a.explicit.zero===false}))}}}if(n==="zeroOrMin"){return e==="x"?{value:0}:{field:{group:"height"}}}else{return e==="x"?{field:{group:"width"}}:{value:0}}}else{var h=t[e==="x"?"width":"height"];return Object.assign(Object.assign({},h),{mult:.5})}}}var FNe={left:"x",center:"xc",right:"x2"};var TNe={top:"y",middle:"yc",bottom:"y2"};function NNe(e,t,n){var r=e==="x"?"align":"baseline";var i=Hke(t[r],pDe(r,t,n));if(e==="x"){return FNe[i!==null&&i!==void 0?i:"center"]}else{return TNe[i!==null&&i!==void 0?i:"middle"]}}function jNe(e,t,n){var r=n.defaultPos,i=n.defaultPos2,a=n.range;if(a){return RNe(e,t,{defaultPos:r,defaultPos2:i})}return SNe(e,t,{defaultPos:r})}function RNe(e,t,n){var r=n.defaultPos,i=n.defaultPos2;var a=t.markDef,o=t.config;var u=e==="x"?"x2":"y2";var s=e==="x"?"width":"height";var l=zNe(t,i,u);var f=l[s]?NNe(e,a,o):e;return Object.assign(Object.assign({},SNe(e,t,{defaultPos:r,vgChannel:f})),l)}function zNe(e,t,n){var r,i,a,o;var u=e.encoding,s=e.mark,l=e.markDef,f=e.stack,c=e.config;var h=n==="x2"?"x":"y";var d=n==="x2"?"width":"height";var p=u[h];var v=e.scaleName(h);var g=e.getScaleComponent(h);var m=ONe(n,e.markDef);if(!p&&(u.latitude||u.longitude)){return r={},r[n]={field:e.getName(n)},r}var y=PNe({channel:n,channelDef:p,channel2Def:u[n],markDef:l,config:c,scaleName:v,scale:g,stack:f,offset:m,defaultRef:undefined});if(y!==undefined){return i={},i[n]=y,i}var b=CNe({model:e,defaultPos:t,channel:n,scaleName:v,scale:g,checkBarAreaWithoutZero:!u[n]})();return Hke(LNe(n,l),LNe(n,(a={},a[n]=vDe(n,l,c.style),a[d]=vDe(d,l,c.style),a)),LNe(n,c[s]),LNe(n,c.mark),(o={},o[n]=b,o))}function PNe(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,i=e.markDef,a=e.config,o=e.scaleName,u=e.scale,s=e.stack,l=e.offset,f=e.defaultRef;if(HDe(n)&&s&&t.charAt(0)===s.fieldChannel.charAt(0)){return mNe(n,o,{suffix:"start"},{offset:l})}return dNe({channel:t,channelDef:r,scaleName:o,scale:u,stack:s,markDef:i,config:a,offset:l,defaultRef:f})}function LNe(e,t){var n,r;var i=e==="x2"?"width":"height";if(t[e]){return n={},n[e]=_Ne(e,t[e]),n}else if(t[i]){return r={},r[i]={value:t[i]},r}return undefined}function INe(e,t,n){var r,i,a,o;var u=e.config,s=e.encoding,l=e.markDef;var f=t==="x"?"x2":"y2";var c=t==="x"?"width":"height";var h=s[t];var d=s[f];var p=e.getScaleComponent(t);var v=p?p.get("type"):undefined;var g=e.scaleName(t);var m=l.orient;var y=(o=(a=(i=(r=s[c],r!==null&&r!==void 0?r:s.size),i!==null&&i!==void 0?i:l[c]),a!==null&&a!==void 0?a:l.size),o!==null&&o!==void 0?o:pDe("size",l,u,{vgChannel:c}));var b=t==="x"?m==="vertical":m==="horizontal";if(HDe(h)&&(OCe(h.bin)||SCe(h.bin)||h.timeUnit&&!d)&&!y&&!GSe(v)){var _=IDe(t,h,undefined,l,u);return HNe({fieldDef:h,fieldDef2:d,channel:t,markDef:l,scaleName:g,band:_,spacing:Hke(l.binSpacing,u[n].binSpacing),reverse:p.get("reverse")})}else if((HDe(h)&&GSe(v)||b)&&!d){if(HDe(h)&&v===FSe.BAND){var x=XDe(h)?h.band:undefined;return WNe(h,t,e,UNe(n,l,c,g,p,u,x))}return BNe(t,e,UNe(n,l,c,g,p,u))}else{return RNe(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}}function BNe(e,t,n){var r=e==="x"?"xc":"yc";var i=e==="x"?"width":"height";return Object.assign(Object.assign({},SNe(e,t,{defaultPos:"mid",vgChannel:r})),xNe("size",t,{defaultRef:n,vgChannel:i}))}function UNe(e,t,n,r,i,a,o){var u=Hke(t[n],t.size,pDe("size",t,a,{vgChannel:n}));if(u!==undefined){return{value:u}}if(i){var s=i.get("type");if(s==="point"||s==="band"){if(a[e].discreteBandSize!==undefined){return{value:a[e].discreteBandSize}}if(s===FSe.POINT){var l=i.get("range");if(aNe(l)&&rke(l.step)){return{value:l.step-2}}return{value:HFe-2}}else{return qNe(r,o)}}else{return{value:a[e].continuousBandSize}}}var f=qFe(a.view,n);var c=Hke(a[e].discreteBandSize,f-2);return{value:c}}function qNe(e,t){if(t===void 0){t=true}return{scale:e,band:t}}function WNe(e,t,n,r){var i,a,o,u;var s;var l=n.scaleName(t);var f=t==="x"?"width":"height";var c=n.markDef,h=n.encoding,d=n.config;var p=NNe(t,c,d);var v=(i={},i[p]=mNe(e,l,{},{band:.5}),i);if(h.size||c.size!==null&&c.size!==undefined){var g=c.orient;if(g){if(vCe(h.size)||YDe(h.size)){return Object.assign(Object.assign({},v),xNe("size",n,{vgChannel:f}))}else if(c.size!==undefined){return Object.assign(Object.assign({},v),(a={},a[f]={value:c.size},a))}}else{SOe(kOe.cannotApplySizeToNonOrientedMark(c.type))}}if(((s=r)===null||s===void 0?void 0:s.value)!==undefined){return Object.assign(Object.assign({},v),(o={},o[f]=r,o))}var m=e.band,y=m===void 0?1:m;return u={},u[t]=mNe(e,l,{binSuffix:"range"},{band:(1-y)/2}),u[f]=r!==null&&r!==void 0?r:qNe(l,y),u}function HNe(e){var t,n;var r=e.fieldDef,i=e.fieldDef2,a=e.channel,o=e.band,u=e.scaleName,s=e.markDef,l=e.spacing,f=l===void 0?0:l,c=e.reverse;var h={x:c?f:0,x2:c?0:f,y:c?0:f,y2:c?f:0};var d=a===ZAe?KAe:eEe;if(OCe(r.bin)||r.timeUnit){return t={},t[d]=GNe({channel:a,fieldDef:r,scaleName:u,markDef:s,band:(1-o)/2,offset:h[a+"2"]}),t[a]=GNe({channel:a,fieldDef:r,scaleName:u,markDef:s,band:1-(1-o)/2,offset:h[a]}),t}else if(SCe(r.bin)&&HDe(i)){return n={},n[d]=mNe(r,u,{},{offset:h[a+"2"]}),n[a]=mNe(i,u,{},{offset:h[a]}),n}else{SOe(kOe.channelRequiredForBinned(d));return undefined}}function GNe(e){var t=e.channel,n=e.fieldDef,r=e.scaleName,i=e.markDef,a=e.band,o=e.offset;var u=yNe({scaleName:r,fieldDef:n,band:a,offset:o});return pNe({fieldDef:n,channel:t,markDef:i,ref:u})}function $Ne(e,t){var n=t.color==="include"?wNe(e):{},r=n.fill,i=r===void 0?undefined:r,a=n.stroke,o=a===void 0?undefined:a;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},VNe(e.markDef,t)),YNe(e,"fill",i)),YNe(e,"stroke",o)),xNe("opacity",e)),xNe("fillOpacity",e)),xNe("strokeOpacity",e)),xNe("strokeWidth",e)),ENe(e)),kNe(e,"href"))}function YNe(e,t,n){var r,i;var a=e.config,o=e.mark,u=e.markDef;var s=dDe("invalid",u,a);if(s==="hide"&&n&&!yAe(o)){var l=XNe(e,{invalid:true,channels:ZEe});if(l){return r={},r[t]=__spreadArrays([{test:l,value:null}],Qwe(n)),r}}return n?(i={},i[t]=n,i):{}}function VNe(e,t){return fNe.reduce((function(n,r){if(e[r]!==undefined&&t[r]!=="ignore"){n[r]={value:e[r]}}return n}),{})}function XNe(e,t){var n=t.invalid,r=n===void 0?false:n,i=t.channels;var a=i.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var i=r.get("type");var a=e.vgField(n,{expr:"datum"});if(a&&$Se(i)){t[a]=true}}return t}),{});var o=Cke(a);if(o.length>0){var u=r?"||":"&&";return o.map((function(e){return gNe(e,r)})).join(" "+u+" ")}return undefined}function JNe(e){var t=e.config,n=e.markDef;var r=dDe("invalid",n,t);if(r){var i=ZNe(e,{channels:["x","y"]});if(i){return{defined:{signal:i}}}}return{}}function ZNe(e,t){var n=t.invalid,r=n===void 0?false:n,i=t.channels;var a=i.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var i=r.get("type");var a=e.vgField(n,{expr:"datum"});if(a&&$Se(i)){t[a]=true}}return t}),{});var o=Cke(a);if(o.length>0){var u=r?"||":"&&";return o.map((function(e){return gNe(e,r)})).join(" "+u+" ")}return undefined}function QNe(e,t){var n;if(t!==undefined){return n={},n[e]={value:t},n}return undefined}var KNe="voronoi";var eje={has:function(e){return e.type!=="interval"&&e.nearest},parse:function(e,t){if(t.events){for(var n=0,r=t.events;n<r.length;n++){var i=r[n];i.markname=e.getName(KNe)}}},marks:function(e,t,n){var r=t.project.hasChannel,i=r.x,a=r.y;var o=e.mark;if(yAe(o)){SOe(kOe.nearestNotSupportForContinuous(o));return n}var u={name:e.getName(KNe),type:"path",interactive:true,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:true}},ENe(e,{reactiveGeom:true}))},transform:[{type:"voronoi",x:{expr:i||!a?"datum.datum.x || 0":"0"},y:{expr:a||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};var s=0;var l=false;n.forEach((function(t,n){var r;var i=(r=t.name,r!==null&&r!==void 0?r:"");if(i===e.component.mark[0].name){s=n}else if(i.indexOf(KNe)>=0){l=true}}));if(!l){n.splice(s+1,0,u)}return n}};var tje=function(){function e(e,t){this.debugName=t;this._children=[];this._parent=null;if(e){this.parent=e}}e.prototype.clone=function(){throw new Error("Cannot clone node")};Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(e){this._parent=e;if(e){e.addChild(this)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:true,configurable:true});e.prototype.numChildren=function(){return this._children.length};e.prototype.addChild=function(e,t){if(this._children.indexOf(e)>-1){console.warn("Attempt to add the same child twice.");return}if(t!==undefined){this._children.splice(t,0,e)}else{this._children.push(e)}};e.prototype.removeChild=function(e){var t=this._children.indexOf(e);this._children.splice(t,1);return t};e.prototype.remove=function(){var e=this._parent.removeChild(this);for(var t=0,n=this._children;t<n.length;t++){var r=n[t];r._parent=this._parent;this._parent.addChild(r,e++)}};e.prototype.insertAsParentOf=function(e){var t=e.parent;t.removeChild(this);this.parent=t;e.parent=this};e.prototype.swapWithParent=function(){var e=this._parent;var t=e.parent;for(var n=0,r=this._children;n<r.length;n++){var i=r[n];i.parent=e}this._children=[];e.removeChild(this);e.parent.removeChild(e);this.parent=t;e.parent=this};return e}();var nje=function(e){p(t,e);function t(t,n,r,i){var a=e.call(this,t,n)||this;a.type=r;a.refCounts=i;a._source=a._name=n;if(a.refCounts&&!(a._name in a.refCounts)){a.refCounts[a._name]=0}return a}t.prototype.clone=function(){var e=new this.constructor;e.debugName="clone_"+this.debugName;e._source=this._source;e._name="clone_"+this._name;e.type=this.type;e.refCounts=this.refCounts;e.refCounts[e._name]=0;return e};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){if(this._hash===undefined){this._hash="Output "+$ke()}return this._hash};t.prototype.getSource=function(){this.refCounts[this._name]++;return this._source};t.prototype.isRequired=function(){return!!this.refCounts[this._name]};t.prototype.setSource=function(e){this._source=e};return t}(tje);var rje=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.formula=n;return r}t.prototype.clone=function(){return new t(null,pke(this.formula))};t.makeFromEncoding=function(e,n){var r=n.reduceFieldDef((function(e,t,r){var i=t.field,a=t.timeUnit;var o=$Le(n)?n.encoding[IEe(r)]:undefined;var u=$Le(n)&&BDe(r,t,o,n.markDef,n.config);if(a){var s=KDe(t,{forAs:true});e[yke({as:s,field:i,timeUnit:a})]=Object.assign({as:s,field:i,timeUnit:a},u?{band:true}:{})}return e}),{});if(Cke(r).length===0){return null}return new t(e,r)};t.makeFromTransform=function(e,n){var r;var i=Object.assign({},n),a=i.timeUnit,o=h(i,["timeUnit"]);var u=oSe(a);var s=Object.assign(Object.assign({},o),{timeUnit:u});return new t(e,(r={},r[yke(s)]=s,r))};t.prototype.merge=function(e){this.formula=Object.assign({},this.formula);for(var t in e.formula){if(!this.formula[t]||e.formula[t].band){this.formula[t]=e.formula[t]}}for(var n=0,r=e.children;n<r.length;n++){var i=r[n];e.removeChild(i);i.parent=this}e.remove()};t.prototype.producedFields=function(){return new Set(Fke(this.formula).map((function(e){return e.as})))};t.prototype.dependentFields=function(){return new Set(Fke(this.formula).map((function(e){return e.field})))};t.prototype.hash=function(){return"TimeUnit "+yke(this.formula)};t.prototype.assemble=function(){var e=[];for(var t=0,n=Fke(this.formula);t<n.length;t++){var r=n[t];var i=r.field,a=r.as,o=r.timeUnit;var u=oSe(o),s=u.unit,l=u.utc,f=h(u,["unit","utc"]);e.push(Object.assign(Object.assign(Object.assign(Object.assign({field:i,type:"timeunit"},s?{units:tSe(s)}:{}),l?{timezone:"utc"}:{}),f),{as:[a,a+"_end"]}))}return e};return t}(tje);var ije="_tuple_fields";var aje=function(){function e(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}this.items=e;this.hasChannel={};this.hasField={}}return e}();var oje={has:function(){return true},parse:function(e,t,n){var r,i,a;var o=t.name;var u=(r=t.project,r!==null&&r!==void 0?r:t.project=new aje);var s={};var l={};var f=new Set;var c=function(e,t){var n;var r=t==="visual"?e.channel:e.field;var i=Nke(o+"_"+r);for(var a=1;f.has(i);a++){i=Nke(o+"_"+r+"_"+a)}f.add(i);return n={},n[t]=i,n};if(!n.fields&&!n.encodings){var h=e.config.selection[n.type];if(n.init){for(var d=0,p=Qwe(n.init);d<p.length;d++){var v=p[d];for(var g=0,m=Cke(v);g<m.length;g++){var y=m[g];if(jEe(y)){(n.encodings||(n.encodings=[])).push(y)}else{if(n.type==="interval"){SOe('Interval selections should be initialized using "x" and/or "y" keys.');n.encodings=h.encodings}else{(n.fields||(n.fields=[])).push(y)}}}}}else{n.encodings=h.encodings;n.fields=h.fields}}for(var b=0,_=(i=n.fields,i!==null&&i!==void 0?i:[]);b<_.length;b++){var x=_[b];var w={type:"E",field:x};w.signals=Object.assign({},c(w,"data"));u.items.push(w);u.hasField[x]=w}for(var k=0,A=(a=n.encodings,a!==null&&a!==void 0?a:[]);k<A.length;k++){var E=A[k];var M=e.fieldDef(E);if(M){var O=M.field;if(M.aggregate){SOe(kOe.cannotProjectAggregate(E,M.aggregate));continue}else if(!O){SOe(kOe.cannotProjectOnChannelWithoutField(E));continue}if(M.timeUnit){O=e.vgField(E);var S={timeUnit:M.timeUnit,as:O,field:M.field};l[yke(S)]=S}if(!s[O]){var D="E";if(t.type==="interval"){var C=e.getScaleComponent(E).get("type");if($Se(C)){D="R"}}else if(M.bin){D="R-RE"}var w={field:O,channel:E,type:D};w.signals=Object.assign(Object.assign({},c(w,"data")),c(w,"visual"));u.items.push(s[O]=w);u.hasField[O]=u.hasChannel[E]=s[O]}}else{SOe(kOe.cannotProjectOnChannelWithoutField(E))}}if(n.init){var F=function(e){return u.items.map((function(t){return e[t.channel]!==undefined?e[t.channel]:e[t.field]}))};if(n.type==="interval"){t.init=F(n.init)}else{var v=Qwe(n.init);t.init=v.map(F)}}if(Cke(l).length>0){u.timeUnit=new rje(null,l)}},signals:function(e,t,n){var r=t.name+ije;var i=n.filter((function(e){return e.name===r}));return i.length>0?n:n.concat({name:r,value:t.project.items.map((function(e){var t=h(e,["signals","hasLegend"]);var n=pke(t);n.field=Bke(n.field);return n}))})}};var uje={has:function(e){return e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!SFe(e.bind)},parse:function(e,t,n,r){if(!r.on)delete t.events;if(!r.clear)delete t.clear},topLevelSignals:function(e,t,n){var r=t.name;var i=t.project;var a=t.bind;var o=t.init&&t.init[0];var u=eje.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";i.items.forEach((function(e,i){var s,l;var f=Nke(r+"_"+e.field);var c=n.filter((function(e){return e.name===f}));if(!c.length){n.unshift(Object.assign(Object.assign({name:f},o?{init:Mje(o[i])}:{value:null}),{on:t.events?[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? "+u+"["+Nwe(e.field)+"] : null"}]:[],bind:(l=(s=a[e.field],s!==null&&s!==void 0?s:a[e.channel]),l!==null&&l!==void 0?l:a)}))}}));return n},signals:function(e,t,n){var r=t.name;var i=t.project;var a=n.filter((function(e){return e.name===r+Hje}))[0];var o=r+ije;var u=i.items.map((function(e){return Nke(r+"_"+e.field)}));var s=u.map((function(e){return e+" !== null"})).join(" && ");if(u.length){a.update=s+" ? {fields: "+o+", values: ["+u.join(", ")+"]} : null"}delete a.value;delete a.on;return n}};var sje="_toggle";var lje={has:function(e){return e.type==="multi"&&!!e.toggle},signals:function(e,t,n){return n.concat({name:t.name+sje,value:false,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t){var n=t.name+Hje;var r=t.name+sje;return r+" ? null : "+n+", "+(t.resolve==="global"?r+" ? null : true, ":r+" ? null : {unit: "+Jje(e)+"}, ")+(r+" ? "+n+" : null")}};var fje={has:function(e){return e.clear!==undefined&&e.clear!==false},parse:function(e,t,n){if(n.clear){t.clear=Twe(n.clear)?gge(n.clear,"scope"):n.clear}},topLevelSignals:function(e,t,n){if(uje.has(t)){t.project.items.forEach((function(e){var r=n.findIndex((function(n){return n.name===Nke(t.name+"_"+e.field)}));if(r!==-1){n[r].on.push({events:t.clear,update:"null"})}}))}return n},signals:function(e,t,n){function r(e,r){if(e!==-1&&n[e].on){n[e].on.push({events:t.clear,update:r})}}if(t.type==="interval"){t.project.items.forEach((function(e){var t=n.findIndex((function(t){return t.name===e.signals.visual}));r(t,"[0, 0]");if(t===-1){var i=n.findIndex((function(t){return t.name===e.signals.data}));r(i,"null")}}))}else{var i=n.findIndex((function(e){return e.name===t.name+Hje}));r(i,"null");if(lje.has(t)){i=n.findIndex((function(e){return e.name===t.name+sje}));r(i,"false")}}return n}};var cje={has:function(e){return e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales"},parse:function(e,t){var n=t.scales=[];for(var r=0,i=t.project.items;r<i.length;r++){var a=i[r];var o=a.channel;if(!QEe(o)){continue}var u=e.getScaleComponent(o);var s=u?u.get("type"):undefined;if(!u||!$Se(s)){SOe(kOe.SCALE_BINDINGS_CONTINUOUS);continue}var l={selection:t.name,field:a.field};u.set("selectionExtent",l,true);n.push(a);if(e.repeater&&e.repeater.row===e.repeater.column){var f=e.getScaleComponent(o===ZAe?QAe:ZAe);f.set("selectionExtent",l,true)}}},topLevelSignals:function(e,t,n){var r=t.scales.filter((function(e){return n.filter((function(t){return t.name===e.signals.data})).length===0}));if(!e.parent||dje(e)||r.length===0){return n}var i=n.filter((function(e){return e.name===t.name}))[0];var a=i.update;if(a.indexOf($je)>=0){i.update="{"+r.map((function(e){return Nwe(e.field)+": "+e.signals.data})).join(", ")+"}"}else{for(var o=0,u=r;o<u.length;o++){var s=u[o];var l=Nwe(s.field)+": "+s.signals.data;if(a.indexOf(l)<0){a=a.substring(0,a.length-1)+", "+l+"}"}}i.update=a}return n.concat(r.map((function(e){return{name:e.signals.data}})))},signals:function(e,t,n){if(e.parent&&!dje(e)){var r=function(e){var t=n.filter((function(t){return t.name===e.signals.data}))[0];t.push="outer";delete t.value;delete t.update};for(var i=0,a=t.scales;i<a.length;i++){var o=a[i];r(o)}}return n}};function hje(e,t){var n=Nwe(e.scaleName(t));return"domain("+n+")"}function dje(e){var t;return e.parent&&JLe(e.parent)&&(t=!e.parent.parent,t!==null&&t!==void 0?t:dje(e.parent.parent))}var pje={has:function(e){var t=e.resolve==="global"&&e.bind&&SFe(e.bind);var n=e.project.items.length===1&&e.project.items[0].field!==MFe;if(t&&!n){SOe(kOe.LEGEND_BINDINGS_PROJECT_LENGTH)}return t&&n},parse:function(e,t,n,r){var i;if(!r.on)delete t.events;if(!r.clear)delete t.clear;if(r.on||r.clear){var a='event.item && indexof(event.item.mark.role, "legend") < 0';for(var o=0,u=t.events;o<u.length;o++){var s=u[o];s.filter=Qwe((i=s.filter,i!==null&&i!==void 0?i:[]));if(s.filter.indexOf(a)<0){s.filter.push(a)}}}var l=DFe(t.bind)?t.bind.legend:"click";var f=Twe(l)?gge(l,"view"):Qwe(l);t.bind={legend:{merge:f}}},topLevelSignals:function(e,t,n){var r=t.name;var i=DFe(t.bind)&&t.bind.legend;var a=function(e){return function(t){var n=pke(t);n.markname=e;return n}};var o=function(e){if(!e.hasLegend)return"continue";var o=Nke(e.field)+"_legend";var u=r+"_"+o;var s=n.filter((function(e){return e.name===u}));if(s.length===0){var l=i.merge.map(a(o+"_symbols")).concat(i.merge.map(a(o+"_labels"))).concat(i.merge.map(a(o+"_entries")));n.unshift(Object.assign(Object.assign({name:u},!t.init?{value:null}:{}),{on:[{events:l,update:"datum.value || item().items[0].items[0].datum.value",force:true},{events:i.merge,update:"!event.item || !datum ? null : "+u,force:true}]}))}};for(var u=0,s=t.project.items;u<s.length;u++){var l=s[u];o(l)}return n},signals:function(e,t,n){var r=t.name;var i=t.project;var a=n.find((function(e){return e.name===r+Hje}));var o=r+ije;var u=i.items.filter((function(e){return e.hasLegend})).map((function(e){return Nke(r+"_"+Nke(e.field)+"_legend")}));var s=u.map((function(e){return e+" !== null"})).join(" && ");var l=s+" ? {fields: "+o+", values: ["+u.join(", ")+"]} : null";if(t.events&&u.length>0){a.on.push({events:u.map((function(e){return{signal:e}})),update:l})}else if(u.length>0){a.update=l;delete a.value;delete a.on}var f=n.find((function(e){return e.name===r+sje}));var c=DFe(t.bind)&&t.bind.legend;if(f){if(!t.events)f.on[0].events=c;else f.on.push(Object.assign(Object.assign({},f.on[0]),{events:c}))}return n}};function vje(e,t,n){var r=e.fieldDef(t).field;Vje(e,(function(e){var i,a;var o=(i=e.project.hasField[r],i!==null&&i!==void 0?i:e.project.hasChannel[t]);if(o&&pje.has(e)){var u=(a=n.get("selections"),a!==null&&a!==void 0?a:[]);u.push(e.name);n.set("selections",u,false);o.hasLegend=true}}))}var gje="_translate_anchor";var mje="_translate_delta";var yje={has:function(e){return e.type==="interval"&&e.translate},signals:function(e,t,n){var r=t.name;var i=cje.has(t);var a=r+gje;var o=t.project.hasChannel,u=o.x,s=o.y;var l=gge(t.translate,"scope");if(!i){l=l.map((function(e){return e.between[0].markname=r+Rje,e}))}n.push({name:a,value:{},on:[{events:l.map((function(e){return e.between[0]})),update:"{x: x(unit), y: y(unit)"+(u!==undefined?", extent_x: "+(i?hje(e,ZAe):"slice("+u.signals.visual+")"):"")+(s!==undefined?", extent_y: "+(i?hje(e,QAe):"slice("+s.signals.visual+")"):"")+"}"}]},{name:r+mje,value:{},on:[{events:l,update:"{x: "+a+".x - x(unit), y: "+a+".y - y(unit)}"}]});if(u!==undefined){bje(e,t,u,"width",n)}if(s!==undefined){bje(e,t,s,"height",n)}return n}};function bje(e,t,n,r,i){var a;var o=t.name;var u=o+gje;var s=o+mje;var l=n.channel;var f=cje.has(t);var c=i.filter((function(e){return e.name===n.signals[f?"data":"visual"]}))[0];var h=e.getSizeSignalRef(r).signal;var d=e.getScaleComponent(l);var p=d.get("type");var v=f&&l===ZAe?"-":"";var g=u+".extent_"+l;var m=""+v+s+"."+l+" / "+(f?""+h:"span("+g+")");var y=!f?"panLinear":p==="log"?"panLog":p==="pow"?"panPow":"panLinear";var b=y+"("+g+", "+m+(f&&p==="pow"?", "+(a=d.get("exponent"),a!==null&&a!==void 0?a:1):"")+")";c.on.push({events:{signal:s},update:f?b:"clampRange("+b+", 0, "+h+")"})}var _je="_zoom_anchor";var xje="_zoom_delta";var wje={has:function(e){return e.type==="interval"&&e.zoom},signals:function(e,t,n){var r=t.name;var i=cje.has(t);var a=r+xje;var o=t.project.hasChannel,u=o.x,s=o.y;var l=Nwe(e.scaleName(ZAe));var f=Nwe(e.scaleName(QAe));var c=gge(t.zoom,"scope");if(!i){c=c.map((function(e){return e.markname=r+Rje,e}))}n.push({name:r+_je,on:[{events:c,update:!i?"{x: x(unit), y: y(unit)}":"{"+[l?"x: invert("+l+", x(unit))":"",f?"y: invert("+f+", y(unit))":""].filter((function(e){return!!e})).join(", ")+"}"}]},{name:a,on:[{events:c,force:true,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]});if(u!==undefined){kje(e,t,u,"width",n)}if(s!==undefined){kje(e,t,s,"height",n)}return n}};function kje(e,t,n,r,i){var a;var o=t.name;var u=n.channel;var s=cje.has(t);var l=i.filter((function(e){return e.name===n.signals[s?"data":"visual"]}))[0];var f=e.getSizeSignalRef(r).signal;var c=e.getScaleComponent(u);var h=c.get("type");var d=s?hje(e,u):l.name;var p=o+xje;var v=""+o+_je+"."+u;var g=!s?"zoomLinear":h==="log"?"zoomLog":h==="pow"?"zoomPow":"zoomLinear";var m=g+"("+d+", "+v+", "+p+(s&&h==="pow"?", "+(a=c.get("exponent"),a!==null&&a!==void 0?a:1):"")+")";l.on.push({events:{signal:p},update:s?m:"clampRange("+m+", 0, "+f+")"})}var Aje=[oje,lje,cje,pje,yje,wje,uje,eje,fje];function Eje(e,t){for(var n=0,r=Aje;n<r.length;n++){var i=r[n];if(i.has(e)){t(i)}}}function Mje(e,t,n){if(t===void 0){t=true}if(n===void 0){n=Pwe}if(Cwe(e)){var r=e.map((function(e){return Mje(e,t,n)}));return t?"["+r.join(", ")+"]":r}else if(FOe(e)){if(t){return n(BOe(e))}else{return n(qOe(e))}}return t?n(JSON.stringify(e)):e}function Oje(e,t){Vje(e,(function(n,r){var i=n.name;var a=r.modifyExpr(e,n);t.push.apply(t,r.signals(e,n));Eje(n,(function(r){if(r.signals){t=r.signals(e,n,t)}if(r.modifyExpr){a=r.modifyExpr(e,n,a)}}));t.push({name:i+Gje,on:[{events:{signal:n.name+Hje},update:"modify("+Nwe(n.name+Wje)+", "+a+")"}]})}));return jje(t)}function Sje(e,t){if(e.component.selection&&Cke(e.component.selection).length){var n=Nwe(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:gge("mousemove","scope"),update:"isTuple(facet) ? facet : group("+n+").datum"}]})}return jje(t)}function Dje(e,t){var n=false;Vje(e,(function(r,i){var a=r.name;var o=Nwe(a+Wje);var u=t.filter((function(e){return e.name===a}));if(u.length===0){var s=r.resolve==="global"?"union":r.resolve;var l=r.type==="multi"?", true)":")";t.push({name:r.name,update:$je+"("+o+", "+Nwe(s)+l})}n=true;if(i.topLevelSignals){t=i.topLevelSignals(e,r,t)}Eje(r,(function(n){if(n.topLevelSignals){t=n.topLevelSignals(e,r,t)}}))}));if(n){var r=t.filter((function(e){return e.name==="unit"}));if(r.length===0){t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}}return jje(t)}function Cje(e,t){var n=__spreadArrays(t);Vje(e,(function(t){var r={name:t.name+Wje};if(t.init){var i=t.project.items.map((function(e){var t=h(e,["signals"]);return t}));var a=t.init.map((function(e){return Mje(e,false)}));r.values=t.type==="interval"?[{unit:Jje(e,{escape:false}),fields:i,values:a}]:a.map((function(t){return{unit:Jje(e,{escape:false}),fields:i,values:t}}))}var o=n.filter((function(e){return e.name===t.name+Wje}));if(!o.length){n.push(r)}}));return n}function Fje(e,t){Vje(e,(function(n,r){t=r.marks?r.marks(e,n,t):t;Eje(n,(function(r){if(r.marks){t=r.marks(e,n,t)}}))}));return t}function Tje(e,t){for(var n=0,r=e.children;n<r.length;n++){var i=r[n];if($Le(i)){t=Fje(i,t)}}return t}function Nje(e,t){var n=t.selection;var r=e.getSelectionComponent(n,Nke(n));return{signal:iRe(r,t)}}function jje(e){return e.map((function(e){if(e.on&&!e.on.length)delete e.on;return e}))}var Rje="_brush";var zje="_scale_trigger";var Pje={signals:function(e,t){var n=t.name;var r=n+ije;var i=cje.has(t);var a=[];var o=[];var u=[];if(t.translate&&!i){var s="!event.item || event.item.mark.name !== "+Nwe(n+Rje);Ije(t,(function(e,t){var n;var r=Qwe((n=t.between[0].filter,n!==null&&n!==void 0?n:t.between[0].filter=[]));if(r.indexOf(s)<0){r.push(s)}return e}))}t.project.items.forEach((function(n,r){var i=n.channel;if(i!==ZAe&&i!==QAe){SOe("Interval selections only support x and y encoding channels.");return}var s=t.init?t.init[r]:null;var l=Lje(e,t,n,s);var f=n.signals.data;var c=n.signals.visual;var h=Nwe(e.scaleName(i));var d=e.getScaleComponent(i).get("type");var p=$Se(d)?"+":"";a.push.apply(a,l);o.push(f);u.push({scaleName:e.scaleName(i),expr:"(!isArray("+f+") || "+("("+p+"invert("+h+", "+c+")[0] === "+p+f+"[0] && ")+(p+"invert("+h+", "+c+")[1] === "+p+f+"[1]))")})}));if(!i){a.push({name:n+zje,value:{},on:[{events:u.map((function(e){return{scale:e.scaleName}})),update:u.map((function(e){return e.expr})).join(" && ")+(" ? "+(n+zje)+" : {}")}]})}var l=t.init;var f="unit: "+Jje(e)+", fields: "+r+", values";return a.concat(Object.assign(Object.assign({name:n+Hje},l?{init:"{"+f+": "+Mje(l)+"}"}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+(" ? {"+f+": ["+o+"]} : null")}]}))},modifyExpr:function(e,t){var n=t.name+Hje;return n+", "+(t.resolve==="global"?"true":"{unit: "+Jje(e)+"}")},marks:function(e,t,n){var r=t.name;var i=t.project.hasChannel,a=i.x,o=i.y;var u=a&&a.signals.visual;var s=o&&o.signals.visual;var l="data("+Nwe(t.name+Wje)+")";if(cje.has(t)){return n}var f={x:a!==undefined?{signal:u+"[0]"}:{value:0},y:o!==undefined?{signal:s+"[0]"}:{value:0},x2:a!==undefined?{signal:u+"[1]"}:{field:{group:"width"}},y2:o!==undefined?{signal:s+"[1]"}:{field:{group:"height"}}};if(t.resolve==="global"){for(var c=0,d=Cke(f);c<d.length;c++){var p=d[c];f[p]=[Object.assign({test:l+".length && "+l+"[0].unit === "+Jje(e)},f[p]),{value:0}]}}var v=t.mark,g=v.fill,m=v.fillOpacity,y=v.cursor,b=h(v,["fill","fillOpacity","cursor"]);var _=Cke(b).reduce((function(e,t){e[t]=[{test:[a!==undefined&&u+"[0] !== "+u+"[1]",o!==undefined&&s+"[0] !== "+s+"[1]"].filter((function(e){return e})).join(" && "),value:b[t]},{value:null}];return e}),{});return __spreadArrays([{name:r+Rje+"_bg",type:"rect",clip:true,encode:{enter:{fill:{value:g},fillOpacity:{value:m}},update:f}}],n,[{name:r+Rje,type:"rect",clip:true,encode:{enter:Object.assign(Object.assign({},y?{cursor:{value:y}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},f),_)}}])}};function Lje(e,t,n,r){var i=n.channel;var a=n.signals.visual;var o=n.signals.data;var u=cje.has(t);var s=Nwe(e.scaleName(i));var l=e.getScaleComponent(i);var f=l?l.get("type"):undefined;var c=function(e){return"scale("+s+", "+e+")"};var h=e.getSizeSignalRef(i===ZAe?"width":"height").signal;var d=i+"(unit)";var p=Ije(t,(function(e,t){return __spreadArrays(e,[{events:t.between[0],update:"["+d+", "+d+"]"},{events:t,update:"["+a+"[0], clamp("+d+", 0, "+h+")]"}])}));p.push({events:{signal:t.name+zje},update:$Se(f)?"["+c(o+"[0]")+", "+c(o+"[1]")+"]":"[0, 0]"});return u?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:Mje(r,true,c)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:Mje(r)}:{}),{on:[{events:{signal:a},update:a+"[0] === "+a+"[1] ? null : invert("+s+", "+a+")"}]})]}function Ije(e,t){return e.events.reduce((function(e,n){if(!n.between){SOe(n+" is not an ordered event stream for interval selections.");return e}return t(e,n)}),[])}function Bje(e,t){var n=t.name;var r=n+ije;var i=t.project;var a="(item().isVoronoi ? datum.datum : datum)";var o=i.items.map((function(t){var n=e.fieldDef(t.channel);return n&&n.bin?"["+a+"["+Nwe(e.vgField(t.channel,{}))+"], "+(a+"["+Nwe(e.vgField(t.channel,{binSuffix:"end"}))+"]]"):a+"["+Nwe(t.field)+"]"})).join(", ");var u="unit: "+Jje(e)+", fields: "+r+", values";var s=t.events;return[{name:n+Hje,on:s?[{events:s,update:"datum && item().mark.marktype !== 'group' ? {"+u+": ["+o+"]} : null",force:true}]:[]}]}var Uje={signals:Bje,modifyExpr:function(e,t){var n=t.name+Hje;return n+", "+(t.resolve==="global"?"null":"{unit: "+Jje(e)+"}")}};var qje={signals:Bje,modifyExpr:function(e,t){var n=t.name+Hje;return n+", "+(t.resolve==="global"?"true":"{unit: "+Jje(e)+"}")}};var Wje="_store";var Hje="_tuple";var Gje="_modify";var $je="vlSelectionResolve";var Yje={single:qje,multi:Uje,interval:Pje};function Vje(e,t){var n=e.component.selection;if(n){for(var r in n){if(tke(n,r)){var i=n[r];var a=t(i,Yje[i.type]);if(a===true)break}}}}function Xje(e){var t=e.parent;while(t){if(YLe(t)){break}t=t.parent}return t}function Jje(e,t){var n=(t===void 0?{escape:true}:t).escape;var r=n?Nwe(e.name):e.name;var i=Xje(e);if(i){var a=i.facet;for(var o=0,u=DEe;o<u.length;o++){var s=u[o];if(a[s]){r+=" + '__facet_"+s+"_' + (facet["+Nwe(i.vgField(s))+"])"}}}return r}function Zje(e){var t=false;Vje(e,(function(e){t=t||e.project.items.some((function(e){return e.field===MFe}))}));return t}function Qje(e){var t=[];if(e.type==="Identifier"){return[e.name]}if(e.type==="Literal"){return[e.value]}if(e.type==="MemberExpression"){t.push.apply(t,Qje(e.object));t.push.apply(t,Qje(e.property))}return t}function Kje(e){if(e.object.type==="MemberExpression"){return Kje(e.object)}return e.object.name==="datum"}function eRe(e){var t=V2(e);var n=new Set;t.visit((function(e){if(e.type==="MemberExpression"&&Kje(e)){n.add(Qje(e).slice(1).join("."))}}));return n}var tRe=function(e){p(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.model=n;i.filter=r;i.expr=oRe(i.model,i.filter,i);i._dependentFields=eRe(i.expr);return i}t.prototype.clone=function(){return new t(null,this.model,pke(this.filter))};t.prototype.dependentFields=function(){return this._dependentFields};t.prototype.producedFields=function(){return new Set};t.prototype.assemble=function(){return{type:"filter",expr:this.expr}};t.prototype.hash=function(){return"Filter "+this.expr};return t}(tje);function nRe(e,t){var n;var r={};var i=e.config.selection;var a=function(a){if(!tke(t,a)){return"continue"}var o=pke(t[a]);var u=i[o.type],s=h(u,["fields","encodings"]);for(var l in s){if(l==="encodings"&&o.fields||l==="fields"&&o.encodings){continue}if(l==="mark"){o[l]=Object.assign(Object.assign({},s[l]),o[l])}if(o[l]===undefined||o[l]===true){o[l]=(n=s[l],n!==null&&n!==void 0?n:o[l])}}var f=Nke(a);var c=r[f]=Object.assign(Object.assign({},o),{name:f,events:Twe(o.on)?gge(o.on,"scope"):pke(o.on)});Eje(c,(function(n){if(n.has(c)&&n.parse){n.parse(e,c,o,t[a])}}))};for(var o in t){a(o)}return r}function rRe(e,t,n,r){if(r===void 0){r="datum"}var i=[];function a(t){var a=Nke(t);var o=e.getSelectionComponent(a,t);var u=Nwe(a+Wje);if(o.project.timeUnit){var s=n!==null&&n!==void 0?n:e.component.data.raw;var l=o.project.timeUnit.clone();if(s.parent){l.insertAsParentOf(s)}else{s.parent=l}}if(o.empty!=="none"){i.push(u)}return"vlSelectionTest("+u+", "+r+(o.resolve==="global"?")":", "+Nwe(o.resolve)+")")}var o=jke(t,a);return(i.length?"!("+i.map((function(e){return"length(data("+e+"))"})).join(" || ")+") || ":"")+("("+o+")")}function iRe(e,t){var n=t["encoding"];var r=t["field"];if(!n&&!r){r=e.project.items[0].field;if(e.project.items.length>1){SOe('A "field" or "encoding" must be specified when using a selection as a scale domain. '+('Using "field": '+Nwe(r)+"."))}}else if(n&&!r){var i=e.project.items.filter((function(e){return e.channel===n}));if(!i.length||i.length>1){r=e.project.items[0].field;SOe((!i.length?"No ":"Multiple ")+("matching "+Nwe(n)+" encoding found for selection "+Nwe(t.selection)+". ")+('Using "field": '+Nwe(r)+"."))}else{r=i[0].field}}return e.name+"["+Nwe(r)+"]"}function aRe(e,t){Vje(e,(function(n){var r=n.name;var i=e.getName("lookup_"+r);e.component.data.outputNodes[i]=n.materialized=new nje(new tRe(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)}))}function oRe(e,t,n){return jke(t,(function(t){if(Twe(t)){return t}else if(lSe(t)){return rRe(e,t.selection,n)}else{return xSe(t)}}))}function uRe(e,t){if(!e){return undefined}if(!lDe(e)){return e.map((function(e){return cCe(e,t)})).join(", ")}return e}function sRe(e,t,n,r){var i,a,o;e.encode=(i=e.encode,i!==null&&i!==void 0?i:{});e.encode[t]=(a=e.encode[t],a!==null&&a!==void 0?a:{});e.encode[t].update=(o=e.encode[t].update,o!==null&&o!==void 0?o:{});e.encode[t].update[n]=r}function lRe(e,t,n,r){if(r===void 0){r={header:false}}var i,a;var o=e.combine(),u=o.orient,s=o.scale,l=o.labelExpr,f=o.title,c=o.zindex,d=h(o,["orient","scale","labelExpr","title","zindex"]);for(var p in d){var v=eAe[p];var g=d[p];if(v&&v!==t&&v!=="both"){delete d[p]}else if(Qke(g)){var m=g.condition,y=g.value;var b=Qwe(m);var _=Zke[p];if(_){var x=_.vgProp,w=_.part;var k=__spreadArrays(b.map((function(e){var t=e.value,n=e.test;return{test:oRe(null,n),value:t}})),[{value:y}]);sRe(d,w,x,k);delete d[p]}else if(_===null){var A={signal:b.map((function(e){var t=e.value,n=e.test;return oRe(null,n)+" ? "+Nwe(t)+" : "})).join("")+Nwe(y)};d[p]=A}}}if(t==="grid"){if(!d.grid){return undefined}if(d.encode){var E=d.encode.grid;d.encode=Object.assign({},E?{grid:E}:{});if(Cke(d.encode).length===0){delete d.encode}}return Object.assign(Object.assign({scale:s,orient:u},d),{domain:false,labels:false,maxExtent:0,minExtent:0,ticks:false,zindex:Hke(c,0)})}else{if(!r.header&&e.mainExtracted){return undefined}if(l!==undefined){var M=l;if(((a=(i=d.encode)===null||i===void 0?void 0:i.labels)===null||a===void 0?void 0:a.update)&&iNe(d.encode.labels.update.text)){M=Uke(l,"datum.label",d.encode.labels.update.text.signal)}sRe(d,"labels","text",{signal:M})}if(d.encode){for(var O=0,S=Kke;O<S.length;O++){var w=S[O];if(!e.hasAxisPart(w)){delete d.encode[w]}}if(Cke(d.encode).length===0){delete d.encode}}var D=uRe(f,n);return Object.assign(Object.assign(Object.assign({scale:s,orient:u,grid:false},D?{title:D}:{}),d),{zindex:Hke(c,0)})}}function fRe(e){var t=e.component.axes;for(var n=0,r=WEe;n<r.length;n++){var i=r[n];if(t[i]){for(var a=0,o=t[i];a<o.length;a++){var u=o[a];if(!u.get("gridScale")){var s=i==="x"?"height":"width";return[{name:s,update:e.getSizeSignalRef(s).signal}]}}}}return[]}function cRe(e,t){var n=e.x,r=n===void 0?[]:n,i=e.y,a=i===void 0?[]:i;return __spreadArrays(r.map((function(e){return lRe(e,"grid",t)})),a.map((function(e){return lRe(e,"grid",t)})),r.map((function(e){return lRe(e,"main",t)})),a.map((function(e){return lRe(e,"main",t)}))).filter((function(e){return e}))}var hRe={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"};var dRe={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelLimit:"limit",labelOrient:"orient",labelPadding:"offset"};var pRe=Cke(hRe);var vRe=Cke(dRe);function gRe(e,t,n,r,i){var a;var o=__spreadArrays(i==="band"?["axisBand"]:[],[n==="x"?"axisX":"axisY"],r?["axis"+r.substr(0,1).toUpperCase()+r.substr(1)]:[],["axis"]);for(var u=0,s=o;u<s.length;u++){var l=s[u];if(((a=t[l])===null||a===void 0?void 0:a[e])!==undefined){return t[l][e]}}return undefined}function mRe(e,t){return!GSe(e)&&!OCe(t.bin)}function yRe(e,t){var n=t==="x"?"y":"x";if(e.getScaleComponent(n)){return e.scaleName(n)}return undefined}function bRe(e,t,n,r){if(t.labelAngle!==undefined){return Xke(t.labelAngle)}else{var i=gRe("labelAngle",e.config,n,ARe(n),e.getScaleComponent(n).get("type"));if(i!==undefined){return Xke(i)}else{if(n===ZAe&&_ke([SSe,MSe],r.type)){return 270}return undefined}}}function _Re(e,t){if(e!==undefined){e=Xke(e);if(t==="top"||t==="bottom"){if(e<=45||315<=e){return t==="top"?"bottom":"top"}else if(135<=e&&e<=225){return t==="top"?"top":"bottom"}else{return"middle"}}else{if(e<=45||315<=e||135<=e&&e<=225){return"middle"}else if(45<=e&&e<=135){return t==="left"?"top":"bottom"}else{return t==="left"?"bottom":"top"}}}return undefined}function xRe(e,t){if(e!==undefined){e=Xke(e);if(t==="top"||t==="bottom"){if(e%180===0){return"center"}else if(0<e&&e<180){return t==="top"?"right":"left"}else{return t==="top"?"left":"right"}}else{if((e+90)%180===0){return"center"}else if(90<=e&&e<270){return t==="left"?"left":"right"}else{return t==="left"?"right":"left"}}}return undefined}function wRe(e,t){if(t==="x"&&_ke(["quantitative","temporal"],e.type)){return true}return undefined}function kRe(e,t){if(e.type!=="nominal"){if(t==="log"){return"greedy"}return true}return undefined}function ARe(e){switch(e){case ZAe:return"bottom";case QAe:return"left"}throw new Error(kOe.INVALID_CHANNEL_FOR_AXIS)}function ERe(e){var t=e.fieldDef,n=e.scaleType,r=e.size;var i;if(!GSe(n)&&n!=="log"&&!_ke(["month","hours","day","quarter"],(i=oSe(t.timeUnit))===null||i===void 0?void 0:i.unit)){if(OCe(t.bin)){return{signal:"ceil("+r.signal+"/10)"}}return{signal:"ceil("+r.signal+"/40)"}}return undefined}function MRe(e,t,n){var r=e.values;if(r){return ACe(n,r)}return undefined}function ORe(e,t){if(e==="rect"&&eCe(t)){return 1}return 0}var SRe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;r._dependentFields=eRe(r.transform.calculate);return r}t.prototype.clone=function(){return new t(null,pke(this.transform))};t.parseAllForSortIndex=function(e,n){n.forEachFieldDef((function(n,r){if(!VDe(n)){return}if(FDe(n.sort)){var i=n.field,a=n.timeUnit;var o=n.sort;var u=o.map((function(e,t){return xSe({field:i,timeUnit:a,equal:e})+" ? "+t+" : "})).join("")+o.length;e=new t(e,{calculate:u,as:DRe(n,r,{forAs:true})})}}));return e};t.prototype.producedFields=function(){return new Set([this.transform.as])};t.prototype.dependentFields=function(){return this._dependentFields};t.prototype.assemble=function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}};t.prototype.hash=function(){return"Calculate "+yke(this.transform)};return t}(tje);function DRe(e,t,n){return KDe(e,Object.assign({prefix:t,suffix:"sort_index"},n!==null&&n!==void 0?n:{}))}function CRe(e,t){if(_ke(["top","bottom"],t)){return"column"}else if(_ke(["left","right"],t)){return"row"}return e==="row"?"row":"column"}function FRe(e,t,n,r){var i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return Hke(t&&t.header?t.header[e]:undefined,i[e],n.header[e])}function TRe(e,t,n,r){var i={};for(var a=0,o=e;a<o.length;a++){var u=o[a];var s=FRe(u,t,n,r);if(s!==undefined){i[u]=s}}return i}var NRe=["row","column"];var jRe=["header","footer"];function RRe(e,t){var n=e.component.layoutHeaders[t].title;var r=e.config?e.config:undefined;var i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:undefined;var a=TRe(["titleAnchor","titleAngle","titleOrient"],i,r,t),o=a.titleAnchor,u=a.titleAngle,s=a.titleOrient;var l=CRe(t,s);return{name:t+"-title",type:"group",role:l+"-title",title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),PRe(u,l)),zRe(l,u,o)),GRe(r,i,t,pRe,hRe))}}function zRe(e,t,n){if(n===void 0){n="middle"}switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}var r=xRe(t,e==="row"?"left":"top");return r?{align:r}:{}}function PRe(e,t){var n=_Re(e,t==="row"?"left":"top");return n?{baseline:n}:{}}function LRe(e,t){var n=e.component.layoutHeaders[t];var r=[];for(var i=0,a=jRe;i<a.length;i++){var o=a[i];if(n[o]){for(var u=0,s=n[o];u<s.length;u++){var l=s[u];r.push(URe(e,t,o,n,l))}}}return r}function IRe(e,t){var n;var r=e.sort;if(CDe(r)){return{field:KDe(r,{expr:"datum"}),order:(n=r.order,n!==null&&n!==void 0?n:"ascending")}}else if(Cwe(r)){return{field:DRe(e,t,{expr:"datum"}),order:"ascending"}}else{return{field:KDe(e,{expr:"datum"}),order:r!==null&&r!==void 0?r:"ascending"}}}function BRe(e,t,n){var r=TRe(["format","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),i=r.format,a=r.labelAngle,o=r.labelAnchor,u=r.labelOrient,s=r.labelExpr;var l=gDe(e,i,"parent",n).signal;var f=CRe(t,u);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:s?Uke(Uke(s,"datum.label",l),"datum.value",KDe(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),PRe(a,f)),zRe(f,a,o)),GRe(n,e,t,vRe,dRe))}function URe(e,t,n,r,i){var a;var o;if(i){var u=null;var s=r.facetFieldDef;var l=e.config?e.config:undefined;if(s&&i.labels){var f=TRe(["labelOrient"],s,l,t).labelOrient;if(t==="row"&&!_ke(["top","bottom"],f)||t==="column"&&!_ke(["left","right"],f)){u=BRe(s,t,l)}}var c=YLe(e)&&!TDe(e.facet);var h=i.axes;var d=((o=h)===null||o===void 0?void 0:o.length)>0;if(u||d){var p=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(t+"_"+n),type:"group",role:t+"-"+n},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:IRe(s,t)}:{}),d&&c?{from:{data:e.getName("facet_domain_"+t)}}:{}),u?{title:u}:{}),i.sizeSignal?{encode:{update:(a={},a[p]=i.sizeSignal,a)}}:{}),d?{axes:h}:{})}}return null}var qRe={column:{start:0,end:1},row:{start:1,end:0}};function WRe(e,t){return qRe[t][e]}function HRe(e,t){var n;var r={};for(var i=0,a=DEe;i<a.length;i++){var o=a[i];var u=e[o];if((n=u)===null||n===void 0?void 0:n.facetFieldDef){var s=TRe(["titleAnchor","titleOrient"],u.facetFieldDef,t,o),l=s.titleAnchor,f=s.titleOrient;var c=CRe(o,f);var h=WRe(l,c);if(h!==undefined){r[c]=h}}}return Cke(r).length>0?r:undefined}function GRe(e,t,n,r,i){var a={};for(var o=0,u=r;o<u.length;o++){var s=u[o];if(!i[s]){continue}var l=FRe(s,t,e,n);if(l!==undefined){a[i[s]]=l}}return a}function $Re(e){return __spreadArrays(YRe(e,"width"),YRe(e,"height"))}function YRe(e,t){var n=t==="width"?"x":"y";var r=e.component.layoutSize.get(t);if(!r||r==="merged"){return[]}var i=e.getSizeSignalRef(t).signal;if(r==="step"){var a=e.getScaleComponent(n);if(a){var o=a.get("type");var u=a.get("range");if(GSe(o)&&aNe(u)){var s=e.scaleName(n);if(YLe(e.parent)){var l=e.parent.component.resolve;if(l.scale[n]==="independent"){return[VRe(s,u)]}}return[VRe(s,u),{name:i,update:XRe(s,a,"domain('"+s+"').length")}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){var f=i.endsWith("width");var c=f?"containerSize()[0]":"containerSize()[1]";var h=UFe(e.config.view,f?"width":"height");var d="isFinite("+c+") ? "+c+" : "+h;return[{name:i,init:d,on:[{update:d,events:"window:resize"}]}]}else{return[{name:i,value:r}]}}function VRe(e,t){return{name:e+"_step",value:t.step}}function XRe(e,t,n){var r=t.get("type");var i=t.get("padding");var a=Hke(t.get("paddingOuter"),i);var o=t.get("paddingInner");o=r==="band"?o!==undefined?o:i:1;return"bandspace("+n+", "+o+", "+a+") * "+e+"_step"}function JRe(e,t){return Cke(e).reduce((function(n,r){var i=e[r];return Object.assign(Object.assign({},n),hNe(t,i,r,(function(e){return{value:e.value}})))}),{})}function ZRe(e,t){if(JLe(t)||YLe(t)){return"shared"}else if(XLe(t)||VLe(t)){return _ke(WEe,e)?"independent":"shared"}throw new Error("invalid model type for resolve")}function QRe(e,t){var n=e.scale[t];var r=_ke(WEe,t)?"axis":"legend";if(n==="independent"){if(e[r][t]==="shared"){SOe(kOe.independentScaleMeansIndependentGuide(t))}return"independent"}return e[r][t]||"shared"}var KRe=function(){function e(e,t){if(e===void 0){e={}}if(t===void 0){t={}}this.explicit=e;this.implicit=t}e.prototype.clone=function(){return new e(pke(this.explicit),pke(this.implicit))};e.prototype.combine=function(){return Object.assign(Object.assign({},this.explicit),this.implicit)};e.prototype.get=function(e){return Hke(this.explicit[e],this.implicit[e])};e.prototype.getWithExplicit=function(e){if(this.explicit[e]!==undefined){return{explicit:true,value:this.explicit[e]}}else if(this.implicit[e]!==undefined){return{explicit:false,value:this.implicit[e]}}return{explicit:false,value:undefined}};e.prototype.setWithExplicit=function(e,t){if(t.value!==undefined){this.set(e,t.value,t.explicit)}};e.prototype.set=function(e,t,n){delete this[n?"implicit":"explicit"][e];this[n?"explicit":"implicit"][e]=t;return this};e.prototype.copyKeyFromSplit=function(e,t){if(t.explicit[e]!==undefined){this.set(e,t.explicit[e],true)}else if(t.implicit[e]!==undefined){this.set(e,t.implicit[e],false)}};e.prototype.copyKeyFromObject=function(e,t){if(t[e]!==undefined){this.set(e,t[e],true)}};e.prototype.copyAll=function(e){for(var t=0,n=Cke(e.combine());t<n.length;t++){var r=n[t];var i=e.getWithExplicit(r);this.setWithExplicit(r,i)}};return e}();function eze(e){return{explicit:true,value:e}}function tze(e){return{explicit:false,value:e}}function nze(e){return function(t,n,r,i){var a=e(t.value,n.value);if(a>0){return t}else if(a<0){return n}return rze(t,n,r,i)}}function rze(e,t,n,r){if(e.explicit&&t.explicit){SOe(kOe.mergeConflictingProperty(n,r,e.value,t.value))}return e}function ize(e,t,n,r,i){if(i===void 0){i=rze}if(e===undefined||e.value===undefined){return t}if(e.explicit&&!t.explicit){return e}else if(t.explicit&&!e.explicit){return t}else if(dke(e.value,t.value)){return e}else{return i(e,t,n,r)}}var aze=Object.assign(Object.assign({},EFe),{labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1});var oze=Cke(aze);var uze=function(e){p(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(KRe);function sze(e,t){var n=e.values;if(n){return ACe(t,n)}return undefined}function lze(e,t,n,r){var i;if(t!=="shape"){var a=(i=kze(n),i!==null&&i!==void 0?i:r);if(a){return a}}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function fze(e){var t=e.legend;return Hke(t.type,cze(e))}function cze(e){var t=e.channel,n=e.timeUnit,r=e.scaleType,i=e.alwaysReturn;if(OEe(t)){if(_ke(["quarter","month","day"],n)){return"symbol"}if(YSe(r)){return i?"gradient":undefined}}return i?"symbol":undefined}function hze(e){var t=e.legend,n=e.legendConfig,r=e.timeUnit,i=e.channel,a=e.scaleType;var o=Hke(t.orient,n.orient,"right");var u=fze({legend:t,channel:i,timeUnit:r,scaleType:a,alwaysReturn:true});return Hke(t.direction,n[u?"gradientDirection":"symbolDirection"],dze(o,u))}function dze(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case undefined:return undefined;default:return t==="gradient"?"horizontal":undefined}}function pze(e){var t=e.legend,n=e.legendConfig,r=e.model,i=e.channel,a=e.scaleType;var o=n.gradientHorizontalMaxLength,u=n.gradientHorizontalMinLength,s=n.gradientVerticalMaxLength,l=n.gradientVerticalMinLength;var f=hze({legend:t,legendConfig:n,channel:i,scaleType:a});if(f==="horizontal"){var c=Hke(t.orient,n.orient);if(c==="top"||c==="bottom"){return vze(r,"width",u,o)}else{return u}}else{return vze(r,"height",l,s)}}function vze(e,t,n,r){var i=e.getSizeSignalRef(t).signal;return{signal:"clamp("+i+", "+n+", "+r+")"}}function gze(e){if(_ke(["quantile","threshold","log"],e)){return"greedy"}return undefined}function mze(e,t,n){var r=t.getScaleComponent(n).get("type");return Hke(e.get("type"),cze({channel:n,scaleType:r,alwaysReturn:true}))}function yze(e,t,n,r,i){var a,o,u,s,l;if(mze(i,n,r)!=="symbol"){return undefined}var f=Object.assign(Object.assign({},cDe({},n,EAe)),wNe(n));var c=n.markDef,h=n.encoding,d=n.config;var p=c.filled;var v=(a=wze(h.opacity),a!==null&&a!==void 0?a:c.opacity);var g=Eze(n,i,e);if(f.fill){if(r==="fill"||p&&r===aEe){delete f.fill}else{if(f.fill["field"]){if(i.get("symbolFillColor")){delete f.fill}else{f.fill={value:(o=d.legend.symbolBaseFillColor,o!==null&&o!==void 0?o:"black")};f.fillOpacity={value:v!==null&&v!==void 0?v:1}}}else if(Cwe(f.fill)){var m=(l=(s=kze((u=h.fill,u!==null&&u!==void 0?u:h.color)),s!==null&&s!==void 0?s:c.fill),l!==null&&l!==void 0?l:p&&c.color);if(m){f.fill={value:m}}}}}if(f.stroke){if(r==="stroke"||!p&&r===aEe){delete f.stroke}else{if(f.stroke["field"]){delete f.stroke}else if(Cwe(f.stroke)){var y=Hke(kze(h.stroke||h.color),c.stroke,p?c.color:undefined);if(y){f.stroke={value:y}}}}}if(r!==fEe){if(g){f.opacity=[{test:g,value:v!==null&&v!==void 0?v:1},{value:d.legend.unselectedOpacity}]}else if(v){f.opacity={value:v}}}f=Object.assign(Object.assign({},f),t);return Cke(f).length>0?f:undefined}function bze(e,t,n,r,i){if(mze(i,n,r)!=="gradient"){return undefined}var a={};var o=wze(n.encoding.opacity)||n.markDef.opacity;if(o){a.opacity={value:o}}a=Object.assign(Object.assign({},a),t);return Cke(a).length>0?a:undefined}function _ze(e,t,n,r,i){var a;var o=n.legend(r);var u=n.config;var s=Eze(n,i,e);var l={};if(xCe(e)){var f=n.getScaleComponent(r).get("type")===FSe.UTC;var c=xDe("datum.value",(a=oSe(e.timeUnit))===null||a===void 0?void 0:a.unit,o.format,u.timeFormat,f);t=Object.assign(Object.assign({},c?{text:{signal:c}}:{}),t)}if(s){t.opacity=[{test:s,value:1},{value:u.legend.unselectedOpacity}]}l=Object.assign(Object.assign({},l),t);return Cke(l).length>0?l:undefined}function xze(e,t,n,r,i){var a;var o=i.get("selections");return((a=o)===null||a===void 0?void 0:a.length)?{fill:{value:"transparent"}}:undefined}function wze(e){return Aze(e,(function(e,t){return Math.max(e,t.value)}))}function kze(e){return Aze(e,(function(e,t){return Hke(e,t.value)}))}function Aze(e,t){if(WDe(e)){return Qwe(e.condition).reduce(t,e.value)}else if(YDe(e)){return e.value}return undefined}function Eze(e,t,n){var r;var i=t.get("selections");if(!((r=i)===null||r===void 0?void 0:r.length))return undefined;var a=Nwe(n.field);return i.map((function(e){var t=Nwe(Nke(e)+Wje);return"(!length(data("+t+")) || ("+e+"["+a+"] && indexof("+e+"["+a+"], datum.value) >= 0))"})).join(" || ")}var Mze=Object.freeze({__proto__:null,symbols:yze,gradient:bze,labels:_ze,entries:xze,getFirstConditionValue:kze});function Oze(e){if($Le(e)){e.component.legends=Sze(e)}else{e.component.legends=Nze(e)}}function Sze(e){var t=e.encoding;return[aEe,oEe,uEe,dEe,lEe,sEe,fEe,cEe,hEe].reduce((function(n,r){var i=t[r];if(e.legend(r)&&e.getScaleComponent(r)&&!(HDe(i)&&r===sEe&&i.type===DSe)){n[r]=Fze(e,r)}return n}),{})}function Dze(e,t){var n;var r=e.scaleName(aEe);if(t==="color"){return e.markDef.filled?{fill:r}:{stroke:r}}return n={},n[t]=e.scaleName(t),n}function Cze(e,t,n,r){switch(t){case"values":return!!n.values;case"title":if(t==="title"&&e===r.title){return true}}return e===n[t]}function Fze(e,t){var n;var r=e.fieldDef(t);var i=e.legend(t);var a=new uze({},Dze(e,t));vje(e,t,a);for(var o=0,u=oze;o<u.length;o++){var s=u[o];var l=Tze(s,i,t,e);if(l!==undefined){var f=Cze(l,s,i,r);if(f||e.config.legend[s]===undefined){a.set(s,l,f)}}}var c=(n=i.encoding,n!==null&&n!==void 0?n:{});var h=a.get("selections");var d=["labels","legend","title","symbols","gradient","entries"].reduce((function(n,i){var o,u,s;var l=JRe((o=c[i],o!==null&&o!==void 0?o:{}),e);var f=Mze[i]?Mze[i](r,l,e,t,a):l;if(f!==undefined&&Cke(f).length>0){n[i]=Object.assign(Object.assign(Object.assign({},((u=h)===null||u===void 0?void 0:u.length)?{name:Nke(r.field)+"_legend_"+i}:{}),((s=h)===null||s===void 0?void 0:s.length)?{interactive:!!h}:{}),{update:f})}return n}),{});if(Cke(d).length>0){a.set("encode",d,!!i.encoding)}return a}function Tze(e,t,n,r){var i;var a=r.encoding,o=r.mark;var u=vCe(a[n]);var s=r.config.legend;var l=(i=oSe(u.timeUnit))===null||i===void 0?void 0:i.unit;var f=r.getScaleComponent(n).get("type");switch(e){case"direction":return hze({legend:t,legendConfig:s,timeUnit:l,channel:n,scaleType:f});case"format":if(xCe(u)){return undefined}return mDe(u,t.format,r.config);case"formatType":if(xCe(u)){return undefined}return t.formatType;case"gradientLength":return Hke(t.gradientLength,s.gradientLength,pze({model:r,legend:t,legendConfig:s,channel:n,scaleType:f}));case"labelOverlap":return Hke(t.labelOverlap,gze(f));case"symbolType":return Hke(t.symbolType,lze(o,n,a.shape,r.markDef.shape));case"title":return lCe(u,r.config,{allowDisabling:true})||undefined;case"type":return fze({legend:t,channel:n,timeUnit:l,scaleType:f,alwaysReturn:false});case"values":return sze(t,u)}return t[e]}function Nze(e){var t=e.component,n=t.legends,r=t.resolve;var i=function(t){Oze(t);Cke(t.component.legends).forEach((function(i){r.legend[i]=QRe(e.component.resolve,i);if(r.legend[i]==="shared"){n[i]=jze(n[i],t.component.legends[i]);if(!n[i]){r.legend[i]="independent";delete n[i]}}}))};for(var a=0,o=e.children;a<o.length;a++){var u=o[a];i(u)}Cke(n).forEach((function(t){for(var n=0,i=e.children;n<i.length;n++){var a=i[n];if(!a.component.legends[t]){continue}if(r.legend[t]==="shared"){delete a.component.legends[t]}}}));return n}function jze(e,t){var n,r,i,a,o,u;if(!e){return t.clone()}var s=e.getWithExplicit("orient");var l=t.getWithExplicit("orient");if(s.explicit&&l.explicit&&s.value!==l.value){return undefined}var f=false;var c=function(n){var r=ize(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",(function(e,t){switch(n){case"symbolType":return Rze(e,t);case"title":return EDe(e,t);case"type":f=true;return tze("symbol")}return rze(e,t,n,"legend")}));e.setWithExplicit(n,r)};for(var h=0,d=oze;h<d.length;h++){var p=d[h];c(p)}if(f){if(i=(r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0?void 0:r.gradient,i!==null&&i!==void 0?i:{}){Rke(e.implicit,["encode","gradient"])}if(u=(o=(a=e.explicit)===null||a===void 0?void 0:a.encode)===null||o===void 0?void 0:o.gradient,u!==null&&u!==void 0?u:{}){Rke(e.explicit,["encode","gradient"])}}return e}function Rze(e,t){if(t.value==="circle"){return t}return e}function zze(e,t,n,r){var i,a,o;e.encode=(i=e.encode,i!==null&&i!==void 0?i:{});e.encode[t]=(a=e.encode[t],a!==null&&a!==void 0?a:{});e.encode[t].update=(o=e.encode[t].update,o!==null&&o!==void 0?o:{});e.encode[t].update[n]=r}function Pze(e){var t=e.component.legends;var n={};for(var r=0,i=Cke(t);r<i.length;r++){var a=i[r];var o=e.getScaleComponent(a);var u=mke(o.get("domains"));if(n[u]){for(var s=0,l=n[u];s<l.length;s++){var f=l[s];var c=jze(f,t[a]);if(!c){n[u].push(t[a])}}}else{n[u]=[t[a].clone()]}}return Fke(n).flat().map((function(e){var t,n,r,i;var a=e.combine(),o=a.labelExpr,u=a.selections,s=h(a,["labelExpr","selections"]);if((t=s.encode)===null||t===void 0?void 0:t.symbols){var l=s.encode.symbols.update;if(l.fill&&l.fill["value"]!=="transparent"&&!l.stroke&&!s.stroke){l.stroke={value:"transparent"}}if(s.fill){delete l.fill}}if(o!==undefined){var f=o;if(((i=(r=(n=s.encode)===null||n===void 0?void 0:n.labels)===null||r===void 0?void 0:r.update)===null||i===void 0?void 0:i.text)&&iNe(s.encode.labels.update.text)){f=Uke(o,"datum.label",s.encode.labels.update.text.signal)}zze(s,"labels","text",{signal:f})}return s}))}function Lze(e){if(JLe(e)||XLe(e)||VLe(e)){return Ize(e)}else{return Bze(e)}}function Ize(e){return e.children.reduce((function(e,t){return e.concat(t.assembleProjections())}),Bze(e))}function Bze(e){var t=e.component.projection;if(!t||t.merged){return[]}var n=t.combine();var r=n.name,i=h(n,["name"]);if(!t.data){return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),i)]}else{var a={signal:"["+t.size.map((function(e){return e.signal})).join(", ")+"]"};var o=t.data.reduce((function(t,n){var r=iNe(n)?n.signal:"data('"+e.lookupDataSource(n)+"')";if(!_ke(t,r)){t.push(r)}return t}),[]);if(o.length<=0){throw new Error("Projection's fit didn't find any data sources")}return[Object.assign({name:r,size:a,fit:{signal:o.length>1?"["+o.join(", ")+"]":o[0]}},i)]}}var Uze=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];var qze=function(e){p(t,e);function t(t,n,r,i){var a=e.call(this,Object.assign({},n),{name:t})||this;a.specifiedProjection=n;a.size=r;a.data=i;a.merged=false;return a}Object.defineProperty(t.prototype,"isFit",{get:function(){return!!this.data},enumerable:true,configurable:true});return t}(KRe);function Wze(e){e.component.projection=$Le(e)?Hze(e):Yze(e)}function Hze(e){var t;if(e.hasProjection){var n=e.specifiedProjection;var r=!(n&&(n.scale!=null||n.translate!=null));var i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:undefined;var a=r?Gze(e):undefined;return new qze(e.projectionName(true),Object.assign(Object.assign({},(t=e.config.projection,t!==null&&t!==void 0?t:{})),n!==null&&n!==void 0?n:{}),i,a)}return undefined}function Gze(e){var t=[];for(var n=0,r=[[nEe,tEe],[iEe,rEe]];n<r.length;n++){var i=r[n];if(e.channelHasField(i[0])||e.channelHasField(i[1])){t.push({signal:e.getName("geojson_"+t.length)})}}if(e.channelHasField(sEe)&&e.fieldDef(sEe).type===DSe){t.push({signal:e.getName("geojson_"+t.length)})}if(t.length===0){t.push(e.requestDataName(jTe))}return t}function $ze(e,t){var n=wke(Uze,(function(n){if(!tke(e.explicit,n)&&!tke(t.explicit,n)){return true}if(tke(e.explicit,n)&&tke(t.explicit,n)&&mke(e.get(n))===mke(t.get(n))){return true}return false}));var r=mke(e.size)===mke(t.size);if(r){if(n){return e}else if(mke(e.explicit)===mke({})){return t}else if(mke(t.explicit)===mke({})){return e}}return null}function Yze(e){if(e.children.length===0){return undefined}var t;e.children.forEach((function(e){return Wze(e)}));var n=wke(e.children,(function(e){var n=e.component.projection;if(!n){return true}else if(!t){t=n;return true}else{var r=$ze(t,n);if(r){t=r}return!!r}}));if(t&&n){var r=e.projectionName(true);var i=new qze(r,t.specifiedProjection,t.size,pke(t.data));e.children.forEach((function(e){var t;var n=e.component.projection;if(n){if(n.isFit){(t=i.data).push.apply(t,e.component.projection.data)}e.renameProjection(n.get("name"),r);n.merged=true}}));return i}return undefined}function Vze(e,t,n,r){var i,a;if(ECe(t,n)){var o=$Le(e)?(a=(i=e.axis(n),i!==null&&i!==void 0?i:e.legend(n)),a!==null&&a!==void 0?a:{}):{};var u=KDe(t,{expr:"datum"});var s=KDe(t,{expr:"datum",binSuffix:"end"});return{formulaAs:KDe(t,{binSuffix:"range",forAs:true}),formula:_De(u,s,o.format,r)}}return{}}function Xze(e,t){return MCe(e)+"_"+t}function Jze(e,t){return{signal:e.getName(t+"_bins"),extentSignal:e.getName(t+"_extent")}}function Zze(e,t,n){var r;var i=(r=yCe(n,undefined),r!==null&&r!==void 0?r:{});var a=Xze(i,t);return e.getName(a+"_bins")}function Qze(e){return"as"in e}function Kze(e,t,n){var r;var i;if(Qze(e)){r=Twe(e.as)?[e.as,e.as+"_end"]:[e.as[0],e.as[1]]}else{r=[KDe(e,{forAs:true}),KDe(e,{binSuffix:"end",forAs:true})]}var a=Object.assign({},yCe(t,undefined));var o=Xze(a,e.field);var u=Jze(n,o),s=u.signal,l=u.extentSignal;if(CCe(a.extent)){var f=a.extent;var c=f.selection;i=iRe(n.getSelectionComponent(Nke(c),c),f);delete a.extent}var h=Object.assign(Object.assign(Object.assign({bin:a,field:e.field,as:[r]},s?{signal:s}:{}),l?{extentSignal:l}:{}),i?{span:i}:{});return{key:o,binComponent:h}}var ePe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.bins=n;return r}t.prototype.clone=function(){return new t(null,pke(this.bins))};t.makeFromEncoding=function(e,n){var r=n.reduceFieldDef((function(e,t,r){if(GDe(t)&&OCe(t.bin)){var i=Kze(t,t.bin,n),a=i.key,o=i.binComponent;e[a]=Object.assign(Object.assign(Object.assign({},o),e[a]),Vze(n,t,r,n.config))}return e}),{});if(Cke(r).length===0){return null}return new t(e,r)};t.makeFromTransform=function(e,n,r){var i;var a=Kze(n,n.bin,r),o=a.key,u=a.binComponent;return new t(e,(i={},i[o]=u,i))};t.prototype.merge=function(e,t){for(var n=0,r=Cke(e.bins);n<r.length;n++){var i=r[n];if(i in this.bins){t(e.bins[i].signal,this.bins[i].signal);this.bins[i].as=Eke(__spreadArrays(this.bins[i].as,e.bins[i].as),yke)}else{this.bins[i]=e.bins[i]}}for(var a=0,o=e.children;a<o.length;a++){var u=o[a];e.removeChild(u);u.parent=this}e.remove()};t.prototype.producedFields=function(){return new Set(Fke(this.bins).map((function(e){return e.as})).flat(2))};t.prototype.dependentFields=function(){return new Set(Fke(this.bins).map((function(e){return e.field})))};t.prototype.hash=function(){return"Bin "+yke(this.bins)};t.prototype.assemble=function(){return Fke(this.bins).flatMap((function(e){var t=[];var n=e.as,r=n[0],i=n.slice(1);var a=e.bin,o=a.extent,u=h(a,["extent"]);var s=Object.assign(Object.assign(Object.assign({type:"bin",field:Bke(e.field),as:r,signal:e.signal},!CCe(o)?{extent:o}:{extent:null}),e.span?{span:{signal:"span("+e.span+")"}}:{}),u);if(!o&&e.extentSignal){t.push({type:"extent",field:Bke(e.field),signal:e.extentSignal});s.extent={signal:e.extentSignal}}t.push(s);for(var l=0,f=i;l<f.length;l++){var c=f[l];for(var d=0;d<2;d++){t.push({type:"formula",expr:KDe({field:r[d]},{expr:"datum"}),as:c[d]})}}if(e.formula){t.push({type:"formula",expr:e.formula,as:e.formulaAs})}return t}))};return t}(tje);var tPe=function(e){p(t,e);function t(t){var n=e.call(this,null)||this;t=t!==null&&t!==void 0?t:{name:"source"};var r;if(!CTe(t)){r=t.format?Object.assign({},gke(t.format,["parse"])):{}}if(STe(t)){n._data={values:t.values}}else if(OTe(t)){n._data={url:t.url};if(!r.type){var i=/(?:\.([^.]+))?$/.exec(t.url)[1];if(!_ke(["json","csv","tsv","dsv","topojson"],i)){i="json"}r.type=i}}else if(TTe(t)){n._data={values:[{type:"Sphere"}]}}else if(DTe(t)||CTe(t)){n._data={}}n._generator=CTe(t);if(t.name){n._name=t.name}if(r&&Cke(r).length>0){n._data.format=r}return n}t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return undefined};Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});t.prototype.hasName=function(){return!!this._name};Object.defineProperty(t.prototype,"isGenerator",{get:function(){return this._generator},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"dataName",{get:function(){return this._name},set:function(e){this._name=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"parent",{set:function(e){throw new Error("Source nodes have to be roots.")},enumerable:true,configurable:true});t.prototype.remove=function(){throw new Error("Source nodes are roots and cannot be removed.")};t.prototype.hash=function(){throw new Error("Cannot hash sources")};t.prototype.assemble=function(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})};return t}(tje);function nPe(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];for(var i=0,a=r.children;i<a.length;i++){var o=a[i];if(o.parent!==r){console.error("Dataflow graph is inconsistent.",r,o);return false}}if(!nPe(r.children)){return false}}return true}var rPe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.params=n;return r}t.prototype.clone=function(){return new t(null,this.params)};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return undefined};t.prototype.hash=function(){return"Graticule "+yke(this.params)};t.prototype.assemble=function(){return Object.assign({type:"graticule"},this.params===true?{}:this.params)};return t}(tje);var iPe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.params=n;return r}t.prototype.clone=function(){return new t(null,this.params)};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){var e;return new Set([(e=this.params.as,e!==null&&e!==void 0?e:"data")])};t.prototype.hash=function(){return"Hash "+yke(this.params)};t.prototype.assemble=function(){return Object.assign({type:"sequence"},this.params)};return t}(tje);function aPe(e){return e instanceof tPe||e instanceof rPe||e instanceof iPe}var oPe=function(){function e(){this._mutated=false}e.prototype.setMutated=function(){this._mutated=true};Object.defineProperty(e.prototype,"mutatedFlag",{get:function(){return this._mutated},enumerable:true,configurable:true});return e}();var uPe=function(e){p(t,e);function t(){var t=e.call(this)||this;t._continue=false;return t}t.prototype.setContinue=function(){this._continue=true};Object.defineProperty(t.prototype,"continueFlag",{get:function(){return this._continue},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"flags",{get:function(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}},set:function(e){var t=e.continueFlag,n=e.mutatedFlag;if(t){this.setContinue()}if(n){this.setMutated()}},enumerable:true,configurable:true});t.prototype.reset=function(){};t.prototype.optimizeNextFromLeaves=function(e){if(aPe(e)){return false}var t=e.parent;var n=this.run(e).continueFlag;if(n){this.optimizeNextFromLeaves(t)}return this.mutatedFlag};return t}(oPe);var sPe=function(e){p(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(oPe);function lPe(e,t,n,r){var i=$Le(r)?r.encoding[IEe(t)]:undefined;if(GDe(n)&&$Le(r)&&BDe(t,n,i,r.markDef,r.config)){e.add(KDe(n,{}));e.add(KDe(n,{suffix:"end"}));if(ECe(n,t)){e.add(KDe(n,{binSuffix:"range"}))}}else if(AEe(t)){var a=wEe(t);e.add(r.getName(a))}else{e.add(KDe(n))}return e}function fPe(e,t){var n;var r;for(var i=0,a=Cke(t);i<a.length;i++){var o=a[i];var u=t[o];for(var s=0,l=Cke(u);s<l.length;s++){var f=l[s];if(o in e){e[o][f]=new Set(__spreadArrays((r=e[o][f],r!==null&&r!==void 0?r:[]),u[f]))}else{e[o]=(n={},n[f]=u[f],n)}}}}var cPe=function(e){p(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.dimensions=n;i.measures=r;return i}t.prototype.clone=function(){return new t(null,new Set(this.dimensions),pke(this.measures))};Object.defineProperty(t.prototype,"groupBy",{get:function(){return this.dimensions},enumerable:true,configurable:true});t.makeFromEncoding=function(e,n){var r=false;n.forEachFieldDef((function(e){if(e.aggregate){r=true}}));var i={};var a=new Set;if(!r){return null}n.forEachFieldDef((function(e,t){var r,o,u,s;var l=e.aggregate,f=e.field;if(l){if(l==="count"){i["*"]=(r=i["*"],r!==null&&r!==void 0?r:{});i["*"]["count"]=new Set([KDe(e,{forAs:true})])}else{if(IAe(l)||BAe(l)){var c=IAe(l)?"argmin":"argmax";var h=l[c];i[h]=(o=i[h],o!==null&&o!==void 0?o:{});i[h][c]=new Set([KDe({op:c,field:h},{forAs:true})])}else{i[f]=(u=i[f],u!==null&&u!==void 0?u:{});i[f][l]=new Set([KDe(e,{forAs:true})])}if(QEe(t)&&n.scaleDomain(t)==="unaggregated"){i[f]=(s=i[f],s!==null&&s!==void 0?s:{});i[f]["min"]=new Set([KDe({field:f,aggregate:"min"},{forAs:true})]);i[f]["max"]=new Set([KDe({field:f,aggregate:"max"},{forAs:true})])}}}else{lPe(a,t,e,n)}}));if(a.size+Cke(i).length===0){return null}return new t(e,a,i)};t.makeFromTransform=function(e,n){var r,i,a;var o=new Set;var u={};for(var s=0,l=n.aggregate;s<l.length;s++){var f=l[s];var c=f.op,h=f.field,d=f.as;if(c){if(c==="count"){u["*"]=(r=u["*"],r!==null&&r!==void 0?r:{});u["*"]["count"]=new Set([d?d:KDe(f,{forAs:true})])}else{u[h]=(i=u[h],i!==null&&i!==void 0?i:{});u[h][c]=new Set([d?d:KDe(f,{forAs:true})])}}}for(var p=0,v=(a=n.groupby,a!==null&&a!==void 0?a:[]);p<v.length;p++){var f=v[p];o.add(f)}if(o.size+Cke(u).length===0){return null}return new t(e,o,u)};t.prototype.merge=function(e){if(Mke(this.dimensions,e.dimensions)){fPe(this.measures,e.measures);return true}else{DOe("different dimensions, cannot merge");return false}};t.prototype.addDimensions=function(e){e.forEach(this.dimensions.add,this.dimensions)};t.prototype.dependentFields=function(){return new Set(__spreadArrays(this.dimensions,Cke(this.measures)))};t.prototype.producedFields=function(){var e=new Set;for(var t=0,n=Cke(this.measures);t<n.length;t++){var r=n[t];for(var i=0,a=Cke(this.measures[r]);i<a.length;i++){var o=a[i];var u=this.measures[r][o];if(u.size===0){e.add(o+"_"+r)}else{u.forEach(e.add,e)}}}return e};t.prototype.hash=function(){return"Aggregate "+yke({dimensions:this.dimensions,measures:this.measures})};t.prototype.assemble=function(){var e=[];var t=[];var n=[];for(var r=0,i=Cke(this.measures);r<i.length;r++){var a=i[r];for(var o=0,u=Cke(this.measures[a]);o<u.length;o++){var s=u[o];for(var l=0,f=this.measures[a][s];l<f.length;l++){var c=f[l];n.push(c);e.push(s);t.push(a==="*"?null:Bke(a))}}}var h={type:"aggregate",groupby:__spreadArrays(this.dimensions),ops:e,fields:t,as:n};return h};return t}(tje);var hPe=function(e){p(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.model=n;a.name=r;a.data=i;for(var o=0,u=DEe;o<u.length;o++){var s=u[o];var l=n.facet[s];if(l){var f=l.bin,c=l.sort;a[s]=Object.assign({name:n.getName(s+"_domain"),fields:__spreadArrays([KDe(l)],OCe(f)?[KDe(l,{binSuffix:"end"})]:[])},CDe(c)?{sortField:c}:Cwe(c)?{sortIndexField:DRe(l,s)}:{})}}a.childModel=n.child;return a}t.prototype.hash=function(){var e="Facet";for(var t=0,n=DEe;t<n.length;t++){var r=n[t];if(this[r]){e+=" "+r.charAt(0)+":"+yke(this[r])}}return e};Object.defineProperty(t.prototype,"fields",{get:function(){var e;var t=[];for(var n=0,r=DEe;n<r.length;n++){var i=r[n];if((e=this[i])===null||e===void 0?void 0:e.fields){t.push.apply(t,this[i].fields)}}return t},enumerable:true,configurable:true});t.prototype.dependentFields=function(){var e=new Set(this.fields);for(var t=0,n=DEe;t<n.length;t++){var r=n[t];if(this[r]){if(this[r].sortField){e.add(this[r].sortField.field)}if(this[r].sortIndexField){e.add(this[r].sortIndexField)}}}return e};t.prototype.producedFields=function(){return new Set};t.prototype.getSource=function(){return this.name};t.prototype.getChildIndependentFieldsWithStep=function(){var e={};for(var t=0,n=["x","y"];t<n.length;t++){var r=n[t];var i=this.childModel.component.scales[r];if(i&&!i.merged){var a=i.get("type");var o=i.get("range");if(GSe(a)&&aNe(o)){var u=uLe(this.childModel,r);var s=oLe(u);if(s){e[r]=s}else{SOe("Unknown field for "+r+". Cannot calculate view size.")}}}}return e};t.prototype.assembleRowColumnHeaderData=function(e,t,n){var r={row:"y",column:"x"}[e];var i=[];var a=[];var o=[];if(n&&n[r]){if(t){i.push("distinct_"+n[r]);a.push("max")}else{i.push(n[r]);a.push("distinct")}o.push("distinct_"+n[r])}var u=this[e],s=u.sortField,l=u.sortIndexField;if(s){var f=s.op,c=f===void 0?MDe:f,h=s.field;i.push(h);a.push(c);o.push(KDe(s,{forAs:true}))}else if(l){i.push(l);a.push("max");o.push(l)}return{name:this[e].name,source:t!==null&&t!==void 0?t:this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},i.length?{fields:i,ops:a,as:o}:{})]}};t.prototype.assembleFacetHeaderData=function(e){var t,n;var r=this.model.layout.columns;var i=this.model.component.layoutHeaders;var a=[];var o={};for(var u=0,s=NRe;u<s.length;u++){var l=s[u];for(var f=0,c=jRe;f<c.length;f++){var h=c[f];var d=(t=i[l]&&i[l][h],t!==null&&t!==void 0?t:[]);for(var p=0,v=d;p<v.length;p++){var g=v[p];if(((n=g.axes)===null||n===void 0?void 0:n.length)>0){o[l]=true;break}}}if(o[l]){var m='length(data("'+this.facet.name+'"))';var y=l==="row"?r?{signal:"ceil("+m+" / "+r+")"}:1:r?{signal:"min("+m+", "+r+")"}:{signal:m};a.push({name:this.facet.name+"_"+l,transform:[{type:"sequence",start:0,stop:y}]})}}var b=o.row,_=o.column;if(b||_){a.unshift(this.assembleRowColumnHeaderData("facet",null,e))}return a};t.prototype.assemble=function(){var e,t;var n=[];var r=null;var i=this.getChildIndependentFieldsWithStep();var a=this,o=a.column,u=a.row,s=a.facet;if(o&&u&&(i.x||i.y)){r="cross_"+this.column.name+"_"+this.row.name;var l=[].concat((e=i.x,e!==null&&e!==void 0?e:[]),(t=i.y,t!==null&&t!==void 0?t:[]));var f=l.map((function(){return"distinct"}));n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:f}]})}for(var c=0,h=[XAe,VAe];c<h.length;c++){var d=h[c];if(this[d]){n.push(this.assembleRowColumnHeaderData(d,r,i))}}if(s){var p=this.assembleFacetHeaderData(i);if(p){n.push.apply(n,p)}}return n};return t}(tje);function dPe(e){if(e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'){return e.slice(1,-1)}return e}function pPe(e,t){var n=Lke(e);if(t==="number"){return"toNumber("+n+")"}else if(t==="boolean"){return"toBoolean("+n+")"}else if(t==="string"){return"toString("+n+")"}else if(t==="date"){return"toDate("+n+")"}else if(t==="flatten"){return n}else if(t.indexOf("date:")===0){var r=dPe(t.slice(5,t.length));return"timeParse("+n+",'"+r+"')"}else if(t.indexOf("utc:")===0){var r=dPe(t.slice(4,t.length));return"utcParse("+n+",'"+r+"')"}else{SOe(kOe.unrecognizedParse(t));return null}}function vPe(e){var t={};cke(e.filter,(function(e){var n;if(ySe(e)){var r=null;if(fSe(e)){r=e.equal}else if(vSe(e)){r=e.range[0]}else if(gSe(e)){r=(n=e.oneOf,n!==null&&n!==void 0?n:e["in"])[0]}if(r){if(FOe(r)){t[e.field]="date"}else if(rke(r)){t[e.field]="number"}else if(Twe(r)){t[e.field]="string"}}if(e.timeUnit){t[e.field]="date"}}}));return t}function gPe(e){var t={};function n(e){if(xCe(e)){t[e.field]="date"}else if(e.type==="quantitative"&&HAe(e.aggregate)){t[e.field]="number"}else if(Wke(e.field)>1){if(!(e.field in t)){t[e.field]="flatten"}}else if(VDe(e)&&CDe(e.sort)&&Wke(e.sort.field)>1){if(!(e.sort.field in t)){t[e.sort.field]="flatten"}}}if($Le(e)||YLe(e)){e.forEachFieldDef((function(t,r){if(GDe(t)){n(t)}else{var i=LEe(r);var a=e.fieldDef(i);n(Object.assign(Object.assign({},t),{type:a.type}))}}))}if($Le(e)){var r=e.mark,i=e.markDef,a=e.encoding;if(yAe(r)&&!e.encoding.order){var o=i.orient==="horizontal"?"y":"x";var u=a[o];if(HDe(u)&&u.type==="quantitative"&&!(u.field in t)){t[u.field]="number"}}}return t}function mPe(e){var t={};if($Le(e)&&e.component.selection){for(var n=0,r=Cke(e.component.selection);n<r.length;n++){var i=r[n];var a=e.component.selection[i];for(var o=0,u=a.project.items;o<u.length;o++){var s=u[o];if(!s.channel&&Wke(s.field)>1){t[s.field]="flatten"}}}}return t}var yPe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r._parse=n;return r}t.prototype.clone=function(){return new t(null,pke(this._parse))};t.prototype.hash=function(){return"Parse "+yke(this._parse)};t.makeExplicit=function(e,t,n){var r={};var i=t.data;if(!CTe(i)&&i&&i.format&&i.format.parse){r=i.format.parse}return this.makeWithAncestors(e,r,{},n)};t.makeWithAncestors=function(e,n,r,i){for(var a=0,o=Cke(r);a<o.length;a++){var u=o[a];var s=i.getWithExplicit(u);if(s.value!==undefined){if(s.explicit||s.value===r[u]||s.value==="derived"||r[u]==="flatten"){delete r[u]}else{SOe(kOe.differentParse(u,r[u],s.value))}}}for(var l=0,f=Cke(n);l<f.length;l++){var c=f[l];var s=i.get(c);if(s!==undefined){if(s===n[c]){delete n[c]}else{SOe(kOe.differentParse(c,n[c],s))}}}var h=new KRe(n,r);i.copyAll(h);var d={};for(var p=0,v=Cke(h.combine());p<v.length;p++){var g=v[p];var m=h.get(g);if(m!==null){d[g]=m}}if(Cke(d).length===0||i.parseNothing){return null}return new t(e,d)};Object.defineProperty(t.prototype,"parse",{get:function(){return this._parse},enumerable:true,configurable:true});t.prototype.merge=function(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse);e.remove()};t.prototype.assembleFormatParse=function(){var e={};for(var t=0,n=Cke(this._parse);t<n.length;t++){var r=n[t];var i=this._parse[r];if(Wke(r)===1){e[r]=i}}return e};t.prototype.producedFields=function(){return new Set(Cke(this._parse))};t.prototype.dependentFields=function(){return new Set(Cke(this._parse))};t.prototype.assembleTransforms=function(e){var t=this;if(e===void 0){e=false}return Cke(this._parse).filter((function(t){return e?Wke(t)>1:true})).map((function(e){var n=pPe(e,t._parse[e]);if(!n){return null}var r={type:"formula",expr:n,as:qke(e)};return r})).filter((function(e){return e!==null}))};return t}(tje);var bPe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,pke(this.transform))};t.prototype.addDimensions=function(e){this.transform.groupby=Eke(this.transform.groupby.concat(e),(function(e){return e}))};t.prototype.dependentFields=function(){var e=new Set;if(this.transform.groupby){this.transform.groupby.forEach((function(t){return e.add(t)}))}this.transform.joinaggregate.map((function(e){return e.field})).filter((function(e){return e!==undefined})).forEach((function(t){return e.add(t)}));return e};t.prototype.producedFields=function(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))};t.prototype.getDefaultName=function(e){var t;return t=e.as,t!==null&&t!==void 0?t:KDe(e)};t.prototype.hash=function(){return"JoinAggregateTransform "+yke(this.transform)};t.prototype.assemble=function(){var e=[];var t=[];var n=[];for(var r=0,i=this.transform.joinaggregate;r<i.length;r++){var a=i[r];t.push(a.op);n.push(this.getDefaultName(a));e.push(a.field===undefined?null:a.field)}var o=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:t,fields:e},o!==undefined?{groupby:o}:{})};return t}(tje);function _Pe(e){return e.stack.stackBy.reduce((function(e,t){var n=t.fieldDef;var r=KDe(n);if(r){e.push(r)}return e}),[])}function xPe(e){return Cwe(e)&&e.every((function(e){return Twe(e)}))&&e.length>1}var wPe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r._stack=n;return r}t.prototype.clone=function(){return new t(null,pke(this._stack))};t.makeFromTransform=function(e,n){var r=n.stack,i=n.groupby,a=n.as,o=n.offset,u=o===void 0?"zero":o;var s=[];var l=[];if(n.sort!==undefined){for(var f=0,c=n.sort;f<c.length;f++){var h=c[f];s.push(h.field);l.push(Hke(h.order,"ascending"))}}var d={field:s,order:l};var p;if(xPe(a)){p=a}else if(Twe(a)){p=[a,a+"_end"]}else{p=[n.stack+"_start",n.stack+"_end"]}return new t(e,{stackField:r,groupby:i,offset:u,sort:d,facetby:[],as:p})};t.makeFromEncoding=function(e,n){var r=n.stack;var i=n.encoding;if(!r){return null}var a;if(r.groupbyChannel){var o=i[r.groupbyChannel];a=vCe(o)}var u=_Pe(n);var s=n.encoding.order;var l;if(Cwe(s)||HDe(s)){l=wDe(s)}else{l=u.reduce((function(e,t){e.field.push(t);e.order.push("descending");return e}),{field:[],order:[]})}return new t(e,{dimensionFieldDef:a,stackField:n.vgField(r.fieldChannel),facetby:[],stackby:u,sort:l,offset:r.offset,impute:r.impute,as:[n.vgField(r.fieldChannel,{suffix:"start",forAs:true}),n.vgField(r.fieldChannel,{suffix:"end",forAs:true})]})};Object.defineProperty(t.prototype,"stack",{get:function(){return this._stack},enumerable:true,configurable:true});t.prototype.addDimensions=function(e){var t;(t=this._stack.facetby).push.apply(t,e)};t.prototype.dependentFields=function(){var e=new Set;e.add(this._stack.stackField);this.getGroupbyFields().forEach((function(t){return e.add(t)}));this._stack.facetby.forEach((function(t){return e.add(t)}));this._stack.sort.field.forEach((function(t){return e.add(t)}));return e};t.prototype.producedFields=function(){return new Set(this._stack.as)};t.prototype.hash=function(){return"Stack "+yke(this._stack)};t.prototype.getGroupbyFields=function(){var e=this._stack,t=e.dimensionFieldDef,n=e.impute,r=e.groupby;if(t){if(t.bin){if(n){return[KDe(t,{binSuffix:"mid"})]}return[KDe(t,{}),KDe(t,{binSuffix:"end"})]}return[KDe(t)]}return r!==null&&r!==void 0?r:[]};t.prototype.assemble=function(){var e=[];var t=this._stack,n=t.facetby,r=t.dimensionFieldDef,i=t.stackField,a=t.stackby,o=t.sort,u=t.offset,s=t.impute,l=t.as;if(s&&r){var f=r.band,c=f===void 0?.5:f,h=r.bin;if(h){e.push({type:"formula",expr:c+"*"+KDe(r,{expr:"datum"})+("+"+(1-c)+"*")+KDe(r,{expr:"datum",binSuffix:"end"}),as:KDe(r,{binSuffix:"mid",forAs:true})})}e.push({type:"impute",field:i,groupby:__spreadArrays(a,n),key:KDe(r,{binSuffix:"mid"}),method:"value",value:0})}e.push({type:"stack",groupby:__spreadArrays(this.getGroupbyFields(),n),field:i,sort:o,as:l,offset:u});return e};return t}(tje);var kPe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,pke(this.transform))};t.prototype.addDimensions=function(e){this.transform.groupby=Eke(this.transform.groupby.concat(e),(function(e){return e}))};t.prototype.dependentFields=function(){var e,t;var n=new Set;(e=this.transform.groupby,e!==null&&e!==void 0?e:[]).forEach((function(e){return n.add(e)}));(t=this.transform.sort,t!==null&&t!==void 0?t:[]).forEach((function(e){return n.add(e.field)}));this.transform.window.map((function(e){return e.field})).filter((function(e){return e!==undefined})).forEach((function(e){return n.add(e)}));return n};t.prototype.producedFields=function(){return new Set(this.transform.window.map(this.getDefaultName))};t.prototype.getDefaultName=function(e){var t;return t=e.as,t!==null&&t!==void 0?t:KDe(e)};t.prototype.hash=function(){return"WindowTransform "+yke(this.transform)};t.prototype.assemble=function(){var e;var t=[];var n=[];var r=[];var i=[];for(var a=0,o=this.transform.window;a<o.length;a++){var u=o[a];n.push(u.op);r.push(this.getDefaultName(u));i.push(u.param===undefined?null:u.param);t.push(u.field===undefined?null:u.field)}var s=this.transform.frame;var l=this.transform.groupby;if(s&&s[0]===null&&s[1]===null&&n.every((function(e){return UAe(e)}))){return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},l!==undefined?{groupby:l}:{})}var f=[];var c=[];if(this.transform.sort!==undefined){for(var h=0,d=this.transform.sort;h<d.length;h++){var p=d[h];f.push(p.field);c.push((e=p.order,e!==null&&e!==void 0?e:"ascending"))}}var v={field:f,order:c};var g=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:r,ops:n,fields:t,sort:v},g!==undefined?{ignorePeers:g}:{}),l!==undefined?{groupby:l}:{}),s!==undefined?{frame:s}:{})};return t}(tje);var APe=function(e){p(t,e);function t(t){return e.call(this,t)||this}t.prototype.clone=function(){return new t(null)};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return new Set([MFe])};t.prototype.hash=function(){return"Identifier"};t.prototype.assemble=function(){return{type:"identifier",as:MFe}};return t}(tje);var EPe=function(e){p(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=e.parent;if(e instanceof yPe){if(aPe(t)){return this.flags}if(t.numChildren()>1){this.setContinue();return this.flags}if(t instanceof yPe){this.setMutated();t.merge(e)}else{if(Dke(t.producedFields(),e.dependentFields())){this.setContinue();return this.flags}this.setMutated();e.swapWithParent()}}this.setContinue();return this.flags};return t}(uPe);var MPe=function(e){p(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.mergeNodes=function(e,t){var n=t.shift();for(var r=0,i=t;r<i.length;r++){var a=i[r];e.removeChild(a);a.parent=n;a.remove()}};t.prototype.run=function(e){var t=e.children.map((function(e){return e.hash()}));var n={};for(var r=0;r<t.length;r++){if(n[t[r]]===undefined){n[t[r]]=[e.children[r]]}else{n[t[r]].push(e.children[r])}}for(var i=0,a=Cke(n);i<a.length;i++){var o=a[i];if(n[o].length>1){this.setMutated();this.mergeNodes(e,n[o])}}for(var u=0,s=e.children;u<s.length;u++){var l=s[u];this.run(l)}return this.mutatedFlag};return t}(sPe);var OPe=function(e){p(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){if(e instanceof nje||e.numChildren()>0||e instanceof hPe){return this.flags}else{this.setMutated();e.remove()}return this.flags};return t}(uPe);var SPe=function(e){p(t,e);function t(){var t=e.apply(this,arguments)||this;t.fields=new Set;t.prev=null;return t}t.prototype.run=function(e){this.setContinue();if(e instanceof rje){var t=e.producedFields();if(Oke(t,this.fields)){this.setMutated();this.prev.remove()}else{this.fields=new Set(__spreadArrays(this.fields,t))}this.prev=e}return this.flags};t.prototype.reset=function(){this.fields.clear()};return t}(uPe);var DPe=function(e){p(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){this.setContinue();var t=e.parent;var n=t.children.filter((function(e){return e instanceof rje}));var r=n.pop();for(var i=0,a=n;i<a.length;i++){var o=a[i];this.setMutated();r.merge(o)}return this.flags};return t}(uPe);function CPe(e){function t(n){if(!(n instanceof hPe)){var r=n.clone();if(r instanceof nje){var i=IPe+r.getSource();r.setSource(i);e.model.component.data.outputNodes[i]=r}else if(r instanceof cPe||r instanceof wPe||r instanceof kPe||r instanceof bPe){r.addDimensions(e.fields)}n.children.flatMap(t).forEach((function(e){return e.parent=r}));return[r]}return n.children.flatMap(t)}return t}function FPe(e){if(e instanceof hPe){if(e.numChildren()===1&&!(e.children[0]instanceof nje)){var t=e.children[0];if(t instanceof cPe||t instanceof wPe||t instanceof kPe||t instanceof bPe){t.addDimensions(e.fields)}t.swapWithParent();FPe(e)}else{var n=e.model.component.data.main;TPe(n);var r=CPe(e);var i=e.children.map(r).flat();for(var a=0,o=i;a<o.length;a++){var u=o[a];u.parent=n}}}else{e.children.map(FPe)}}function TPe(e){if(e instanceof nje&&e.type===jTe){if(e.numChildren()===1){var t=e.children[0];if(!(t instanceof hPe)){t.swapWithParent();TPe(e)}}}}var NPe=function(e){p(t,e);function t(){return e.call(this)||this}t.prototype.run=function(e){if(e instanceof nje&&!e.isRequired()){this.setMutated();e.remove()}for(var t=0,n=e.children;t<n.length;t++){var r=n[t];this.run(r)}return this.mutatedFlag};return t}(sPe);var jPe=function(e){p(t,e);function t(t){var n=e.call(this)||this;n.requiresSelectionId=t&&Zje(t);return n}t.prototype.run=function(e){if(e instanceof APe){if(!(this.requiresSelectionId&&(aPe(e.parent)||e.parent instanceof cPe||e.parent instanceof yPe))){this.setMutated();e.remove()}}for(var t=0,n=e.children;t<n.length;t++){var r=n[t];this.run(r)}return this.mutatedFlag};return t}(sPe);var RPe=function(e){p(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=e.parent;var n=__spreadArrays(t.children);var r=t.children.filter((function(e){return e instanceof yPe}));if(t.numChildren()>1&&r.length>=1){var i={};var a=new Set;for(var o=0,u=r;o<u.length;o++){var s=u[o];var l=s.parse;for(var f=0,c=Cke(l);f<c.length;f++){var h=c[f];if(!(h in i)){i[h]=l[h]}else if(i[h]!==l[h]){a.add(h)}}}for(var d=0,p=a;d<p.length;d++){var v=p[d];delete i[v]}if(Cke(i).length!==0){this.setMutated();var g=new yPe(t,i);for(var m=0,y=n;m<y.length;m++){var b=y[m];if(b instanceof yPe){for(var _=0,x=Cke(i);_<x.length;_++){var w=x[_];delete b.parse[w]}}t.removeChild(b);b.parent=g;if(b instanceof yPe&&Cke(b.parse).length===0){b.remove()}}}}this.setContinue();return this.flags};return t}(uPe);var zPe=function(e){p(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=e.parent;var n=t.children.filter((function(e){return e instanceof cPe}));var r={};for(var i=0,a=n;i<a.length;i++){var o=a[i];var u=yke(o.groupBy);if(!(u in r)){r[u]=[]}r[u].push(o)}for(var s=0,l=Cke(r);s<l.length;s++){var f=l[s];var c=r[f];if(c.length>1){var h=c.pop();for(var d=0,p=c;d<p.length;d++){var o=p[d];if(h.merge(o)){t.removeChild(o);o.parent=h;o.remove();this.setMutated()}}}}this.setContinue();return this.flags};return t}(uPe);var PPe=function(e){p(t,e);function t(t){var n=e.call(this)||this;n.model=t;return n}t.prototype.run=function(e){var t=e.parent;var n=!(aPe(t)||t instanceof tRe||t instanceof yPe||t instanceof APe);var r=[];var i=[];for(var a=0,o=t.children;a<o.length;a++){var u=o[a];if(u instanceof ePe){if(n&&!Dke(t.producedFields(),u.dependentFields())){r.push(u)}else{i.push(u)}}}if(r.length>0){var s=r.pop();for(var l=0,f=r;l<f.length;l++){var c=f[l];s.merge(c,this.model.renameSignal.bind(this.model))}this.setMutated();if(t instanceof ePe){t.merge(s,this.model.renameSignal.bind(this.model))}else{s.swapWithParent()}}if(i.length>1){var h=i.pop();for(var d=0,p=i;d<p.length;d++){var v=p[d];h.merge(v,this.model.renameSignal.bind(this.model))}this.setMutated()}this.setContinue();return this.flags};return t}(uPe);var LPe=function(e){p(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=e.parent;var n=__spreadArrays(t.children);var r=xke(n,(function(e){return e instanceof nje}));if(!r||t.numChildren()<=1){this.setContinue();return this.flags}var i=[];var a;for(var o=0,u=n;o<u.length;o++){var s=u[o];if(s instanceof nje){var l=s;while(l.numChildren()===1){var f=l.children[0];if(f instanceof nje){l=f}else{break}}i.push.apply(i,l.children);if(a){t.removeChild(s);s.parent=a.parent;a.parent.removeChild(a);a.parent=l;this.setMutated()}else{a=l}}else{i.push(s)}}if(i.length){this.setMutated();for(var c=0,h=i;c<h.length;c++){var s=h[c];s.parent.removeChild(s);s.parent=a}}this.setContinue();return this.flags};return t}(uPe);var IPe="scale_";var BPe=5;function UPe(e){var t=[];function n(e){if(e.numChildren()===0){t.push(e)}else{e.children.forEach(n)}}e.forEach(n);return t}function qPe(e){return e}function WPe(e,t){var n=t.map((function(t){if(e instanceof uPe){var n=e.optimizeNextFromLeaves(t);e.reset();return n}else{return e.run(t)}}));return n.some(qPe)}function HPe(e,t){var n=e.sources;var r=new Set;r.add(WPe(new NPe,n));r.add(WPe(new jPe(t),n));n=n.filter((function(e){return e.numChildren()>0}));r.add(WPe(new OPe,UPe(n)));n=n.filter((function(e){return e.numChildren()>0}));r.add(WPe(new EPe,UPe(n)));r.add(WPe(new PPe(t),UPe(n)));r.add(WPe(new SPe,UPe(n)));r.add(WPe(new RPe,UPe(n)));r.add(WPe(new zPe,UPe(n)));r.add(WPe(new DPe,UPe(n)));r.add(WPe(new MPe,n));r.add(WPe(new LPe,UPe(n)));e.sources=n;return r.has(true)}function GPe(e,t){nPe(e.sources);var n=0;var r=0;for(var i=0;i<BPe;i++){if(!HPe(e,t)){break}n++}e.sources.map(FPe);for(var i=0;i<BPe;i++){if(!HPe(e,t)){break}r++}nPe(e.sources);if(Math.max(n,r)===BPe){SOe("Maximum optimization runs("+BPe+") reached.")}}var $Pe=function(){function e(e){Object.defineProperty(this,"signal",{enumerable:true,get:e})}e.fromName=function(t,n){return new e((function(){return t(n)}))};return e}();function YPe(e){if($Le(e)){VPe(e)}else{XPe(e)}}function VPe(e){var t=e.component.scales;Cke(t).forEach((function(n){var r=ZPe(e,n);var i=t[n];i.setWithExplicit("domains",r);tLe(e,n);if(e.component.data.isFaceted){var a=e;while(!YLe(a)&&a.parent){a=a.parent}var o=a.component.resolve.scale[n];if(o==="shared"){for(var u=0,s=r.value;u<s.length;u++){var l=s[u];if(sNe(l)){l.data=IPe+l.data.replace(IPe,"")}}}}}))}function XPe(e){for(var t=0,n=e.children;t<n.length;t++){var r=n[t];YPe(r)}var i=e.component.scales;Cke(i).forEach((function(t){var n;var r=null;for(var a=0,o=e.children;a<o.length;a++){var u=o[a];var s=u.component.scales[t];if(s){if(n===undefined){n=s.getWithExplicit("domains")}else{n=ize(n,s.getWithExplicit("domains"),"domains","scale",iLe)}var l=s.get("selectionExtent");if(r&&l&&r.selection!==l.selection){SOe("The same selection must be used to override scale domains in a layered view.")}r=l}}i[t].setWithExplicit("domains",n);if(r){i[t].set("selectionExtent",r,true)}}))}function JPe(e,t,n,r){if(e==="unaggregated"){var i=rLe(t,n),a=i.valid,o=i.reason;if(!a){SOe(o);return undefined}}else if(e===undefined&&r.useUnaggregatedDomain){var a=rLe(t,n).valid;if(a){return"unaggregated"}}return e}function ZPe(e,t){var n=e.getScaleComponent(t).get("type");var r=JPe(e.scaleDomain(t),e.fieldDef(t),n,e.config.scale);if(r!==e.scaleDomain(t)){e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})}if(t==="x"&&e.channelHasField("x2")){if(e.channelHasField("x")){return ize(KPe(n,r,e,"x"),KPe(n,r,e,"x2"),"domain","scale",iLe)}else{return KPe(n,r,e,"x2")}}else if(t==="y"&&e.channelHasField("y2")){if(e.channelHasField("y")){return ize(KPe(n,r,e,"y"),KPe(n,r,e,"y2"),"domain","scale",iLe)}else{return KPe(n,r,e,"y2")}}return KPe(n,r,e,t)}function QPe(e,t,n){return e.map((function(e){var r=kCe(e,{timeUnit:n,type:t});return{signal:"{data: "+r+"}"}}))}function KPe(e,t,n,r){var i;var a=n.fieldDef(r);if(t&&t!=="unaggregated"&&!ZSe(t)){var o=a.type;var u=(i=oSe(a.timeUnit))===null||i===void 0?void 0:i.unit;if(o==="temporal"||u){return eze(QPe(t,o,u))}return eze([t])}var s=n.stack;if(s&&r===s.fieldChannel){if(s.offset==="normalize"){return tze([[0,1]])}var l=n.requestDataName(jTe);return tze([{data:l,field:n.vgField(r,{suffix:"start"})},{data:l,field:n.vgField(r,{suffix:"end"})}])}var f=QEe(r)?nLe(n,r,e):undefined;if(t==="unaggregated"){var c=n.requestDataName(jTe);var h=a.field;return tze([{data:c,field:KDe({field:h,aggregate:"min"})},{data:c,field:KDe({field:h,aggregate:"max"})}])}else if(OCe(a.bin)){if(GSe(e)){if(e==="bin-ordinal"){return tze([])}return tze([{data:Tke(f)?n.requestDataName(jTe):n.requestDataName(RTe),field:n.vgField(r,ECe(a,r)?{binSuffix:"range"}:{}),sort:f===true||!Fwe(f)?{field:n.vgField(r,{}),op:"min"}:f}])}else{var d=a.bin;if(OCe(d)){var p=Zze(n,a.field,d);return tze([new $Pe((function(){var e=n.getSignalName(p);return"["+e+".start, "+e+".stop]"}))])}else{return tze([{data:n.requestDataName(jTe),field:n.vgField(r,{})}])}}}else if(a.timeUnit&&_ke(["time","utc"],e)&&BDe(r,a,$Le(n)?n.encoding[IEe(r)]:undefined,n.markDef,n.config)){var v=n.requestDataName(jTe);return tze([{data:v,field:n.vgField(r)},{data:v,field:n.vgField(r,{suffix:"end"})}])}else if(f){return tze([{data:Tke(f)?n.requestDataName(jTe):n.requestDataName(RTe),field:n.vgField(r),sort:f}])}else{return tze([{data:n.requestDataName(jTe),field:n.vgField(r)}])}}function eLe(e,t){var n=e.op,r=e.field,i=e.order;return Object.assign(Object.assign({op:n!==null&&n!==void 0?n:t?"sum":MDe},r?{field:Bke(r)}:{}),i?{order:i}:{})}function tLe(e,t){var n=e.component.scales[t];var r=e.specifiedScales[t].domain;var i=e.fieldDef(t).bin;var a=ZSe(r)&&r;var o=DCe(i)&&CCe(i.extent)&&i.extent;if(a||o){n.set("selectionExtent",a!==null&&a!==void 0?a:o,true)}}function nLe(e,t,n){if(!GSe(n)){return undefined}var r=e.fieldDef(t);var i=r.sort;if(FDe(i)){return{op:"min",field:DRe(r,t),order:"ascending"}}var a=e.stack!==null;if(CDe(i)){return eLe(i,a)}else if(DDe(i)){var o=i.encoding,u=i.order;var s=e.fieldDef(o);var l=s.aggregate,f=s.field;if(IAe(l)||BAe(l)){return eLe({field:KDe(s),order:u},a)}else if(UAe(l)||!l){return eLe({op:l,field:f,order:u},a)}}else if(i==="descending"){return{op:"min",field:e.vgField(t),order:"descending"}}else if(_ke(["ascending",undefined],i)){return true}return undefined}function rLe(e,t){var n=e.aggregate,r=e.type;if(!n){return{valid:false,reason:kOe.unaggregateDomainHasNoEffectForRawField(e)}}if(Twe(n)&&!YAe[n]){return{valid:false,reason:kOe.unaggregateDomainWithNonSharedDomainOp(n)}}if(r==="quantitative"){if(t==="log"){return{valid:false,reason:kOe.unaggregatedDomainWithLogScale(e)}}}return{valid:true}}function iLe(e,t,n,r){if(e.explicit&&t.explicit){SOe(kOe.mergeConflictingDomainProperty(n,r,e.value,t.value))}return{explicit:e.explicit,value:__spreadArrays(e.value,t.value)}}function aLe(e){var t=Eke(e.map((function(e){if(sNe(e)){var t=h(e,["sort"]);return t}return e})),yke);var n=Eke(e.map((function(e){if(sNe(e)){var t=e.sort;if(t!==undefined&&!Tke(t)){if("op"in t&&t.op==="count"){delete t.field}if(t.order==="ascending"){delete t.order}}return t}return undefined})).filter((function(e){return e!==undefined})),yke);if(t.length===0){return undefined}else if(t.length===1){var r=e[0];if(sNe(r)&&n.length>0){var i=n[0];if(n.length>1){SOe(kOe.MORE_THAN_ONE_SORT);i=true}return Object.assign(Object.assign({},r),{sort:i})}return r}var a=Eke(n.map((function(e){if(Tke(e)||!("op"in e)||e.op in LAe){return e}SOe(kOe.domainSortDropped(e));return true})),yke);var o;if(a.length===1){o=a[0]}else if(a.length>1){SOe(kOe.MORE_THAN_ONE_SORT);o=true}var u=Eke(e.map((function(e){if(sNe(e)){return e.data}return null})),(function(e){return e}));if(u.length===1&&u[0]!==null){var s=Object.assign({data:u[0],fields:t.map((function(e){return e.field}))},o?{sort:o}:{});return s}return Object.assign({fields:t},o?{sort:o}:{})}function oLe(e){if(sNe(e)&&Twe(e.field)){return e.field}else if(oNe(e)){var t;for(var n=0,r=e.fields;n<r.length;n++){var i=r[n];if(sNe(i)&&Twe(i.field)){if(!t){t=i.field}else if(t!==i.field){SOe("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.");return t}}}SOe("Detected faceted independent scales that union domain of identical fields from different source detected. We will assume that this is the same field from a different fork of the same data source. However, if this is not case, the result view size maybe incorrect.");return t}else if(uNe(e)){SOe("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");var a=e.fields[0];return Twe(a)?a:undefined}return undefined}function uLe(e,t){var n=e.component.scales[t];var r=n.get("domains").map((function(t){if(sNe(t)){t.data=e.lookupDataSource(t.data)}return t}));return aLe(r)}function sLe(e){if(JLe(e)||XLe(e)||VLe(e)){return e.children.reduce((function(e,t){return e.concat(sLe(t))}),lLe(e))}else{return lLe(e)}}function lLe(e){return Cke(e.component.scales).reduce((function(t,n){var r=e.component.scales[n];if(r.merged){return t}var i=r.combine();var a=i.name,o=i.type,u=i.selectionExtent,s=i.domains,l=i.range,f=h(i,["name","type","selectionExtent","domains","range"]);var c=fLe(i.range,a,n);var d;if(u){d=Nje(e,u)}var p=uLe(e,n);t.push(Object.assign(Object.assign(Object.assign(Object.assign({name:a,type:o},p?{domain:p}:{}),d?{domainRaw:d}:{}),{range:c}),f));return t}),[])}function fLe(e,t,n){if(n==="x"||n==="y"){if(aNe(e)){return{step:{signal:t+"_step"}}}}return e}var cLe=function(e){p(t,e);function t(t,n){var r=e.call(this,{},{name:t})||this;r.merged=false;r.setWithExplicit("type",n);return r}t.prototype.domainDefinitelyIncludesZero=function(){if(this.get("zero")!==false){return true}return xke(this.get("domains"),(function(e){return Cwe(e)&&e.length===2&&e[0]<=0&&e[1]>=0}))};return t}(KRe);var hLe=["range","scheme"];function dLe(e){return e==="x"?"width":e==="y"?"height":undefined}function pLe(e){var t=e.component.scales;ZEe.forEach((function(n){var r=t[n];if(!r){return}var i=gLe(n,e);r.setWithExplicit("range",i)}))}function vLe(e,t){var n=e.fieldDef(t);if(n&&n.bin&&OCe(n.bin)){var r=Zze(e,n.field,n.bin);var i=dLe(t);var a=e.getName(i);return new $Pe((function(){var t=e.getSignalName(r);var n="("+t+".stop - "+t+".start) / "+t+".step";return e.getSignalName(a)+" / ("+n+")"}))}return undefined}function gLe(e,t){var n=t.specifiedScales[e];var r=t.size;var i=t.getScaleComponent(e);var a=i.get("type");for(var o=0,u=hLe;o<u.length;o++){var s=u[o];if(n[s]!==undefined){var l=nDe(a,s);var f=rDe(e,s);if(!l){SOe(kOe.scalePropertyNotWorkWithScaleType(a,s,e))}else if(f){SOe(f)}else{switch(s){case"range":return eze(n[s]);case"scheme":return eze(mLe(n[s]))}}}}if(e===ZAe||e===QAe){var c=e===ZAe?"width":"height";var h=r[c];if(RFe(h)){if(GSe(a)){return eze({step:h.step})}else{SOe(kOe.stepDropped(c))}}}return tze(yLe(e,t))}function mLe(e){if(JSe(e)){return Object.assign({scheme:e.name},gke(e,["name"]))}return{scheme:e}}function yLe(e,t){var n=t.size,r=t.config,i=t.mark;var a=t.getSignalName.bind(t);var o=t.fieldDef(e).type;var u=t.getScaleComponent(e);var s=u.get("type");var l=t.specifiedScales[e],f=l.domain,c=l.domainMid;switch(e){case ZAe:case QAe:{if(_ke(["point","band"],s)){if(e===ZAe&&!n.width){var h=WFe(r.view,"width");if(RFe(h)){return h}}else if(e===QAe&&!n.height){var d=WFe(r.view,"height");if(RFe(d)){return d}}}var p=dLe(e);var v=t.getName(p);if(e===QAe&&$Se(s)){return[$Pe.fromName(a,v),0]}else{return[0,$Pe.fromName(a,v)]}}case lEe:{var g=t.component.scales[e].get("zero");var m=xLe(i,g,r);var y=kLe(i,n,t,r);if(VSe(s)){return _Le(m,y,bLe(s,r,f,e))}else{return[m,y]}}case dEe:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case sEe:return"symbol";case aEe:case oEe:case uEe:if(s==="ordinal"){return o==="nominal"?"category":"ordinal"}else{if(c!==undefined){return"diverging"}else{return i==="rect"||i==="geoshape"?"heatmap":"ramp"}}case fEe:case cEe:case hEe:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel "+e)}function bLe(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":if(n!==undefined&&Cwe(n)){return n.length+1}else{SOe(kOe.domainRequiredForThresholdScale(r));return 3}}}function _Le(e,t,n){var r=function(){var r=iNe(t)?t.signal:t;var i="("+r+" - "+e+") / ("+n+" - 1)";return"sequence("+e+", "+t+" + "+i+", "+i+")"};if(iNe(t)){return new $Pe(r)}else{return{signal:r()}}}function xLe(e,t,n){if(t){return 0}switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(kOe.incompatibleChannel("size",e))}var wLe=.95;function kLe(e,t,n,r){var i={x:vLe(n,"x"),y:vLe(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==undefined){return r.scale.maxBandSize}var a=ALe(t,i,r.view);if(rke(a)){return a-1}else{return new $Pe((function(){return a.signal+" - 1"}))}}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize){return r.scale.maxSize}var o=ALe(t,i,r.view);if(rke(o)){return Math.pow(wLe*o,2)}else{return new $Pe((function(){return"pow("+wLe+" * "+o.signal+", 2)"}))}}}throw new Error(kOe.incompatibleChannel("size",e))}function ALe(e,t,n){var r=RFe(e.width)?e.width.step:qFe(n,"width");var i=RFe(e.height)?e.height.step:qFe(n,"height");if(t.x||t.y){return new $Pe((function(){var e=[t.x?t.x.signal:r,t.y?t.y.signal:i];return"min("+e.join(", ")+")"}))}return Math.min(r,i)}function ELe(e,t){if($Le(e)){MLe(e,t)}else{DLe(e,t)}}function MLe(e,t){var n=e.component.scales;Cke(n).forEach((function(r){var i=e.specifiedScales[r];var a=n[r];var o=e.getScaleComponent(r);var u=e.fieldDef(r);var s=e.config;var l=i[t];var f=o.get("type");var c=nDe(f,t);var h=rDe(r,t);if(l!==undefined){if(!c){SOe(kOe.scalePropertyNotWorkWithScaleType(f,t,r))}else if(h){SOe(h)}}if(c&&h===undefined){if(l!==undefined){a.copyKeyFromObject(t,i)}else{var d=OLe(t,e,r,u,o.get("type"),o.get("padding"),o.get("paddingInner"),i.domain,e.markDef,s);if(d!==undefined){a.set(t,d,false)}}}}))}function OLe(e,t,n,r,i,a,o,u,s,l){var f=l.scale;var c=r.type,h=r.sort;switch(e){case"bins":return CLe(t,r);case"interpolate":return FLe(n,c);case"nice":return TLe(i,n,r);case"padding":return NLe(n,i,f,r,s,l.bar);case"paddingInner":return jLe(a,n,s.type,f);case"paddingOuter":return RLe(a,n,i,s.type,o,f);case"reverse":return zLe(i,h);case"zero":return PLe(n,r,u,s,i)}return f[e]}function SLe(e){if($Le(e)){pLe(e)}else{DLe(e,"range")}}function DLe(e,t){var n=e.component.scales;for(var r=0,i=e.children;r<i.length;r++){var a=i[r];if(t==="range"){SLe(a)}else{ELe(a,t)}}Cke(n).forEach((function(r){var i;for(var a=0,o=e.children;a<o.length;a++){var u=o[a];var s=u.component.scales[r];if(s){var l=s.getWithExplicit(t);i=ize(i,l,t,"scale",nze((function(e,n){switch(t){case"range":if(e.step&&n.step){return e.step-n.step}return 0}return 0})))}}n[r].setWithExplicit(t,i)}))}function CLe(e,t){var n=t.bin;if(OCe(n)){var r=Zze(e,t.field,n);return new $Pe((function(){return e.getSignalName(r)}))}else if(SCe(n)&&DCe(n)&&n.step!==undefined){return{step:n.step}}return undefined}function FLe(e,t){if(_ke([aEe,oEe,uEe],e)&&t!=="nominal"){return"hcl"}return undefined}function TLe(e,t,n){if(n.bin||_ke([FSe.TIME,FSe.UTC],e)){return undefined}return _ke([ZAe,QAe],t)?true:undefined}function NLe(e,t,n,r,i,a){if(_ke([ZAe,QAe],e)){if(YSe(t)){if(n.continuousPadding!==undefined){return n.continuousPadding}var o=i.type,u=i.orient;if(o==="bar"&&!r.bin&&!r.timeUnit){if(u==="vertical"&&e==="x"||u==="horizontal"&&e==="y"){return a.continuousBandSize}}}if(t===FSe.POINT){return n.pointPadding}}return undefined}function jLe(e,t,n,r){if(e!==undefined){return undefined}if(_ke([ZAe,QAe],t)){var i=r.bandPaddingInner,a=r.barBandPaddingInner,o=r.rectBandPaddingInner;return Hke(i,n==="bar"?a:o)}return undefined}function RLe(e,t,n,r,i,a){if(e!==undefined){return undefined}if(_ke([ZAe,QAe],t)){if(n===FSe.BAND){var o=a.bandPaddingOuter;return Hke(o,i/2)}}return undefined}function zLe(e,t){if($Se(e)&&t==="descending"){return true}return undefined}function PLe(e,t,n,r,i){var a=!!n&&n!=="unaggregated";if(a){if($Se(i)){if(Cwe(n)){var o=n[0];var u=n[n.length-1];if(o<=0&&u>=0){return true}}return false}}if(e==="size"&&t.type==="quantitative"&&!VSe(i)){return true}if(!t.bin&&_ke([ZAe,QAe],e)){var s=r.orient,l=r.type;if(_ke(["bar","area","line","trail"],l)){if(s==="horizontal"&&e==="y"||s==="vertical"&&e==="x"){return false}}return true}return false}function LLe(e,t,n,r){var i=ILe(t,n,r);var a=e.type;if(!QEe(t)){return null}if(a!==undefined){if(!aDe(t,a)){SOe(kOe.scaleTypeNotWorkWithChannel(t,a,i));return i}if(!iDe(a,n.type)){SOe(kOe.scaleTypeNotWorkWithFieldDef(a,i));return i}return a}return i}function ILe(e,t,n){switch(t.type){case"nominal":case"ordinal":if(OEe(e)||rMe(e)==="discrete"){if(e==="shape"&&t.type==="ordinal"){SOe(kOe.discreteChannelCannotEncode(e,"ordinal"))}return"ordinal"}if(_ke(["x","y"],e)){if(_ke(["rect","bar","image","rule"],n)){return"band"}}return"point";case"temporal":if(OEe(e)){return"time"}else if(rMe(e)==="discrete"){SOe(kOe.discreteChannelCannotEncode(e,"temporal"));return"ordinal"}else if(t.timeUnit&&oSe(t.timeUnit).utc){return"utc"}return"time";case"quantitative":if(OEe(e)){if(OCe(t.bin)){return"bin-ordinal"}return"linear"}else if(rMe(e)==="discrete"){SOe(kOe.discreteChannelCannotEncode(e,"quantitative"));return"ordinal"}return"linear";case"geojson":return undefined}throw new Error(kOe.invalidFieldType(t.type))}function BLe(e,t){var n=(t===void 0?{}:t).ignoreRange;ULe(e);YPe(e);for(var r=0,i=eDe;r<i.length;r++){var a=i[r];ELe(e,a)}if(!n){SLe(e)}}function ULe(e){if($Le(e)){e.component.scales=qLe(e)}else{e.component.scales=HLe(e)}}function qLe(e){var t=e.encoding,n=e.mark;return ZEe.reduce((function(r,i){var a;var o;var u=t[i];if(HDe(u)&&n===gAe&&i===sEe&&u.type===DSe){return r}if(HDe(u)){a=u;o=u.scale}else if(qDe(u)){a=u.condition;o=u.condition["scale"]}if(a&&o!==null&&o!==false){o=o!==null&&o!==void 0?o:{};var s=LLe(o,i,a,n);r[i]=new cLe(e.scaleName(i+"",true),{value:s,explicit:o.type===s})}return r}),{})}var WLe=nze((function(e,t){return zSe(e)-zSe(t)}));function HLe(e){var t=e.component.scales={};var n={};var r=e.component.resolve;var i=function(t){ULe(t);Cke(t.component.scales).forEach((function(i){var a;r.scale[i]=(a=r.scale[i],a!==null&&a!==void 0?a:ZRe(i,e));if(r.scale[i]==="shared"){var o=n[i];var u=t.component.scales[i].getWithExplicit("type");if(o){if(jSe(o.value,u.value)){n[i]=ize(o,u,"type","scale",WLe)}else{r.scale[i]="independent";delete n[i]}}else{n[i]=u}}}))};for(var a=0,o=e.children;a<o.length;a++){var u=o[a];i(u)}for(var s=0,l=Cke(n);s<l.length;s++){var f=l[s];var c=e.scaleName(f,true);var h=n[f];t[f]=new cLe(c,h);for(var d=0,p=e.children;d<p.length;d++){var u=p[d];var v=u.component.scales[f];if(v){u.renameScale(v.get("name"),c);v.merged=true}}}return t}var GLe=function(){function e(){this.nameMap={}}e.prototype.rename=function(e,t){this.nameMap[e]=t};e.prototype.has=function(e){return this.nameMap[e]!==undefined};e.prototype.get=function(e){while(this.nameMap[e]&&e!==this.nameMap[e]){e=this.nameMap[e]}return e};return e}();function $Le(e){var t;return((t=e)===null||t===void 0?void 0:t.type)==="unit"}function YLe(e){var t;return((t=e)===null||t===void 0?void 0:t.type)==="facet"}function VLe(e){var t;return((t=e)===null||t===void 0?void 0:t.type)==="repeat"}function XLe(e){var t;return((t=e)===null||t===void 0?void 0:t.type)==="concat"}function JLe(e){var t;return((t=e)===null||t===void 0?void 0:t.type)==="layer"}var ZLe=function(){function e(e,t,n,r,i,a,o,u){var s=this;var l,f;this.type=t;this.parent=n;this.config=i;this.repeater=a;this.view=u;this.children=[];this.correctDataNames=function(e){if(e.from&&e.from.data){e.from.data=s.lookupDataSource(e.from.data)}if(e.from&&e.from.facet&&e.from.facet.data){e.from.facet.data=s.lookupDataSource(e.from.facet.data)}return e};this.parent=n;this.config=i;this.repeater=a;this.name=(l=e.name,l!==null&&l!==void 0?l:r);this.title=lDe(e.title)?{text:e.title}:e.title;this.scaleNameMap=n?n.scaleNameMap:new GLe;this.projectionNameMap=n?n.projectionNameMap:new GLe;this.signalNameMap=n?n.signalNameMap:new GLe;this.data=e.data;this.description=e.description;this.transforms=rNe((f=e.transform,f!==null&&f!==void 0?f:[]));this.layout=RAe(e)||eTe(e)?{}:BFe(e,t,i);this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:jDe(e)||n&&n.component.data.isFaceted&&e.data===undefined},layoutSize:new KRe,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?pke(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}Object.defineProperty(e.prototype,"width",{get:function(){return this.getSizeSignalRef("width")},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this.getSizeSignalRef("height")},enumerable:true,configurable:true});e.prototype.parse=function(){this.parseScale();this.parseLayoutSize();this.renameTopLevelLayoutSizeSignal();this.parseSelections();this.parseProjection();this.parseData();this.parseAxesAndHeaders();this.parseLegends();this.parseMarkGroup()};e.prototype.parseScale=function(){BLe(this)};e.prototype.parseProjection=function(){Wze(this)};e.prototype.renameTopLevelLayoutSizeSignal=function(){if(this.getName("width")!=="width"){this.renameSignal(this.getName("width"),"width")}if(this.getName("height")!=="height"){this.renameSignal(this.getName("height"),"height")}};e.prototype.parseLegends=function(){Oze(this)};e.prototype.assembleGroupStyle=function(){var e,t;if(this.type==="unit"||this.type==="layer"){return t=(e=this.view)===null||e===void 0?void 0:e.style,t!==null&&t!==void 0?t:"cell"}return undefined};e.prototype.assembleEncodeFromView=function(e){var t=h(e,["style"]);var n={};for(var r in t){if(tke(t,r)){var i=t[r];if(i!==undefined){n[r]={value:i}}}}return n};e.prototype.assembleGroupEncodeEntry=function(e){var t=undefined;if(this.view){t=this.assembleEncodeFromView(this.view)}if(!e){if(this.type==="unit"||this.type==="layer"){return Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},t!==null&&t!==void 0?t:{})}}return t};e.prototype.assembleLayout=function(){if(!this.layout){return undefined}var e=this.layout,t=e.spacing,n=h(e,["spacing"]);var r=this,i=r.component,a=r.config;var o=HRe(i.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),o?{titleBand:o}:{})};e.prototype.assembleDefaultLayout=function(){return{}};e.prototype.assembleHeaderMarks=function(){var e=this.component.layoutHeaders;var t=[];for(var n=0,r=DEe;n<r.length;n++){var i=r[n];if(e[i].title){t.push(RRe(this,i))}}for(var a=0,o=NRe;a<o.length;a++){var i=o[a];t=t.concat(LRe(this,i))}return t};e.prototype.assembleAxes=function(){return cRe(this.component.axes,this.config)};e.prototype.assembleLegends=function(){return Pze(this)};e.prototype.assembleProjections=function(){return Lze(this)};e.prototype.assembleTitle=function(){var e,t,n;var r=(e=this.title,e!==null&&e!==void 0?e:{}),i=r.encoding,a=h(r,["encoding"]);var o=Object.assign(Object.assign(Object.assign({},sDe(this.config.title).nonMark),a),i?{encode:{update:i}}:{});if(o.text){if(_ke(["unit","layer"],this.type)){if(_ke(["middle",undefined],o.anchor)){o.frame=(t=o.frame,t!==null&&t!==void 0?t:"group")}}else{o.anchor=(n=o.anchor,n!==null&&n!==void 0?n:"start")}return Cke(o).length>0?o:undefined}return undefined};e.prototype.assembleGroup=function(e){if(e===void 0){e=[]}var t={};e=e.concat(this.assembleSignals());if(e.length>0){t.signals=e}var n=this.assembleLayout();if(n){t.layout=n}t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||YLe(this.parent)?sLe(this):[];if(r.length>0){t.scales=r}var i=this.assembleAxes();if(i.length>0){t.axes=i}var a=this.assembleLegends();if(a.length>0){t.legends=a}return t};e.prototype.getName=function(e){return Nke((this.name?this.name+"_":"")+e)};e.prototype.requestDataName=function(e){var t;var n=this.getName(e);var r=this.component.data.outputNodeRefCounts;r[n]=(t=r[n],t!==null&&t!==void 0?t:0)+1;return n};e.prototype.getSizeSignalRef=function(e){if(YLe(this.parent)){var t=GEe(e);var n=this.component.scales[t];if(n&&!n.merged){var r=n.get("type");var i=n.get("range");if(GSe(r)&&aNe(i)){var a=n.get("name");var o=uLe(this,t);var u=oLe(o);if(u){var s=KDe({aggregate:"distinct",field:u},{expr:"datum"});return{signal:XRe(a,n,s)}}else{SOe("Unknown field for "+t+". Cannot calculate view size.");return null}}}}return{signal:this.signalNameMap.get(this.getName(e))}};e.prototype.lookupDataSource=function(e){var t=this.component.data.outputNodes[e];if(!t){return e}return t.getSource()};e.prototype.getSignalName=function(e){return this.signalNameMap.get(e)};e.prototype.renameSignal=function(e,t){this.signalNameMap.rename(e,t)};e.prototype.renameScale=function(e,t){this.scaleNameMap.rename(e,t)};e.prototype.renameProjection=function(e,t){this.projectionNameMap.rename(e,t)};e.prototype.scaleName=function(e,t){if(t){return this.getName(e)}if(REe(e)&&QEe(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))){return this.scaleNameMap.get(this.getName(e))}return undefined};e.prototype.projectionName=function(e){if(e){return this.getName("projection")}if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))){return this.projectionNameMap.get(this.getName("projection"))}return undefined};e.prototype.getScaleComponent=function(e){if(!this.component.scales){throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().")}var t=this.component.scales[e];if(t&&!t.merged){return t}return this.parent?this.parent.getScaleComponent(e):undefined};e.prototype.getSelectionComponent=function(e,t){var n=this.component.selection[e];if(!n&&this.parent){n=this.parent.getSelectionComponent(e,t)}if(!n){throw new Error(kOe.selectionNotFound(t))}return n};return e}();var QLe=function(e){p(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.vgField=function(e,t){if(t===void 0){t={}}var n=this.fieldDef(e);if(!n){return undefined}return KDe(n,t)};t.prototype.reduceFieldDef=function(e,t){return ICe(this.getMapping(),(function(t,n,r){var i=pCe(n);if(i){return e(t,i,r)}return t}),t)};t.prototype.forEachFieldDef=function(e,t){LCe(this.getMapping(),(function(t,n){var r=pCe(t);if(r){e(r,n)}}),t)};return t}(ZLe);var KLe=function(e){p(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=pke(n);var u=(i=r.transform.as,i!==null&&i!==void 0?i:[undefined,undefined]);r.transform.as=[(a=u[0],a!==null&&a!==void 0?a:"value"),(o=u[1],o!==null&&o!==void 0?o:"density")];return r}t.prototype.clone=function(){return new t(null,pke(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(__spreadArrays([this.transform.density],(e=this.transform.groupby,e!==null&&e!==void 0?e:[])))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"DensityTransform "+yke(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.density,n=h(e,["density"]);var r=Object.assign({type:"kde",field:t},n);return r};return t}(tje);var eIe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.filter=n;return r}t.prototype.clone=function(){return new t(null,Object.assign({},this.filter))};t.make=function(e,n){var r=n.config,i=n.mark,a=n.markDef;var o=dDe("invalid",a,r);if(o!=="filter"){return null}var u=n.reduceFieldDef((function(e,t,r){var a=QEe(r)&&n.getScaleComponent(r);if(a){var o=a.get("type");if($Se(o)&&!t.aggregate&&!yAe(i)){e[t.field]=t}}return e}),{});if(!Cke(u).length){return null}return new t(e,u)};t.prototype.dependentFields=function(){return new Set(Cke(this.filter))};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){return"FilterInvalid "+yke(this.filter)};t.prototype.assemble=function(){var e=this;var t=Cke(this.filter).reduce((function(t,n){var r=e.filter[n];var i=KDe(r,{expr:"datum"});if(r!==null){if(r.type==="temporal"){t.push("(isDate("+i+") || (isValid("+i+") && isFinite(+"+i+")))")}else if(r.type==="quantitative"){t.push("isValid("+i+")");t.push("isFinite(+"+i+")")}}return t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null};return t}(tje);var tIe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;r.transform=pke(n);var i=r.transform,a=i.flatten,o=i.as,u=o===void 0?[]:o;r.transform.as=a.map((function(e,t){var n;return n=u[t],n!==null&&n!==void 0?n:e}));return r}t.prototype.clone=function(){return new t(this.parent,pke(this.transform))};t.prototype.dependentFields=function(){return new Set(this.transform.flatten)};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"FlattenTransform "+yke(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.flatten,n=e.as;var r={type:"flatten",fields:t,as:n};return r};return t}(tje);var nIe=function(e){p(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=pke(n);var u=(i=r.transform.as,i!==null&&i!==void 0?i:[undefined,undefined]);r.transform.as=[(a=u[0],a!==null&&a!==void 0?a:"key"),(o=u[1],o!==null&&o!==void 0?o:"value")];return r}t.prototype.clone=function(){return new t(null,pke(this.transform))};t.prototype.dependentFields=function(){return new Set(this.transform.fold)};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"FoldTransform "+yke(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.fold,n=e.as;var r={type:"fold",fields:t,as:n};return r};return t}(tje);var rIe=function(e){p(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.fields=n;a.geojson=r;a.signal=i;return a}t.prototype.clone=function(){return new t(null,pke(this.fields),this.geojson,this.signal)};t.parseAll=function(e,n){if(n.component.projection&&!n.component.projection.isFit){return e}var r=0;for(var i=0,a=[[nEe,tEe],[iEe,rEe]];i<a.length;i++){var o=a[i];var u=o.map((function(e){return n.channelHasField(e)?n.fieldDef(e).field:YDe(n.encoding[e])?{expr:n.encoding[e].value+""}:undefined}));if(u[0]||u[1]){e=new t(e,u,null,n.getName("geojson_"+r++))}}if(n.channelHasField(sEe)){var s=n.fieldDef(sEe);if(s.type===DSe){e=new t(e,null,s.field,n.getName("geojson_"+r++))}}return e};t.prototype.dependentFields=function(){var e;var t=(e=this.fields,e!==null&&e!==void 0?e:[]).filter(Twe);return new Set(__spreadArrays(this.geojson?[this.geojson]:[],t))};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){return"GeoJSON "+this.geojson+" "+this.signal+" "+yke(this.fields)};t.prototype.assemble=function(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})};return t}(tje);var iIe=function(e){p(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.projection=n;a.fields=r;a.as=i;return a}t.prototype.clone=function(){return new t(null,this.projection,pke(this.fields),pke(this.as))};t.parseAll=function(e,n){if(!n.projectionName()){return e}for(var r=0,i=[[nEe,tEe],[iEe,rEe]];r<i.length;r++){var a=i[r];var o=a.map((function(e){return n.channelHasField(e)?n.fieldDef(e).field:YDe(n.encoding[e])?{expr:n.encoding[e].value+""}:undefined}));var u=a[0]===iEe?"2":"";if(o[0]||o[1]){e=new t(e,n.projectionName(),o,[n.getName("x"+u),n.getName("y"+u)])}}return e};t.prototype.dependentFields=function(){return new Set(this.fields.filter(Twe))};t.prototype.producedFields=function(){return new Set(this.as)};t.prototype.hash=function(){return"Geopoint "+this.projection+" "+yke(this.fields)+" "+yke(this.as)};t.prototype.assemble=function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}};return t}(tje);var aIe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,pke(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(__spreadArrays([this.transform.impute,this.transform.key],(e=this.transform.groupby,e!==null&&e!==void 0?e:[])))};t.prototype.producedFields=function(){return new Set([this.transform.impute])};t.prototype.processSequence=function(e){var t=e.start,n=t===void 0?0:t,r=e.stop,i=e.step;var a=__spreadArrays([n,r],i?[i]:[]).join(",");return{signal:"sequence("+a+")"}};t.makeFromTransform=function(e,n){return new t(e,n)};t.makeFromEncoding=function(e,n){var r=n.encoding;var i=r.x;var a=r.y;if(HDe(i)&&HDe(a)){var o=i.impute?i:a.impute?a:undefined;if(o===undefined){return undefined}var u=i.impute?a:a.impute?i:undefined;var s=o.impute,l=s.method,f=s.value,c=s.frame,h=s.keyvals;var d=BCe(n.mark,r);return new t(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:u.field},l?{method:l}:{}),f!==undefined?{value:f}:{}),c?{frame:c}:{}),h!==undefined?{keyvals:h}:{}),d.length?{groupby:d}:{}))}return null};t.prototype.hash=function(){return"Impute "+yke(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.impute,n=e.key,r=e.keyvals,i=e.method,a=e.groupby,o=e.value,u=e.frame,s=u===void 0?[null,null]:u;var l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:PTe(r)?this.processSequence(r):r}:{}),{method:"value"}),a?{groupby:a}:{}),{value:null});var f;if(i&&i!=="value"){var c=Object.assign({type:"window",as:["imputed_"+t+"_value"],ops:[i],fields:[t],frame:s,ignorePeers:false},a?{groupby:a}:{});var h={type:"formula",expr:"datum."+t+" === null ? datum.imputed_"+t+"_value : datum."+t,as:t};f=[c,h]}else{var d={type:"formula",expr:"datum."+t+" === null ? "+o+" : datum."+t,as:t};f=[d]}return __spreadArrays([l],f)};return t}(tje);var oIe=function(e){p(t,e);function t(t,n,r){if(t===void 0){t={}}if(n===void 0){n={}}if(r===void 0){r=false}var i=e.call(this,t,n)||this;i.explicit=t;i.implicit=n;i.parseNothing=r;return i}t.prototype.clone=function(){var t=e.prototype.clone.call(this);t.parseNothing=this.parseNothing;return t};return t}(KRe);var uIe=function(e){p(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=pke(n);var u=(i=r.transform.as,i!==null&&i!==void 0?i:[undefined,undefined]);r.transform.as=[(a=u[0],a!==null&&a!==void 0?a:n.on),(o=u[1],o!==null&&o!==void 0?o:n.loess)];return r}t.prototype.clone=function(){return new t(null,pke(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(__spreadArrays([this.transform.loess,this.transform.on],(e=this.transform.groupby,e!==null&&e!==void 0?e:[])))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"LoessTransform "+yke(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.loess,n=e.on,r=h(e,["loess","on"]);var i=Object.assign({type:"loess",x:n,y:t},r);return i};return t}(tje);var sIe=function(e){p(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.transform=n;i.secondary=r;return i}t.prototype.clone=function(){return new t(null,pke(this.transform),this.secondary)};t.make=function(e,n,r,i){var a=n.component.data.sources;var o=r.from;var u=null;if(ITe(o)){var s=LIe(o.data,a);if(!s){s=new tPe(o.data);a.push(s)}var l=n.getName("lookup_"+i);u=new nje(s,l,"lookup",n.component.data.outputNodeRefCounts);n.component.data.outputNodes[l]=u}else if(BTe(o)){var f=o.selection;r=Object.assign({as:f},r);u=n.getSelectionComponent(Nke(f),f).materialized;if(!u){throw new Error(kOe.noSameUnitLookup(f))}}return new t(e,r,u.getSource())};t.prototype.dependentFields=function(){return new Set([this.transform.lookup])};t.prototype.producedFields=function(){return new Set(this.transform.as?Qwe(this.transform.as):this.transform.from.fields)};t.prototype.hash=function(){return"Lookup "+yke({transform:this.transform,secondary:this.secondary})};t.prototype.assemble=function(){var e;if(this.transform.from.fields){e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:Qwe(this.transform.as)}:{})}else{var t=this.transform.as;if(!Twe(t)){SOe(kOe.NO_FIELDS_NEEDS_AS);t="_lookup"}e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})};return t}(tje);var lIe=function(e){p(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=pke(n);var u=(i=r.transform.as,i!==null&&i!==void 0?i:[undefined,undefined]);r.transform.as=[(a=u[0],a!==null&&a!==void 0?a:"prob"),(o=u[1],o!==null&&o!==void 0?o:"value")];return r}t.prototype.clone=function(){return new t(null,pke(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(__spreadArrays([this.transform.quantile],(e=this.transform.groupby,e!==null&&e!==void 0?e:[])))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"QuantileTransform "+yke(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.quantile,n=h(e,["quantile"]);var r=Object.assign({type:"quantile",field:t},n);return r};return t}(tje);var fIe=function(e){p(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=pke(n);var u=(i=r.transform.as,i!==null&&i!==void 0?i:[undefined,undefined]);r.transform.as=[(a=u[0],a!==null&&a!==void 0?a:n.on),(o=u[1],o!==null&&o!==void 0?o:n.regression)];return r}t.prototype.clone=function(){return new t(null,pke(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(__spreadArrays([this.transform.regression,this.transform.on],(e=this.transform.groupby,e!==null&&e!==void 0?e:[])))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"RegressionTransform "+yke(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.regression,n=e.on,r=h(e,["regression","on"]);var i=Object.assign({type:"regression",x:n,y:t},r);return i};return t}(tje);var cIe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,pke(this.transform))};t.prototype.addDimensions=function(e){var t;this.transform.groupby=Eke((t=this.transform.groupby,t!==null&&t!==void 0?t:[]).concat(e),(function(e){return e}))};t.prototype.producedFields=function(){return undefined};t.prototype.dependentFields=function(){var e;return new Set(__spreadArrays([this.transform.pivot,this.transform.value],(e=this.transform.groupby,e!==null&&e!==void 0?e:[])))};t.prototype.hash=function(){return"PivotTransform "+yke(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.pivot,n=e.value,r=e.groupby,i=e.limit,a=e.op;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==undefined?{limit:i}:{}),a!==undefined?{op:a}:{}),r!==undefined?{groupby:r}:{})};return t}(tje);var hIe=function(e){p(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,pke(this.transform))};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){return"SampleTransform "+yke(this.transform)};t.prototype.assemble=function(){return{type:"sample",size:this.transform.sample}};return t}(tje);function dIe(e){var t=0;function n(r,i){var a,o,u;var s;if(r instanceof tPe){if(!r.isGenerator&&!OTe(r.data)){e.push(i);var l={name:null,source:i.name,transform:[]};i=l}}if(r instanceof yPe){if(r.parent instanceof tPe&&!i.source){i.format=Object.assign(Object.assign({},(s=i.format,s!==null&&s!==void 0?s:{})),{parse:r.assembleFormatParse()});(a=i.transform).push.apply(a,r.assembleTransforms(true))}else{(o=i.transform).push.apply(o,r.assembleTransforms())}}if(r instanceof hPe){if(!i.name){i.name="data_"+t++}if(!i.source||i.transform.length>0){e.push(i);r.data=i.name}else{r.data=i.source}r.assemble().forEach((function(t){return e.push(t)}));return}if(r instanceof rPe||r instanceof iPe||r instanceof eIe||r instanceof tRe||r instanceof SRe||r instanceof iIe||r instanceof rIe||r instanceof cPe||r instanceof sIe||r instanceof kPe||r instanceof bPe||r instanceof nIe||r instanceof tIe||r instanceof KLe||r instanceof uIe||r instanceof lIe||r instanceof fIe||r instanceof APe||r instanceof hIe||r instanceof cIe){i.transform.push(r.assemble())}if(r instanceof ePe||r instanceof rje||r instanceof aIe||r instanceof wPe){(u=i.transform).push.apply(u,r.assemble())}if(r instanceof nje){if(i.source&&i.transform.length===0){r.setSource(i.source)}else if(r.parent instanceof nje){r.setSource(i.name)}else{if(!i.name){i.name="data_"+t++}r.setSource(i.name);if(r.numChildren()===1){e.push(i);var l={name:null,source:i.name,transform:[]};i=l}}}switch(r.numChildren()){case 0:if(r instanceof nje&&(!i.source||i.transform.length>0)){e.push(i)}break;case 1:n(r.children[0],i);break;default:{if(!i.name){i.name="data_"+t++}var f=i.name;if(!i.source||i.transform.length>0){e.push(i)}else{f=i.source}r.children.forEach((function(e){var t={name:null,source:f,transform:[]};n(e,t)}));break}}}return n}function pIe(e){var t=[];var n=dIe(t);e.children.forEach((function(t){return n(t,{source:e.name,name:null,transform:[]})}));return t}function vIe(e,t){var n,r;var i=[];var a=dIe(i);var o=0;e.sources.forEach((function(e){if(!e.hasName()){e.dataName="source_"+o++}var t=e.assemble();a(e,t)}));i.forEach((function(e){if(e.transform.length===0){delete e.transform}}));var u=0;for(var s=0,l=i.entries();s<l.length;s++){var f=l[s],c=f[0],h=f[1];if((n=h.transform,n!==null&&n!==void 0?n:[]).length===0&&!h.source){i.splice(u++,0,i.splice(c,1)[0])}}for(var d=0,p=i;d<p.length;d++){var h=p[d];for(var v=0,g=(r=h.transform,r!==null&&r!==void 0?r:[]);v<g.length;v++){var m=g[v];if(m.type==="lookup"){m.from=e.outputNodes[m.from].getSource()}}}for(var y=0,b=i;y<b.length;y++){var h=b[y];if(h.name in t){h.values=t[h.name]}}return i}function gIe(e){if(e==="top"||e==="left"){return"header"}return"footer"}function mIe(e){for(var t=0,n=DEe;t<n.length;t++){var r=n[t];yIe(e,r)}_Ie(e,"x");_Ie(e,"y")}function yIe(e,t){var n;var r;if(e.channelHasField(t)){var i=e.facet[t];var a=FRe("title",null,e.config,t);var o=lCe(i,e.config,{allowDisabling:true,includeDefault:a===undefined||!!a});if(e.child.component.layoutHeaders[t].title){o=Cwe(o)?o.join(", "):o;o+=" / "+e.child.component.layoutHeaders[t].title;e.child.component.layoutHeaders[t].title=null}var u=FRe("labelOrient",i,e.config,t);var s=(r=i.header,r!==null&&r!==void 0?r:{});var l=Hke(s.labels,true);var f=_ke(["bottom","right"],u)?"footer":"header";e.component.layoutHeaders[t]=(n={title:o,facetFieldDef:i},n[f]=t==="facet"?[]:[bIe(e,t,l)],n)}}function bIe(e,t,n){var r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):undefined,axes:[]}}function _Ie(e,t){var n;var r=e.child;if(r.component.axes[t]){var i=e.component,a=i.layoutHeaders,o=i.resolve;o.axis[t]=QRe(o,t);if(o.axis[t]==="shared"){var u=t==="x"?"column":"row";var s=a[u];for(var l=0,f=r.component.axes[t];l<f.length;l++){var c=f[l];var h=gIe(c.get("orient"));s[h]=(n=s[h],n!==null&&n!==void 0?n:[bIe(e,u,false)]);var d=lRe(c,"main",e.config,{header:true});s[h][0].axes.push(d);c.mainExtracted=true}}}}function xIe(e){EIe(e);var t=e.component.layoutSize;t.setWithExplicit("width",MIe(e,"width"));t.setWithExplicit("height",MIe(e,"height"))}var wIe=xIe;var kIe={vconcat:"width",hconcat:"height"};function AIe(e){EIe(e);var t=e.component.layoutSize;var n=kIe[e.concatType];if(n){t.setWithExplicit(n,MIe(e,n))}}function EIe(e){for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.parseLayoutSize()}}function MIe(e,t){var n=t==="width"?"x":"y";var r=e.component.resolve;var i;for(var a=0,o=e.children;a<o.length;a++){var u=o[a];var s=u.component.layoutSize.getWithExplicit(t);var l=r.scale[n];if(l==="independent"&&s.value==="step"){i=undefined;break}if(i){if(l==="independent"&&i.value!==s.value){i=undefined;break}i=ize(i,s,t,"")}else{i=s}}if(i){for(var f=0,c=e.children;f<c.length;f++){var u=c[f];e.renameSignal(u.getName(t),e.getName(t));u.component.layoutSize.set(t,"merged",false)}return i}else{return{explicit:false,value:undefined}}}function OIe(e){var t=e.size,n=e.component;for(var r=0,i=WEe;r<i.length;r++){var a=i[r];var o=HEe(a);if(t[o]){var u=t[o];n.layoutSize.set(o,RFe(u)?"step":u,true)}else{var s=SIe(e,o);n.layoutSize.set(o,s,false)}}}function SIe(e,t){var n=t==="width"?"x":"y";var r=e.config;var i=e.getScaleComponent(n);if(i){var a=i.get("type");var o=i.get("range");if(GSe(a)){var u=WFe(r.view,t);if(aNe(o)||RFe(u)){return"step"}else{return u}}else{return UFe(r.view,t)}}else if(e.hasProjection){return UFe(r.view,t)}else{var u=WFe(r.view,t);return RFe(u)?u.step:u}}function DIe(e,t){if(TDe(e)){return jIe(e,t)}return TIe(e,t)}function CIe(e,t){return jIe(e,t)}function FIe(e,t){if(zDe(e.field)){if(e.field.repeat in t){return Object.assign(Object.assign({},e),{field:t[e.field.repeat]})}else{SOe(kOe.noSuchRepeatedValue(e.field.repeat));return undefined}}return e}function TIe(e,t){e=FIe(e,t);if(e===undefined){return undefined}else if(e===null){return null}if(LDe(e)&&CDe(e.sort)){var n=FIe(e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}function NIe(e,t){if(HDe(e)){var n=TIe(e,t);if(n){return n}else if(UDe(e)){return{condition:e.condition}}}else{if(qDe(e)){var n=TIe(e.condition,t);if(n){return Object.assign(Object.assign({},e),{condition:n})}else{var r=h(e,["condition"]);return r}}return e}return undefined}function jIe(e,t){var n={};for(var r in e){if(tke(e,r)){var i=e[r];if(Cwe(i)){n[r]=i.map((function(e){return NIe(e,t)})).filter((function(e){return e}))}else{var a=NIe(i,t);if(a!==undefined){n[r]=a}}}}return n}function RIe(e,t,n){return KDe(t,Object.assign({suffix:"by_"+KDe(e)},n!==null&&n!==void 0?n:{}))}var zIe=function(e){p(t,e);function t(t,n,r,i,a){var o=e.call(this,t,"facet",n,r,a,i,t.resolve)||this;o.child=qBe(t.spec,o,o.getName("child"),undefined,i,a);o.children=[o.child];var u=DIe(t.facet,i);o.facet=o.initFacet(u);return o}t.prototype.initFacet=function(e){if(!TDe(e)){return{facet:gCe(e,"facet")}}return ICe(e,(function(e,t,n){if(!_ke([VAe,XAe],n)){SOe(kOe.incompatibleChannel(n,"facet"));return e}if(t.field===undefined){SOe(kOe.emptyFieldDef(t,n));return e}e[n]=gCe(t,n);return e}),{})};t.prototype.channelHasField=function(e){return!!this.facet[e]};t.prototype.fieldDef=function(e){return this.facet[e]};t.prototype.parseData=function(){this.component.data=UIe(this);this.child.parseData()};t.prototype.parseLayoutSize=function(){EIe(this)};t.prototype.parseSelections=function(){this.child.parseSelections();this.component.selection=this.child.component.selection};t.prototype.parseMarkGroup=function(){this.child.parseMarkGroup()};t.prototype.parseAxesAndHeaders=function(){this.child.parseAxesAndHeaders();mIe(this)};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.child.assembleSelectionTopLevelSignals(e)};t.prototype.assembleSignals=function(){this.child.assembleSignals();return[]};t.prototype.assembleSelectionData=function(e){return this.child.assembleSelectionData(e)};t.prototype.getHeaderLayoutMixins=function(){var e,t,n,r;var i={};for(var a=0,o=DEe;a<o.length;a++){var u=o[a];for(var s=0,l=jRe;s<l.length;s++){var f=l[s];var c=this.component.layoutHeaders[u];var h=c[f];var d=c.facetFieldDef;if(d){var p=FRe("titleOrient",d,this.config,u);if(_ke(["right","bottom"],p)){var v=CRe(u,p);i.titleAnchor=(e=i.titleAnchor,e!==null&&e!==void 0?e:{});i.titleAnchor[v]="end"}}if((t=h)===null||t===void 0?void 0:t[0]){var g=u==="row"?"height":"width";var m=f==="header"?"headerBand":"footerBand";if(u!=="facet"&&!this.child.component.layoutSize.get(g)){i[m]=(n=i[m],n!==null&&n!==void 0?n:{});i[m][u]=.5}if(c.title){i.offset=(r=i.offset,r!==null&&r!==void 0?r:{});i.offset[u==="row"?"rowTitle":"columnTitle"]=10}}}}return i};t.prototype.assembleDefaultLayout=function(){var e=this.facet,t=e.column,n=e.row;var r=t?this.columnDistinctSignal():n?1:undefined;var i="all";if(!n&&this.component.resolve.scale.x==="independent"){i="none"}else if(!t&&this.component.resolve.scale.y==="independent"){i="none"}return Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})};t.prototype.assembleLayoutSignals=function(){return this.child.assembleLayoutSignals()};t.prototype.columnDistinctSignal=function(){if(this.parent&&this.parent instanceof t){return undefined}else{var e=this.getName("column_domain");return{signal:"length(data('"+e+"'))"}}};t.prototype.assembleGroup=function(n){if(this.parent&&this.parent instanceof t){return Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:KDe(this.facet.column,{prefix:"distinct"})}}}}:{}),e.prototype.assembleGroup.call(this,n))}return e.prototype.assembleGroup.call(this,n)};t.prototype.getCardinalityAggregateForChild=function(){var e=[];var n=[];var r=[];if(this.child instanceof t){if(this.child.channelHasField("column")){var i=KDe(this.child.facet.column);e.push(i);n.push("distinct");r.push("distinct_"+i)}}else{for(var a=0,o=["x","y"];a<o.length;a++){var u=o[a];var s=this.child.component.scales[u];if(s&&!s.merged){var l=s.get("type");var f=s.get("range");if(GSe(l)&&aNe(f)){var c=uLe(this.child,u);var h=oLe(c);if(h){e.push(h);n.push("distinct");r.push("distinct_"+h)}else{SOe("Unknown field for "+u+". Cannot calculate view size.")}}}}}return{fields:e,ops:n,as:r}};t.prototype.assembleFacet=function(){var e=this.component.data.facetRoot,t=e.name,n=e.data;var r=this.facet,i=r.row,a=r.column;var o=this.getCardinalityAggregateForChild(),u=o.fields,s=o.ops,l=o.as;var f=[];for(var c=0,h=DEe;c<h.length;c++){var d=h[c];var p=this.facet[d];if(p){f.push(KDe(p));var v=p.bin,g=p.sort;if(OCe(v)){f.push(KDe(p,{binSuffix:"end"}))}if(CDe(g)){var m=g.field,y=g.op,b=y===void 0?MDe:y;var _=RIe(p,g);if(i&&a){u.push(_);s.push("max");l.push(_)}else{u.push(m);s.push(b);l.push(_)}}else if(Cwe(g)){var _=DRe(p,d);u.push(_);s.push("max");l.push(_)}}}var x=!!i&&!!a;return Object.assign({name:t,data:n,groupby:f},x||u.length>0?{aggregate:Object.assign(Object.assign({},x?{cross:x}:{}),u.length?{fields:u,ops:s,as:l}:{})}:{})};t.prototype.facetSortFields=function(e){var t=this.facet;var n=t[e];if(n){if(CDe(n.sort)){return[RIe(n,n.sort,{expr:"datum"})]}else if(Cwe(n.sort)){return[DRe(n,e,{expr:"datum"})]}return[KDe(n,{expr:"datum"})]}return[]};t.prototype.facetSortOrder=function(e){var t=this.facet;var n=t[e];if(n){var r=n.sort;var i=(CDe(r)?r.order:!Cwe(r)&&r)||"ascending";return[i]}return[]};t.prototype.assembleLabelTitle=function(){var e=this,t=e.facet,n=e.config;if(t.facet){return BRe(t.facet,"facet",n)}var r={row:["top","bottom"],column:["left","right"]};for(var i=0,a=NRe;i<a.length;i++){var o=a[i];if(t[o]){var u=FRe("labelOrient",t[o],n,o);if(_ke(r[o],u)){return BRe(t[o],o,n)}}}return undefined};t.prototype.assembleMarks=function(){var e=this;var t=this.child;var n=this.component.data.facetRoot;var r=pIe(n);var i=t.assembleGroupEncodeEntry(false);var a=this.assembleLabelTitle()||t.assembleTitle();var o=t.assembleGroupStyle();var u=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:DEe.map((function(t){return e.facetSortFields(t)})).flat(),order:DEe.map((function(t){return e.facetSortOrder(t)})).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(Sje(this,[])));return[u]};t.prototype.getMapping=function(){return this.facet};return t}(QLe);function PIe(e,t){var n=t.row,r=t.column;if(n&&r){var i=null;for(var a=0,o=[n,r];a<o.length;a++){var u=o[a];if(CDe(u.sort)){var s=u.sort,l=s.field,f=s.op,c=f===void 0?MDe:f;e=i=new bPe(e,{joinaggregate:[{op:c,field:l,as:RIe(u,u.sort,{forAs:true})}],groupby:[KDe(u)]})}}return i}return null}function LIe(e,t){var n,r,i,a,o,u,s,l,f,c;for(var h=0,d=t;h<d.length;h++){var p=d[h];var v=p.data;if(e.name&&p.hasName()&&e.name!==p.dataName){continue}if(((n=e["format"])===null||n===void 0?void 0:n.mesh)&&((r=v.format)===null||r===void 0?void 0:r.feature)){continue}if((((i=e["format"])===null||i===void 0?void 0:i.feature)||((a=v.format)===null||a===void 0?void 0:a.feature))&&((o=e["format"])===null||o===void 0?void 0:o.feature)!==((u=v.format)===null||u===void 0?void 0:u.feature)){continue}if((((s=e["format"])===null||s===void 0?void 0:s.mesh)||((l=v.format)===null||l===void 0?void 0:l.mesh))&&((f=e["format"])===null||f===void 0?void 0:f.mesh)!==((c=v.format)===null||c===void 0?void 0:c.mesh)){continue}if(STe(e)&&STe(v)){if(dke(e.values,v.values)){return p}}else if(OTe(e)&&OTe(v)){if(e.url===v.url){return p}}else if(DTe(e)){if(e.name===p.dataName){return p}}}return null}function IIe(e,t){if(e.data||!e.parent){if(e.data===null){var n=new tPe([]);t.push(n);return n}var r=LIe(e.data,t);if(r){if(!CTe(e.data)){r.data.format=kke({},e.data.format,r.data.format)}if(!r.hasName()&&e.data.name){r.dataName=e.data.name}return r}else{var i=new tPe(e.data);t.push(i);return i}}else{return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}}function BIe(e,t,n){var r;var i,a;var o=0;for(var u=0,s=t.transforms;u<s.length;u++){var l=s[u];var f=undefined;var c=void 0;if(JTe(l)){c=e=new SRe(e,l);f="derived"}else if(zTe(l)){var h=vPe(l);c=e=(i=yPe.makeWithAncestors(e,{},h,n),i!==null&&i!==void 0?i:e);e=new tRe(e,t,l.filter)}else if(ZTe(l)){c=e=ePe.makeFromTransform(e,l,t);f="number"}else if(KTe(l)){f="date";var d=n.getWithExplicit(l.field);if(d.value===undefined){e=new yPe(e,(r={},r[l.field]=f,r));n.set(l.field,f,false)}c=e=rje.makeFromTransform(e,l)}else if(eNe(l)){c=e=cPe.makeFromTransform(e,l);f="number";if(Zje(t)){e=new APe(e)}}else if(LTe(l)){c=e=sIe.make(e,t,l,o++);f="derived"}else if(YTe(l)){c=e=new kPe(e,l);f="number"}else if(VTe(l)){c=e=new bPe(e,l);f="number"}else if(tNe(l)){c=e=wPe.makeFromTransform(e,l);f="derived"}else if(nNe(l)){c=e=new nIe(e,l);f="derived"}else if(XTe(l)){c=e=new tIe(e,l);f="derived"}else if(UTe(l)){c=e=new cIe(e,l);f="derived"}else if($Te(l)){e=new hIe(e,l)}else if(QTe(l)){c=e=aIe.makeFromTransform(e,l);f="derived"}else if(qTe(l)){c=e=new KLe(e,l);f="derived"}else if(WTe(l)){c=e=new lIe(e,l);f="derived"}else if(HTe(l)){c=e=new fIe(e,l);f="derived"}else if(GTe(l)){c=e=new uIe(e,l);f="derived"}else{SOe(kOe.invalidTransformIgnored(l));continue}if(c&&f!==undefined){for(var p=0,v=(a=c.producedFields(),a!==null&&a!==void 0?a:[]);p<v.length;p++){var g=v[p];n.set(g,f,false)}}}return e}function UIe(e){var t,n,r,i,a,o,u,s,l,f,c;var h=IIe(e,e.component.data.sources);var d=e.component.data,p=d.outputNodes,v=d.outputNodeRefCounts;var g=e.parent?e.parent.component.data.ancestorParse.clone():new oIe;var m=e.data;if(CTe(m)){if(FTe(m)){h=new iPe(h,m.sequence)}else if(NTe(m)){h=new rPe(h,m.graticule)}g.parseNothing=true}else if(((n=(t=m)===null||t===void 0?void 0:t.format)===null||n===void 0?void 0:n.parse)===null){g.parseNothing=true}h=(r=yPe.makeExplicit(h,e,g),r!==null&&r!==void 0?r:h);h=new APe(h);var y=e.parent&&JLe(e.parent);if($Le(e)||YLe(e)){if(y){h=(i=ePe.makeFromEncoding(h,e),i!==null&&i!==void 0?i:h)}}if(e.transforms.length>0){h=BIe(h,e,g)}var b=mPe(e);var _=gPe(e);h=(a=yPe.makeWithAncestors(h,{},Object.assign(Object.assign({},b),_),g),a!==null&&a!==void 0?a:h);if($Le(e)){h=rIe.parseAll(h,e);h=iIe.parseAll(h,e)}if($Le(e)||YLe(e)){if(!y){h=(o=ePe.makeFromEncoding(h,e),o!==null&&o!==void 0?o:h)}h=(u=rje.makeFromEncoding(h,e),u!==null&&u!==void 0?u:h);h=SRe.parseAllForSortIndex(h,e)}var x=e.getName(RTe);var w=new nje(h,x,RTe,v);p[x]=w;h=w;if($Le(e)){var k=cPe.makeFromEncoding(h,e);if(k){h=k;if(Zje(e)){h=new APe(h)}}h=(s=aIe.makeFromEncoding(h,e),s!==null&&s!==void 0?s:h);h=(l=wPe.makeFromEncoding(h,e),l!==null&&l!==void 0?l:h)}if($Le(e)){h=(f=eIe.make(h,e),f!==null&&f!==void 0?f:h)}var A=e.getName(jTe);var E=new nje(h,A,jTe,v);p[A]=E;h=E;if($Le(e)){aRe(e,E)}var M=null;if(YLe(e)){var O=e.getName("facet");h=SRe.parseAllForSortIndex(h,e);h=(c=PIe(h,e.facet),c!==null&&c!==void 0?c:h);M=new hPe(h,e,O,E.getSource());p[O]=M;h=M}return Object.assign(Object.assign({},e.component.data),{outputNodes:p,outputNodeRefCounts:v,raw:w,main:E,facetRoot:M,ancestorParse:g})}var qIe=function(e){p(t,e);function t(t,n,r,i,a,o,u){return e.call(this,t,n,r,i,a,o,u)||this}t.prototype.parseData=function(){this.component.data=UIe(this);this.children.forEach((function(e){e.parseData()}))};t.prototype.parseSelections=function(){var e=this;this.component.selection={};var t=function(t){t.parseSelections();Cke(t.component.selection).forEach((function(n){e.component.selection[n]=t.component.selection[n]}))};for(var n=0,r=this.children;n<r.length;n++){var i=r[n];t(i)}};t.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseMarkGroup()}};t.prototype.parseAxesAndHeaders=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseAxesAndHeaders()}};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)};t.prototype.assembleSignals=function(){this.children.forEach((function(e){return e.assembleSignals()}));return[]};t.prototype.assembleLayoutSignals=function(){return this.children.reduce((function(e,t){return __spreadArrays(e,t.assembleLayoutSignals())}),$Re(this))};t.prototype.assembleSelectionData=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)};t.prototype.assembleMarks=function(){return this.children.map((function(e){var t=e.assembleTitle();var n=e.assembleGroupStyle();var r=e.assembleGroupEncodeEntry(false);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),e.assembleGroup())}))};return t}(ZLe);var WIe=function(e){p(t,e);function t(t,n,r,i,a){var o=this;var u,s,l,f;o=e.call(this,t,"concat",n,r,a,i,t.resolve)||this;if(((s=(u=t.resolve)===null||u===void 0?void 0:u.axis)===null||s===void 0?void 0:s.x)==="shared"||((f=(l=t.resolve)===null||l===void 0?void 0:l.axis)===null||f===void 0?void 0:f.y)==="shared"){SOe(kOe.CONCAT_CANNOT_SHARE_AXIS)}o.concatType=TFe(t)?"vconcat":NFe(t)?"hconcat":"concat";o.children=o.getChildren(t).map((function(e,t){return qBe(e,o,o.getName("concat_"+t),undefined,i,a)}));return o}t.prototype.getChildren=function(e){if(TFe(e)){return e.vconcat}else if(NFe(e)){return e.hconcat}return e.concat};t.prototype.parseLayoutSize=function(){AIe(this)};t.prototype.parseAxisGroup=function(){return null};t.prototype.assembleDefaultLayout=function(){return Object.assign(Object.assign({},this.concatType==="vconcat"?{columns:1}:{}),{bounds:"full",align:"each"})};return t}(qIe);function HIe(e){return e===false||e===null}var GIe=Object.assign(Object.assign({gridScale:1,scale:1},tAe),{labelExpr:1,encode:1});var $Ie=Cke(GIe);var YIe=function(e){p(t,e);function t(t,n,r){if(t===void 0){t={}}if(n===void 0){n={}}if(r===void 0){r=false}var i=e.call(this)||this;i.explicit=t;i.implicit=n;i.mainExtracted=r;return i}t.prototype.clone=function(){return new t(pke(this.explicit),pke(this.implicit),this.mainExtracted)};t.prototype.hasAxisPart=function(e){if(e==="axis"){return true}if(e==="grid"||e==="title"){return!!this.get(e)}return!HIe(this.get(e))};return t}(KRe);function VIe(e,t,n){var r,i;var a=(r=e.fieldDef(t),r!==null&&r!==void 0?r:t==="x"?e.fieldDef("x2"):t==="y"?e.fieldDef("y2"):undefined);var o=e.axis(t);var u={};if(xCe(a)){var s=e.getScaleComponent(t).get("type")===FSe.UTC;var l=xDe("datum.value",(i=oSe(a.timeUnit))===null||i===void 0?void 0:i.unit,o.format,null,s);if(l){u.text={signal:l}}}u=Object.assign(Object.assign({},u),n);return Cke(u).length===0?undefined:u}function XIe(e){return WEe.reduce((function(t,n){if(e.component.scales[n]&&e.axis(n)){t[n]=[nBe(n,e)]}return t}),{})}var JIe={bottom:"top",top:"bottom",left:"right",right:"left"};function ZIe(e){var t;var n=e.component,r=n.axes,i=n.resolve;var a={top:0,bottom:0,right:0,left:0};for(var o=0,u=e.children;o<u.length;o++){var s=u[o];s.parseAxesAndHeaders();for(var l=0,f=Cke(s.component.axes);l<f.length;l++){var c=f[l];i.axis[c]=QRe(e.component.resolve,c);if(i.axis[c]==="shared"){r[c]=QIe(r[c],s.component.axes[c]);if(!r[c]){i.axis[c]="independent";delete r[c]}}}}for(var h=0,d=[ZAe,QAe];h<d.length;h++){var c=d[h];for(var p=0,v=e.children;p<v.length;p++){var s=v[p];if(!s.component.axes[c]){continue}if(i.axis[c]==="independent"){r[c]=(t=r[c],t!==null&&t!==void 0?t:[]).concat(s.component.axes[c]);for(var g=0,m=s.component.axes[c];g<m.length;g++){var y=m[g];var b=y.getWithExplicit("orient"),_=b.value,x=b.explicit;if(a[_]>0&&!x){var w=JIe[_];if(a[_]>a[w]){y.set("orient",w,false)}}a[_]++}}delete s.component.axes[c]}if(i.axis[c]==="independent"&&r[c]&&r[c].length>1){for(var k=0,A=r[c];k<A.length;k++){var E=A[k];if(!!E.get("grid")&&!E.explicit.grid){E.implicit.grid=false}}}}}function QIe(e,t){if(e){if(e.length!==t.length){return undefined}var n=e.length;for(var r=0;r<n;r++){var i=e[r];var a=t[r];if(!!i!==!!a){return undefined}else if(i&&a){var o=i.getWithExplicit("orient");var u=a.getWithExplicit("orient");if(o.explicit&&u.explicit&&o.value!==u.value){return undefined}else{e[r]=KIe(i,a)}}}}else{return t.map((function(e){return e.clone()}))}return e}function KIe(e,t){var n=function(n){var r=ize(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(function(e,t){switch(n){case"title":return EDe(e,t);case"gridScale":return{explicit:e.explicit,value:Hke(e.value,t.value)}}return rze(e,t,n,"axis")}));e.setWithExplicit(n,r)};for(var r=0,i=$Ie;r<i.length;r++){var a=i[r];n(a)}return e}function eBe(e,t){var n=t==="x"?"x2":"y2";var r=e.fieldDef(t);var i=e.fieldDef(n);var a=r?r.title:undefined;var o=i?i.title:undefined;if(a&&o){return ADe(a,o)}else if(a){return a}else if(o){return o}else if(a!==undefined){return a}else if(o!==undefined){return o}return undefined}function tBe(e,t,n,r,i){switch(t){case"titleAngle":case"labelAngle":return e===Xke(n[t]);case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===eBe(r,i)){return true}}return e===n[t]}function nBe(e,t){var n;var r=t.axis(e);var i=new YIe;for(var a=0,o=$Ie;a<o.length;a++){var u=o[a];var s=rBe(u,r,e,t);var l=gRe(u,t.config,e,i.get("orient"),t.getScaleComponent(e).get("type"));if(s!==undefined){var f=tBe(s,u,r,t,e);if(f||l===undefined){i.set(u,s,f)}else if(_ke(["grid","orient"],u)&&l){i.set(u,l,false)}}else if(Qke(l)){i.set(u,l,false)}}var c=(n=r.encoding,n!==null&&n!==void 0?n:{});var h=Kke.reduce((function(n,r){var a;if(!i.hasAxisPart(r)){return n}var o=JRe((a=c[r],a!==null&&a!==void 0?a:{}),t);var u=r==="labels"?VIe(t,e,o):o;if(u!==undefined&&Cke(u).length>0){n[r]={update:u}}return n}),{});if(Cke(h).length>0){i.set("encode",h,!!r.encoding||r.labelAngle!==undefined)}return i}function rBe(e,t,n,r){var i=r.fieldDef(n);var a=bRe(r,t,n,i);var o=Hke(t.orient,ARe(n));var u=r.mark,s=r.config;switch(e){case"scale":return r.scaleName(n);case"gridScale":return yRe(r,n);case"format":if(xCe(i)){return undefined}return mDe(i,t.format,s);case"formatType":if(xCe(i)){return undefined}return t.formatType;case"grid":{if(SCe(r.fieldDef(n).bin)){return false}else{var l=r.getScaleComponent(n).get("type");return Hke(t.grid,mRe(l,i))}}case"labelAlign":return Hke(t.labelAlign,xRe(a,o));case"labelAngle":return a;case"labelBaseline":return Hke(t.labelBaseline,_Re(a,o));case"labelFlush":return Hke(t.labelFlush,wRe(i,n));case"labelOverlap":{var f=r.getScaleComponent(n).get("type");return Hke(t.labelOverlap,kRe(i,f))}case"orient":return o;case"tickCount":{var c=r.getScaleComponent(n).get("type");var h=n==="x"?"width":n==="y"?"height":undefined;var d=h?r.getSizeSignalRef(h):undefined;return Hke(t.tickCount,ERe({fieldDef:i,scaleType:c,size:d}))}case"title":{var p=n==="x"?"x2":"y2";var v=r.fieldDef(p);return Hke(t.title,eBe(r,n),kDe([PDe(i)],v?[PDe(v)]:[]))}case"values":return MRe(t,r,i);case"zindex":return Hke(t.zindex,ORe(u,i))}return rAe(e)?t[e]:undefined}function iBe(e){var t=e.encoding,n=e.size;for(var r=0,i=WEe;r<i.length;r++){var a=i[r];var o=HEe(a);var u=pCe(t[a]);if(RFe(n[o])){if(u){if(tCe(u)){delete n[o];SOe(kOe.stepDropped(o))}}}}return n}function aBe(e,t,n,r){var i=r.graticule;var a,o,u;var s=xAe(e)?Object.assign({},e):{type:e};var l=(a=s.orient,a!==null&&a!==void 0?a:pDe("orient",s,n));s.orient=lBe(s.type,t,l);if(l!==undefined&&l!==s.orient){SOe(kOe.orientOverridden(s.orient,l))}if(s.type==="bar"&&s.orient){var f=(o=s.cornerRadiusEnd,o!==null&&o!==void 0?o:pDe("cornerRadiusEnd",s,n));if(f!==undefined){var c=DAe[s.orient];for(var h=0,d=c;h<d.length;h++){var p=d[h];s[p]=f}if(s.cornerRadiusEnd!==undefined){delete s.cornerRadiusEnd}}}var v=Hke(s.opacity,pDe("opacity",s,n));if(v===undefined){s.opacity=uBe(s.type,t)}var g=s.filled;if(g===undefined){s.filled=i?false:sBe(s,n)}var m=(u=s.cursor,u!==null&&u!==void 0?u:pDe("cursor",s,n));if(m===undefined){s.cursor=oBe(s,t,n)}return s}function oBe(e,t,n){if(t.href||e.href||pDe("href",e,n)){return"pointer"}return e.cursor}function uBe(e,t){if(_ke([sAe,hAe,pAe,vAe],e)){if(!NCe(t)){return.7}}return undefined}function sBe(e,t){var n=pDe("filled",e,t);var r=e.type;return Hke(n,r!==sAe&&r!==uAe&&r!==fAe)}function lBe(e,t,n){switch(e){case sAe:case pAe:case vAe:case cAe:case lAe:case oAe:return undefined}var r=t.x,i=t.y,a=t.x2,o=t.y2;switch(e){case aAe:if(HDe(r)&&(SCe(r.bin)||HDe(i)&&i.aggregate&&!r.aggregate)){return"vertical"}if(HDe(i)&&(SCe(i.bin)||HDe(r)&&r.aggregate&&!i.aggregate)){return"horizontal"}if(o||a){if(n){return n}if(!a&&HDe(r)&&r.type===ESe&&!OCe(r.bin)){return"horizontal"}if(!o&&HDe(i)&&i.type===ESe&&!OCe(i.bin)){return"vertical"}}case fAe:if(a&&o){return undefined}case iAe:if(o){if(HDe(i)&&SCe(i.bin)){return"horizontal"}else{return"vertical"}}else if(a){if(HDe(r)&&SCe(r.bin)){return"vertical"}else{return"horizontal"}}else if(e===fAe){if(r&&!i){return"vertical"}else if(i&&!r){return"horizontal"}}case uAe:case hAe:{var u=HDe(r)&&tCe(r);var s=HDe(i)&&tCe(i);if(u&&!s){return e!=="tick"?"horizontal":"vertical"}else if(!u&&s){return e!=="tick"?"vertical":"horizontal"}else if(u&&s){var l=r;var f=i;var c=l.type===OSe;var h=f.type===OSe;if(c&&!h){return e!=="tick"?"vertical":"horizontal"}else if(!c&&h){return e!=="tick"?"horizontal":"vertical"}if(!l.aggregate&&f.aggregate){return e!=="tick"?"vertical":"horizontal"}else if(l.aggregate&&!f.aggregate){return e!=="tick"?"horizontal":"vertical"}if(n){return n}return"vertical"}else{if(n){return n}return undefined}}}return"vertical"}var fBe={vgMark:"area",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},$Ne(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore"})),jNe("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),jNe("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),JNe(e))}};var cBe={vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},$Ne(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),INe(e,"x","bar")),INe(e,"y","bar"))}};var hBe={vgMark:"shape",encodeEntry:function(e){return Object.assign({},$Ne(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding;var n=t.shape;var r=Object.assign({type:"geoshape",projection:e.projectionName()},n&&HDe(n)&&n.type===DSe?{field:KDe(n,{expr:"datum"})}:{});return[r]}};var dBe={vgMark:"image",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},$Ne(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore"})),INe(e,"x","image")),INe(e,"y","image")),kNe(e,"url"))}};var pBe={vgMark:"line",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$Ne(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore"})),SNe("x",e,{defaultPos:"mid"})),SNe("y",e,{defaultPos:"mid"})),xNe("size",e,{vgChannel:"strokeWidth"})),JNe(e))}};var vBe={vgMark:"trail",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$Ne(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore"})),SNe("x",e,{defaultPos:"mid"})),SNe("y",e,{defaultPos:"mid"})),xNe("size",e)),JNe(e))}};function gBe(e,t){var n=e.config;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$Ne(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore"})),SNe("x",e,{defaultPos:"mid"})),SNe("y",e,{defaultPos:"mid"})),xNe("size",e)),mBe(e,n,t))}function mBe(e,t,n){if(n){return{shape:{value:n}}}return xNe("shape",e)}var yBe={vgMark:"symbol",encodeEntry:function(e){return gBe(e)}};var bBe={vgMark:"symbol",encodeEntry:function(e){return gBe(e,"circle")}};var _Be={vgMark:"symbol",encodeEntry:function(e){return gBe(e,"square")}};var xBe={vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},$Ne(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),INe(e,"x","rect")),INe(e,"y","rect"))}};var wBe={vgMark:"rule",encodeEntry:function(e){var t=e.markDef;var n=t.orient;if(!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude){return{}}return Object.assign(Object.assign(Object.assign(Object.assign({},$Ne(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),jNe("x",e,{defaultPos:n==="horizontal"?"zeroOrMin":"mid",defaultPos2:"zeroOrMax",range:n!=="vertical"})),jNe("y",e,{defaultPos:n==="vertical"?"zeroOrMin":"mid",defaultPos2:"zeroOrMax",range:n!=="horizontal"})),xNe("size",e,{vgChannel:"strokeWidth"}))}};var kBe={vgMark:"text",encodeEntry:function(e){var t=e.config,n=e.encoding;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$Ne(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore"})),SNe("x",e,{defaultPos:"mid"})),SNe("y",e,{defaultPos:"mid"})),kNe(e)),xNe("size",e,{vgChannel:"fontSize"})),QNe("align",ABe(e.markDef,n,t))),QNe("baseline",EBe(e.markDef,n,t)))}};function ABe(e,t,n){var r;var i=(r=e.align,r!==null&&r!==void 0?r:pDe("align",e,n));if(i===undefined){return"center"}return undefined}function EBe(e,t,n){var r;var i=(r=e.baseline,r!==null&&r!==void 0?r:pDe("baseline",e,n));if(i===undefined){return"middle"}return undefined}var MBe={vgMark:"rect",encodeEntry:function(e){var t;var n=e.config,r=e.markDef;var i=r.orient;var a=i==="horizontal"?"width":"height";var o=i==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$Ne(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),SNe("x",e,{defaultPos:"mid",vgChannel:"xc"})),SNe("y",e,{defaultPos:"mid",vgChannel:"yc"})),xNe("size",e,{defaultValue:OBe(e),vgChannel:a})),(t={},t[o]={value:Hke(r.thickness,n.tick.thickness)},t))}};function OBe(e){var t=e.config,n=e.markDef;var r=n.orient;var i=r==="horizontal"?"width":"height";var a=e.getScaleComponent(r==="horizontal"?"x":"y");var o=Hke(n[i],n.size,pDe("size",n,t,{vgChannel:i}),t.tick.bandSize);if(o!==undefined){return o}else{var u=a?a.get("range"):undefined;if(u&&aNe(u)&&rke(u.step)){return u.step*3/4}var s=qFe(t.view,i);return s*3/4}}var SBe={area:fBe,bar:cBe,circle:bBe,geoshape:hBe,image:dBe,line:pBe,point:yBe,rect:xBe,rule:wBe,square:_Be,text:kBe,tick:MBe,trail:vBe};function DBe(e){if(_ke([uAe,iAe,dAe],e.mark)){return FBe(e)}else if(_ke([aAe],e.mark)){return NBe(e)}else{return RBe(e)}}var CBe="faceted_path_";function FBe(e){var t=BCe(e.mark,e.encoding);var n=RBe(e,{fromPrefix:t.length>0?CBe:""});if(t.length>0){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:CBe+e.requestDataName(jTe),data:e.requestDataName(jTe),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]}else{return n}}var TBe="stack_group_";function NBe(e){var t,n;var r=cNe.some((function(t){return e.markDef[t]||pDe(t,e.markDef,e.config)}));if(e.stack&&!e.fieldDef("size")&&r){var i=RBe(e,{fromPrefix:TBe})[0];var a=e.scaleName(e.stack.fieldChannel);var o=function(t){if(t===void 0){t={}}return e.vgField(e.stack.fieldChannel,t)};var u=function(e,t){var n=[o({prefix:"min",suffix:"start",expr:t}),o({prefix:"max",suffix:"start",expr:t}),o({prefix:"min",suffix:"end",expr:t}),o({prefix:"max",suffix:"end",expr:t})];return e+"("+n.map((function(e){return"scale('"+a+"',"+e+")"})).join(",")+")"};var s=void 0;var l=void 0;if(e.stack.fieldChannel==="x"){s=Object.assign(Object.assign({},vke(i.encode.update,__spreadArrays(["y","yc","y2","height"],cNe))),{x:{signal:u("min","datum")},x2:{signal:u("max","datum")},clip:{value:true}});l={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}};i.encode.update=Object.assign(Object.assign({},gke(i.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})}else{s=Object.assign(Object.assign({},vke(i.encode.update,["x","xc","x2","width"])),{y:{signal:u("min","datum")},y2:{signal:u("max","datum")},clip:{value:true}});l={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}};i.encode.update=Object.assign(Object.assign({},gke(i.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}})}for(var f=0,c=cNe;f<c.length;f++){var h=c[f];var d=pDe(h,e.markDef,e.config);if(i.encode.update[h]){s[h]=i.encode.update[h];delete i.encode.update[h]}else if(d){s[h]={value:d}}if(d){i.encode.update[h]={value:0}}}var p=e.fieldDef(e.stack.groupbyChannel);var v=KDe(p)?[KDe(p)]:[];if(((t=p)===null||t===void 0?void 0:t.bin)||((n=p)===null||n===void 0?void 0:n.timeUnit)){v.push(KDe(p,{binSuffix:"end"}))}var g=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"];s=g.reduce((function(t,n){var r,a;if(i.encode.update[n]){return Object.assign(Object.assign({},t),(r={},r[n]=i.encode.update[n],r))}else{var o=pDe(n,e.markDef,e.config);if(o!==undefined){return Object.assign(Object.assign({},t),(a={},a[n]={value:o},a))}else{return t}}}),s);if(s.stroke){s.strokeForeground={value:true};s.strokeOffset={value:0}}return[{type:"group",from:{facet:{data:e.requestDataName(jTe),name:TBe+e.requestDataName(jTe),groupby:v,aggregate:{fields:[o({suffix:"start"}),o({suffix:"start"}),o({suffix:"end"}),o({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:s},marks:[{type:"group",encode:{update:l},marks:[i]}]}]}else{return RBe(e)}}function jBe(e){var t=e.encoding,n=e.stack,r=e.mark,i=e.markDef,a=e.config;var o=t.order;if(!Cwe(o)&&YDe(o)&&bke(o.value)||!o&&bke(i.order)||bke(pDe("order",i,a))){return undefined}else if((Cwe(o)||HDe(o))&&!n){return wDe(o,{expr:"datum"})}else if(yAe(r)){var u=i.orient==="horizontal"?"y":"x";var s=t[u];if(HDe(s)){var l=s.sort;if(Cwe(l)){return{field:KDe(s,{prefix:u,suffix:"sort_index",expr:"datum"})}}else if(CDe(l)){return{field:KDe({aggregate:NCe(e.encoding)?l.op:undefined,field:l.field},{expr:"datum"})}}else if(DDe(l)){var f=e.fieldDef(l.encoding);return{field:KDe(f,{expr:"datum"}),order:l.order}}else{return{field:KDe(s,{binSuffix:e.stack&&e.stack.impute?"mid":undefined,expr:"datum"})}}}return undefined}return undefined}function RBe(e,t){if(t===void 0){t={fromPrefix:""}}var n=e.mark;var r=Hke(e.markDef.clip,zBe(e),PBe(e));var i=hDe(e.markDef);var a=e.encoding.key;var o=jBe(e);var u=LBe(e);var s=SBe[n].postEncodingTransform?SBe[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:SBe[n].vgMark},r?{clip:true}:{}),i?{style:i}:{}),a?{key:a.field}:{}),o?{sort:o}:{}),u?u:{}),{from:{data:t.fromPrefix+e.requestDataName(jTe)},encode:{update:SBe[n].encodeEntry(e)}}),s?{transform:s}:{})]}function zBe(e){var t=e.getScaleComponent("x");var n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?true:undefined}function PBe(e){var t=e.component.projection;return t&&!t.isFit?true:undefined}function LBe(e){if(!e.component.selection)return null;var t=Cke(e.component.selection).length;var n=t;var r=e.parent;while(r&&n===0){n=Cke(r.component.selection).length;r=r.parent}return n?{interactive:t>0}:null}var IBe=function(e){p(t,e);function t(t,n,r,i,a,o){if(i===void 0){i={}}var u=this;var s;u=e.call(this,t,"unit",n,r,o,a,undefined,zFe(t)?t.view:undefined)||this;u.specifiedScales={};u.specifiedAxes={};u.specifiedLegends={};u.specifiedProjection={};u.selection={};u.children=[];var l=xAe(t.mark)?t.mark.type:t.mark;var f=CIe((s=t.encoding,s!==null&&s!==void 0?s:{}),a);u.markDef=aBe(t.mark,f,o,{graticule:t.data&&NTe(t.data)});var c=u.encoding=zCe(f,u.markDef);u.size=iBe({encoding:c,size:zFe(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i});u.stack=uTe(l,c);u.specifiedScales=u.initScales(l,c);u.specifiedAxes=u.initAxes(c);u.specifiedLegends=u.initLegend(c);u.specifiedProjection=t.projection;u.selection=t.selection;return u}Object.defineProperty(t.prototype,"hasProjection",{get:function(){var e=this.encoding;var t=this.mark===gAe;var n=e&&EEe.some((function(t){return HDe(e[t])}));return t||n},enumerable:true,configurable:true});t.prototype.scaleDomain=function(e){var t=this.specifiedScales[e];return t?t.domain:undefined};t.prototype.axis=function(e){return this.specifiedAxes[e]};t.prototype.legend=function(e){return this.specifiedLegends[e]};t.prototype.initScales=function(e,t){return ZEe.reduce((function(e,n){var r;var i;var a=t[n];if(HDe(a)){r=a;i=a.scale}else if(qDe(a)){r=a.condition;i=a.condition["scale"]}if(r){e[n]=i!==null&&i!==void 0?i:{}}return e}),{})};t.prototype.initAxes=function(e){return[ZAe,QAe].reduce((function(t,n){var r=e[n];if(HDe(r)||n===ZAe&&HDe(e.x2)||n===QAe&&HDe(e.y2)){var i=HDe(r)?r.axis:null;if(i!==null){t[n]=Object.assign({},i)}}return t}),{})};t.prototype.initLegend=function(e){return YEe.reduce((function(t,n){var r=e[n];if(r){var i=HDe(r)?r.legend:qDe(r)?r.condition["legend"]:null;if(i!==null&&i!==false&&XEe(n)){t[n]=Object.assign({},i)}}return t}),{})};t.prototype.parseData=function(){this.component.data=UIe(this)};t.prototype.parseLayoutSize=function(){OIe(this)};t.prototype.parseSelections=function(){this.component.selection=nRe(this,this.selection)};t.prototype.parseMarkGroup=function(){this.component.mark=DBe(this)};t.prototype.parseAxesAndHeaders=function(){this.component.axes=XIe(this)};t.prototype.assembleSelectionTopLevelSignals=function(e){return Dje(this,e)};t.prototype.assembleSignals=function(){return __spreadArrays(fRe(this),Oje(this,[]))};t.prototype.assembleSelectionData=function(e){return Cje(this,e)};t.prototype.assembleLayout=function(){return null};t.prototype.assembleLayoutSignals=function(){return $Re(this)};t.prototype.assembleMarks=function(){var e;var t=(e=this.component.mark,e!==null&&e!==void 0?e:[]);if(!this.parent||!JLe(this.parent)){t=Fje(this,t)}return t.map(this.correctDataNames)};t.prototype.getMapping=function(){return this.encoding};Object.defineProperty(t.prototype,"mark",{get:function(){return this.markDef.type},enumerable:true,configurable:true});t.prototype.channelHasField=function(e){return TCe(this.encoding,e)};t.prototype.fieldDef=function(e){var t=this.encoding[e];return vCe(t)};return t}(QLe);var BBe=function(e){p(t,e);function t(n,r,i,a,o,u){var s=e.call(this,n,"layer",r,i,u,o,n.resolve,n.view)||this;var l=Object.assign(Object.assign(Object.assign({},a),n.width?{width:n.width}:{}),n.height?{height:n.height}:{});s.children=n.layer.map((function(e,n){if(eTe(e)){return new t(e,s,s.getName("layer_"+n),l,o,u)}else if(RAe(e)){return new IBe(e,s,s.getName("layer_"+n),l,o,u)}throw new Error(kOe.invalidSpec(e))}));return s}t.prototype.parseData=function(){this.component.data=UIe(this);for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseData()}};t.prototype.parseLayoutSize=function(){xIe(this)};t.prototype.parseSelections=function(){var e=this;this.component.selection={};var t=function(t){t.parseSelections();Cke(t.component.selection).forEach((function(n){e.component.selection[n]=t.component.selection[n]}))};for(var n=0,r=this.children;n<r.length;n++){var i=r[n];t(i)}};t.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseMarkGroup()}};t.prototype.parseAxesAndHeaders=function(){ZIe(this)};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)};t.prototype.assembleSignals=function(){return this.children.reduce((function(e,t){return e.concat(t.assembleSignals())}),fRe(this))};t.prototype.assembleLayoutSignals=function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLayoutSignals())}),$Re(this))};t.prototype.assembleSelectionData=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)};t.prototype.assembleTitle=function(){var t=e.prototype.assembleTitle.call(this);if(t){return t}for(var n=0,r=this.children;n<r.length;n++){var i=r[n];t=i.assembleTitle();if(t){return t}}return undefined};t.prototype.assembleLayout=function(){return null};t.prototype.assembleMarks=function(){return Tje(this,this.children.flatMap((function(e){return e.assembleMarks()})))};t.prototype.assembleLegends=function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLegends())}),Pze(this))};return t}(ZLe);var UBe=function(e){p(t,e);function t(t,n,r,i,a){var o=e.call(this,t,"repeat",n,r,a,i,t.resolve)||this;if(t.resolve&&t.resolve.axis&&(t.resolve.axis.x==="shared"||t.resolve.axis.y==="shared")){SOe(kOe.REPEAT_CANNOT_SHARE_AXIS)}o.repeat=t.repeat;o.children=o._initChildren(t,o.repeat,i,a);return o}t.prototype._initChildren=function(e,t,n,r){var i=[];var a=!Cwe(t)&&t.row||[n?n.row:null];var o=!Cwe(t)&&t.column||[n?n.column:null];var u=Cwe(t)&&t||[n?n.repeat:null];for(var s=0,l=u;s<l.length;s++){var f=l[s];for(var c=0,h=a;c<h.length;c++){var d=h[c];for(var p=0,v=o;p<v.length;p++){var g=v[p];var m=(f?"__repeat_repeat_"+f:"")+(d?"__repeat_row_"+d:"")+(g?"__repeat_column_"+g:"");var y={repeat:f,row:d,column:g};i.push(qBe(e.spec,this,this.getName("child"+m),undefined,y,r))}}}return i};t.prototype.parseLayoutSize=function(){wIe(this)};t.prototype.assembleDefaultLayout=function(){var e=this.repeat;var t=Cwe(e)?undefined:e.column?e.column.length:1;return Object.assign(Object.assign({},t?{columns:t}:{}),{bounds:"full",align:"all"})};return t}(qIe);function qBe(e,t,n,r,i,a){if(jDe(e)){return new zIe(e,t,n,i,a)}else if(eTe(e)){return new BBe(e,t,n,r,i,a)}else if(RAe(e)){return new IBe(e,t,n,r,i,a)}else if(jFe(e)){return new UBe(e,t,n,i,a)}else if(CFe(e)){return new WIe(e,t,n,i,a)}throw new Error(kOe.invalidSpec(e))}function WBe(e,t){if(t===void 0){t={}}if(t.logger){MOe(t.logger)}if(t.fieldTitle){uCe(t.fieldTitle)}try{var n=YFe(Xwe({},t.config,e.config));var r=yTe(e,n);var i=qBe(r,null,"",undefined,undefined,n);i.parse();GPe(i.component.data,i);var a=GBe(i,HBe(e,r.autosize,n,i),e.datasets,e.usermeta);return{spec:a,normalized:r}}finally{if(t.logger){OOe()}if(t.fieldTitle){sCe()}}}function HBe(e,t,n,r){var i=r.component.layoutSize.get("width");var a=r.component.layoutSize.get("height");if(t===undefined){t={type:"pad"}}else if(Twe(t)){t={type:t}}if(i&&a&&kTe(t.type)){if(i==="step"&&a==="step"){SOe(kOe.droppingFit());t.type="pad"}else if(i==="step"||a==="step"){var o=i==="step"?"width":"height";SOe(kOe.droppingFit(GEe(o)));var u=o==="width"?"height":"width";t.type=ATe(u)}}return Object.assign(Object.assign(Object.assign({},Cke(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),MTe(n)),MTe(e))}function GBe(e,t,n,r){if(n===void 0){n={}}var i=e.config?ZFe(e.config):undefined;var a=[].concat(e.assembleSelectionData([]),vIe(e.component.data,n));var o=e.assembleProjections();var u=e.assembleTitle();var s=e.assembleGroupStyle();var l=e.assembleGroupEncodeEntry(true);var f=e.assembleLayoutSignals();f=f.filter((function(e){if((e.name==="width"||e.name==="height")&&e.value!==undefined){t[e.name]=+e.value;return false}return true}));return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),u?{title:u}:{}),s?{style:s}:{}),l?{encode:{update:l}}:{}),{data:a}),o.length>0?{projections:o}:{}),e.assembleGroup(__spreadArrays(f,e.assembleSelectionTopLevelSignals([])))),i?{config:i}:{}),r?{usermeta:r}:{})}var $Be=function(e){p(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.mapUnit=function(e,t){var n=t.config;if(e.encoding){var r=e.encoding,i=e.transform;var a=jCe(r,n),o=a.bins,u=a.timeUnits,s=a.aggregate,l=a.groupby,f=a.encoding;var c=__spreadArrays(i?i:[],o,u,s.length===0?[]:[{aggregate:s,groupby:l}]);return Object.assign(Object.assign(Object.assign({},e),c.length>0?{transform:c}:{}),{encoding:f})}else{return e}};return t}(tTe);var YBe=new $Be;function VBe(e,t){return YBe.map(e,{config:t})}var XBe=Mwe.version;var JBe=Object.freeze({__proto__:null,normalize:yTe,version:XBe,compile:WBe,extractTransforms:VBe});var ZBe=Q((function(e,t){Object.defineProperty(t,"__esModule",{value:true});function n(e){var t=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g;var n=t.exec(e).slice(1,3),r=n[0],i=n[1];return{library:r,version:i}}t.default=n}));var QBe=Z(ZBe);var KBe="vega-themes";var eUe="2.6.1";var tUe="Themes for stylized Vega and Vega-Lite visualizations.";var nUe=["vega","vega-lite","themes","style"];var rUe="BSD-3-Clause";var iUe={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"};var aUe=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"http://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}];var oUe="build/vega-themes.js";var uUe="build/src/index.js";var sUe="build/vega-themes.min.js";var lUe="build/vega-themes.min.js";var fUe="build/src/index.d.ts";var cUe={type:"git",url:"https://github.com/vega/vega-themes.git"};var hUe={prepare:"beemo create-config --silent",clean:"rm -rf build examples/build",prettierbase:"beemo prettier 'examples/*.{html,scss,css}'",eslintbase:"beemo eslint 'src/**/*.ts'",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",prebuild:"mkdir -p build",build:"tsc && rollup -c",postbuild:"terser build/vega-themes.js -cm > build/vega-themes.min.js","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Typescript,Rollup 'yarn serve' 'tsc -w' 'rollup -c -w'"};var dUe={"@rollup/plugin-json":"^4.0.1","browser-sync":"^2.26.7",concurrently:"^5.1.0","gh-pages":"^2.2.0",rollup:"^1.30.1",terser:"^4.6.3",typescript:"~3.7.5",vega:"^5.9.0","vega-lite":"^4.0.0","vega-lite-dev-config":"^0.3.1"};var pUe={vega:"*","vega-lite":"*"};var vUe={module:"vega-lite-dev-config",drivers:["prettier","eslint"]};var gUe={name:KBe,version:eUe,description:tUe,keywords:nUe,license:rUe,author:iUe,contributors:aUe,main:oUe,module:uUe,unpkg:sUe,jsdelivr:lUe,typings:fUe,repository:cUe,scripts:hUe,devDependencies:dUe,peerDependencies:pUe,beemo:vUe};var mUe="#fff";var yUe="#888";var bUe={background:"#333",title:{color:mUe},style:{"guide-label":{fill:mUe},"guide-title":{fill:mUe}},axis:{domainColor:mUe,gridColor:yUe,tickColor:mUe}};var _Ue="#4572a7";var xUe={background:"#fff",arc:{fill:_Ue},area:{fill:_Ue},line:{stroke:_Ue,strokeWidth:2},path:{stroke:_Ue},rect:{fill:_Ue},shape:{stroke:_Ue},symbol:{fill:_Ue,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:true,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:false,tickExtra:true},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}};var wUe="#30a2da";var kUe="#cbcbcb";var AUe="#999";var EUe="#333";var MUe="#f0f0f0";var OUe="#333";var SUe={arc:{fill:wUe},area:{fill:wUe},axis:{domainColor:kUe,grid:true,gridColor:kUe,gridWidth:1,labelColor:AUe,labelFontSize:10,titleColor:EUe,tickColor:kUe,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:false},background:MUe,group:{fill:MUe},legend:{labelColor:OUe,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:OUe,titleFontSize:14,titlePadding:10},line:{stroke:wUe,strokeWidth:2},path:{stroke:wUe,strokeWidth:.5},rect:{fill:wUe},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:true,shape:"circle"},shape:{stroke:wUe},style:{bar:{binSpacing:2,fill:wUe,stroke:null}},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}};var DUe="#000";var CUe={group:{fill:"#e5e5e5"},arc:{fill:DUe},area:{fill:DUe},line:{stroke:DUe},path:{stroke:DUe},rect:{fill:DUe},shape:{stroke:DUe},symbol:{fill:DUe,size:40},axis:{domain:false,grid:true,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}};var FUe=22;var TUe="normal";var NUe="Benton Gothic, sans-serif";var jUe=11.5;var RUe="normal";var zUe="#82c6df";var PUe="Benton Gothic Bold, sans-serif";var LUe="normal";var IUe=13;var BUe={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]};var UUe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:PUe,fontSize:FUe,fontWeight:TUe},arc:{fill:zUe},area:{fill:zUe},line:{stroke:zUe,strokeWidth:2},path:{stroke:zUe},rect:{fill:zUe},shape:{stroke:zUe},symbol:{fill:zUe,size:30},axis:{labelFont:NUe,labelFontSize:jUe,labelFontWeight:RUe,titleFont:PUe,titleFontSize:IUe,titleFontWeight:LUe},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:NUe,labelFontSize:jUe,symbolType:"square",titleFont:PUe,titleFontSize:IUe,titleFontWeight:LUe},range:{category:BUe["category-6"],diverging:BUe["fireandice-6"],heatmap:BUe["fire-7"],ordinal:BUe["fire-7"],ramp:BUe["fire-7"]}};var qUe="#ab5787";var WUe="#979797";var HUe={background:"#f9f9f9",arc:{fill:qUe},area:{fill:qUe},line:{stroke:qUe},path:{stroke:qUe},rect:{fill:qUe},shape:{stroke:qUe},symbol:{fill:qUe,size:30},axis:{domainColor:WUe,domainWidth:.5,gridWidth:.2,labelColor:WUe,tickColor:WUe,tickWidth:.2,titleColor:WUe},axisBand:{grid:false},axisX:{grid:true,tickSize:10},axisY:{domain:false,grid:true,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}};var GUe="#3e5c69";var $Ue={background:"#fff",arc:{fill:GUe},area:{fill:GUe},line:{stroke:GUe},path:{stroke:GUe},rect:{fill:GUe},shape:{stroke:GUe},symbol:{fill:GUe},axis:{domainWidth:.5,grid:true,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:false},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}};var YUe="#1696d2";var VUe="#000000";var XUe="#FFFFFF";var JUe="Lato";var ZUe="Lato";var QUe="Lato";var KUe="#DEDDDD";var eqe=18;var tqe={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]};var nqe={background:XUe,title:{anchor:"start",fontSize:eqe,font:JUe},axisX:{domain:true,domainColor:VUe,domainWidth:1,grid:false,labelFontSize:12,labelFont:ZUe,labelAngle:0,tickColor:VUe,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:JUe},axisY:{domain:false,domainWidth:1,grid:true,gridColor:KUe,gridWidth:1,labelFontSize:12,labelFont:ZUe,labelPadding:8,ticks:false,titleFontSize:12,titlePadding:10,titleFont:JUe,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:ZUe,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:JUe,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:tqe["six-groups-cat-1"],diverging:tqe["diverging-colors"],heatmap:tqe["diverging-colors"],ordinal:tqe["six-groups-seq"],ramp:tqe["shades-blue"]},area:{fill:YUe},rect:{fill:YUe},line:{color:YUe,stroke:YUe,strokeWidth:5},trail:{color:YUe,stroke:YUe,strokeWidth:0,size:1},path:{stroke:YUe,strokeWidth:.5},point:{filled:true},text:{font:QUe,color:YUe,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:YUe,stroke:null}},arc:{fill:YUe},shape:{stroke:YUe},symbol:{fill:YUe,size:30}};var rqe=gUe.version;var iqe=Object.freeze({__proto__:null,version:rqe,dark:bUe,excel:xUe,fivethirtyeight:SUe,ggplot2:CUe,latimes:UUe,quartz:HUe,vox:$Ue,urbaninstitute:nqe});var aqe="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n";var oqe="vg-tooltip-element";var uqe={offsetX:10,offsetY:10,id:oqe,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:false,sanitize:sqe,maxDepth:2};function sqe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function lqe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e)){throw new Error("Invalid HTML ID")}return aqe.toString().replace(oqe,e)}function fqe(e,t,n){e.fields=t||[];e.fname=n;return e}function cqe(e){throw Error(e)}function hqe(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)cqe("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)cqe("Access path missing closing bracket: "+e);if(n)cqe("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var dqe=Array.isArray;function pqe(e){return e===Object(e)}function vqe(e){return typeof e==="string"}function gqe(e){return dqe(e)?"["+e.map(gqe)+"]":pqe(e)||vqe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function mqe(e,t){var n=hqe(e),r="return _["+n.map(gqe).join("][")+"];";return fqe(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var yqe=[];var bqe=mqe("id");var _qe=fqe((function(e){return e}),yqe,"identity");var xqe=fqe((function(){return 0}),yqe,"zero");var wqe=fqe((function(){return 1}),yqe,"one");var kqe=fqe((function(){return true}),yqe,"true");var Aqe=fqe((function(){return false}),yqe,"false");var Eqe=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function Mqe(e,t,n){if(dqe(e)){return"["+e.map((function(e){return t(vqe(e)?e:Sqe(e,n))})).join(", ")+"]"}if(pqe(e)){var r="";var i=e,a=i.title,o=Eqe(i,["title"]);if(a){r+="<h2>"+t(a)+"</h2>"}var u=Object.keys(o);if(u.length>0){r+="<table>";for(var s=0,l=u;s<l.length;s++){var f=l[s];var c=o[f];if(c===undefined){continue}if(pqe(c)){c=Sqe(c,n)}r+='<tr><td class="key">'+t(f)+':</td><td class="value">'+t(c)+"</td></tr>"}r+="</table>"}return r||"{}"}return t(e)}function Oqe(e){var t=[];return function(n,r){if(typeof r!=="object"||r===null){return r}var i=t.indexOf(this)+1;t.length=i;if(t.length>e){return"[Object]"}if(t.indexOf(r)>=0){return"[Circular]"}t.push(r);return r}}function Sqe(e,t){return JSON.stringify(e,Oqe(t))}function Dqe(e,t,n,r){var i=e.clientX+n;if(i+t.width>window.innerWidth){i=+e.clientX-n-t.width}var a=e.clientY+r;if(a+t.height>window.innerHeight){a=+e.clientY-r-t.height}return{x:i,y:a}}var Cqe=function(){function e(e){this.options=Object.assign(Object.assign({},uqe),e);var t=this.options.id;this.call=this.tooltipHandler.bind(this);if(!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){var n=document.createElement("style");n.setAttribute("id",this.options.styleId);n.innerHTML=lqe(t);var r=document.head;if(r.childNodes.length>0){r.insertBefore(n,r.childNodes[0])}else{r.appendChild(n)}}this.el=document.getElementById(t);if(!this.el){this.el=document.createElement("div");this.el.setAttribute("id",t);this.el.classList.add("vg-tooltip");document.body.appendChild(this.el)}}e.prototype.tooltipHandler=function(e,t,n,r){if(r==null||r===""){this.el.classList.remove("visible",this.options.theme+"-theme");return}this.el.innerHTML=Mqe(r,this.options.sanitize,this.options.maxDepth);this.el.classList.add("visible",this.options.theme+"-theme");var i=Dqe(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY),a=i.x,o=i.y;this.el.setAttribute("style","top: "+o+"px; left: "+a+"px")};return e}();function Fqe(e,t,n){var r=e.open(t);var i=1e4;var a=250;var o=~~(i/a);function u(t){if(t.source===r){o=0;e.removeEventListener("message",u,false)}}e.addEventListener("message",u,false);function s(){if(o<=0){return}r.postMessage(n,"*");setTimeout(s,a);o-=1}setTimeout(s,a)}var Tqe='.vega-embed {\n  position: relative;\n  display: inline-block; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5); }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: scroll;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e}}function Nqe(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}for(var r=0,i=t;r<i.length;r++){var a=i[r];jqe(e,a)}return e}function jqe(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Me(e,i,t[i],true)}}var Rqe,zqe;var Pqe=rwe;var Lqe=JBe;var Iqe=typeof window!=="undefined"?window:undefined;if(Lqe===undefined&&((zqe=(Rqe=Iqe)===null||Rqe===void 0?void 0:Rqe["vl"])===null||zqe===void 0?void 0:zqe.compile)){Lqe=Iqe["vl"]}var Bqe={export:{svg:true,png:true},source:true,compiled:true,editor:true};var Uqe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"};var qqe={vega:"Vega","vega-lite":"Vega-Lite"};var Wqe={vega:Pqe.version,"vega-lite":Lqe?Lqe.version:"not available"};var Hqe={vega:function(e){return e},"vega-lite":function(e,t){return Lqe.compile(e,{config:t}).spec}};var Gqe='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>';function $qe(e){return typeof e==="function"}function Yqe(e,t,n,r){var i="<html><head>"+t+'</head><body><pre><code class="json">';var a="</code></pre>"+n+"</body></html>";var o=window.open("");o.document.write(i+e+a);o.document.title=qqe[r]+" JSON Source"}function Vqe(e,t){var n;if(e.$schema){var r=QBe(e.$schema);if(t&&t!==r.library){console.warn("The given visualization spec is written in "+qqe[r.library]+", but mode argument sets "+(n=qqe[t],n!==null&&n!==void 0?n:t)+".")}var i=r.library;if(!ee(Wqe[i],"^"+r.version.slice(1))){console.warn("The input spec uses "+qqe[i]+" "+r.version+", but the current version of "+qqe[i]+" is v"+Wqe[i]+".")}return i}if("mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e){return"vega-lite"}if("marks"in e||"signals"in e||"scales"in e||"axes"in e){return"vega"}return t!==null&&t!==void 0?t:"vega"}function Xqe(e){return!!(e&&"load"in e)}function Jqe(e,t,n){if(n===void 0){n={}}var r,i,a;return d(this,void 0,void 0,(function(){var o,u,s,l,f,c,h,d;return __generator(this,(function(p){switch(p.label){case 0:o=Xqe(n.loader)?n.loader:Pqe.loader(n.loader);if(!Ln(t))return[3,2];f=(l=JSON).parse;return[4,o.load(t)];case 1:s=f.apply(l,[p.sent()]);return[3,3];case 2:s=t;p.label=3;case 3:u=s;return[4,Zqe((r=u.usermeta&&u.usermeta["embedOptions"],r!==null&&r!==void 0?r:{}),o)];case 4:c=p.sent();return[4,Zqe(n,o)];case 5:h=p.sent();d=Object.assign(Object.assign({},Nqe(h,c)),{config:Vn((i=h.config,i!==null&&i!==void 0?i:{}),(a=c.config,a!==null&&a!==void 0?a:{}))});return[4,Qqe(e,u,d,o)];case 6:return[2,p.sent()]}}))}))}function Zqe(e,t){var n;return d(this,void 0,void 0,(function(){var r,i,a,o,u,s,l,f;return __generator(this,(function(c){switch(c.label){case 0:if(!Ln(e.config))return[3,2];o=(a=JSON).parse;return[4,t.load(e.config)];case 1:i=o.apply(a,[c.sent()]);return[3,3];case 2:i=(n=e.config,n!==null&&n!==void 0?n:{});c.label=3;case 3:r=i;if(!Ln(e.patch))return[3,5];f=(l=JSON).parse;return[4,t.load(e.patch)];case 4:s=f.apply(l,[c.sent()]);return[3,6];case 5:s=e.patch;c.label=6;case 6:u=s;return[2,Object.assign(Object.assign(Object.assign({},e),u?{patch:u}:{}),r?{config:r}:{})]}}))}))}function Qqe(e,t,n,r){if(n===void 0){n={}}var i,a,o,u,s,l;return d(this,void 0,void 0,(function(){function f(){if(N){document.removeEventListener("click",N)}M.finalize()}var c,h,p,v,g,m,y,b,_,x,w,k,A,E,M,O,S,D,C,T,N,j,R,z,P,L,I,B,U,q,W,H,G;return __generator(this,(function($){switch($.label){case 0:c=n.theme?Vn(iqe[n.theme],(i=n.config,i!==null&&i!==void 0?i:{})):n.config;h=sr(n.actions)?n.actions:Nqe({},Bqe,(a=n.actions,a!==null&&a!==void 0?a:{}));p=Object.assign(Object.assign({},Uqe),n.i18n);v=(o=n.renderer,o!==null&&o!==void 0?o:"canvas");g=(u=n.logLevel,u!==null&&u!==void 0?u:Pqe.Warn);m=(s=n.downloadFileName,s!==null&&s!==void 0?s:"visualization");if(n.defaultStyle!==false){y="vega-embed-style";if(!document.getElementById(y)){b=document.createElement("style");b.id=y;b.innerText=n.defaultStyle===undefined||n.defaultStyle===true?Tqe.toString():n.defaultStyle;document.head.appendChild(b)}}_=Vqe(t,n.mode);x=Hqe[_](t,c);if(_==="vega-lite"){if(x.$schema){w=QBe(x.$schema);if(!ee(Wqe.vega,"^"+w.version.slice(1))){console.warn("The compiled spec uses Vega "+w.version+", but current version is v"+Wqe.vega+".")}}}k=typeof e==="string"?document.querySelector(e):e;if(!k){throw Error(e+" does not exist")}k.classList.add("vega-embed");if(h){k.classList.add("has-actions")}k.innerHTML="";A=n.patch;if(A){if(A instanceof Function){x=A(x)}else{x=F(x,A,true,false).newDocument}}if(n.formatLocale){Pqe.formatLocale(n.formatLocale)}if(n.timeFormatLocale){Pqe.timeFormatLocale(n.timeFormatLocale)}E=Pqe.parse(x,_==="vega-lite"?{}:c);M=new Pqe.View(E,{loader:r,logLevel:g,renderer:v});if(n.tooltip!==false){O=void 0;if($qe(n.tooltip)){O=n.tooltip}else{O=new Cqe(n.tooltip===true?{}:n.tooltip).call}M.tooltip(O)}S=n.hover;if(S===undefined){S=_==="vega"}if(S){D=typeof S==="boolean"?{}:S,C=D.hoverSet,T=D.updateSet;M.hover(C,T)}if(n){if(n.width){M.width(n.width)}if(n.height){M.height(n.height)}if(n.padding){M.padding(n.padding)}}return[4,M.initialize(e).runAsync()];case 1:$.sent();if(h!==false){j=k;if(n.defaultStyle!==false){R=document.createElement("details");R.title=p.CLICK_TO_VIEW_ACTIONS;k.append(R);j=R;z=document.createElement("summary");z.innerHTML=Gqe;R.append(z);N=function(e){if(!R.contains(e.target)){R.removeAttribute("open")}};document.addEventListener("click",N)}P=document.createElement("div");j.append(P);P.classList.add("vega-actions");if(h===true||h.export!==false){L=function(e){if(h===true||h.export===true||h.export[e]){var t=p[e.toUpperCase()+"_ACTION"];var r=document.createElement("a");r.text=t;r.href="#";r.target="_blank";r.download=m+"."+e;r.addEventListener("mousedown",(function(t){return d(this,void 0,void 0,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:t.preventDefault();return[4,M.toImageURL(e,n.scaleFactor)];case 1:r=i.sent();this.href=r;return[2]}}))}))}));P.append(r)}};for(I=0,B=["svg","png"];I<B.length;I++){U=B[I];L(U)}}if(h===true||h.source!==false){q=document.createElement("a");q.text=p.SOURCE_ACTION;q.href="#";q.addEventListener("mousedown",(function(e){var r,i;Yqe(J(t),(r=n.sourceHeader,r!==null&&r!==void 0?r:""),(i=n.sourceFooter,i!==null&&i!==void 0?i:""),_);e.preventDefault()}));P.append(q)}if(_==="vega-lite"&&(h===true||h.compiled!==false)){W=document.createElement("a");W.text=p.COMPILED_ACTION;W.href="#";W.addEventListener("mousedown",(function(e){var t,r;Yqe(J(x),(t=n.sourceHeader,t!==null&&t!==void 0?t:""),(r=n.sourceFooter,r!==null&&r!==void 0?r:""),"vega");e.preventDefault()}));P.append(W)}if(h===true||h.editor!==false){H=(l=n.editorUrl,l!==null&&l!==void 0?l:"https://vega.github.io/editor/");G=document.createElement("a");G.text=p.EDITOR_ACTION;G.href="#";G.addEventListener("mousedown",(function(e){Fqe(window,H,{config:c,mode:_,renderer:v,spec:J(t)});e.preventDefault()}));P.append(G)}}return[2,{view:M,spec:t,vgSpec:x,finalize:f}]}}))}))}var Kqe=e("my_component",function(){function e(e){t(this,e);this.barData={$schema:"https://vega.github.io/schema/vega/v5.json",width:400,height:200,padding:5,data:[{name:"table",values:[{category:"A",amount:28},{category:"B",amount:55},{category:"C",amount:43},{category:"D",amount:91},{category:"E",amount:81},{category:"F",amount:53},{category:"G",amount:19},{category:"H",amount:87}]}],signals:[{name:"tooltip",value:{},on:[{events:"rect:mouseover",update:"datum"},{events:"rect:mouseout",update:"{}"}]}],scales:[{name:"xscale",type:"band",domain:{data:"table",field:"category"},range:"width",padding:.05,round:true},{name:"yscale",domain:{data:"table",field:"amount"},nice:true,range:"height"}],axes:[{orient:"bottom",scale:"xscale"},{orient:"left",scale:"yscale"}],marks:[{type:"rect",from:{data:"table"},encode:{enter:{x:{scale:"xscale",field:"category"},width:{scale:"xscale",band:1},y:{scale:"yscale",field:"amount"},y2:{scale:"yscale",value:0}},update:{fill:{value:"steelblue"}},hover:{fill:{value:"red"}}}},{type:"text",encode:{enter:{align:{value:"center"},baseline:{value:"bottom"},fill:{value:"#333"}},update:{x:{scale:"xscale",signal:"tooltip.category",band:.5},y:{scale:"yscale",signal:"tooltip.amount",offset:-2},text:{signal:"tooltip.amount"},fillOpacity:[{test:"datum === tooltip",value:0},{value:1}]}}}]}}e.prototype.componentDidLoad=function(){var e=this.element.shadowRoot.querySelector("#bar");Jqe(e,this.barData).then((function(e){return e.view}))};e.prototype.render=function(){return n("div",null,n("div",{id:"bar"}))};Object.defineProperty(e.prototype,"element",{get:function(){return r(this)},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return"STYLE_TEXT_PLACEHOLDER:my-component"},enumerable:true,configurable:true});return e}())}}}));